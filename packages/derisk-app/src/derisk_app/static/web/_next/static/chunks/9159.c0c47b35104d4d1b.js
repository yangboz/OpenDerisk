(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9159,919],{74266:function(e,o,n){var r={"./simpleWorker":50223,"./simpleWorker.js":50223,"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/base/common/worker/simpleWorker":50223,"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/base/common/worker/simpleWorker.js":50223};function t(e){return Promise.resolve().then(function(){if(!n.o(r,e)){var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return n(r[e])})}t.keys=function(){return Object.keys(r)},t.id=74266,e.exports=t},79410:function(e,o,n){var r={"./editorBaseApi":[54726],"./editorBaseApi.js":[54726],"./editorSimpleWorker":[56216],"./editorSimpleWorker.js":[56216],"./editorWorker":[14541],"./editorWorker.js":[14541],"./editorWorkerHost":[7570],"./editorWorkerHost.js":[7570],"./findSectionHeaders":[26767],"./findSectionHeaders.js":[26767],"./getIconClasses":[25129],"./getIconClasses.js":[25129],"./languageFeatureDebounce":[27825],"./languageFeatureDebounce.js":[27825],"./languageFeatures":[47924],"./languageFeatures.js":[47924],"./languageFeaturesService":[26524],"./languageFeaturesService.js":[26524],"./languageService":[39920],"./languageService.js":[39920],"./languagesAssociations":[15981],"./languagesAssociations.js":[15981],"./languagesRegistry":[27921],"./languagesRegistry.js":[27921],"./markerDecorations":[90231],"./markerDecorations.js":[90231],"./markerDecorationsService":[15761],"./markerDecorationsService.js":[15761],"./model":[42361],"./model.js":[42361],"./modelService":[95451],"./modelService.js":[95451],"./resolverService":[16417],"./resolverService.js":[16417],"./semanticTokensDto":[77263],"./semanticTokensDto.js":[77263],"./semanticTokensProviderStyling":[89094],"./semanticTokensProviderStyling.js":[89094],"./semanticTokensStyling":[51819],"./semanticTokensStyling.js":[51819],"./semanticTokensStylingService":[79837],"./semanticTokensStylingService.js":[79837],"./textModelSync/textModelSync.impl":[48838],"./textModelSync/textModelSync.impl.js":[48838],"./textModelSync/textModelSync.protocol":[45858,5858],"./textModelSync/textModelSync.protocol.js":[45858,5858],"./textResourceConfiguration":[95633],"./textResourceConfiguration.js":[95633],"./treeSitterParserService":[25224],"./treeSitterParserService.js":[25224],"./treeViewsDnd":[10234],"./treeViewsDnd.js":[10234],"./treeViewsDndService":[8743],"./treeViewsDndService.js":[8743],"./unicodeTextModelHighlighter":[69810],"./unicodeTextModelHighlighter.js":[69810],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/editorBaseApi":[54726],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/editorBaseApi.js":[54726],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/editorSimpleWorker":[56216],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/editorSimpleWorker.js":[56216],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/editorWorker":[14541],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/editorWorker.js":[14541],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/editorWorkerHost":[7570],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/editorWorkerHost.js":[7570],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/findSectionHeaders":[26767],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/findSectionHeaders.js":[26767],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/getIconClasses":[25129],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/getIconClasses.js":[25129],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/languageFeatureDebounce":[27825],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/languageFeatureDebounce.js":[27825],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/languageFeatures":[47924],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/languageFeatures.js":[47924],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/languageFeaturesService":[26524],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/languageFeaturesService.js":[26524],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/languageService":[39920],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/languageService.js":[39920],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/languagesAssociations":[15981],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/languagesAssociations.js":[15981],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/languagesRegistry":[27921],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/languagesRegistry.js":[27921],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/markerDecorations":[90231],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/markerDecorations.js":[90231],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/markerDecorationsService":[15761],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/markerDecorationsService.js":[15761],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/model":[42361],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/model.js":[42361],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/modelService":[95451],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/modelService.js":[95451],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/resolverService":[16417],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/resolverService.js":[16417],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensDto":[77263],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensDto.js":[77263],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensProviderStyling":[89094],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensProviderStyling.js":[89094],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensStyling":[51819],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensStyling.js":[51819],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensStylingService":[79837],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensStylingService.js":[79837],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.impl":[48838],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.impl.js":[48838],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.protocol":[45858,5858],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.protocol.js":[45858,5858],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/textResourceConfiguration":[95633],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/textResourceConfiguration.js":[95633],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/treeSitterParserService":[25224],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/treeSitterParserService.js":[25224],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/treeViewsDnd":[10234],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/treeViewsDnd.js":[10234],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/treeViewsDndService":[8743],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/treeViewsDndService.js":[8743],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/unicodeTextModelHighlighter":[69810],"node_modules/.pnpm/monaco-editor@0.52.2/node_modules/monaco-editor/esm/vs/editor/common/services/unicodeTextModelHighlighter.js":[69810]};function t(e){if(!n.o(r,e))return Promise.resolve().then(function(){var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o});var o=r[e],t=o[0];return Promise.all(o.slice(1).map(n.e)).then(function(){return n(t)})}t.keys=function(){return Object.keys(r)},t.id=79410,e.exports=t},94138:function(e,o,n){"use strict";let r;n.d(o,{Z:function(){return g}});var t=n(52676),a=n(21011),i=n(92821),s=n(67167),l=n(9181),d=n(82187),c=n.n(d),u=n(8661),m=n(75271);async function f(){window.obMonaco={getWorkerUrl:e=>{switch(e){case"mysql":return location.origin+"/_next/static/ob-workers/mysql.js";case"obmysql":return location.origin+"/_next/static/ob-workers/obmysql.js";case"oboracle":return location.origin+"/_next/static/ob-workers/oracle.js"}return""}};let e=await n.e(7634).then(n.bind(n,27634)),o=e.default;return r||(r=new o).setup(["mysql"]),r}function g(e){let{className:o,value:n,language:r="mysql",onChange:d,thoughts:u,session:g}=e,p=(0,m.useMemo)(()=>"mysql"!==r?n:u&&u.length>0?(0,i._m)("-- ".concat(u," \n").concat(n)):(0,i._m)(n),[n,u]),v=(0,l.Z)(g),x=(0,m.useContext)(a.p);async function h(e){var o,n;let r=await f();r.setModelOptions((null===(o=e.getModel())||void 0===o?void 0:o.id)||"",function(e,o){let{_modelId:n,delimiter:r}=e;return{delimiter:r,async getTableList(e){var n;return(null==o?void 0:null===(n=o())||void 0===n?void 0:n.getTableList(e))||[]},async getTableColumns(e,n){var r;return(null==o?void 0:null===(r=o())||void 0===r?void 0:r.getTableColumns(e))||[]},async getSchemaList(){var e;return(null==o?void 0:null===(e=o())||void 0===e?void 0:e.getSchemaList())||[]}}}({modelId:(null===(n=e.getModel())||void 0===n?void 0:n.id)||"",delimiter:";"},()=>v.current||null))}return(0,t.jsx)(s.ZP,{className:c()(o),onMount:h,value:p,defaultLanguage:r,onChange:d,theme:(null==x?void 0:x.mode)!=="dark"?"github":"githubDark",options:{minimap:{enabled:!1},wordWrap:"on"}})}s._m.config({monaco:u}),u.editor.defineTheme("github",{base:"vs",inherit:!0,rules:[{background:"ffffff",token:""},{foreground:"6a737d",token:"comment"},{foreground:"6a737d",token:"punctuation.definition.comment"},{foreground:"6a737d",token:"string.comment"},{foreground:"005cc5",token:"constant"},{foreground:"005cc5",token:"entity.name.constant"},{foreground:"005cc5",token:"variable.other.constant"},{foreground:"005cc5",token:"variable.language"},{foreground:"6f42c1",token:"entity"},{foreground:"6f42c1",token:"entity.name"},{foreground:"24292e",token:"variable.parameter.function"},{foreground:"22863a",token:"entity.name.tag"},{foreground:"d73a49",token:"keyword"},{foreground:"d73a49",token:"storage"},{foreground:"d73a49",token:"storage.type"},{foreground:"24292e",token:"storage.modifier.package"},{foreground:"24292e",token:"storage.modifier.import"},{foreground:"24292e",token:"storage.type.java"},{foreground:"032f62",token:"string"},{foreground:"032f62",token:"punctuation.definition.string"},{foreground:"032f62",token:"string punctuation.section.embedded source"},{foreground:"005cc5",token:"support"},{foreground:"005cc5",token:"meta.property-name"},{foreground:"e36209",token:"variable"},{foreground:"24292e",token:"variable.other"},{foreground:"b31d28",fontStyle:"bold italic underline",token:"invalid.broken"},{foreground:"b31d28",fontStyle:"bold italic underline",token:"invalid.deprecated"},{foreground:"fafbfc",background:"b31d28",fontStyle:"italic underline",token:"invalid.illegal"},{foreground:"fafbfc",background:"d73a49",fontStyle:"italic underline",token:"carriage-return"},{foreground:"b31d28",fontStyle:"bold italic underline",token:"invalid.unimplemented"},{foreground:"b31d28",token:"message.error"},{foreground:"24292e",token:"string source"},{foreground:"005cc5",token:"string variable"},{foreground:"032f62",token:"source.regexp"},{foreground:"032f62",token:"string.regexp"},{foreground:"032f62",token:"string.regexp.character-class"},{foreground:"032f62",token:"string.regexp constant.character.escape"},{foreground:"032f62",token:"string.regexp source.ruby.embedded"},{foreground:"032f62",token:"string.regexp string.regexp.arbitrary-repitition"},{foreground:"22863a",fontStyle:"bold",token:"string.regexp constant.character.escape"},{foreground:"005cc5",token:"support.constant"},{foreground:"005cc5",token:"support.variable"},{foreground:"005cc5",token:"meta.module-reference"},{foreground:"735c0f",token:"markup.list"},{foreground:"005cc5",fontStyle:"bold",token:"markup.heading"},{foreground:"005cc5",fontStyle:"bold",token:"markup.heading entity.name"},{foreground:"22863a",token:"markup.quote"},{foreground:"24292e",fontStyle:"italic",token:"markup.italic"},{foreground:"24292e",fontStyle:"bold",token:"markup.bold"},{foreground:"005cc5",token:"markup.raw"},{foreground:"b31d28",background:"ffeef0",token:"markup.deleted"},{foreground:"b31d28",background:"ffeef0",token:"meta.diff.header.from-file"},{foreground:"b31d28",background:"ffeef0",token:"punctuation.definition.deleted"},{foreground:"22863a",background:"f0fff4",token:"markup.inserted"},{foreground:"22863a",background:"f0fff4",token:"meta.diff.header.to-file"},{foreground:"22863a",background:"f0fff4",token:"punctuation.definition.inserted"},{foreground:"e36209",background:"ffebda",token:"markup.changed"},{foreground:"e36209",background:"ffebda",token:"punctuation.definition.changed"},{foreground:"f6f8fa",background:"005cc5",token:"markup.ignored"},{foreground:"f6f8fa",background:"005cc5",token:"markup.untracked"},{foreground:"6f42c1",fontStyle:"bold",token:"meta.diff.range"},{foreground:"005cc5",token:"meta.diff.header"},{foreground:"005cc5",fontStyle:"bold",token:"meta.separator"},{foreground:"005cc5",token:"meta.output"},{foreground:"586069",token:"brackethighlighter.tag"},{foreground:"586069",token:"brackethighlighter.curly"},{foreground:"586069",token:"brackethighlighter.round"},{foreground:"586069",token:"brackethighlighter.square"},{foreground:"586069",token:"brackethighlighter.angle"},{foreground:"586069",token:"brackethighlighter.quote"},{foreground:"b31d28",token:"brackethighlighter.unmatched"},{foreground:"b31d28",token:"sublimelinter.mark.error"},{foreground:"e36209",token:"sublimelinter.mark.warning"},{foreground:"959da5",token:"sublimelinter.gutter-mark"},{foreground:"032f62",fontStyle:"underline",token:"constant.other.reference.link"},{foreground:"032f62",fontStyle:"underline",token:"string.other.link"}],colors:{"editor.foreground":"#24292e","editor.background":"#ffffff","editor.selectionBackground":"#c8c8fa","editor.inactiveSelectionBackground":"#fafbfc","editor.lineHighlightBackground":"#fafbfc","editorCursor.foreground":"#24292e","editorWhitespace.foreground":"#959da5","editorIndentGuide.background":"#959da5","editorIndentGuide.activeBackground":"#24292e","editor.selectionHighlightBorder":"#fafbfc"}}),u.editor.defineTheme("githubDark",{base:"vs-dark",inherit:!0,rules:[{background:"24292e",token:""},{foreground:"959da5",token:"comment"},{foreground:"959da5",token:"punctuation.definition.comment"},{foreground:"959da5",token:"string.comment"},{foreground:"c8e1ff",token:"constant"},{foreground:"c8e1ff",token:"entity.name.constant"},{foreground:"c8e1ff",token:"variable.other.constant"},{foreground:"c8e1ff",token:"variable.language"},{foreground:"b392f0",token:"entity"},{foreground:"b392f0",token:"entity.name"},{foreground:"f6f8fa",token:"variable.parameter.function"},{foreground:"7bcc72",token:"entity.name.tag"},{foreground:"ea4a5a",token:"keyword"},{foreground:"ea4a5a",token:"storage"},{foreground:"ea4a5a",token:"storage.type"},{foreground:"f6f8fa",token:"storage.modifier.package"},{foreground:"f6f8fa",token:"storage.modifier.import"},{foreground:"f6f8fa",token:"storage.type.java"},{foreground:"79b8ff",token:"string"},{foreground:"79b8ff",token:"punctuation.definition.string"},{foreground:"79b8ff",token:"string punctuation.section.embedded source"},{foreground:"c8e1ff",token:"support"},{foreground:"c8e1ff",token:"meta.property-name"},{foreground:"fb8532",token:"variable"},{foreground:"f6f8fa",token:"variable.other"},{foreground:"d73a49",fontStyle:"bold italic underline",token:"invalid.broken"},{foreground:"d73a49",fontStyle:"bold italic underline",token:"invalid.deprecated"},{foreground:"fafbfc",background:"d73a49",fontStyle:"italic underline",token:"invalid.illegal"},{foreground:"fafbfc",background:"d73a49",fontStyle:"italic underline",token:"carriage-return"},{foreground:"d73a49",fontStyle:"bold italic underline",token:"invalid.unimplemented"},{foreground:"d73a49",token:"message.error"},{foreground:"f6f8fa",token:"string source"},{foreground:"c8e1ff",token:"string variable"},{foreground:"79b8ff",token:"source.regexp"},{foreground:"79b8ff",token:"string.regexp"},{foreground:"79b8ff",token:"string.regexp.character-class"},{foreground:"79b8ff",token:"string.regexp constant.character.escape"},{foreground:"79b8ff",token:"string.regexp source.ruby.embedded"},{foreground:"79b8ff",token:"string.regexp string.regexp.arbitrary-repitition"},{foreground:"7bcc72",fontStyle:"bold",token:"string.regexp constant.character.escape"},{foreground:"c8e1ff",token:"support.constant"},{foreground:"c8e1ff",token:"support.variable"},{foreground:"c8e1ff",token:"meta.module-reference"},{foreground:"fb8532",token:"markup.list"},{foreground:"0366d6",fontStyle:"bold",token:"markup.heading"},{foreground:"0366d6",fontStyle:"bold",token:"markup.heading entity.name"},{foreground:"c8e1ff",token:"markup.quote"},{foreground:"f6f8fa",fontStyle:"italic",token:"markup.italic"},{foreground:"f6f8fa",fontStyle:"bold",token:"markup.bold"},{foreground:"c8e1ff",token:"markup.raw"},{foreground:"b31d28",background:"ffeef0",token:"markup.deleted"},{foreground:"b31d28",background:"ffeef0",token:"meta.diff.header.from-file"},{foreground:"b31d28",background:"ffeef0",token:"punctuation.definition.deleted"},{foreground:"176f2c",background:"f0fff4",token:"markup.inserted"},{foreground:"176f2c",background:"f0fff4",token:"meta.diff.header.to-file"},{foreground:"176f2c",background:"f0fff4",token:"punctuation.definition.inserted"},{foreground:"b08800",background:"fffdef",token:"markup.changed"},{foreground:"b08800",background:"fffdef",token:"punctuation.definition.changed"},{foreground:"2f363d",background:"959da5",token:"markup.ignored"},{foreground:"2f363d",background:"959da5",token:"markup.untracked"},{foreground:"b392f0",fontStyle:"bold",token:"meta.diff.range"},{foreground:"c8e1ff",token:"meta.diff.header"},{foreground:"0366d6",fontStyle:"bold",token:"meta.separator"},{foreground:"0366d6",token:"meta.output"},{foreground:"ffeef0",token:"brackethighlighter.tag"},{foreground:"ffeef0",token:"brackethighlighter.curly"},{foreground:"ffeef0",token:"brackethighlighter.round"},{foreground:"ffeef0",token:"brackethighlighter.square"},{foreground:"ffeef0",token:"brackethighlighter.angle"},{foreground:"ffeef0",token:"brackethighlighter.quote"},{foreground:"d73a49",token:"brackethighlighter.unmatched"},{foreground:"d73a49",token:"sublimelinter.mark.error"},{foreground:"fb8532",token:"sublimelinter.mark.warning"},{foreground:"6a737d",token:"sublimelinter.gutter-mark"},{foreground:"79b8ff",fontStyle:"underline",token:"constant.other.reference.link"},{foreground:"79b8ff",fontStyle:"underline",token:"string.other.link"}],colors:{"editor.foreground":"#f6f8fa","editor.background":"#24292e","editor.selectionBackground":"#4c2889","editor.inactiveSelectionBackground":"#444d56","editor.lineHighlightBackground":"#444d56","editorCursor.foreground":"#ffffff","editorWhitespace.foreground":"#6a737d","editorIndentGuide.background":"#6a737d","editorIndentGuide.activeBackground":"#f6f8fa","editor.selectionHighlightBorder":"#444d56"}})},2803:function(e,o,n){"use strict";var r=n(52676),t=n(87402),a=n.n(t);o.Z=function(e){let{src:o,label:n,width:t,height:i,className:s}=e;return(0,r.jsx)(a(),{className:"w-11 h-11 rounded-full mr-4 border border-gray-200 object-contain bg-white ".concat(s),width:t||44,height:i||44,src:o,alt:n||"db-icon"})}},40797:function(e,o,n){"use strict";var r=n(84769);o.Z=()=>{var e;return JSON.parse(null!==(e=localStorage.getItem(r.C9))&&void 0!==e?e:"")}},34948:function(e,o,n){"use strict";n.r(o),n.d(o,{default:function(){return ea}});var r=n(52676),t=n(21011),a=n(59864),i=n(94138),s=n(50554),l=n(84769),d=n(7036),c=n(24573),u=n(14258),m=n(3642),f=n(2590),g=n(35215),p=n(82187),v=n.n(p),x=n(87402),h=n.n(x),k=n(29052),b=n(75271),_=n(78490),j=n(31959),y=n(72423),w=n(41148),S=n(94634),N=n(84774),C=n(4093),Z=n(77635),M=n(40389),T=n(80737),D=n(32651),O=n(14486),R=n(77258),E=(0,b.memo)(e=>{let{maxNewTokensValue:o,setMaxNewTokensValue:n}=e,{appInfo:t}=(0,b.useContext)(j.ChatContentContext),{t:a}=(0,_.$G)(),i=(0,b.useMemo)(()=>{var e;return(null===(e=t.param_need)||void 0===e?void 0:e.map(e=>e.type))||[]},[t.param_need]);if(!i.includes("max_new_tokens"))return(0,r.jsx)(M.Z,{title:a("max_new_tokens_tip"),children:(0,r.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)] cursor-pointer",children:(0,r.jsx)(T.Z,{className:"text-xl cursor-not-allowed opacity-30"})})});let s=e=>{null===e||isNaN(e)||n(e)},l=e=>{n(e)};return(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(D.Z,{arrow:!1,trigger:["click"],placement:"topLeft",content:()=>(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(O.Z,{className:"w-32",min:1,max:20480,step:1,onChange:l,value:"number"==typeof o?o:4e3}),(0,r.jsx)(R.Z,{size:"small",className:"w-20",min:1,max:20480,step:1,onChange:s,value:o})]}),children:(0,r.jsx)(M.Z,{title:a("max_new_tokens"),placement:"bottom",arrow:!1,children:(0,r.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)] cursor-pointer",children:(0,r.jsx)(T.Z,{})})})}),(0,r.jsx)("span",{className:"text-sm ml-2",children:o})]})}),P=n(62237),W=n(62601),A=n(10332),H=(0,b.memo)(()=>{let{modelList:e}=(0,b.useContext)(t.p),{appInfo:o,modelValue:n,setModelValue:a}=(0,b.useContext)(j.ChatContentContext),{t:i}=(0,_.$G)(),s=(0,b.useMemo)(()=>{var e;return(null===(e=o.param_need)||void 0===e?void 0:e.map(e=>e.type))||[]},[o.param_need]);return s.includes("model")?(0,r.jsx)(W.default,{value:n,placeholder:i("choose_model"),className:"h-8 rounded-3xl",onChange:e=>{a(e)},popupMatchSelectWidth:300,children:e.map(e=>(0,r.jsx)(W.default.Option,{children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(A.Z,{model:e}),(0,r.jsx)("span",{className:"ml-2",children:e})]})},e))}):(0,r.jsx)(M.Z,{title:i("model_tip"),children:(0,r.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)]",children:(0,r.jsx)(P.Z,{className:"text-xl cursor-not-allowed opacity-30"})})})}),V=n(2803),F=n(92821),L=n(49704),q=n(80998),B=n(99113),I=n(7297),J=n(54426),$=(0,b.memo)(e=>{var o,n,t,i,s;let{fileList:l,setFileList:d,setLoading:c,fileName:u}=e,{setResourceValue:m,appInfo:f,refreshHistory:g,refreshDialogList:p,modelValue:x,resourceValue:h}=(0,b.useContext)(j.ChatContentContext),{temperatureValue:y,maxNewTokensValue:w}=(0,b.useContext)(j.ChatContentContext),S=(0,k.useSearchParams)(),N=null!==(o=null==S?void 0:S.get("scene"))&&void 0!==o?o:"",C=null!==(n=null==S?void 0:S.get("id"))&&void 0!==n?n:"",{t:Z}=(0,_.$G)(),[T,D]=(0,b.useState)([]),O=(0,b.useMemo)(()=>{var e;return(null===(e=f.param_need)||void 0===e?void 0:e.map(e=>e.type))||[]},[f.param_need]),R=(0,b.useMemo)(()=>{var e,o;return O.includes("resource")&&(null===(e=null===(o=f.param_need)||void 0===o?void 0:o.filter(e=>"resource"===e.type)[0])||void 0===e?void 0:e.value)==="database"},[f.param_need,O]),E=(0,b.useMemo)(()=>{var e,o;return O.includes("resource")&&(null===(e=null===(o=f.param_need)||void 0===o?void 0:o.filter(e=>"resource"===e.type)[0])||void 0===e?void 0:e.value)==="knowledge"},[f.param_need,O]),P=(0,b.useMemo)(()=>{var e;return null===(e=f.param_need)||void 0===e?void 0:e.find(e=>"resource"===e.type)},[f.param_need]),{run:A,loading:H}=(0,B.Z)(async()=>await (0,a.Vx)((0,a.vD)(N)),{manual:!0,onSuccess:e=>{let[,o]=e;D(null!=o?o:[])}});(0,I.Z)(async()=>{(R||E)&&!(null==P?void 0:P.bind_value)&&await A()},[R,E,P]);let $=(0,b.useMemo)(()=>{var e;return null===(e=T.map)||void 0===e?void 0:e.call(T,e=>({label:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(V.Z,{width:24,height:24,src:F.S$[e.type].icon,label:F.S$[e.type].label,className:"w-[1.5em] h-[1.5em] mr-1 inline-block mt-[-4px]"}),e.param]}),value:e.param}))},[T]),U=(0,b.useCallback)(async()=>{let e=new FormData;e.append("doc_file",null==l?void 0:l[0]),c(!0);let[o,n]=await (0,a.Vx)((0,a.qn)({convUid:C,chatMode:N,data:e,model:x,temperatureValue:y,maxNewTokensValue:w,config:{timeout:36e5}})).finally(()=>{c(!1)});n&&(m(n),await g(),await p())},[C,l,x,p,g,N,c,m]);if(!O.includes("resource"))return(0,r.jsx)(M.Z,{title:Z("extend_tip"),children:(0,r.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)]",children:(0,r.jsx)(L.Z,{className:"text-lg cursor-not-allowed opacity-30"})})});switch(null==P?void 0:P.value){case"excel_file":case"text_file":case"image_file":return(0,r.jsx)(J.default,{name:"file",accept:".csv,.xlsx,.xls",fileList:l,showUploadList:!1,beforeUpload:(e,o)=>{null==d||d(o)},customRequest:U,disabled:!!u||!!(null===(t=l[0])||void 0===t?void 0:t.name),children:(0,r.jsx)(M.Z,{title:Z("file_tip"),arrow:!1,placement:"bottom",children:(0,r.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)]",children:(0,r.jsx)(q.Z,{className:v()("text-xl",{"cursor-pointer":!(u||(null===(i=l[0])||void 0===i?void 0:i.name))})})})})});case"database":case"knowledge":case"plugin":case"awel_flow":return h||m(null==$?void 0:null===(s=$[0])||void 0===s?void 0:s.value),(0,r.jsx)(W.default,{value:h,className:"w-52 h-8 rounded-3xl",onChange:e=>{m(e)},disabled:!!(null==P?void 0:P.bind_value),loading:H,options:$})}}),U=(0,b.memo)(e=>{let{temperatureValue:o,setTemperatureValue:n}=e,{appInfo:t}=(0,b.useContext)(j.ChatContentContext),{t:a}=(0,_.$G)(),i=(0,b.useMemo)(()=>{var e;return(null===(e=t.param_need)||void 0===e?void 0:e.map(e=>e.type))||[]},[t.param_need]);if(!i.includes("temperature"))return(0,r.jsx)(M.Z,{title:a("temperature_tip"),children:(0,r.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)] cursor-pointer",children:(0,r.jsx)(T.Z,{className:"text-xl cursor-not-allowed opacity-30"})})});let s=e=>{isNaN(e)||n(e)};return(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(D.Z,{arrow:!1,trigger:["click"],placement:"topLeft",content:()=>(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(O.Z,{className:"w-20",min:0,max:1,step:.1,onChange:s,value:"number"==typeof o?o:0}),(0,r.jsx)(R.Z,{size:"small",className:"w-14",min:0,max:1,step:.1,onChange:s,value:o})]}),children:(0,r.jsx)(M.Z,{title:a("temperature"),placement:"bottom",arrow:!1,children:(0,r.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)] cursor-pointer",children:(0,r.jsx)(T.Z,{})})})}),(0,r.jsx)("span",{className:"text-sm ml-2",children:o})]})}),z=(0,b.memo)(e=>{var o,n;let{ctrl:t}=e,{t:i}=(0,_.$G)(),{history:s,scrollRef:l,canAbort:d,replyLoading:u,currentDialogue:m,appInfo:f,temperatureValue:g,maxNewTokensValue:p,resourceValue:x,setTemperatureValue:k,setMaxNewTokensValue:y,refreshHistory:w,setCanAbort:T,setReplyLoading:D,handleChat:O}=(0,b.useContext)(j.ChatContentContext),[R,P]=(0,b.useState)([]),[W,A]=(0,b.useState)(!1),[V,F]=(0,b.useState)(!1),L=(0,b.useMemo)(()=>{var e;return(null===(e=f.param_need)||void 0===e?void 0:e.map(e=>e.type))||[]},[f.param_need]),q=(0,b.useMemo)(()=>[{tip:i("stop_replying"),icon:(0,r.jsx)(N.Z,{className:v()({"text-[#0c75fc]":d})}),can_use:d,key:"abort",onClick:()=>{d&&(t.abort(),setTimeout(()=>{T(!1),D(!1)},100))}},{tip:i("answer_again"),icon:(0,r.jsx)(C.Z,{}),can_use:!u&&s.length>0,key:"redo",onClick:async()=>{var e,o;let n=null===(e=null===(o=s.filter(e=>"human"===e.role))||void 0===o?void 0:o.slice(-1))||void 0===e?void 0:e[0];O((null==n?void 0:n.context)||"",{app_code:f.app_code,...L.includes("temperature")&&{temperature:g},...L.includes("max_new_tokens")&&{max_new_tokens:p},...L.includes("resource")&&{select_param:"string"==typeof x?x:JSON.stringify(x)||m.select_param}}),setTimeout(()=>{var e,o;null===(e=l.current)||void 0===e||e.scrollTo({top:null===(o=l.current)||void 0===o?void 0:o.scrollHeight,behavior:"smooth"})},0)}},{tip:i("erase_memory"),icon:V?(0,r.jsx)(S.Z,{spinning:V,indicator:(0,r.jsx)(c.Z,{style:{fontSize:20}})}):(0,r.jsx)(Z.Z,{}),can_use:s.length>0,key:"clear",onClick:async()=>{V||(F(!0),await (0,a.Vx)((0,a.zR)(m.conv_uid)).finally(async()=>{await w(),F(!1)}))}}],[i,d,u,s,V,t,T,D,O,f.app_code,L,g,x,m.select_param,m.conv_uid,l,w]),B=(0,b.useMemo)(()=>{try{return JSON.parse(m.select_param).file_name}catch(e){return""}},[m.select_param]);return(0,r.jsxs)("div",{className:"flex flex-col  mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between h-full w-full",children:[(0,r.jsxs)("div",{className:"flex gap-3 text-lg",children:[(0,r.jsx)(H,{}),(0,r.jsx)($,{fileList:R,setFileList:P,setLoading:A,fileName:B}),(0,r.jsx)(U,{temperatureValue:g,setTemperatureValue:k}),(0,r.jsx)(E,{maxNewTokensValue:p,setMaxNewTokensValue:y})]}),(0,r.jsx)("div",{className:"flex gap-1",children:(0,r.jsx)(r.Fragment,{children:q.map(e=>(0,r.jsx)(M.Z,{title:e.tip,arrow:!1,placement:"bottom",children:(0,r.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)] text-lg ".concat(e.can_use?"cursor-pointer":"opacity-30 cursor-not-allowed"),onClick:()=>{var o;null===(o=e.onClick)||void 0===o||o.call(e)},children:e.icon})},e.key))})})]}),(B||(null===(o=R[0])||void 0===o?void 0:o.name))&&(0,r.jsx)("div",{className:"group/item flex mt-2",children:(0,r.jsxs)("div",{className:"flex items-center justify-between w-64 border border-[#e3e4e6] dark:border-[rgba(255,255,255,0.6)] rounded-lg p-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(h(),{src:"/icons/chat/excel.png",width:20,height:20,alt:"file-icon",className:"mr-2"}),(0,r.jsx)("span",{className:"text-sm text-[#1c2533] dark:text-white line-clamp-1",children:B||(null===(n=R[0])||void 0===n?void 0:n.name)})]}),(0,r.jsx)(S.Z,{spinning:W,indicator:(0,r.jsx)(c.Z,{style:{fontSize:24},spin:!0})})]})})]})}),G=(0,b.memo)(e=>{var o;let{ctrl:n}=e,{t}=(0,_.$G)(),{scrollRef:a,replyLoading:i,handleChat:s,appInfo:l,currentDialogue:d,temperatureValue:u,maxNewTokensValue:m,resourceValue:f,refreshDialogList:g}=(0,b.useContext)(j.ChatContentContext),p=(0,k.useSearchParams)(),x=null!==(o=null==p?void 0:p.get("select_param"))&&void 0!==o?o:"",[h,N]=(0,b.useState)(""),[C,Z]=(0,b.useState)(!1),[M,T]=(0,b.useState)(!1),D=(0,b.useRef)(0),O=(0,b.useMemo)(()=>{var e;return(null===(e=l.param_need)||void 0===e?void 0:e.map(e=>e.type))||[]},[l.param_need]),R=async()=>{D.current++,setTimeout(()=>{var e,o;null===(e=a.current)||void 0===e||e.scrollTo({top:null===(o=a.current)||void 0===o?void 0:o.scrollHeight,behavior:"smooth"}),N("")},0),await s(h,{app_code:l.app_code||"",...O.includes("temperature")&&{temperature:u},...O.includes("max_new_tokens")&&{max_new_tokens:m},select_param:x,...O.includes("resource")&&{select_param:"string"==typeof f?f:JSON.stringify(f)||d.select_param}}),1===D.current&&await g()};return(0,r.jsx)("div",{className:"flex flex-col w-full mx-auto pt-4 pb-0 bg-transparent",children:(0,r.jsxs)("div",{className:"flex flex-1 flex-col bg-white dark:bg-[rgba(255,255,255,0.16)] px-5 py-4 pt-2 rounded-xl relative border-t border-b border-l border-r dark:border-[rgba(255,255,255,0.6)] ".concat(C?"border-[#0c75fc]":""),id:"input-panel",children:[(0,r.jsx)(z,{ctrl:n}),(0,r.jsx)(y.default.TextArea,{placeholder:t("input_tips"),className:"w-full h-10 resize-none border-0 p-0 focus:shadow-none dark:bg-transparent",value:h,onKeyDown:e=>{"Enter"===e.key&&!e.shiftKey&&!M&&(e.preventDefault(),h.trim()&&!i&&R())},onChange:e=>{N(e.target.value)},onFocus:()=>{Z(!0)},onBlur:()=>Z(!1),onCompositionStart:()=>T(!0),onCompositionEnd:()=>T(!1)}),(0,r.jsx)(w.ZP,{type:"primary",className:v()("flex items-center justify-center w-14 h-8 rounded-lg text-sm absolute right-4 bottom-3 bg-button-gradient border-0",{"cursor-not-allowed":!h.trim()}),onClick:()=>{!i&&h.trim()&&R()},children:i?(0,r.jsx)(S.Z,{spinning:i,indicator:(0,r.jsx)(c.Z,{className:"text-white"})}):t("sent")})]})})});let K=()=>{var e;let o=JSON.parse(null!==(e=localStorage.getItem(l.C9))&&void 0!==e?e:""),n=(null==o?void 0:o.avatar_url)||"/agents/sre.png";return(0,r.jsx)(h(),{className:"rounded-full border border-gray-200 object-contain bg-white inline-block",width:32,height:32,src:n,alt:"User Avatar"})},Q={todo:{bgClass:"bg-gray-500",icon:(0,r.jsx)(d.Z,{className:"ml-2"})},runing:{bgClass:"bg-blue-500",icon:(0,r.jsx)(c.Z,{className:"ml-2"})},failed:{bgClass:"bg-red-500",icon:(0,r.jsx)(u.Z,{className:"ml-2"})},completed:{bgClass:"bg-green-500",icon:(0,r.jsx)(m.Z,{className:"ml-2"})}},X=e=>e.replaceAll("\\n","\n").replace(/<table(\w*=[^>]+)>/gi,"<table $1>").replace(/<tr(\w*=[^>]+)>/gi,"<tr $1>"),Y=e=>null==e?void 0:e.replace(/<table(\w*=[^>]+)>/gi,"<table $1>").replace(/<tr(\w*=[^>]+)>/gi,"<tr $1>");var ee=(0,b.memo)(e=>{var o;let{content:n,onLinkClick:t,messages:a}=e,{t:i}=(0,_.$G)(),l=(0,k.useSearchParams)(),d=null!==(o=null==l?void 0:l.get("scene"))&&void 0!==o?o:"",{context:c,model_name:u,role:m,thinking:p}=n,x=(0,b.useMemo)(()=>"view"===m,[m]),{value:h,cachePluginContext:j}=(0,b.useMemo)(()=>{if("string"!=typeof c)return{relations:[],value:"",cachePluginContext:[]};let[e,o]=c.split("	relations:"),n=o?o.split(","):[],r=[],t=0,a=e.replace(/<dbgpt-view[^>]*>[^<]*<\/dbgpt-view>/gi,e=>{try{var o;let n=e.replaceAll("\n","\\n").replace(/<[^>]*>|<\/[^>]*>/gm,""),a=JSON.parse(n),i="<custom-view>".concat(t,"</custom-view>");return r.push({...a,result:X(null!==(o=a.result)&&void 0!==o?o:"")}),t++,i}catch(o){return console.log(o.message,o),e}});return{relations:n,cachePluginContext:r,value:a}},[c]),y=(0,b.useMemo)(()=>({"custom-view"(e){var o;let{children:n}=e,t=+n.toString();if(!j[t])return n;let{name:a,status:i,err_msg:l,result:d}=j[t],{bgClass:c,icon:u}=null!==(o=Q[i])&&void 0!==o?o:{};return(0,r.jsxs)("div",{className:"bg-white dark:bg-[#212121] rounded-lg overflow-hidden my-2 flex flex-col lg:max-w-[80%]",children:[(0,r.jsxs)("div",{className:v()("flex px-4 md:px-6 py-2 items-center text-white text-sm",c),children:[a,u]}),d?(0,r.jsx)("div",{className:"px-4 md:px-6 py-4 text-sm",children:(0,r.jsx)(g.Z,{components:s.ZP,...s.dx,children:(0,s.CE)(null!=d?d:"")})}):(0,r.jsx)("div",{className:"px-4 md:px-6 py-4 text-sm",children:l})]})}}),[j]),w=function(e){try{let o=JSON.parse(e);return o}catch(e){return console.log(e),{left:"",right:""}}}(c),{left:S="",right:N=""}=w;return(0,r.jsx)("div",{className:"flex h-full",children:(0,r.jsxs)("div",{className:"flex ".concat("chat_agent"!==d||p?"":"flex-1"," overflow-hidden"),children:[!x&&!1,x&&(0,r.jsx)("div",{className:"flex flex-1 flex-col w-full p-2",children:(0,r.jsxs)("div",{className:"flex w-full h-full bg-white dark:bg-[rgba(255,255,255,0.16)] p-2 rounded-2xl",children:["object"==typeof c&&(0,r.jsxs)("div",{children:["[".concat(c.template_name,"]: "),(0,r.jsxs)("span",{className:"text-theme-primary cursor-pointer",onClick:t,children:[(0,r.jsx)(f.Z,{className:"mr-1"}),c.template_introduce||"More Details"]})]}),"string"==typeof c&&"chat_agent"===d&&(0,r.jsxs)("div",{className:"flex flex-row w-full",children:[(0,r.jsxs)("div",{className:"flex flex-col w-2/5 pr-2 border-dashed border-r border-gray-300",children:[(0,r.jsxs)("div",{className:"flex flex-col flex-justify-space-between h-full overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex flex-row gap-2 mb-2 text-gray-500 text-ms pt-2 pb-3 justify-end",children:[(0,r.jsx)("span",{className:"wrap-break-word w-4/5",children:a[0].context}),(0,r.jsx)("span",{className:"pl-3",children:(0,r.jsx)(K,{})})]}),(0,r.jsx)(g.Z,{components:s.ZP,...s.dx,children:(0,s.CE)(Y(S))})]}),(0,r.jsx)(G,{})]}),(0,r.jsx)("div",{className:"flex flex-col w-3/5 pl-2 h-full",children:(0,r.jsx)(g.Z,{className:"h-full overflow-y-auto",components:s.ZP,...s.dx,children:(0,s.CE)(Y(N))})})]}),"string"==typeof c&&"chat_agent"!==d&&(0,r.jsx)("div",{children:(0,r.jsx)(g.Z,{components:{...s.ZP,...y},...s.dx,children:(0,s.CE)(X(h))})}),!1]})})]})})}),eo=n(97149),en=n(99879),er=n(32699),et=n(5185),ea=(0,b.memo)(()=>{var e,o;let n=(0,b.useRef)(null),s=(0,k.useSearchParams)(),l=null!==(o=null==s?void 0:s.get("id"))&&void 0!==o?o:"",{currentDialogInfo:d,model:c}=(0,b.useContext)(t.p),{history:u,handleChat:m,refreshDialogList:f,setAppInfo:g,setModelValue:p,setTemperatureValue:v,setMaxNewTokensValue:x,setResourceValue:h}=(0,b.useContext)(j.ChatContentContext),_=(0,eo.Z)(m,{wait:500}),[y,w]=(0,b.useState)(!1),[S,N]=(0,b.useState)(""),C=(0,b.useMemo)(()=>{let e=(0,er.cloneDeep)(u);return e.filter(e=>["view","human"].includes(e.role)).map(e=>({...e,key:(0,et.Z)()}))},[u]);return(0,I.Z)(async()=>{console.log(l,d,"chatId, currentDialogInfo");let e=(0,F.a_)();if(e&&e.id===l){let[,l]=await (0,a.Vx)((0,a.BN)({...d}));if(l){var o,n,r,t,i,s,u,m,k;let a=(null==l?void 0:null===(o=l.param_need)||void 0===o?void 0:o.map(e=>e.type))||[],d=(null===(n=null==l?void 0:null===(r=l.param_need)||void 0===r?void 0:r.filter(e=>"model"===e.type)[0])||void 0===n?void 0:n.value)||c,b=(null===(t=null==l?void 0:null===(i=l.param_need)||void 0===i?void 0:i.filter(e=>"temperature"===e.type)[0])||void 0===t?void 0:t.value)||.6,j=(null===(s=null==l?void 0:null===(u=l.param_need)||void 0===u?void 0:u.filter(e=>"max_new_tokens"===e.type)[0])||void 0===s?void 0:s.value)||4e3,y=null===(m=null==l?void 0:null===(k=l.param_need)||void 0===k?void 0:k.filter(e=>"resource"===e.type)[0])||void 0===m?void 0:m.bind_value;g(l||{}),v(b||.6),x(j||4e3),p(d),h(y),_.run(e.message,{app_code:null==l?void 0:l.app_code,model_name:d,...(null==a?void 0:a.includes("temperature"))&&{temperature:b},...(null==a?void 0:a.includes("max_new_tokens"))&&{max_new_tokens:j},...a.includes("resource")&&{select_param:"string"==typeof y?y:JSON.stringify(y)}}),await f(),localStorage.removeItem(F.rU)}}},[l,JSON.stringify(d)]),(0,b.useEffect)(()=>{setTimeout(()=>{var e,o;null===(e=n.current)||void 0===e||e.scrollTo(0,null===(o=n.current)||void 0===o?void 0:o.scrollHeight)},50)},[u,null===(e=u[u.length-1])||void 0===e?void 0:e.context]),(0,r.jsxs)("div",{className:"w-full pl-4 pr-4 h-full",ref:n,children:[!!C.length&&C.filter(e=>"view"===e.role).map((e,o)=>(0,r.jsx)(ee,{content:e,onLinkClick:()=>{w(!0),N(JSON.stringify(null==e?void 0:e.context,null,2))},messages:C},o)),(0,r.jsx)(en.default,{title:"JSON Editor",open:y,width:"60%",cancelButtonProps:{hidden:!0},onOk:()=>{w(!1)},onCancel:()=>{w(!1)},children:(0,r.jsx)(i.Z,{className:"w-full h-[500px]",language:"json",value:S})})]})})},10332:function(e,o,n){"use strict";var r=n(52676),t=n(31819),a=n(87402),i=n.n(a),s=n(75271);o.Z=(0,s.memo)(e=>{let{width:o,height:n,model:a}=e,l=(0,s.useMemo)(()=>(0,t.ab)(a||"huggingface"),[a]);return a?(0,r.jsx)(i(),{className:"rounded-full border border-gray-200 object-contain bg-white inline-block",width:o||24,height:n||24,src:l,alt:"llm",priority:!0}):null})},67665:function(e,o,n){"use strict";n.r(o);var r=n(52676),t=n(99275),a=n(81899),i=n(56697),s=n(44610),l=n(874),d=n.n(l),c=n(75271),u=n(919);o.default=(0,c.memo)(()=>{var e;let{appInfo:o}=(0,c.useContext)(u.MobileChatContext),{message:n}=i.Z.useApp(),[l,m]=(0,c.useState)(0);if(!(null==o?void 0:o.app_code))return null;let f=async()=>{let e=d()("dingtalk://dingtalkclient/page/link?url=".concat(encodeURIComponent(location.href),"&pc_slide=true"));n[e?"success":"error"](e?"复制成功":"复制失败")};return l>6&&n.info(JSON.stringify(window.navigator.userAgent),2,()=>{m(0)}),(0,r.jsxs)("header",{className:"flex w-full items-center justify-between bg-[rgba(255,255,255,0.9)] border dark:bg-black dark:border-[rgba(255,255,255,0.6)] rounded-xl mx-auto px-4 py-2 mb-4 sticky top-4 z-50 mt-4 shadow-md",children:[(0,r.jsxs)("div",{className:"flex gap-2 items-center",onClick:()=>m(l+1),children:[(0,r.jsx)(t.Z,{scene:(null==o?void 0:null===(e=o.team_context)||void 0===e?void 0:e.chat_scene)||"chat_agent",width:8,height:8}),(0,r.jsxs)("div",{className:"flex flex-col ml-2",children:[(0,r.jsx)(s.Z.Text,{className:"text-md font-bold line-clamp-2",children:null==o?void 0:o.app_name}),(0,r.jsx)(s.Z.Text,{className:"text-sm line-clamp-2",children:null==o?void 0:o.app_describe})]})]}),(0,r.jsx)("div",{onClick:f,className:"flex items-center justify-center w-10 h-10 bg-[#ffffff99] dark:bg-[rgba(255,255,255,0.2)] border border-white dark:border-[rgba(255,255,255,0.2)] rounded-[50%] cursor-pointer",children:(0,r.jsx)(a.Z,{className:"text-lg"})})]})})},76357:function(e,o,n){"use strict";n.r(o);var r=n(52676),t=n(59864),a=n(92821),i=n(84769),s=n(84774),l=n(4093),d=n(24573),c=n(77635),u=n(28974),m=n(63464),f=n(99113),g=n(56367),p=n(32651),v=n(94634),x=n(72423),h=n(41148),k=n(82187),b=n.n(k),_=n(29052),j=n(75271),y=n(919),w=n(68120),S=n(58521),N=n(59741),C=n(31226);let Z=["magenta","orange","geekblue","purple","cyan","green"];o.default=()=>{var e,o;let n=(0,_.useSearchParams)(),k=null!==(o=null==n?void 0:n.get("ques"))&&void 0!==o?o:"",{history:M,model:T,scene:D,temperature:O,resource:R,conv_uid:E,appInfo:P,scrollViewRef:W,order:A,userInput:H,ctrl:V,canAbort:F,canNewChat:L,setHistory:q,setCanNewChat:B,setCarAbort:I,setUserInput:J}=(0,j.useContext)(y.MobileChatContext),[$,U]=(0,j.useState)(!1),[z,G]=(0,j.useState)(!1),K=async e=>{var o,n,r;J(""),V.current=new AbortController;let t={chat_mode:D,model_name:T,user_input:e||H,conv_uid:E,temperature:O,app_code:null==P?void 0:P.app_code,...R&&{select_param:JSON.stringify(R)}};if(M&&M.length>0){let e=null==M?void 0:M.filter(e=>"view"===e.role);A.current=e[e.length-1].order+1}let s=[{role:"human",context:e||H,model_name:T,order:A.current,time_stamp:0},{role:"view",context:"",model_name:T,order:A.current,time_stamp:0,thinking:!0}],l=s.length-1;q([...M,...s]),B(!1);try{await (0,m.L)("".concat(null!==(o=C.env.API_BASE_URL)&&void 0!==o?o:"","/api/v1/chat/completions"),{method:"POST",headers:{"Content-Type":"application/json",[i.gp]:null!==(n=(0,a.n5)())&&void 0!==n?n:""},signal:V.current.signal,body:JSON.stringify(t),openWhenHidden:!0,async onopen(e){if(e.ok&&e.headers.get("content-type")===m.a)return},onclose(){var e;null===(e=V.current)||void 0===e||e.abort(),B(!0),I(!1)},onerror(e){throw Error(e)},onmessage:e=>{let o=e.data;try{o=JSON.parse(o).vis}catch(e){o.replaceAll("\\n","\n")}"[DONE]"===o?(B(!0),I(!1)):(null==o?void 0:o.startsWith("[ERROR]"))?(s[l].context=null==o?void 0:o.replace("[ERROR]",""),s[l].thinking=!1,q([...M,...s]),B(!0),I(!1)):(I(!0),s[l].context=o,s[l].thinking=!1,q([...M,...s]))}})}catch(e){null===(r=V.current)||void 0===r||r.abort(),s[l].context="Sorry, we meet some error, please try again later.",s[l].thinking=!1,q([...s]),B(!0),I(!1)}},Q=async()=>{H.trim()&&L&&await K()};(0,j.useEffect)(()=>{var e,o;null===(e=W.current)||void 0===e||e.scrollTo({top:null===(o=W.current)||void 0===o?void 0:o.scrollHeight,behavior:"auto"})},[M,W]);let X=(0,j.useMemo)(()=>{if(!P)return[];let{param_need:e=[]}=P;return null==e?void 0:e.map(e=>e.type)},[P]),Y=(0,j.useMemo)(()=>{var e;return 0===M.length&&P&&!!(null==P?void 0:null===(e=P.recommend_questions)||void 0===e?void 0:e.length)},[M,P]),{run:ee,loading:eo}=(0,f.Z)(async()=>await (0,t.Vx)((0,t.zR)(E)),{manual:!0,onSuccess:()=>{q([])}});return(0,j.useEffect)(()=>{k&&T&&E&&P&&K(k)},[P,E,T,k]),(0,r.jsxs)("div",{className:"flex flex-col",children:[Y&&(0,r.jsx)("ul",{children:null==P?void 0:null===(e=P.recommend_questions)||void 0===e?void 0:e.map((e,o)=>(0,r.jsx)("li",{className:"mb-3",children:(0,r.jsx)(g.Z,{color:Z[o],className:"p-2 rounded-xl",onClick:async()=>{K(e.question)},children:e.question})},e.id))}),(0,r.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,r.jsxs)("div",{className:"flex gap-2 mb-1 w-full overflow-x-auto",children:[(null==X?void 0:X.includes("model"))&&(0,r.jsx)(w.default,{}),(null==X?void 0:X.includes("resource"))&&(0,r.jsx)(S.default,{}),(null==X?void 0:X.includes("temperature"))&&(0,r.jsx)(N.default,{})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-lg font-bold",children:[(0,r.jsx)(p.Z,{content:"暂停回复",trigger:["hover"],children:(0,r.jsx)(s.Z,{className:b()("p-2 cursor-pointer",{"text-[#0c75fc]":F,"text-gray-400":!F}),onClick:()=>{var e;F&&(null===(e=V.current)||void 0===e||e.abort(),setTimeout(()=>{I(!1),B(!0)},100))}})}),(0,r.jsx)(p.Z,{content:"再来一次",trigger:["hover"],children:(0,r.jsx)(l.Z,{className:b()("p-2 cursor-pointer",{"text-gray-400":!M.length||!L}),onClick:()=>{var e,o;if(!L||0===M.length)return;let n=null===(e=null===(o=M.filter(e=>"human"===e.role))||void 0===o?void 0:o.slice(-1))||void 0===e?void 0:e[0];K((null==n?void 0:n.context)||"")}})}),eo?(0,r.jsx)(v.Z,{spinning:eo,indicator:(0,r.jsx)(d.Z,{style:{fontSize:18},spin:!0}),className:"p-2"}):(0,r.jsx)(p.Z,{content:"清除历史",trigger:["hover"],children:(0,r.jsx)(c.Z,{className:b()("p-2 cursor-pointer",{"text-gray-400":!M.length||!L}),onClick:()=>{L&&ee()}})})]})]}),(0,r.jsxs)("div",{className:b()("flex py-2 px-3 items-center justify-between bg-white dark:bg-[#242733] dark:border-[#6f7f95] rounded-xl border",{"border-[#0c75fc] dark:border-[rgba(12,117,252,0.8)]":$}),children:[(0,r.jsx)(x.default.TextArea,{placeholder:"可以问我任何问题",className:"w-full resize-none border-0 p-0 focus:shadow-none",value:H,autoSize:{minRows:1},onKeyDown:e=>{if("Enter"===e.key&&!e.shiftKey){if(z){e.preventDefault();return}H.trim()&&(e.preventDefault(),Q())}},onChange:e=>{J(e.target.value)},onFocus:()=>{U(!0)},onBlur:()=>U(!1),onCompositionStartCapture:()=>{G(!0)},onCompositionEndCapture:()=>{setTimeout(()=>{G(!1)},0)}}),(0,r.jsx)(h.ZP,{type:"primary",className:b()("flex items-center justify-center rounded-lg bg-button-gradient border-0 ml-2",{"opacity-40 cursor-not-allowed":!H.trim()||!L}),onClick:Q,children:L?(0,r.jsx)(u.Z,{}):(0,r.jsx)(v.Z,{indicator:(0,r.jsx)(d.Z,{className:"text-white"})})})]})]})}},68120:function(e,o,n){"use strict";n.r(o);var r=n(52676),t=n(21011),a=n(10332),i=n(5196),s=n(48763),l=n(32651),d=n(75271),c=n(919);o.default=()=>{let{modelList:e}=(0,d.useContext)(t.p),{model:o,setModel:n}=(0,d.useContext)(c.MobileChatContext),u=(0,d.useMemo)(()=>e.length>0?e.map(e=>({label:(0,r.jsxs)("div",{className:"flex items-center gap-2",onClick:()=>{n(e)},children:[(0,r.jsx)(a.Z,{width:14,height:14,model:e}),(0,r.jsx)("span",{className:"text-xs",children:e})]}),key:e})):[],[e,n]);return(0,r.jsx)(s.Z,{menu:{items:u},placement:"top",trigger:["click"],children:(0,r.jsx)(l.Z,{content:o,children:(0,r.jsxs)("div",{className:"flex items-center gap-1 border rounded-xl bg-white dark:bg-black p-2 flex-shrink-0",children:[(0,r.jsx)(a.Z,{width:16,height:16,model:o}),(0,r.jsx)("span",{className:"text-xs font-medium line-clamp-1",style:{maxWidth:96},children:o}),(0,r.jsx)(i.Z,{rotate:90})]})})})}},67282:function(e,o,n){"use strict";n.r(o);var r=n(52676),t=n(87402),a=n.n(t),i=n(75271);o.default=(0,i.memo)(e=>{let{width:o,height:n,src:t,label:i}=e;return(0,r.jsx)(a(),{width:o||14,height:n||14,src:t,alt:i||"db-icon",priority:!0})})},58521:function(e,o,n){"use strict";n.r(o);var r=n(52676),t=n(59864),a=n(31959),i=n(92821),s=n(24573),l=n(5196),d=n(80998),c=n(99113),u=n(94634),m=n(54426),f=n(48763),g=n(75271),p=n(919),v=n(67282);o.default=()=>{let{appInfo:e,resourceList:o,scene:n,model:x,conv_uid:h,getChatHistoryRun:k,setResource:b,resource:_}=(0,g.useContext)(p.MobileChatContext),{temperatureValue:j,maxNewTokensValue:y}=(0,g.useContext)(a.ChatContentContext),[w,S]=(0,g.useState)(null),N=(0,g.useMemo)(()=>{var o,n,r;return null===(o=null==e?void 0:null===(n=e.param_need)||void 0===n?void 0:n.filter(e=>"resource"===e.type))||void 0===o?void 0:null===(r=o[0])||void 0===r?void 0:r.value},[e]),C=(0,g.useMemo)(()=>o&&o.length>0?o.map(e=>({label:(0,r.jsxs)("div",{className:"flex items-center gap-2",onClick:()=>{S(e),b(e.space_id||e.param)},children:[(0,r.jsx)(v.default,{width:14,height:14,src:i.S$[e.type].icon,label:i.S$[e.type].label}),(0,r.jsx)("span",{className:"text-xs",children:e.param})]}),key:e.space_id||e.param})):[],[o,b]),{run:Z,loading:M}=(0,c.Z)(async e=>{let[,o]=await (0,t.Vx)((0,t.qn)({convUid:h,chatMode:n,data:e,model:x,temperatureValue:j,maxNewTokensValue:y,config:{timeout:36e5}}));return b(o),o},{manual:!0,onSuccess:async()=>{await k()}}),T=async e=>{let o=new FormData;o.append("doc_file",null==e?void 0:e.file),await Z(o)},D=(0,g.useMemo)(()=>M?(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(u.Z,{size:"small",indicator:(0,r.jsx)(s.Z,{spin:!0})}),(0,r.jsx)("span",{className:"text-xs",children:"上传中"})]}):_?(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)("span",{className:"text-xs",children:_.file_name}),(0,r.jsx)(l.Z,{rotate:90})]}):(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(d.Z,{className:"text-base"}),(0,r.jsx)("span",{className:"text-xs",children:"上传文件"})]}),[M,_]);return(0,r.jsx)(r.Fragment,{children:(()=>{switch(N){case"excel_file":case"text_file":case"image_file":return(0,r.jsx)("div",{className:"flex items-center justify-center gap-1 border rounded-xl bg-white dark:bg-black px-2 flex-shrink-0",children:(0,r.jsx)(m.default,{name:"file",accept:".xlsx,.xls",maxCount:1,showUploadList:!1,beforeUpload:()=>!1,onChange:T,className:"flex h-full w-full items-center justify-center",children:D})});case"database":case"knowledge":case"plugin":case"awel_flow":var e,n,t,a,s;if(!(null==o?void 0:o.length))return null;return(0,r.jsx)(f.Z,{menu:{items:C},placement:"top",trigger:["click"],children:(0,r.jsxs)("div",{className:"flex items-center gap-1 border rounded-xl bg-white dark:bg-black p-2 flex-shrink-0",children:[(0,r.jsx)(v.default,{width:14,height:14,src:null===(e=i.S$[(null==w?void 0:w.type)||(null==o?void 0:null===(n=o[0])||void 0===n?void 0:n.type)])||void 0===e?void 0:e.icon,label:null===(t=i.S$[(null==w?void 0:w.type)||(null==o?void 0:null===(a=o[0])||void 0===a?void 0:a.type)])||void 0===t?void 0:t.label}),(0,r.jsx)("span",{className:"text-xs font-medium",children:(null==w?void 0:w.param)||(null==o?void 0:null===(s=o[0])||void 0===s?void 0:s.param)}),(0,r.jsx)(l.Z,{rotate:90})]})})}})()})}},59741:function(e,o,n){"use strict";n.r(o);var r=n(52676),t=n(68508),a=n(48763),i=n(14486),s=n(75271),l=n(919);o.default=()=>{let{temperature:e,setTemperature:o}=(0,s.useContext)(l.MobileChatContext),n=e=>{isNaN(e)||o(e)};return(0,r.jsx)(a.Z,{trigger:["click"],dropdownRender:()=>(0,r.jsx)("div",{className:"flex h-28 bg-white dark:bg-[rgba(255,255,255,0.5)] items-center justify-center rounded-xl py-3",children:(0,r.jsx)(i.Z,{defaultValue:.5,max:1,min:0,step:.1,vertical:!0,onChange:n,value:e})}),placement:"top",children:(0,r.jsxs)("div",{className:"flex items-center justify-between border rounded-xl bg-white dark:bg-black w-14 p-2 flex-shrink-0",children:[(0,r.jsx)(t.Z,{type:"icon-icons-temperature",className:"text-sm"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:e})]})})}},919:function(e,o,n){"use strict";n.r(o),n.d(o,{MobileChatContext:function(){return b}});var r=n(52676),t=n(21011),a=n(59864),i=n(40797),s=n(92821),l=n(84769),d=n(63464),c=n(99113),u=n(94634),m=n(68554),f=n.n(m),g=n(29052),p=n(75271),v=n(67665),x=n(76357),h=n(31226);let k=f()(()=>Promise.all([n.e(8201),n.e(9915),n.e(4130),n.e(4521),n.e(768),n.e(5745),n.e(9066),n.e(2601),n.e(5711),n.e(7707),n.e(4395),n.e(8223),n.e(6705),n.e(9907),n.e(3046),n.e(4465),n.e(3769),n.e(1633),n.e(2026),n.e(2466),n.e(4132),n.e(6414),n.e(2501),n.e(3527),n.e(4822)]).then(n.bind(n,24822)),{loadableGenerated:{webpack:()=>[24822]},ssr:!1}),b=(0,p.createContext)({model:"",temperature:.5,resource:null,setModel:()=>{},setTemperature:()=>{},setResource:()=>{},scene:"",history:[],setHistory:()=>{},scrollViewRef:{current:null},appInfo:{},conv_uid:"",resourceList:[],order:{current:1},handleChat:()=>Promise.resolve(),canAbort:!1,setCarAbort:()=>{},canNewChat:!1,setCanNewChat:()=>{},ctrl:{current:void 0},userInput:"",setUserInput:()=>{},getChatHistoryRun:()=>{}});o.default=()=>{var e,o;let n=(0,g.useSearchParams)(),m=null!==(e=null==n?void 0:n.get("chat_scene"))&&void 0!==e?e:"",f=null!==(o=null==n?void 0:n.get("app_code"))&&void 0!==o?o:"",{modelList:_}=(0,p.useContext)(t.p),[j,y]=(0,p.useState)([]),[w,S]=(0,p.useState)(""),[N,C]=(0,p.useState)(.5),[Z,M]=(0,p.useState)(null),T=(0,p.useRef)(null),[D,O]=(0,p.useState)(""),[R,E]=(0,p.useState)(!1),[P,W]=(0,p.useState)(!0),A=(0,p.useRef)(),H=(0,p.useRef)(1),V=(0,i.Z)(),F=(0,p.useMemo)(()=>"".concat(null==V?void 0:V.user_no,"_").concat(f),[f,V]),{run:L,loading:q}=(0,c.Z)(async()=>await (0,a.Vx)((0,a.$i)("".concat(null==V?void 0:V.user_no,"_").concat(f))),{manual:!0,onSuccess:e=>{let[,o]=e,n=null==o?void 0:o.filter(e=>"view"===e.role);n&&n.length>0&&(H.current=n[n.length-1].order+1),y(o||[])}}),{data:B,run:I,loading:J}=(0,c.Z)(async e=>{let[,o]=await (0,a.Vx)((0,a.BN)(e));return null!=o?o:{}},{manual:!0}),{run:$,data:U,loading:z}=(0,c.Z)(async()=>{var e,o;let[,n]=await (0,a.Vx)((0,a.vD)(m));return M((null==n?void 0:null===(e=n[0])||void 0===e?void 0:e.space_id)||(null==n?void 0:null===(o=n[0])||void 0===o?void 0:o.param)),null!=n?n:[]},{manual:!0}),{run:G,loading:K}=(0,c.Z)(async()=>{let[,e]=await (0,a.Vx)((0,a.iP)());return null!=e?e:[]},{manual:!0,onSuccess:e=>{var o;let n=null===(o=null==e?void 0:e.filter(e=>e.conv_uid===F))||void 0===o?void 0:o[0];(null==n?void 0:n.select_param)&&M(JSON.parse(null==n?void 0:n.select_param))}});(0,p.useEffect)(()=>{m&&f&&_.length&&I({chat_scene:m,app_code:f})},[f,m,I,_]),(0,p.useEffect)(()=>{f&&L()},[f]),(0,p.useEffect)(()=>{if(_.length>0){var e,o,n;let r=null===(e=null==B?void 0:null===(o=B.param_need)||void 0===o?void 0:o.filter(e=>"model"===e.type))||void 0===e?void 0:null===(n=e[0])||void 0===n?void 0:n.value;S(r||_[0])}},[_,B]),(0,p.useEffect)(()=>{var e,o,n;let r=null===(e=null==B?void 0:null===(o=B.param_need)||void 0===o?void 0:o.filter(e=>"temperature"===e.type))||void 0===e?void 0:null===(n=e[0])||void 0===n?void 0:n.value;C(r||.5)},[B]),(0,p.useEffect)(()=>{if(m&&(null==B?void 0:B.app_code)){var e,o,n,r,t,a;let i=null===(e=null==B?void 0:null===(o=B.param_need)||void 0===o?void 0:o.filter(e=>"resource"===e.type))||void 0===e?void 0:null===(n=e[0])||void 0===n?void 0:n.value,s=null===(r=null==B?void 0:null===(t=B.param_need)||void 0===t?void 0:t.filter(e=>"resource"===e.type))||void 0===r?void 0:null===(a=r[0])||void 0===a?void 0:a.bind_value;s&&M(s),["database","knowledge","plugin","awel_flow"].includes(i)&&!s&&$()}},[B,m,$]);let Q=async e=>{var o,n,r;O(""),A.current=new AbortController;let t={chat_mode:m,model_name:w,user_input:e||D,conv_uid:F,temperature:N,app_code:null==B?void 0:B.app_code,...Z&&{select_param:Z}};if(j&&j.length>0){let e=null==j?void 0:j.filter(e=>"view"===e.role);H.current=e[e.length-1].order+1}let a=[{role:"human",context:e||D,model_name:w,order:H.current,time_stamp:0},{role:"view",context:"",model_name:w,order:H.current,time_stamp:0,thinking:!0}],i=a.length-1;y([...j,...a]),W(!1);try{await (0,d.L)("".concat(null!==(o=h.env.API_BASE_URL)&&void 0!==o?o:"","/api/v1/chat/completions"),{method:"POST",headers:{"Content-Type":"application/json",[l.gp]:null!==(n=(0,s.n5)())&&void 0!==n?n:""},signal:A.current.signal,body:JSON.stringify(t),openWhenHidden:!0,async onopen(e){if(e.ok&&e.headers.get("content-type")===d.a)return},onclose(){var e;null===(e=A.current)||void 0===e||e.abort(),W(!0),E(!1)},onerror(e){throw Error(e)},onmessage:e=>{let o=e.data;try{o=JSON.parse(o).vis}catch(e){o.replaceAll("\\n","\n")}"[DONE]"===o?(W(!0),E(!1)):(null==o?void 0:o.startsWith("[ERROR]"))?(a[i].context=null==o?void 0:o.replace("[ERROR]",""),a[i].thinking=!1,y([...j,...a]),W(!0),E(!1)):(E(!0),a[i].context=o,a[i].thinking=!1,y([...j,...a]))}})}catch(e){null===(r=A.current)||void 0===r||r.abort(),a[i].context="Sorry, we meet some error, please try again later.",a[i].thinking=!1,y([...a]),W(!0),E(!1)}};return(0,p.useEffect)(()=>{m&&"chat_agent"!==m&&G()},[m,G]),(0,r.jsx)(b.Provider,{value:{model:w,resource:Z,setModel:S,setTemperature:C,setResource:M,temperature:N,appInfo:B,conv_uid:F,scene:m,history:j,scrollViewRef:T,setHistory:y,resourceList:U,order:H,handleChat:Q,setCanNewChat:W,ctrl:A,canAbort:R,setCarAbort:E,canNewChat:P,userInput:D,setUserInput:O,getChatHistoryRun:L},children:(0,r.jsx)(u.Z,{size:"large",className:"flex h-screen w-screen justify-center items-center max-h-screen",spinning:q||J||z||K,children:(0,r.jsxs)("div",{className:"flex flex-col h-screen bg-gradient-light dark:bg-gradient-dark p-4 pt-0",children:[(0,r.jsxs)("div",{ref:T,className:"flex flex-col flex-1 overflow-y-auto mb-3",children:[(0,r.jsx)(v.default,{}),(0,r.jsx)(k,{})]}),(null==B?void 0:B.app_code)&&(0,r.jsx)(x.default,{})]})})})}}}]);