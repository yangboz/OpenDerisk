(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1967],{23193:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var i=n(58709),s=n(75271),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M793 242H366v-74c0-6.7-7.7-10.4-12.9-6.3l-142 112a8 8 0 000 12.6l142 112c5.2 4.1 12.9.4 12.9-6.3v-74h415v470H175c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h618c35.3 0 64-28.7 64-64V306c0-35.3-28.7-64-64-64z"}}]},name:"rollback",theme:"outlined"},r=n(35244),a=s.forwardRef(function(t,e){return s.createElement(r.Z,(0,i.Z)({},t,{ref:e,icon:o}))})},1729:function(t){function e(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}t.exports=function(t){let n=function(t){let n=[];for(let i=0;i<t.length;i++){for(;n.length>=2&&0>=e(n[n.length-2],n[n.length-1],t[i]);)n.pop();n.push(t[i])}return n.pop(),n}(t),i=function(t){let n=t.reverse(),i=[];for(let t=0;t<n.length;t++){for(;i.length>=2&&0>=e(i[i.length-2],i[i.length-1],n[t]);)i.pop();i.push(n[t])}return i.pop(),i}(t),s=i.concat(n);return s.push(t[0]),s}},91460:function(t){t.exports={toXy:function(t,e){return void 0===e?t.slice():t.map(function(t){let n=Function("pt","return [pt"+e[0]+",pt"+e[1]+"];");return n(t)})},fromXy:function(t,e){return void 0===e?t.slice():t.map(function(t){let n=Function("pt","const o = {}; o"+e[0]+"= pt[0]; o"+e[1]+"= pt[1]; return o;");return n(t)})}}},21057:function(t){function e(t,e){this._cells=[],this._cellSize=e,this._reverseCellSize=1/e;for(let e=0;e<t.length;e++){let n=t[e],i=this.coordToCellNum(n[0]),s=this.coordToCellNum(n[1]);if(this._cells[i])this._cells[i][s]?this._cells[i][s].push(n):this._cells[i][s]=[n];else{let t=[];t[s]=[n],this._cells[i]=t}}}e.prototype={cellPoints:function(t,e){return void 0!==this._cells[t]&&void 0!==this._cells[t][e]?this._cells[t][e]:[]},rangePoints:function(t){let e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),i=this.coordToCellNum(t[2]),s=this.coordToCellNum(t[3]),o=[];for(let t=e;t<=i;t++)for(let e=n;e<=s;e++)for(let n=0;n<this.cellPoints(t,e).length;n++)o.push(this.cellPoints(t,e)[n]);return o},removePoint:function(t){let e;let n=this.coordToCellNum(t[0]),i=this.coordToCellNum(t[1]),s=this._cells[n][i];for(let n=0;n<s.length;n++)if(s[n][0]===t[0]&&s[n][1]===t[1]){e=n;break}return s.splice(e,1),s},trunc:Math.trunc||function(t){return t-t%1},coordToCellNum:function(t){return this.trunc(t*this._reverseCellSize)},extendBbox:function(t,e){return[t[0]-e*this._cellSize,t[1]-e*this._cellSize,t[2]+e*this._cellSize,t[3]+e*this._cellSize]}},t.exports=function(t,n){return new e(t,n)}},97359:function(t,e,n){"use strict";let i=n(6351),s=n(21057),o=n(91460),r=n(1729);function a(t,e){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function l(t,e,n){let i=[e[0]-t[0],e[1]-t[1]],s=[n[0]-t[0],n[1]-t[1]],o=a(t,e),r=a(t,n),l=i[0]*s[0]+i[1]*s[1];return l/Math.sqrt(o*r)}function h(t,e){for(let n=0;n<e.length-1;n++){let s=[e[n],e[n+1]];if((t[0][0]!==s[0][0]||t[0][1]!==s[0][1])&&(t[0][0]!==s[1][0]||t[0][1]!==s[1][1])&&i(t,s))return!0}return!1}let d=Math.cos(90/(180/Math.PI));t.exports=function(t,e,n){let i=function(t){let e=[t[0]],n=t[0];for(let i=1;i<t.length;i++){let s=t[i];(n[0]!==s[0]||n[1]!==s[1])&&e.push(s),n=s}return e}(o.toXy(t,n).sort(function(t,e){return t[0]-e[0]||t[1]-e[1]}));if(i.length<4){let t=i.concat([i[0]]);return n?o.fromXy(t,n):t}let c=function(t){let e=1/0,n=1/0,i=-1/0,s=-1/0;for(let o=t.length-1;o>=0;o--)t[o][0]<e&&(e=t[o][0]),t[o][1]<n&&(n=t[o][1]),t[o][0]>i&&(i=t[o][0]),t[o][1]>s&&(s=t[o][1]);return[i-e,s-n]}(i),u=[.6*c[0],.6*c[1]],p=r(i),g=i.filter(function(t){return 0>p.indexOf(t)}),f=Math.ceil(1/(i.length/(c[0]*c[1]))),m=function t(e,n,i,s,o){let r=!1;for(let t=0;t<e.length-1;t++){let c,u,p;let g=[e[t],e[t+1]],f=g[0][0]+","+g[0][1]+","+g[1][0]+","+g[1][1];if(a(g[0],g[1])<n||o.has(f))continue;let m=0,y=[Math.min(g[0][0],g[1][0]),Math.min(g[0][1],g[1][1]),Math.max(g[0][0],g[1][0]),Math.max(g[0][1],g[1][1])];do c=(y=s.extendBbox(y,m))[2]-y[0],u=y[3]-y[1],p=function(t,e,n){let i=null,s=d,o=d,r,a;for(let d=0;d<e.length;d++)r=l(t[0],t[1],e[d]),a=l(t[1],t[0],e[d]),r>s&&a>o&&!h([t[0],e[d]],n)&&!h([t[1],e[d]],n)&&(s=r,o=a,i=e[d]);return i}(g,s.rangePoints(y),e),m++;while(null===p&&(i[0]>c||i[1]>u));c>=i[0]&&u>=i[1]&&o.add(f),null!==p&&(e.splice(t+1,0,p),s.removePoint(p),r=!0)}return r?t(e,n,i,s,o):e}(p,Math.pow(e||20,2),u,s(g,f),new Set);return n?o.fromXy(m,n):m}},6351:function(t){function e(t,e,n,i,s,o){let r=(o-e)*(n-t)-(i-e)*(s-t);return r>0||!(r<0)}t.exports=function(t,n){let i=t[0][0],s=t[0][1],o=t[1][0],r=t[1][1],a=n[0][0],l=n[0][1],h=n[1][0],d=n[1][1];return e(i,s,a,l,h,d)!==e(o,r,a,l,h,d)&&e(i,s,o,r,a,l)!==e(i,s,o,r,h,d)}},51463:function(t,e,n){"use strict";let i;n.d(e,{jD:function(){return U}});var s,o,r,a,l,h,d,c,u,p,g,f,m,y,v,b,E,x,O,S,w,D,C={};n.r(C),n.d(C,{circle:function(){return nv},diamond:function(){return nE},rect:function(){return nO},simple:function(){return nw},triangle:function(){return nb},triangleRect:function(){return nS},vee:function(){return nx}});var A=n(18687),M=n(18599),T=n(89148),R=n(99666),P=n(70373);let k={duration:500},L={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"};(s=f||(f={})).NodeAdded="NodeAdded",s.NodeUpdated="NodeUpdated",s.NodeRemoved="NodeRemoved",s.EdgeAdded="EdgeAdded",s.EdgeUpdated="EdgeUpdated",s.EdgeRemoved="EdgeRemoved",s.ComboAdded="ComboAdded",s.ComboUpdated="ComboUpdated",s.ComboRemoved="ComboRemoved",(o=m||(m={})).DRAW="draw",o.COLLAPSE="collapse",o.EXPAND="expand",o.TRANSFORM="transform",(r=y||(y={})).CLICK="canvas:click",r.DBLCLICK="canvas:dblclick",r.POINTER_OVER="canvas:pointerover",r.POINTER_LEAVE="canvas:pointerleave",r.POINTER_ENTER="canvas:pointerenter",r.POINTER_MOVE="canvas:pointermove",r.POINTER_OUT="canvas:pointerout",r.POINTER_DOWN="canvas:pointerdown",r.POINTER_UP="canvas:pointerup",r.CONTEXT_MENU="canvas:contextmenu",r.DRAG_START="canvas:dragstart",r.DRAG="canvas:drag",r.DRAG_END="canvas:dragend",r.DRAG_ENTER="canvas:dragenter",r.DRAG_OVER="canvas:dragover",r.DRAG_LEAVE="canvas:dragleave",r.DROP="canvas:drop",r.WHEEL="canvas:wheel",(a=v||(v={})).CLICK="combo:click",a.DBLCLICK="combo:dblclick",a.POINTER_OVER="combo:pointerover",a.POINTER_LEAVE="combo:pointerleave",a.POINTER_ENTER="combo:pointerenter",a.POINTER_MOVE="combo:pointermove",a.POINTER_OUT="combo:pointerout",a.POINTER_DOWN="combo:pointerdown",a.POINTER_UP="combo:pointerup",a.CONTEXT_MENU="combo:contextmenu",a.DRAG_START="combo:dragstart",a.DRAG="combo:drag",a.DRAG_END="combo:dragend",a.DRAG_ENTER="combo:dragenter",a.DRAG_OVER="combo:dragover",a.DRAG_LEAVE="combo:dragleave",a.DROP="combo:drop",(l=b||(b={})).CLICK="click",l.DBLCLICK="dblclick",l.POINTER_OVER="pointerover",l.POINTER_LEAVE="pointerleave",l.POINTER_ENTER="pointerenter",l.POINTER_MOVE="pointermove",l.POINTER_OUT="pointerout",l.POINTER_DOWN="pointerdown",l.POINTER_UP="pointerup",l.CONTEXT_MENU="contextmenu",l.DRAG_START="dragstart",l.DRAG="drag",l.DRAG_END="dragend",l.DRAG_ENTER="dragenter",l.DRAG_OVER="dragover",l.DRAG_LEAVE="dragleave",l.DROP="drop",l.KEY_DOWN="keydown",l.KEY_UP="keyup",l.WHEEL="wheel",(h=E||(E={})).KEY_DOWN="keydown",h.KEY_UP="keyup",(d=x||(x={})).CLICK="edge:click",d.DBLCLICK="edge:dblclick",d.POINTER_OVER="edge:pointerover",d.POINTER_LEAVE="edge:pointerleave",d.POINTER_ENTER="edge:pointerenter",d.POINTER_MOVE="edge:pointermove",d.POINTER_OUT="edge:pointerout",d.POINTER_DOWN="edge:pointerdown",d.POINTER_UP="edge:pointerup",d.CONTEXT_MENU="edge:contextmenu",d.DRAG_ENTER="edge:dragenter",d.DRAG_OVER="edge:dragover",d.DRAG_LEAVE="edge:dragleave",d.DROP="edge:drop",(c=O||(O={})).BEFORE_CANVAS_INIT="beforecanvasinit",c.AFTER_CANVAS_INIT="aftercanvasinit",c.BEFORE_SIZE_CHANGE="beforesizechange",c.AFTER_SIZE_CHANGE="aftersizechange",c.BEFORE_ELEMENT_CREATE="beforeelementcreate",c.AFTER_ELEMENT_CREATE="afterelementcreate",c.BEFORE_ELEMENT_UPDATE="beforeelementupdate",c.AFTER_ELEMENT_UPDATE="afterelementupdate",c.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",c.AFTER_ELEMENT_DESTROY="afterelementdestroy",c.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",c.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",c.BEFORE_DRAW="beforedraw",c.AFTER_DRAW="afterdraw",c.BEFORE_RENDER="beforerender",c.AFTER_RENDER="afterrender",c.BEFORE_ANIMATE="beforeanimate",c.AFTER_ANIMATE="afteranimate",c.BEFORE_LAYOUT="beforelayout",c.AFTER_LAYOUT="afterlayout",c.BEFORE_STAGE_LAYOUT="beforestagelayout",c.AFTER_STAGE_LAYOUT="afterstagelayout",c.BEFORE_TRANSFORM="beforetransform",c.AFTER_TRANSFORM="aftertransform",c.BATCH_START="batchstart",c.BATCH_END="batchend",c.BEFORE_DESTROY="beforedestroy",c.AFTER_DESTROY="afterdestroy",c.BEFORE_RENDERER_CHANGE="beforerendererchange",c.AFTER_RENDERER_CHANGE="afterrendererchange",(u=S||(S={})).UNDO="undo",u.REDO="redo",u.CANCEL="cancel",u.ADD="add",u.CLEAR="clear",u.CHANGE="change",(p=w||(w={})).CLICK="node:click",p.DBLCLICK="node:dblclick",p.POINTER_OVER="node:pointerover",p.POINTER_LEAVE="node:pointerleave",p.POINTER_ENTER="node:pointerenter",p.POINTER_MOVE="node:pointermove",p.POINTER_OUT="node:pointerout",p.POINTER_DOWN="node:pointerdown",p.POINTER_UP="node:pointerup",p.CONTEXT_MENU="node:contextmenu",p.DRAG_START="node:dragstart",p.DRAG="node:drag",p.DRAG_END="node:dragend",p.DRAG_ENTER="node:dragenter",p.DRAG_OVER="node:dragover",p.DRAG_LEAVE="node:dragleave",p.DROP="node:drop";let N="combo",j="tree";(g=D||(D={})).NODE="node",g.EDGE="edge",g.COMBO="combo",g.THEME="theme",g.PALETTE="palette",g.LAYOUT="layout",g.BEHAVIOR="behavior",g.PLUGIN="plugin",g.ANIMATION="animation",g.TRANSFORM="transform",g.SHAPE="shape";let I={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function B(t,e){var n;let i=null===(n=I[t])||void 0===n?void 0:n[e];if(i)return i}function _(t){return"[".concat("G6"," v").concat("5.0.24","] ").concat(t)}let F={mute:!1,debug:t=>{F.mute||console.debug(_(t))},info:t=>{F.mute||console.info(_(t))},warn:t=>{F.mute||console.warn(_(t))},error:t=>{F.mute||console.error(_(t))}};function z(t){let{theme:e}=t;if(!e)return{};let n=B(D.THEME,e);return n||(F.warn("The theme of ".concat(e," is not registered.")),{})}function Z(t,e){if(Array.isArray(t)&&0===t.length)return null;let n=Array.isArray(t)?t[0]:t,i=Array.isArray(t)?t.slice(1):e||[];return new Proxy(n,{get:(t,e)=>"function"!=typeof t[e]||["onframe","onfinish"].includes(e)?"finished"===e?Promise.all([n.finished,...i.map(t=>t.finished)]):Reflect.get(t,e):function(){for(var n=arguments.length,s=Array(n),o=0;o<n;o++)s[o]=arguments[o];t[e](...s),i.forEach(t=>{var n;return null===(n=t[e])||void 0===n?void 0:n.call(t,...s)})},set:(t,e,n)=>(["onframe","onfinish"].includes(e)||i.forEach(t=>{t[e]=n}),Reflect.set(t,e,n))})}function W(t){let e=t.reduce((t,e)=>(Object.entries(e).forEach(e=>{let[n,i]=e;void 0===t[n]?t[n]=[i]:t[n].push(i)}),t),{});Object.entries(e).forEach(n=>{let[i,s]=n;(s.length!==t.length||s.some(t=>(0,T.Z)(t))||s.every(t=>!["sourceNode","targetNode","childrenNode"].includes(i)&&(0,R.Z)(t,s[0])))&&delete e[i]});let n=Object.entries(e).reduce((t,e)=>{let[n,i]=e;return i.forEach((e,i)=>{t[i]?t[i][n]=e:t[i]={[n]:e}}),t},[]);return 0!==t.length&&0===n.length&&n.push(...[{_:0},{_:0}]),n}function V(t){switch(t){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function K(t,e){let{animation:n}=t;if(!1===n||!1===e)return!1;let i=Object.assign({},k);return(0,P.Z)(n)&&Object.assign(i,n),(0,P.Z)(e)&&Object.assign(i,e),i}var G=n(48690);function U(t){if(void 0!==t.id)return t.id;if(void 0!==t.source&&void 0!==t.target)return"".concat(t.source,"-").concat(t.target);throw Error(_("The datum does not have available id."))}function H(t,e){let n={nodes:(t.nodes||[]).map(U),edges:(t.edges||[]).map(U),combos:(t.combos||[]).map(U)};return e?Object.values(n).flat():n}function Y(t,e,n,i){let s=i?i.replace(/translate(3d)?\([^)]*\)/g,""):"";return 0===n?"translate(".concat(t,", ").concat(e,")").concat(s):"translate3d(".concat(t,", ").concat(e,", ").concat(n,")").concat(s)}let X=function(t,e,n,i){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=U(i),r="".concat(n,"s"),a=t.add[r].get(o)||t.update[r].get(o)||t.remove[r].get(o)||i;Object.entries(t).forEach(t=>{let[n,l]=t;e===n?l[r].set(o,s?(0,G.Z)(a,i):i):l[r].delete(o)})};var $=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};let q=(t,e,n)=>{let i;if(!n.length)return null;let[s,o]=e,r=e=>{var n;if(!e)return{shape:t,fromStyle:s,toStyle:o};{let i=t.getShape(e);if(!i)return null;let r="get".concat((0,M.Z)(e),"Style"),a=(null===(n=null==t?void 0:t[r])||void 0===n?void 0:n.bind(t))||(t=>t),l=(null==a?void 0:a(s))||{},h=(null==a?void 0:a(o))||{};return{shape:i,fromStyle:l,toStyle:h}}},a=n.map(t=>{var{fields:e,shape:n,states:s}=t,o=$(t,["fields","shape","states"]);let a=r(n);if(!a)return null;let{shape:l,fromStyle:h,toStyle:d}=a,c=[{},{}];if(e.forEach(t=>{var e,n;Object.assign(c[0],{[t]:null!==(e=h[t])&&void 0!==e?e:V(t)}),Object.assign(c[1],{[t]:null!==(n=d[t])&&void 0!==n?n:V(t)})}),c.some(t=>Object.keys(t).some(t=>["x","y","z"].includes(t)))){let{x:t=0,y:e=0,z:n=0,transform:i=""}=l.attributes||{};c.forEach(s=>{s.transform=Y(s.x||t,s.y||e,s.z||n,i)})}let u=l.animate(W(c),o);return void 0===n&&(i=u),u}).filter(Boolean),l=i||(null==a?void 0:a[0]);return l?Z(l,a.filter(t=>t!=t)):null},Q=[{fields:["x","y"]}],J=[{fields:["sourceNode","targetNode"]}],tt=[{fields:["childrenNode","x","y"]}];function te(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:R.Z,s=new Map(t.map(t=>[n(t),t])),o=new Map(e.map(t=>[n(t),t])),r=new Set(s.keys()),a=new Set(o.keys()),l=[],h=[],d=[],c=[];return a.forEach(t=>{r.has(t)?i(s.get(t),o.get(t))?c.push(o.get(t)):h.push(o.get(t)):l.push(o.get(t))}),r.forEach(t=>{a.has(t)||d.push(s.get(t))}),{enter:l,exit:d,keep:c,update:h}}class tn{setExtensions(t){let e=function(t,e,n){let i={},s=t=>(t in i||(i[t]=0),"".concat(e,"-").concat(t,"-").concat(i[t]++));return n.map(e=>"string"==typeof e?{type:e,key:s(e)}:"function"==typeof e?e.call(t):e.key?e:Object.assign(Object.assign({},e),{key:s(e.type)}))}(this.context.graph,this.category,t),{enter:n,update:i,exit:s,keep:o}=te(this.extensions,e,t=>t.key);this.createExtensions(n),this.updateExtensions([...i,...o]),this.destroyExtensions(s),this.extensions=e}createExtension(t){let{category:e}=this,{key:n,type:i}=t,s=B(e,i);if(!s)return F.warn("The extension ".concat(i," of ").concat(e," is not registered."));let o=new s(this.context,t);this.extensionMap[n]=o}createExtensions(t){t.forEach(t=>this.createExtension(t))}updateExtension(t){let{key:e}=t,n=this.extensionMap[e];n&&n.update(t)}updateExtensions(t){t.forEach(t=>this.updateExtension(t))}destroyExtension(t){let e=this.extensionMap[t];e&&(e.destroy(),delete this.extensionMap[t])}destroyExtensions(t){t.forEach(t=>{let{key:e}=t;return this.destroyExtension(e)})}destroy(){Object.values(this.extensionMap).forEach(t=>t.destroy()),this.context={},this.extensions=[],this.extensionMap={}}constructor(t){this.extensions=[],this.extensionMap={},this.context=t}}class ti{update(t){this.options=Object.assign(this.options,t)}destroy(){this.context={},this.options={},this.destroyed=!0}constructor(t,e){this.events=[],this.destroyed=!1,this.context=t,this.options=e}}class ts extends ti{}var to=n(91531),tr=n(21914);function ta(t){return t instanceof Float32Array||!!Array.isArray(t)&&(2===t.length||3===t.length)&&t.every(t=>"number"==typeof t)}function tl(t,e,n){return t>=e&&t<=n}function th(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(Array.isArray(t)){let[e=0,n=e,i=e,s=n]=t;return[e,n,i,s]}return[t,t,t,t]}function td(t){return t.max[0]-t.min[0]}function tc(t){return t.max[1]-t.min[1]}function tu(t){return[td(t),tc(t)]}function tp(t,e){let n=ta(t)?tg(t):t.getShape("key").getBounds();return e?tf(n,e):n}function tg(t){let[e,n,i=0]=t,s=new A.mN;return s.setMinMax([e,n,i],[e,n,i]),s}function tf(t,e){let[n,i,s,o]=th(e),[r,a,l]=t.min,[h,d,c]=t.max,u=new A.mN;return u.setMinMax([r-o,a-n,l],[h+i,d+s,c]),u}function tm(t){if(0===t.length)return new A.mN;if(1===t.length)return t[0];let e=new A.mN;e.setMinMax(t[0].min,t[0].max);for(let n=1;n<t.length;n++){let i=t[n];e.setMinMax([Math.min(e.min[0],i.min[0]),Math.min(e.min[1],i.min[1]),Math.min(e.min[2],i.min[2])],[Math.max(e.max[0],i.max[0]),Math.max(e.max[1],i.max[1]),Math.max(e.max[2],i.max[2])])}return e}function ty(t,e){return tl(t[0],e.min[0],e.max[0])&&tl(t[1],e.min[1],e.max[1])}function tv(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{min:[i,s],max:[o,r]}=e,a=(t[1]===s||t[1]===r)&&(n||tl(t[0],i,o)),l=(t[0]===i||t[0]===o)&&(n||tl(t[1],s,r));return a||l}function tb(t,e){let{center:n}=e;return t[0]===n[0]&&t[1]===n[1]}function tE(t,e){let[n,i]=t,[s,o]=e.min,[r,a]=e.max,l=n-s,h=r-n,d=i-o,c=a-i,u=Math.min(l,h,d,c);return u===l?"left":u===h?"right":u===d?"top":u===c?"bottom":"left"}function tx(t,e){let n=(0,tr.Z)(t);if(ty(t,e)){let i=tE(t,e);switch(i){case"left":n[0]=e.min[0];break;case"right":n[0]=e.max[0];break;case"top":n[1]=e.min[1];break;case"bottom":n[1]=e.max[1]}}else{let[i,s]=t,[o,r]=e.min,[a,l]=e.max;n[0]=tl(i,o,a)?i:i<o?o:a,n[1]=tl(s,r,l)?s:s<r?r:l}return n}let tO=[0,0,0];function tS(t,e){return t.map((t,n)=>t+e[n])}function tw(t,e){return t.map((t,n)=>t-e[n])}function tD(t,e){return"number"==typeof e?t.map(t=>t*e):t.map((t,n)=>t*e[n])}function tC(t,e){return"number"==typeof e?t.map(t=>t/e):t.map((t,n)=>t/e[n])}function tA(t,e){return t.map(t=>t*e)}function tM(t,e){return Math.sqrt(t.reduce((t,n,i)=>t+Math.pow(n-e[i]||0,2),0))}function tT(t,e){return t.reduce((t,n,i)=>t+Math.abs(n-e[i]),0)}function tR(t){let e=t.reduce((t,e)=>t+Math.pow(e,2),0);return t.map(t=>t/Math.sqrt(e))}function tP(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t[0]*e[1]-t[1]*e[0],s=Math.acos(tD(t,e).reduce((t,e)=>t+e,0)/(tM(t,tO)*tM(e,tO)));return n&&i<0&&(s=2*Math.PI-s),s}function tk(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return e?[-t[1],t[0]]:[t[1],-t[0]]}function tL(t){return[t[0],t[1]]}function tN(t){return 2===t.length?[t[0],t[1],0]:t}function tj(t){let[e,n]=t;return e||n?Math.atan2(n,e):0}function tI(t,e){let[n,i]=t,[s,o]=e,r=tw(n,i),a=tw(s,o);return(function(t,e){let n=tN(t),i=tN(e);return[n[1]*i[2]-n[2]*i[1],n[2]*i[0]-n[0]*i[2],n[0]*i[1]-n[1]*i[0]]})(r,a).every(t=>0===t)}function tB(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(tI(t,e))return;let[i,s]=t,[o,r]=e,a=((i[0]-o[0])*(o[1]-r[1])-(i[1]-o[1])*(o[0]-r[0]))/((i[0]-s[0])*(o[1]-r[1])-(i[1]-s[1])*(o[0]-r[0])),l=r[0]-o[0]?(i[0]-o[0]+a*(s[0]-i[0]))/(r[0]-o[0]):(i[1]-o[1]+a*(s[1]-i[1]))/(r[1]-o[1]);if(n||tl(a,0,1)&&tl(l,0,1))return[i[0]+a*(s[0]-i[0]),i[1]+a*(s[1]-i[1])]}function t_(t){if(Array.isArray(t))return tl(t[0],0,1)&&tl(t[1],0,1)?t:[.5,.5];let e=t.split("-"),n=e.includes("left")?0:e.includes("right")?1:.5,i=e.includes("top")?0:e.includes("bottom")?1:.5;return[n,i]}function tF(t){let{x:e=0,y:n=0,z:i=0}=t.style||{};return[+e,+n,+i]}function tz(t){let{x:e,y:n,z:i}=t.style||{};return void 0!==e||void 0!==n||void 0!==i}function tZ(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"center",n=t_(e);return function(t,e){let[n,i]=e,{min:s,max:o}=t;return[s[0]+n*(o[0]-s[0]),s[1]+i*(o[1]-s[1])]}(t,n)}function tW(t){var e;return[t.x,t.y,null!==(e=t.z)&&void 0!==e?e:0]}function tV(t){var e;return{x:t[0],y:t[1],z:null!==(e=t[2])&&void 0!==e?e:0}}function tK(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.map(t=>parseFloat(t.toFixed(e)))}function tG(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if((0,R.Z)(t,e))return t;let s=i?tw(t,e):tw(e,t),o=tR(s),r=[o[0]*n,o[1]*n];return tS(tL(t),r)}function tU(t,e){return[2*e[0]-t[0],2*e[1]-t[1]]}function tH(t,e,n){let i=!(arguments.length>3)||void 0===arguments[3]||arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];for(let o=0;o<n.length;o++){let r=n[o],a=n[(o+1)%n.length];i&&(r=tS(e,r),a=tS(e,a));let l=s?tU(t,e):t,h=tB([e,l],[r,a]);if(h)return{point:h,line:[r,a]}}return{point:e,line:void 0}}function tY(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.center,s=n?tU(t,i):t,o=tw(s,e.center),r=Math.atan2(o[1],o[0]);if(isNaN(r))return i;let a=td(e)/2,l=tc(e)/2,h=i[0]+a*Math.cos(r),d=i[1]+l*Math.sin(r);return[h,d]}function tX(t,e){let[n,i]=e[0],[s,o]=e[1],[r,a]=t,l=s-n,h=o-i;if(0===l&&0===h)return[n,i];let d=((r-n)*l+(a-i)*h)/(l*l+h*h);d>1?d=1:d<0&&(d=0);let c=n+d*l,u=i+d*h;return[c,u]}function t$(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=function(t){let e=t.reduce((t,e)=>tS(t,e),[0,0]);return tC(e,t.length)}(t);return t.sort((t,i)=>{let[s,o]=t,[r,a]=i,l=Math.atan2(o-n[1],s-n[0]),h=Math.atan2(a-n[1],r-n[0]);return e?h-l:l-h})}function tq(t,e){return[t,[t[0],e[1]],e,[e[0],t[1]]]}var tQ=n(27412);let tJ=t=>t.map(t=>(0,tQ.Z)(t)?t.toLocaleLowerCase():t);class t0{bind(t,e){0!==t.length&&this.map.set(t,e)}unbind(t,e){this.map.forEach((n,i)=>{(0,R.Z)(i,t)&&(!e||e===n)&&this.map.delete(i)})}unbindAll(){this.map.clear()}match(t){let e=tJ(Array.from(this.recordKey)).sort(),n=tJ(t).sort();return(0,R.Z)(e,n)}bindEvents(){let{emitter:t}=this;t.on(b.KEY_DOWN,this.onKeyDown),t.on(b.KEY_UP,this.onKeyUp),t.on(b.WHEEL,this.onWheel),t.on(b.DRAG,this.onDrag),window.addEventListener("focus",this.onFocus)}trigger(t){this.map.forEach((e,n)=>{this.match(n)&&e(t)})}triggerExtendKey(t,e){this.map.forEach((n,i)=>{i.includes(t)&&(0,R.Z)(Array.from(this.recordKey),i.filter(e=>e!==t))&&n(e)})}destroy(){this.unbindAll(),this.emitter.off(b.KEY_DOWN,this.onKeyDown),this.emitter.off(b.KEY_UP,this.onKeyUp),this.emitter.off(b.WHEEL,this.onWheel),this.emitter.off(b.DRAG,this.onDrag),window.removeEventListener("blur",this.onFocus)}constructor(t){this.map=new Map,this.recordKey=new Set,this.onKeyDown=t=>{(null==t?void 0:t.key)&&(this.recordKey.add(t.key),this.trigger(t))},this.onKeyUp=t=>{(null==t?void 0:t.key)&&this.recordKey.delete(t.key)},this.onWheel=t=>{this.triggerExtendKey(b.WHEEL,t)},this.onDrag=t=>{this.triggerExtendKey(b.DRAG,t)},this.onFocus=()=>{this.recordKey.clear()},this.emitter=t,this.bindEvents()}}class t1 extends ts{onPointerDown(t){if(!this.validate(t)||!this.isKeydown()||this.startPoint)return;let{canvas:e,graph:n}=this.context,i=Object.assign({},this.options.style);this.options.style.lineWidth&&(i.lineWidth=+this.options.style.lineWidth/n.getZoom()),this.rectShape=new A.UL({id:"g6-brush-select",style:i}),e.appendChild(this.rectShape),this.startPoint=[t.canvas.x,t.canvas.y]}onPointerMove(t){var e;if(!this.startPoint)return;let{immediately:n,mode:i}=this.options;this.endPoint=t3(t),null===(e=this.rectShape)||void 0===e||e.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),n&&"default"===i&&this.updateElementsStates(tq(this.startPoint,this.endPoint))}onPointerUp(t){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=t3(t),this.updateElementsStates(tq(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){let{graph:t}=this.context,e=Object.values(t.getData()).reduce((t,e)=>Object.assign({},t,e.reduce((t,e)=>(t[U(e)]=[],t),{})),{});t.setElementState(e,this.options.animation)}updateElementsStates(t){let{graph:e}=this.context,{enableElements:n,state:i,mode:s,onSelect:o}=this.options,r=this.selector(e,t,n),a={};switch(s){case"union":r.forEach(t=>{a[t]=[...e.getElementState(t),i]});break;case"diff":r.forEach(t=>{let n=e.getElementState(t);a[t]=n.includes(i)?n.filter(t=>t!==i):[...n,i]});break;case"intersect":r.forEach(t=>{let n=e.getElementState(t);a[t]=n.includes(i)?[i]:[]});break;default:r.forEach(t=>{a[t]=[i]})}(0,to.Z)(o)&&(a=o(a)),e.setElementState(a,this.options.animation)}selector(t,e,n){if(!n||0===n.length)return[];let i=[],s=t.getData();if(n.forEach(n=>{s["".concat(n,"s")].forEach(n=>{let s=U(n);"hidden"!==t.getElementVisibility(s)&&function(t,e,n,i){let s=t[0],o=t[1],r=!1;void 0===n&&(n=0),void 0===i&&(i=e.length);let a=i-n;for(let t=0,i=a-1;t<a;i=t++){let a=e[t+n][0],l=e[t+n][1],h=e[i+n][0],d=e[i+n][1],c=l>o!=d>o&&s<(h-a)*(o-l)/(d-l)+a;c&&(r=!r)}return r}(t.getElementPosition(s),e)&&i.push(s)})}),n.includes("edge")){let t=s.edges;null==t||t.forEach(t=>{let{source:e,target:n}=t;i.includes(e)&&i.includes(n)&&i.push(U(t))})}return i}clearBrush(){var t;null===(t=this.rectShape)||void 0===t||t.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){let{trigger:t}=this.options,e=Array.isArray(t)?t:[t];return this.shortcut.match(e.filter(t=>"drag"!==t))}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,to.Z)(e)?e(t):!!e}bindEvents(){let{graph:t}=this.context;t.on(b.POINTER_DOWN,this.onPointerDown),t.on(b.POINTER_MOVE,this.onPointerMove),t.on(b.POINTER_UP,this.onPointerUp),t.on(y.CLICK,this.clearStates)}unbindEvents(){let{graph:t}=this.context;t.off(b.POINTER_DOWN,this.onPointerDown),t.off(b.POINTER_MOVE,this.onPointerMove),t.off(b.POINTER_UP,this.onPointerUp),t.off(y.CLICK,this.clearStates)}update(t){this.unbindEvents(),this.options=(0,G.Z)(this.options,t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,(0,G.Z)({},t1.defaultOptions,e)),this.shortcut=new t0(t.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}}t1.defaultOptions={animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}};let t3=t=>[t.canvas.x,t.canvas.y],t6=["node","edge","combo"];function t2(t,e,n,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;"TB"===i&&e(t,s);let o=n(t);if(o)for(let t of o)t2(t,e,n,i,s+1);"BT"===i&&e(t,s)}function t4(t,e,n,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"both";if("combo"===e||"node"===e)return t8(t,n,i,s);let o=t.getEdgeData(n);if(!o)return[];let r=t8(t,o.source,i-1,s),a=t8(t,o.target,i-1,s);return Array.from(new Set([...r,...a,n]))}function t8(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"both",s=new Set,o=new Set,r=new Set;return!function(t,e,n){let i=[[t,0]];for(;i.length;){let[t,s]=i.shift();e(t,s);let o=n(t);if(o)for(let t of o)i.push([t,s+1])}}(e,(e,s)=>{s>n||(r.add(e),t.getRelatedEdgesData(e,i).forEach(t=>{let e=U(t);!o.has(e)&&s<n&&(r.add(e),o.add(e))}))},e=>t.getRelatedEdgesData(e,i).map(t=>t.source===e?t.target:t.source).filter(t=>!s.has(t)&&(s.add(t),!0))),Array.from(r)}function t9(t){return t.states||[]}var t5=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})};class t7 extends ts{bindEvents(){let{graph:t}=this.context;this.unbindEvents(),t6.forEach(e=>{t.on("".concat(e,":").concat(b.CLICK),this.onClickSelect)}),t.on(y.CLICK,this.onClickCanvas)}get isMultipleSelect(){let{multiple:t,trigger:e}=this.options;return t&&this.shortcut.match(e)}getNeighborIds(t){let{target:e,targetType:n}=t,{graph:i}=this.context,{degree:s}=this.options;return t4(i,n,e.id,"function"==typeof s?s(t):s).filter(t=>t!==e.id)}updateState(t){return t5(this,void 0,void 0,function*(){let{state:e,unselectedState:n,neighborState:i,animation:s}=this.options;if(!e&&!i&&!n)return;let{target:o}=t,{graph:r}=this.context,a=r.getElementData(o.id),l=t9(a).includes(e)?"unselect":"select",h={},d=this.isMultipleSelect,c=[o.id],u=this.getNeighborIds(t);if(d){if(Object.assign(h,this.getDataStates()),"select"===l){let t=(t,e)=>{t.forEach(t=>{let i=new Set(r.getElementState(t));i.add(e),i.delete(n),h[t]=Array.from(i)})};t(c,e),t(u,i),n&&Object.keys(h).forEach(t=>{let s=h[t];s.includes(e)||s.includes(i)||s.includes(n)||h[t].push(n)})}else{let t=h[o.id];h[o.id]=t.filter(t=>t!==e&&t!==i),t.includes(n)||h[o.id].push(n),u.forEach(t=>{h[t]=h[t].filter(t=>t!==i),h[t].includes(e)||h[t].push(n)})}}else if("select"===l){Object.assign(h,this.getClearStates(!!n));let t=(t,e)=>{t.forEach(t=>{h[t]||(h[t]=r.getElementState(t)),h[t].push(e)})};t(c,e),t(u,i),n&&Object.keys(h).forEach(t=>{c.includes(t)||u.includes(t)||h[t].push(n)})}else Object.assign(h,this.getClearStates());yield r.setElementState(h,s)})}getDataStates(){let{graph:t}=this.context,{nodes:e,edges:n,combos:i}=t.getData(),s={};return[...e,...n,...i].forEach(t=>{s[U(t)]=t9(t)}),s}getClearStates(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{graph:e}=this.context,{state:n,unselectedState:i,neighborState:s}=this.options,o=new Set([n,i,s]),{nodes:r,edges:a,combos:l}=e.getData(),h={};return[...r,...a,...l].forEach(e=>{let n=t9(e),i=n.filter(t=>!o.has(t));t?h[U(e)]=i:i.length!==n.length&&(h[U(e)]=i)}),h}clearState(){return t5(this,void 0,void 0,function*(){let{graph:t}=this.context;yield t.setElementState(this.getClearStates(),this.options.animation)})}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,to.Z)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;t6.forEach(e=>{t.off("".concat(e,":").concat(b.CLICK),this.onClickSelect)}),t.off(y.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},t7.defaultOptions,e)),this.onClickSelect=t=>t5(this,void 0,void 0,function*(){var e,n;this.validate(t)&&(yield this.updateState(t),null===(n=(e=this.options).onClick)||void 0===n||n.call(e,t))}),this.onClickCanvas=t=>t5(this,void 0,void 0,function*(){var e,n;this.validate(t)&&(yield this.clearState(),null===(n=(e=this.options).onClick)||void 0===n||n.call(e,t))}),this.shortcut=new t0(t.graph),this.bindEvents()}}function et(t){var e;return!!(null===(e=t.style)||void 0===e?void 0:e.collapsed)}t7.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0};var ee=n(22040),en=n(28767),ei=n(2159);function es(t,e){if(!t.startsWith(e))return!1;let n=t[e.length];return n>="A"&&n<="Z"}function eo(t,e){let n=Object.entries(t).reduce((t,n)=>{let[i,s]=n;return"className"===i||"class"===i||es(i,e)&&Object.assign(t,{[function(t,e){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(!e||!es(t,e))return t;let i=t.slice(e.length);return n?(0,ei.Z)(i):i}(i,e)]:s}),t},{});if("opacity"in t){let i="".concat(e).concat((0,M.Z)("opacity")),s=t.opacity;if(i in t){let e=t[i];Object.assign(n,{opacity:s*e})}else Object.assign(n,{opacity:s})}return n}function er(t,e){let n=e.length;return Object.keys(t).reduce((i,s)=>{if(s.startsWith(e)){let e=s.slice(n);i[e]=t[s]}return i},{})}function ea(t,e){let n="string"==typeof e?[e]:e,i={};return Object.keys(t).forEach(e=>{n.find(t=>e.startsWith(t))||(i[e]=t[e])}),i}function el(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if("number"==typeof t)return[t,t,t];let[e,n=e,i=e]=t;return[e,n,i]}var eh=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};function ed(t,e){let{datum:n,graph:i}=e;return"function"==typeof t?t.call(i,n):Object.fromEntries(Object.entries(t).map(t=>{let[e,s]=t;return"function"==typeof s?[e,s.call(i,n)]:[e,s]}))}function ec(t,e){let n=(null==t?void 0:t.style)||{},i=(null==e?void 0:e.style)||{};return Object.assign({},t,e,{style:Object.assign({},n,i)})}let eu=new WeakMap;function ep(t,e,n){eu.has(t)||eu.set(t,{});let i=eu.get(t);if(!i[e])return i[e]=n,!0;let s=i[e];return!eg(s,n)&&(i[e]=n,!0)}let eg=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if("object"!=typeof t||"object"!=typeof e)return t===e;let i=Object.keys(t),s=Object.keys(e);if(i.length!==s.length)return!1;for(let s of i){let i=t[s],o=e[s];if(n>1&&"object"==typeof i&&"object"==typeof o){if(!eg(i,o,n-1))return!1}else if(i!==o)return!1}return!0};var ef=n(26218);function em(t){if(t)return"string"==typeof t||"function"==typeof t||Array.isArray(t)?{type:"group",field:t=>t.id,color:t,invert:!1}:t}function ey(t){let e="string"==typeof t?B("palette",t):t;if("function"!=typeof e)return e}function ev(t,e){let n=2*t;return"string"==typeof e?n=t*Number(e.replace("%",""))/100:"number"==typeof e&&(n=e),isNaN(n)&&(n=2*t),n}function eb(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=(t.max[0]-t.min[0])*(i?n:1);return ev(s,e)}let eE=new WeakMap;function ex(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0;if(void 0===e)return;let s=function(o){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,a=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;return o.childNodes.forEach(e=>s(e,t))};if(i&&!i(o))return a();if(n||o!==t){eE.has(o)||eE.set(o,o.style.visibility);let t="hidden"===r||"hidden"===(eE.has(o)?eE.get(o):o.style.visibility)?"hidden":"visible";o.style.visibility=t,a(t)}else t.style.visibility=e,eE.delete(t),a(e)};s(t)}var eO=n(70591);class eS extends A.b_{get parsedAttributes(){return this.attributes}upsert(t,e,n,i,s){var o,r,a,l,h,d,c,u;let p=this.shapeMap[t];if(!1===n){p&&(null===(o=null==s?void 0:s.beforeDestroy)||void 0===o||o.call(s,p),i.removeChild(p),delete this.shapeMap[t],null===(r=null==s?void 0:s.afterDestroy)||void 0===r||r.call(s,p));return}let g="string"==typeof e?B(D.SHAPE,e):e;if(!g)throw Error(_("Shape ".concat(e," not found")));if(!p||p.destroyed||!(p instanceof g)){p&&(null===(a=null==s?void 0:s.beforeDestroy)||void 0===a||a.call(s,p),null==p||p.destroy(),null===(l=null==s?void 0:s.afterDestroy)||void 0===l||l.call(s,p)),null===(h=null==s?void 0:s.beforeCreate)||void 0===h||h.call(s);let e=new g({className:t,style:n});return i.appendChild(e),this.shapeMap[t]=e,null===(d=null==s?void 0:s.afterCreate)||void 0===d||d.call(s,e),e}return null===(c=null==s?void 0:s.beforeUpdate)||void 0===c||c.call(s,p),n6(p,n),null===(u=null==s?void 0:s.afterUpdate)||void 0===u||u.call(s,p),p}transformPosition(t){if("x"in t||"y"in t||"z"in t){let{x:e=0,y:n=0,z:i=0,transform:s}=t;this.style.transform=Y(+e,+n,+i,s)}}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},this.attributes,t);this.attr(e),this.render(e,this),this.transformPosition(e),this.setVisibility()}bindEvents(){}getGraphicStyle(t){return function(t){let{x:e,y:n,z:i,class:s,className:o,transform:r,transformOrigin:a,context:l,zIndex:h,visibility:d}=t,c=eh(t,["x","y","z","class","className","transform","transformOrigin","context","zIndex","visibility"]);return c}(t)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(t,e){if(0===t.length)return null;let n=[];if(void 0!==t[0].x||void 0!==t[0].y||void 0!==t[0].z){let{x:e=0,y:n=0,z:i=0}=this.attributes;t.forEach(t=>{let{x:s=e,y:o=n,z:r=i}=t;Object.assign(t,{transform:Y(+s,+o,+r)})})}let i=super.animate(t,e);if(i&&(ew(this,i),n.push(i)),Array.isArray(t)&&t.length>0){let i=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(t[0]).some(t=>!i.includes(t))){Object.entries(this.shapeMap).forEach(i=>{let[s,o]=i,r="get".concat((0,M.Z)(s),"Style"),a=this[r];if((0,to.Z)(a)){let i=t.map(t=>a.call(this,Object.assign(Object.assign({},this.attributes),t))),s=o.animate(W(i),e);s&&(ew(o,s),n.push(s))}});let i=(i,s)=>{if(!(0,eO.Z)(i)){let o="get".concat((0,M.Z)(s),"Style"),r=this[o];if((0,to.Z)(r)){let s=t.map(t=>r.call(this,Object.assign(Object.assign({},this.attributes),t)));Object.entries(s[0]).map(t=>{let[o]=t,r=s.map(t=>t[o]),a=i[o];if(a){let t=a.animate(W(r),e);t&&(ew(a,t),n.push(t))}})}}};this.compositeShapes.forEach(t=>{let[e,n]=t,s=er(this.shapeMap,n);i(s,e)})}}return Z(n)}getShape(t){return this.shapeMap[t]}setVisibility(){let{visibility:t}=this.attributes;ex(this,t,!0)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}constructor(t){super(t),this.shapeMap={},this.animateMap={},this.transformPosition(this.attributes),this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}}function ew(t,e){null==e||e.finished.then(()=>{let n=t.activeAnimations.findIndex(t=>t===e);n>-1&&t.activeAnimations.splice(n,1)})}var eD=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};class eC extends eS{isTextStyle(t){return es(t,"label")}isBackgroundStyle(t){return es(t,"background")}getTextStyle(t){let e=this.getGraphicStyle(t),{padding:n}=e,i=eD(e,["padding"]);return ea(i,"background")}getBackgroundStyle(t){if(!1===t.background)return!1;let e=this.getGraphicStyle(t),{wordWrap:n,wordWrapWidth:i,padding:s}=e,o=eo(e,"background"),{min:[r,a],center:[l,h],halfExtents:[d,c]}=this.shapeMap.text.getGeometryBounds(),[u,p,g,f]=th(s),m=2*d+f+p,{width:y,height:v}=o;y&&v?Object.assign(o,{x:l-Number(y)/2,y:h-Number(v)/2}):Object.assign(o,{x:r-f,y:a-u,width:n?Math.min(m,i+f+p):m,height:2*c+u+g});let{radius:b}=o;if("string"==typeof b&&b.endsWith("%")){let t=Number(b.replace("%",""))/100;o.radius=Math.min(+o.width,+o.height)*t}return o}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parsedAttributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.upsert("text",A.xv,this.getTextStyle(t),e),this.upsert("background",A.UL,this.getBackgroundStyle(t),e)}getGeometryBounds(){let t=this.getShape("background")||this.getShape("text");return t.getGeometryBounds()}constructor(t){super(ec({style:eC.defaultStyleProps},t))}}eC.defaultStyleProps={padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};class eA extends eS{getBadgeStyle(t){return this.getGraphicStyle(t)}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parsedAttributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.upsert("label",eC,this.getBadgeStyle(t),e)}getGeometryBounds(){let t=this.getShape("label"),e=t.getShape("background")||t.getShape("text");return e.getGeometryBounds()}constructor(t){super(ec({style:eA.defaultStyleProps},t))}}eA.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1};let eM={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]},eT=t=>{if(t.length<2)return[["M",0,0],["L",0,0]];let e=t[0],n=t[1],i=t[t.length-1],s=t[t.length-2];t.unshift(s,i),t.push(e,n);let o=[["M",i[0],i[1]]];for(let e=1;e<t.length-2;e+=1){let[n,i]=t[e-1],[s,r]=t[e],[a,l]=t[e+1],[h,d]=e!==t.length-2?t[e+2]:[a,l],c=s+(a-n)/6,u=r+(l-i)/6,p=a-(h-s)/6,g=l-(d-r)/6;o.push(["C",c,u,p,g,a,l])}return o};var eR=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};class eP extends eS{getLabelStyle(t){if(!t.label||!t.d||0===t.d.length)return!1;let e=eo(this.getGraphicStyle(t),"label"),{maxWidth:n,offsetX:i,offsetY:s,autoRotate:o,placement:r,closeToPath:a}=e,l=eR(e,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),h=this.shapeMap.key,d=null==h?void 0:h.getRenderBounds();return Object.assign(function(t,e,n,i,s,o,r){var a;let l,h;let[d,c]=tZ(t,e),u={textAlign:"left"===e?"right":"right"===e?"left":"center",textBaseline:"top"===e?"bottom":"bottom"===e?"top":"middle",transform:"translate(".concat(d+n,", ").concat(c+i,")")};if("center"===e||!s)return u;let p=function(t){let e=[],n="string"==typeof t?function(t){let e=t.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),n=[],i="",s={};for(;e.length>0;){let t=e.shift();t in eM?i=t:e.unshift(t),s={type:i},eM[i].forEach(n=>{t=e.shift(),s[n]=t}),"M"===i?i="L":"m"===i&&(i="l");let[o,...r]=Object.values(s);n.push([o,...r.map(Number)])}return n}(t):t;return n.forEach(t=>{let n=t[0];if("Z"===n){e.push(e[0]);return}if("A"!==n)for(let n=1;n<t.length;n+=2)e.push([t[n],t[n+1],0]);else{let n=t.length;e.push([t[n-2],t[n-1],0])}}),e}(o);if(!p||p.length<=3)return u;let g=p.map((t,e)=>{let n=p[(e+1)%p.length];return(0,R.Z)(t,n)?null:[t,n]}).filter(Boolean),f=(a=[d,c],l=1/0,h=[[0,0],[0,0]],g.forEach(t=>{let e=function(t,e){let n=tX(t,e);return tM(t,n)}(a,t);e<l&&(l=e,h=t)}),h),m=tX([d,c],f);if(m&&f&&(u.transform="translate(".concat(m[0]+n,", ").concat(m[1]+i,")"),r)){let t=Math.atan((f[0][1]-f[1][1])/(f[0][0]-f[1][0]));u.transform+="rotate(".concat(t/Math.PI*180,"deg)"),u.textAlign="center",("right"===e||"left"===e)&&(t>0?u.textBaseline="right"===e?"bottom":"top":u.textBaseline="right"===e?"top":"bottom")}return u}(d,r,i,s,a,t.d,o),{wordWrapWidth:eb(d,n)},l)}getKeyStyle(t){return this.getGraphicStyle(t)}render(t,e){this.upsert("key",A.y$,this.getKeyStyle(t),e),this.upsert("label",eC,this.getLabelStyle(t),e)}constructor(t){super(ec({style:eP.defaultStyleProps},t))}}eP.defaultStyleProps={label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};class ek extends A.Ee{handleRadius(){let{radius:t,clipPath:e,width:n=0,height:i=0}=this.attributes;if(t&&n&&i){let[s,o]=this.getBounds().min,r={x:s,y:o,radius:t,width:n,height:i};if(e)Object.assign(this.parsedStyle.clipPath.style,r);else{let t=new A.UL({style:r});this.style.clipPath=t}}else e&&(this.style.clipPath=null)}constructor(t){super(t),this.onMounted=()=>{this.handleRadius()},this.onAttrModified=()=>{this.handleRadius()},eN=this,this.isMutationObserved=!0,this.addEventListener(A.Dk.MOUNTED,this.onMounted),this.addEventListener(A.Dk.ATTR_MODIFIED,this.onAttrModified)}}let eL=new WeakMap,eN=null,ej=t=>{if(eN&&(function(t){let e=[],n=t.parentNode;for(;n;)e.push(n),n=n.parentNode;return e})(eN).includes(t)){let e=eL.get(t);e?e.includes(eN)||e.push(eN):eL.set(t,[eN])}},eI=t=>{let e=eL.get(t);e&&e.forEach(t=>t.handleRadius())};class eB extends eS{isImage(){let{src:t}=this.attributes;return!!t}getIconStyle(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.attributes,{width:e=0,height:n=0}=t,i=this.getGraphicStyle(t);return this.isImage()?Object.assign({x:-e/2,y:-n/2},i):Object.assign({textBaseline:"middle",textAlign:"center"},i)}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.attributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.upsert("icon",this.isImage()?ek:A.xv,this.getIconStyle(t),e)}constructor(t){super(t)}}class e_ extends eS{get context(){return this.attributes.context}get parsedAttributes(){return this.attributes}onframe(){}animate(t,e){let n=super.animate(t,e);return n&&(n.onframe=()=>this.onframe(),n.finished.then(()=>this.onframe())),n}}var eF=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};class ez extends e_{getSize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.attributes,{size:e}=t;return el(e)}getKeyStyle(t){let e=this.getGraphicStyle(t);return Object.assign(ea(e,["label","halo","icon","badge","port"]))}getLabelStyle(t){if(!1===t.label||!t.labelText)return!1;let e=eo(this.getGraphicStyle(t),"label"),{placement:n,maxWidth:i,offsetX:s,offsetY:o}=e,r=eF(e,["placement","maxWidth","offsetX","offsetY"]),a=this.getShape("key").getLocalBounds();return Object.assign(n3(a,n,s,o),{wordWrapWidth:eb(a,i)},r)}getHaloStyle(t){if(!1===t.halo)return!1;let e=this.getKeyStyle(t),{fill:n}=e,i=eF(e,["fill"]),s=eo(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign(Object.assign({},i),{stroke:n}),s)}getIconStyle(t){if(!1===t.icon||!t.iconText&&!t.iconSrc)return!1;let e=eo(this.getGraphicStyle(t),"icon");return Object.assign(function(t,e){let n=el(t),i={};return e.text&&!e.fontSize&&(i={fontSize:.5*Math.min(...n)}),!e.src||e.width&&e.height||(i={width:.5*n[0],height:.5*n[1]}),i}(t.size,e),e)}getBadgesStyle(t){var e;let n=er(this.shapeMap,"badge-"),i={};if(Object.keys(n).forEach(t=>{i[t]=!1}),!1===t.badge||!(null===(e=t.badges)||void 0===e?void 0:e.length))return i;let{badges:s=[],badgePalette:o,opacity:r=1}=t,a=eF(t,["badges","badgePalette","opacity"]),l=ey(o),h=eo(this.getGraphicStyle(a),"badge");return s.forEach((t,e)=>{i[e]=Object.assign(Object.assign({backgroundFill:l?l[e%(null==l?void 0:l.length)]:void 0,opacity:r},h),this.getBadgeStyle(t))}),i}getBadgeStyle(t){let e=this.getShape("key"),{placement:n="top",offsetX:i,offsetY:s}=t,o=eF(t,["placement","offsetX","offsetY"]),r=n3(e.getLocalBounds(),n,i,s,!0);return Object.assign(Object.assign({},r),o)}getPortsStyle(t){var e;let n=this.getPorts(),i={};if(Object.keys(n).forEach(t=>{i[t]=!1}),!1===t.port||!(null===(e=t.ports)||void 0===e?void 0:e.length))return i;let s=eo(this.getGraphicStyle(t),"port"),{ports:o=[]}=t;return o.forEach((e,n)=>{let o=e.key||n,r=Object.assign(Object.assign({},s),e);if(n$(r))i[o]=!1;else{let[n,s]=this.getPortXY(t,e);i[o]=Object.assign({transform:"translate(".concat(n,", ").concat(s,")")},r)}}),i}getPortXY(t,e){let{placement:n="left"}=e,i=this.getShape("key");return nY(function(t,e){if(!t)return e.getLocalBounds();let n=t.canvas.getLayer(),i=e.cloneNode();ex(i,"hidden"),n.appendChild(i);let s=i.getLocalBounds();return n.removeChild(i),s}(this.context,i),n)}getPorts(){return er(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getShape("key").getBounds();return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=tZ(e,"center"),s=[tZ(e,"left-top"),tZ(e,"right-top"),tZ(e,"right-bottom"),tZ(e,"left-bottom")];return tH(t,i,s,!1,n).point}(t,n,e)}drawHaloShape(t,e){let n=this.getHaloStyle(t);if(!ep(this,"halo",n))return;let i=this.getShape("key");this.upsert("halo",i.constructor,n,e)}drawIconShape(t,e){let n=this.getIconStyle(t);ep(this,"icon",n)&&(this.upsert("icon",eB,n,e),ej(this))}drawBadgeShapes(t,e){let n=this.getBadgesStyle(t);Object.keys(n).forEach(t=>{let i=n[t];ep(this,"badge-".concat(t),i)&&this.upsert("badge-".concat(t),eA,i,e)})}drawPortShapes(t,e){let n=this.getPortsStyle(t);Object.keys(n).forEach(t=>{let i=n[t],s="port-".concat(t);ep(this,s,i)&&this.upsert(s,A.Cd,i,e)})}drawLabelShape(t,e){let n=this.getLabelStyle(t);ep(this,"label",n)&&this.upsert("label",eC,n,e)}_drawKeyShape(t,e){return this.drawKeyShape(t,e)}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parsedAttributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this._drawKeyShape(t,e),this.getShape("key")&&(this.drawHaloShape(t,e),this.drawIconShape(t,e),this.drawBadgeShapes(t,e),this.drawLabelShape(t,e),this.drawPortShapes(t,e))}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&eI(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}constructor(t){super(ec({style:ez.defaultStyleProps},t)),this.type="node"}}ez.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0};class eZ extends ez{drawKeyShape(t,e){return this.upsert("key",A.Cd,this.getKeyStyle(t),e)}getKeyStyle(t){let e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{r:Math.min(...this.getSize(t))/2})}getIconStyle(t){let e=super.getIconStyle(t),{r:n}=this.getShape("key").attributes,i=2*n*.8;return!!e&&Object.assign({width:i,height:i},e)}getIntersectPoint(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getShape("key").getBounds();return tY(t,n,e)}constructor(t){super(ec({style:eZ.defaultStyleProps},t))}}eZ.defaultStyleProps={size:32};class eW extends ez{get parsedAttributes(){return this.attributes}drawKeyShape(t,e){return this.upsert("key",A.mg,this.getKeyStyle(t),e)}getKeyStyle(t){let e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{points:this.getPoints(t)})}getIntersectPoint(t){var e,n;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{points:s}=this.getShape("key").attributes,o=[+((null===(e=this.attributes)||void 0===e?void 0:e.x)||0),+((null===(n=this.attributes)||void 0===n?void 0:n.y)||0)];return tH(t,o,s,!0,i).point}constructor(t){super(t)}}var eV=n(26912),eK=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};class eG extends eZ{parseOuterR(){let{size:t}=this.parsedAttributes;return Math.min(...el(t))/2}parseInnerR(){let{innerR:t}=this.parsedAttributes;return(0,tQ.Z)(t)?parseInt(t)/100*this.parseOuterR():t}drawDonutShape(t,e){let{donuts:n}=t;if(!(null==n?void 0:n.length))return;let i=n.map(t=>(0,eV.Z)(t)?{value:t}:t),s=eo(this.getGraphicStyle(t),"donut"),o=ey(t.donutPalette);if(!o)return;let r=i.reduce((t,e)=>{var n;return t+(null!==(n=e.value)&&void 0!==n?n:0)},0),a=this.parseOuterR(),l=this.parseInnerR(),h=0;i.forEach((t,n)=>{let{value:d=0,color:c=o[n%o.length]}=t,u=eK(t,["value","color"]),p=(0===r?1/i.length:d/r)*360;this.upsert("round".concat(n),A.y$,Object.assign(Object.assign(Object.assign({},s),{d:eX(a,l,h,h+p),fill:c}),u),e),h+=p})}render(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;super.render(t,e),this.drawDonutShape(t,e)}constructor(t){super(ec({style:eG.defaultStyleProps},t))}}eG.defaultStyleProps={innerR:"50%",donuts:[],donutPalette:"tableau"};let eU=(t,e,n,i)=>[t+Math.sin(i)*n,e-Math.cos(i)*n],eH=(t,e,n,i)=>i<=0||n<=i?[["M",t-n,e],["A",n,n,0,1,1,t+n,e],["A",n,n,0,1,1,t-n,e],["Z"]]:[["M",t-n,e],["A",n,n,0,1,1,t+n,e],["A",n,n,0,1,1,t-n,e],["Z"],["M",t+i,e],["A",i,i,0,1,0,t-i,e],["A",i,i,0,1,0,t+i,e],["Z"]],eY=(t,e,n,i,s,o)=>{let[r,a]=[s/360*2*Math.PI,o/360*2*Math.PI],l=[eU(t,e,i,r),eU(t,e,n,r),eU(t,e,n,a),eU(t,e,i,a)],h=a-r>Math.PI?1:0;return[["M",l[0][0],l[0][1]],["L",l[1][0],l[1][1]],["A",n,n,0,h,1,l[2][0],l[2][1]],["L",l[3][0],l[3][1]],["A",i,i,0,h,0,l[0][0],l[0][1]],["Z"]]},eX=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,[s,o]=[0,0];return Math.abs(n-i)%360<1e-6?eH(s,o,t,e):eY(s,o,t,e,n,i)};class e$ extends ez{drawKeyShape(t,e){return this.upsert("key",A.Pj,this.getKeyStyle(t),e)}getKeyStyle(t){let e=super.getKeyStyle(t),[n,i]=this.getSize(t);return Object.assign(Object.assign({},e),{rx:n/2,ry:i/2})}getIconStyle(t){let e=super.getIconStyle(t),{rx:n,ry:i}=this.getShape("key").attributes,s=2*Math.min(+n,+i)*.8;return!!e&&Object.assign({width:s,height:s},e)}getIntersectPoint(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getShape("key").getBounds();return tY(t,n,e)}constructor(t){super(ec({style:e$.defaultStyleProps},t))}}e$.defaultStyleProps={size:[45,35]};var eq=n(57796),eQ=n(88458),eJ=n(36179),e0=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};class e1 extends ez{get eventService(){return this.context.canvas.context.eventService}get events(){return[b.CLICK,b.POINTER_DOWN,b.POINTER_MOVE,b.POINTER_UP,b.POINTER_OVER,b.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}getKeyStyle(t){let e=(0,eQ.Z)(t,["dx","dy","innerHTML","pointerEvents","cursor"]),{dx:n=0,dy:i=0}=e,s=e0(e,["dx","dy"]),[o,r]=this.getSize(t);return Object.assign(Object.assign({x:n,y:i},s),{width:o,height:r})}drawKeyShape(t,e){let n=this.getKeyStyle(t),{x:i,y:s,width:o=0,height:r=0}=n,a=this.upsert("key-container",A.UL,{x:i,y:s,width:o,height:r,opacity:0},e);return this.upsert("key",A.k9,n,a)}connectedCallback(){let t=this.context.canvas.getRenderer("main"),e=t instanceof eq.Th;if(!e)return;let n=this.getDomElement();this.events.forEach(t=>{n.addEventListener(t,this.forwardEvents)})}attributeChangedCallback(t,e,n){"zIndex"===t&&e!==n&&(this.getDomElement().style.zIndex=n)}destroy(){let t=this.getDomElement();this.events.forEach(e=>{t.removeEventListener(e,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(t,e){let n=[];if(e.isTouchEvent(t))for(let e=0;e<t.changedTouches.length;e++){let i=t.changedTouches[e];(0,eJ.Z)(i.button)&&(i.button=0),(0,eJ.Z)(i.buttons)&&(i.buttons=1),(0,eJ.Z)(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,eJ.Z)(i.width)&&(i.width=i.radiusX||1),(0,eJ.Z)(i.height)&&(i.height=i.radiusY||1),(0,eJ.Z)(i.tiltX)&&(i.tiltX=0),(0,eJ.Z)(i.tiltY)&&(i.tiltY=0),(0,eJ.Z)(i.pointerType)&&(i.pointerType="touch"),(0,eJ.Z)(i.pointerId)&&(i.pointerId=i.identifier||0),(0,eJ.Z)(i.pressure)&&(i.pressure=i.force||.5),(0,eJ.Z)(i.twist)&&(i.twist=0),(0,eJ.Z)(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i)}else e.isMouseEvent(t)&&((0,eJ.Z)(t.isPrimary)&&(t.isPrimary=!0),(0,eJ.Z)(t.width)&&(t.width=1),(0,eJ.Z)(t.height)&&(t.height=1),(0,eJ.Z)(t.tiltX)&&(t.tiltX=0),(0,eJ.Z)(t.tiltY)&&(t.tiltY=0),(0,eJ.Z)(t.pointerType)&&(t.pointerType="mouse"),(0,eJ.Z)(t.pointerId)&&(t.pointerId=1),(0,eJ.Z)(t.pressure)&&(t.pressure=.5),(0,eJ.Z)(t.twist)&&(t.twist=0),(0,eJ.Z)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),n.push(t);return n}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}bootstrapEvent(t,e,n,i){t.view=n,t.originalEvent=null,t.nativeEvent=i,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);let{x:s,y:o}=this.getViewportXY(e);t.viewport.x=s,t.viewport.y=o;let[r,a]=this.context.canvas.getCanvasByViewport([s,o]);return t.canvas.x=r,t.canvas.y=a,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=i.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t}getViewportXY(t){let e,n;let{offsetX:i,offsetY:s,clientX:o,clientY:r}=t;if(!this.context.canvas.context.config.supportsCSSTransform||(0,T.Z)(i)||(0,T.Z)(s)){let t=this.eventService.client2Viewport({x:o,y:r});e=t.x,n=t.y}else e=i,n=s;return{x:e,y:n}}onframe(){super.onframe();let{opacity:t}=this.attributes;this.getDomElement().style.opacity="".concat(t)}constructor(t){super(Object.assign(Object.assign({},t),{style:Object.assign({},e1.defaultStyleProps,t.style)})),this.rootPointerEvent=new A.nR(null),this.forwardEvents=t=>{let e=this.context.canvas,n=e.context.renderingContext.root.ownerDocument.defaultView,i=this.normalizeToPointerEvent(t,n);i.forEach(i=>{let s=this.bootstrapEvent(this.rootPointerEvent,i,n,t);(0,en.Z)(e.context.eventService,"mappingTable.pointerupoutside",[]),e.context.eventService.mapEvent(s)})}}}e1.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"};var e3=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};class e6 extends ez{getKeyStyle(t){let[e,n]=this.getSize(t),i=super.getKeyStyle(t),{fillOpacity:s,opacity:o=s}=i,r=e3(i,["fillOpacity","opacity"]);return Object.assign(Object.assign({opacity:o},r),{width:e,height:n,x:-e/2,y:-n/2})}getHaloStyle(t){if(!1===t.halo)return!1;let e=this.getShape("key").attributes,{fill:n,stroke:i}=e;e3(e,["fill","stroke"]);let s=eo(this.getGraphicStyle(t),"halo"),o=Number(s.lineWidth),[r,a]=tS(this.getSize(t),[o,o]);return Object.assign(Object.assign({},s),{width:r,height:a,fill:"transparent",x:-r/2,y:-a/2})}getIconStyle(t){let e=super.getIconStyle(t),[n,i]=this.getSize(t);return!!e&&Object.assign({width:.8*n,height:.8*i},e)}drawKeyShape(t,e){let n=this.upsert("key",ek,this.getKeyStyle(t),e);return ej(this),n}drawHaloShape(t,e){this.upsert("halo",A.UL,this.getHaloStyle(t),e)}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&eI(this)}constructor(t){super(ec({style:e6.defaultStyleProps},t))}}e6.defaultStyleProps={size:32};class e2 extends eW{getPoints(t){let{direction:e}=t,[n,i]=this.getSize(t);return function(t,e,n){let i=e/2,s=t/2,o={up:[[-s,i],[s,i],[0,-i]],left:[[-s,0],[s,i],[s,-i]],right:[[-s,i],[-s,-i],[s,0]],down:[[-s,-i],[s,-i],[0,i]]};return o[n]||o.up}(n,i,e)}getPortXY(t,e){let{direction:n}=t,{placement:i="top"}=e,s=this.getShape("key").getLocalBounds(),[o,r]=this.getSize(t),a=function(t,e,n){let i=e/2,s=t/2,o={};return"down"===n?(o.bottom=o.default=[0,i],o.right=[s,-i],o.left=[-s,-i]):"left"===n?(o.top=[s,-i],o.bottom=[s,i],o.left=o.default=[-s,0]):"right"===n?(o.top=[-s,-i],o.bottom=[-s,i],o.right=o.default=[s,0]):(o.left=[-s,i],o.top=o.default=[0,-i],o.right=[s,i]),o}(o,r,n);return nY(s,i,a,!1)}getIconStyle(t){let{icon:e,iconText:n,iconSrc:i,direction:s}=t;if(!1===e||(0,eO.Z)(n||i))return!1;let o=eo(this.getGraphicStyle(t),"icon"),r=this.getShape("key").getLocalBounds(),[a,l]=function(t,e){let{center:n}=t,[i,s]=tu(t),o="up"===e||"down"===e?n[0]:"right"===e?n[0]-i/6:n[0]+i/6,r="left"===e||"right"===e?n[1]:"down"===e?n[1]-s/6:n[1]+s/6;return[o,r]}(r,s),h=2*function(t,e){let[n,i]=tu(t);return[n,i]="up"===e||"down"===e?[n,i]:[i,n],(Math.pow(i,2)-Math.pow(Math.sqrt(Math.pow(n/2,2)+Math.pow(i,2))-n/2,2))/(2*i)}(r,s)*.8;return Object.assign({x:a,y:l,width:h,height:h},o)}constructor(t){super(ec({style:e2.defaultStyleProps},t))}}e2.defaultStyleProps={size:40,direction:"up"};var e4=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};class e8 extends ez{getKeySize(t){let{collapsed:e,childrenNode:n=[]}=t;return 0===n.length?this.getEmptyKeySize(t):e?this.getCollapsedKeySize(t):this.getExpandedKeySize(t)}getEmptyKeySize(t){let{padding:e,collapsedSize:n}=t,[i,s,o,r]=th(e);return tS(el(n),[r+s,i+o,0])}getCollapsedKeySize(t){return el(t.collapsedSize)}getExpandedKeySize(t){let e=this.getContentBBox(t);return[td(e),tc(e),0]}getContentBBox(t){let{context:e,childrenNode:n=[],padding:i}=t,s=n.map(t=>e.element.getElement(t)).filter(Boolean);if(0===s.length){let e=new A.mN,{x:n=0,y:i=0,size:s}=t,[o,r]=el(s);return e.setMinMax([n-o/2,i-r/2,0],[n+o/2,i+r/2,0]),e}let o=tm(s.map(t=>t.getBounds()));return i?tf(o,i):o}drawCollapsedMarkerShape(t,e){let n=this.getCollapsedMarkerStyle(t);ep(this,"collapsedMarker",n)&&(this.upsert("collapsed-marker",eB,n,e),ej(this))}getCollapsedMarkerStyle(t){if(!t.collapsed||!t.collapsedMarker)return!1;let e=eo(this.getGraphicStyle(t),"collapsedMarker"),{type:n}=e,i=e4(e,["type"]),s=this.getShape("key"),[o,r]=tZ(s.getLocalBounds(),"center"),a=Object.assign(Object.assign({},i),{x:o,y:r});if(n){let e=this.getCollapsedMarkerText(n,t);Object.assign(a,{text:e})}return a}getCollapsedMarkerText(t,e){let{context:n,childrenData:i=[]}=e,{model:s}=n;return"descendant-count"===t?s.getDescendantsData(this.id).length.toString():"child-count"===t?i.length.toString():"node-count"===t?s.getDescendantsData(this.id).filter(t=>"node"===s.getElementType(U(t))).length.toString():(0,to.Z)(t)?t(i):""}getComboZIndex(t){let e=this.context.model.getAncestorsData(this.id,N)||[];return e.length}getComboPosition(t){let{x:e=0,y:n=0,collapsed:i,context:s,childrenData:o=[]}=t;if(0===o.length)return[+e,+n,0];if(i){let{model:t}=s,i=t.getDescendantsData(this.id).filter(e=>!t.isCombo(U(e)));if(i.length>0&&i.some(tz)){let t=i.reduce((t,e)=>tS(t,tF(e)),[0,0,0]);return tC(t,i.length)}return[+e,+n,0]}return this.getContentBBox(t).center}getComboStyle(t){let{zIndex:e=this.getComboZIndex(t)}=t,[n,i]=this.getComboPosition(t);return{x:n,y:i,transform:"translate(".concat(n,", ").concat(i,")"),zIndex:e}}updateComboPosition(t){let e=this.getComboStyle(t);Object.assign(this.style,e);let{x:n,y:i}=e;this.context.model.syncComboDatum({id:this.id,style:{x:n,y:i}}),eI(this)}render(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;super.render(t,e),this.drawCollapsedMarkerShape(t,e)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super.update(t),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(t,e){let n=super.animate(this.attributes.collapsed?t:t.map(t=>{var{x:e,y:n,z:i,transform:s}=t;return e4(t,["x","y","z","transform"])}),e);return n?new Proxy(n,{set:(t,e,n)=>("currentTime"===e&&Promise.resolve().then(()=>this.onframe()),Reflect.set(t,e,n))}):n}constructor(t){super(ec({style:e8.defaultStyleProps},t)),this.type="combo",this.updateComboPosition(this.parsedAttributes)}}e8.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"};var e9=n(82425);let e5={padding:10};function e7(t,e,n,i,s,o){let{padding:r}=Object.assign(e5,o),a=tp(n,r),l=tp(i,r),h=[t,...s,e],d=null,c=[];for(let t=0,e=h.length;t<e-1;t++){var u,p;let n=t+1,i=h[t],s=h[n],o=(u=i,p=s,u[1]===p[1]||u[0]===p[0]),g=null;if(0===t){if(n===e-1){if(a.intersects(l))g=na(i,s,a,l);else if(tb(i,a)||tb(s,l))o||(g=function(t,e,n,i){let s=no(t,e,n),o=tN(s.points[0]);if(ty(o,i)){s=no(e,t,i);let r=tN(s.points[0]);if(ty(r,n)){let a=tG(t,o,ni(n,nn(t,o))/2),l=tG(e,r,ni(i,nn(e,r))/2),h=[(a[0]+l[0])/2,(a[1]+l[1])/2],d=no(t,h,n),c=nr(h,e,i,d.direction);s.points=[d.points[0],c.points[0]],s.direction=c.direction}}return s}(i,s,a,l));else{let t=tx(i,a),e=tx(s,l);(g=ns(t,e,nn(t,e))).points.unshift(t),g.points.push(e)}}else ty(s,a)?g=na(i,s,a,tp(s,r),d):o||(g=no(i,s,a))}else n===e-1?ty(i,l)?g=na(i,s,tp(i,r),l,d):o||(g=nr(i,s,l,d)):o||(g=ns(i,s,d));g?(c.push(...g.points),d=g.direction):d=nn(i,s),n<e-1&&c.push(s)}return c.map(tL)}let nt={N:"S",S:"N",W:"E",E:"W"},ne={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function nn(t,e){let[n,i]=t,[s,o]=e;return n===s?i>o?"N":"S":i===o?n>s?"W":"E":null}function ni(t,e){return"N"===e||"S"===e?tc(t):td(t)}function ns(t,e,n){let i=[t[0],e[1]],s=[e[0],t[1]],o=nn(t,i),r=nn(t,s),a=n?nt[n]:null,l=o===n||o!==a&&r!==n?i:s;return{points:[l],direction:nn(l,e)}}function no(t,e,n){if(tb(t,n)){let i=nl(t,e,n);return{points:[i],direction:nn(i,e)}}{let i=tx(t,n),s=["left","right"].includes(tE(t,n)),o=s?[e[0],i[1]]:[i[0],e[1]];return{points:[o],direction:nn(o,e)}}}function nr(t,e,n,i){let s=tb(e,n)?e:tx(e,n),o=[[s[0],t[1]],[t[0],s[1]]],r=o.filter(t=>!ty(t,n)&&!tv(t,n,!0)),a=r.filter(e=>nn(e,t)!==i);if(a.length>0){let n=a.find(e=>nn(t,e)===i)||a[0];return{points:[n],direction:nn(n,e)}}{let s=(0,e9.Z)(o,r)[0],a=tG(e,s,ni(n,i)/2),l=nl(a,t,n);return{points:[l,a],direction:nn(a,e)}}}function na(t,e,n,i,s){let o;let r=tm([n,i]),a=tM(e,r.center)>tM(t,r.center),[l,h]=a?[e,t]:[t,e],d=tc(r)+td(r);if(s){let t=[l[0]+d*Math.cos(ne[s]),l[1]+d*Math.sin(ne[s])];o=tG(tx(t,r),t,.01)}else o=tG(tx(l,r),l,-.01);let c=nl(o,h,r),u=[tK(o,2),tK(c,2)];if((0,R.Z)(tK(o),tK(c))){let t=tP(tw(o,l),[1,0,0])+Math.PI/2;c=tK(tG(tx(c=[h[0]+d*Math.cos(t),h[1]+d*Math.sin(t),0],r),h,-.01),2);let e=nl(o,c,r);u=[o,e,c]}return{points:a?u.reverse():u,direction:a?nn(o,e):nn(c,e)}}function nl(t,e,n){let i=[t[0],e[1]];return ty(i,n)&&(i=[e[0],t[1]]),i}function nh(t,e,n,i,s){let o="number"==typeof e?e:.5;"start"===e&&(o=0),"end"===e&&(o=.99);let r=tW(t.getPoint(o)),a=tW(t.getPoint(o+.01)),l="start"===e?"left":"end"===e?"right":"center";if(r[1]===a[1]||!n){let[e,n]=nd(t,o,i,s);return{transform:"translate(".concat(e,", ").concat(n,")"),textAlign:l}}let h=Math.atan2(a[1]-r[1],a[0]-r[0]),d=a[0]<r[0];d&&(l="center"===l?l:"left"===l?"right":"left",i*=-1,h+=Math.PI);let[c,u]=nd(t,o,i,s,h),p="translate(".concat(c,", ").concat(u,") rotate(").concat(h/Math.PI*180,"deg)");return{textAlign:l,transform:p}}function nd(t,e,n,i,s){let[o,r]=tW(t.getPoint(e)),a=n,l=i;return s&&(a=n*Math.cos(s)-i*Math.sin(s),l=n*Math.sin(s)+i*Math.cos(s)),[o+a,r+l]}function nc(t,e,n,i){if((0,R.Z)(t,e))return t;let s=tw(e,t),o=[t[0]+n*s[0],t[1]+n*s[1]],r=tR(tk(s,!1));return o[0]+=i*r[0],o[1]+=i*r[1],o}function nu(t,e,n){return[["M",t[0],t[1]],["C",n[0][0],n[0][1],n[1][0],n[1][1],e[0],e[1]]]}function np(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t[0],s=t[t.length-1],o=t.slice(1,t.length-1),r=[["M",i[0],i[1]]];return o.forEach((t,n)=>{let a=o[n-1]||i,l=o[n+1]||s;if(!tI([a,t],[t,l])&&e){let[n,i]=function(t,e,n,i){let s=tT(t,e),o=tT(n,e),r=Math.min(i,Math.min(s,o)/2),a=[e[0]-r/s*(e[0]-t[0]),e[1]-r/s*(e[1]-t[1])],l=[e[0]-r/o*(e[0]-n[0]),e[1]-r/o*(e[1]-n[1])];return[a,l]}(a,t,l,e);r.push(["L",n[0],n[1]],["Q",t[0],t[1],i[0],i[1]],["L",i[0],i[1]])}else r.push(["L",t[0],t[1]])}),r.push(["L",s[0],s[1]]),n&&r.push(["Z"]),r}let ng=t=>{let e=Math.PI/2,n=tc(t)/2,i=td(t)/2,s=Math.atan2(n,i)/2,o=Math.atan2(i,n)/2;return{top:[-e-o,-e+o],"top-right":[-e+o,-s],"right-top":[-e+o,-s],right:[-s,s],"bottom-right":[s,e-o],"right-bottom":[s,e-o],bottom:[e-o,e+o],"bottom-left":[e+o,Math.PI-s],"left-bottom":[e+o,Math.PI-s],left:[Math.PI-s,Math.PI+s],"top-left":[Math.PI+s,-e-o],"left-top":[Math.PI+s,-e-o]}};function nf(t,e,n,i,s){let o=tp(t),r=t.getCenter(),a=i&&nq(i),l=s&&nq(s);if(!a||!l){let i=ng(o),s=i[e][0],h=i[e][1],[d,c]=tu(o),u=Math.max(d,c),p=tS(r,[u*Math.cos(s),u*Math.sin(s),0]),g=tS(r,[u*Math.cos(h),u*Math.sin(h),0]);a=n1(t,p),l=n1(t,g),n||([a,l]=[l,a])}return[a,l]}function nm(t,e){let n=new Set,i=new Set,s=new Set;return t.forEach(o=>{let r=e(o);r.forEach(e=>{n.add(e),t.includes(e.source)&&t.includes(e.target)?i.add(e):s.add(e)})}),{edges:Array.from(n),internal:Array.from(i),external:Array.from(s)}}function ny(t,e){let n=[],i=t;for(;i;){n.push(i);let t=e(U(i));if(t)i=t;else break}if(n.some(t=>{var e;return null===(e=t.style)||void 0===e?void 0:e.collapsed})){let t=n.reverse().findIndex(et);return n[t]||n.at(-1)}return t}let nv=(t,e)=>{let n=Math.max(t,e)/2;return[["M",-t/2,0],["A",n,n,0,1,0,2*n-t/2,0],["A",n,n,0,1,0,-t/2,0],["Z"]]},nb=(t,e)=>[["M",-t/2,0],["L",t/2,-e/2],["L",t/2,e/2],["Z"]],nE=(t,e)=>[["M",-t/2,0],["L",0,-e/2],["L",t/2,0],["L",0,e/2],["Z"]],nx=(t,e)=>[["M",-t/2,0],["L",t/2,-e/2],["L",4*t/5-t/2,0],["L",t/2,e/2],["Z"]],nO=(t,e)=>[["M",-t/2,-e/2],["L",t/2,-e/2],["L",t/2,e/2],["L",-t/2,e/2],["Z"]],nS=(t,e)=>{let n=t/2,i=t/7,s=t-i;return[["M",-n,0],["L",0,-e/2],["L",0,e/2],["Z"],["M",s-n,-e/2],["L",s+i-n,-e/2],["L",s+i-n,e/2],["L",s-n,e/2],["Z"]]},nw=(t,e)=>[["M",t/2,-e/2],["L",-t/2,0],["L",t/2,0],["L",-t/2,0],["L",t/2,e/2]];var nD=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};class nC extends e_{get sourceNode(){let{context:t,sourceNode:e}=this.parsedAttributes;return t.element.getElement(e)}get targetNode(){let{context:t,targetNode:e}=this.parsedAttributes;return t.element.getElement(e)}getKeyStyle(t){let e=this.getGraphicStyle(t),{loop:n}=e,i=nD(e,["loop"]),{sourceNode:s,targetNode:o}=this,r=n&&s&&o&&s===o?this.getLoopPath(t):this.getKeyPath(t);return Object.assign({d:r},ea(i,["halo","label","startArrow","endArrow"]))}getLoopPath(t){let{sourcePort:e,targetPort:n}=t,i=this.sourceNode,s=tp(i),o=Math.max(td(s),tc(s)),{placement:r,clockwise:a,dist:l=o}=eo(this.getGraphicStyle(t),"loop");return function(t,e,n,i,s,o){let r=t.getPorts()[s||o],a=t.getPorts()[o||s],[l,h]=nf(t,e,n,r,a),d=function(t,e,n,i){let s=t.getCenter();if((0,R.Z)(e,n)){let t=tw(e,s),o=[i*Math.sign(t[0])||i/2,i*Math.sign(t[1])||-i/2,0];return[tS(e,o),tS(n,tD(o,[1,-1,1]))]}return[tG(s,e,tM(s,e)+i),tG(s,n,tM(s,n)+i)]}(t,l,h,i);return r&&(l=n0(r,d[0])),a&&(h=n0(a,d[d.length-1])),nu(l,h,d)}(i,r,a,l,e,n)}getEndpoints(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],{sourcePort:i,targetPort:s}=t,{sourceNode:o,targetNode:r}=this,[a,l]=function(t,e,n,i){let s=nQ(t,e,n,i),o=nQ(e,t,i,n);return[s,o]}(o,r,i,s);if(!e){let t=a?nq(a):o.getCenter(),e=l?nq(l):r.getCenter();return[t,e]}let h="function"==typeof n?n():n,d=nJ(a||o,h[0]||l||r),c=nJ(l||r,h[h.length-1]||a||o);return[d,c]}getHaloStyle(t){if(!1===t.halo)return!1;let e=this.getKeyStyle(t),n=eo(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign({},e),n)}getLabelStyle(t){if(!1===t.label||!t.labelText)return!1;let e=eo(this.getGraphicStyle(t),"label"),{placement:n,offsetX:i,offsetY:s,autoRotate:o,maxWidth:r}=e,a=nD(e,["placement","offsetX","offsetY","autoRotate","maxWidth"]),l=nh(this.shapeMap.key,n,o,i,s),h=this.shapeMap.key.getLocalBounds(),d=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=tM(t[0],t[1])*n;return ev(i,e)}([h.min,h.max],r);return Object.assign({wordWrapWidth:d},l,a)}getBadgeStyle(t){if(!1===t.badge||!t.badgeText)return!1;let e=eo(t,"badge"),{offsetX:n,offsetY:i,placement:s}=e,o=nD(e,["offsetX","offsetY","placement"]);return Object.assign(o,function(t,e,n,i,s){var o,r;let a=(null===(o=t.badge)||void 0===o?void 0:o.getGeometryBounds().halfExtents[0])*2||0,l=(null===(r=t.label)||void 0===r?void 0:r.getGeometryBounds().halfExtents[0])*2||0;return nh(t.key,n,!0,(l?(l/2+a/2)*("suffix"===e?1:-1):0)+i,s)}(this.shapeMap,s,t.labelPlacement,n,i))}drawArrow(t,e){var n;let i="start"===e,s=t["start"===e?"startArrow":"endArrow"],o=this.shapeMap.key;if(s){let n=this.getArrowStyle(t,i);if(!ep(this,"arrow-".concat(e),n))return;let[s,r,a]=i?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],l=o.parsedStyle[s];if(l)l.attr(n);else{let t=n.src?A.Ee:A.y$,e=new t({style:n});o.style[s]=e}o.style[r]=t[a]||n.width/2+ +n.lineWidth}else{let t=i?"markerStart":"markerEnd";null===(n=o.style[t])||void 0===n||n.destroy(),o.style[t]=null}}getArrowStyle(t,e){var n;let i=this.getShape("key").attributes,s=eo(this.getGraphicStyle(t),e?"startArrow":"endArrow"),{size:o,type:r}=s,a=nD(s,["size","type"]),[l,h]=el((n=i.lineWidth,o||(n<4?10:4===n?12:2.5*n))),d=(0,to.Z)(r)?r:C[r]||nb,c=d(l,h);return Object.assign((0,eQ.Z)(i,["stroke","strokeOpacity","fillOpacity"]),{width:l,height:h},Object.assign({},c&&{d:c,fill:"simple"===r?"":i.stroke}),a)}drawLabelShape(t,e){let n=this.getLabelStyle(t);ep(this,"label",n)&&this.upsert("label",eC,n,e)}drawHaloShape(t,e){let n=this.getHaloStyle(t);ep(this,"halo",n)&&this.upsert("halo",A.y$,n,e)}drawBadgeShape(t,e){let n=this.getBadgeStyle(t);ep(this,"badge",n)&&this.upsert("badge",eA,n,e)}drawSourceArrow(t){this.drawArrow(t,"start")}drawTargetArrow(t){this.drawArrow(t,"end")}drawKeyShape(t,e){let n=this.getKeyStyle(t);if(ep(this,"key",n))return this.upsert("key",A.y$,n,e)}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parsedAttributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.drawKeyShape(t,e),this.getShape("key")&&(this.drawSourceArrow(t),this.drawTargetArrow(t),this.drawLabelShape(t,e),this.drawHaloShape(t,e),this.drawBadgeShape(t,e))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(t,e){let n=super.animate(t,e);return n?new Proxy(n,{set:(t,e,n)=>("currentTime"===e&&Promise.resolve().then(()=>this.onframe()),Reflect.set(t,e,n))}):n}constructor(t){super(ec({style:nC.defaultStyleProps},t)),this.type="edge"}}nC.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0};class nA extends nC{getKeyPath(t){let[e,n]=this.getEndpoints(t),{controlPoints:i,curvePosition:s,curveOffset:o}=t,r=this.getControlPoints(e,n,(0,eV.Z)(s)?[s,1-s]:s,(0,eV.Z)(o)?[o,-o]:o,i);return nu(e,n,r)}getControlPoints(t,e,n,i,s){return(null==s?void 0:s.length)===2?s:[nc(t,e,n[0],i[0]),nc(t,e,n[1],i[1])]}constructor(t){super(ec({style:nA.defaultStyleProps},t))}}nA.defaultStyleProps={curvePosition:.5,curveOffset:20};class nM extends nA{getControlPoints(t,e,n,i){let s=e[0]-t[0];return[[t[0]+s*n[0]+i[0],t[1]],[e[0]-s*n[1]+i[1],e[1]]]}constructor(t){super(ec({style:nM.defaultStyleProps},t))}}nM.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class nT extends nA{get ref(){return this.context.model.getRootsData()[0]}getEndpoints(t){if(this.sourceNode.id===this.ref.id)return super.getEndpoints(t);let e=tF(this.ref),n=this.sourceNode.getIntersectPoint(e,!0),i=this.targetNode.getIntersectPoint(e);return[n,i]}toRadialCoordinate(t){let e=tF(this.ref),n=tM(t,e),i=tj(tw(t,e));return[n,i]}getControlPoints(t,e,n,i){let[s,o]=this.toRadialCoordinate(t),[r]=this.toRadialCoordinate(e),a=r-s;return[[t[0]+(a*n[0]+i[0])*Math.cos(o),t[1]+(a*n[0]+i[0])*Math.sin(o)],[e[0]-(a*n[1]-i[0])*Math.cos(o),e[1]-(a*n[1]-i[0])*Math.sin(o)]]}constructor(t){super(ec({style:nT.defaultStyleProps},t))}}nT.defaultStyleProps={curvePosition:.5,curveOffset:20};class nR extends nA{getControlPoints(t,e,n,i){let s=e[1]-t[1];return[[t[0],t[1]+s*n[0]+i[0]],[e[0],e[1]-s*n[1]+i[1]]]}constructor(t){super(ec({style:nR.defaultStyleProps},t))}}nR.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class nP extends nC{getKeyPath(t){let[e,n]=this.getEndpoints(t);return[["M",e[0],e[1]],["L",n[0],n[1]]]}constructor(t){super(ec({style:nP.defaultStyleProps},t))}}nP.defaultStyleProps={};let nk={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:tT},nL=t=>"".concat(Math.round(t[0]),"|||").concat(Math.round(t[1]));function nN(t,e){let n=t=>Math.round(t/e);return(0,eV.Z)(t)?n(t):t.map(n)}function nj(t,e){let n=e[0]-t[0],i=e[1]-t[1];return n||i?Math.atan2(i,n):0}function nI(t,e,n,i){let s=nj(t,e),o=n[nL(t)],r=nj(o||i,t);return function(t,e){let n=Math.abs(t-e);return n>Math.PI?2*Math.PI-n:n}(r,s)}let nB=(t,e)=>{let{offset:n,gridSize:i}=e,s={};return t.forEach(t=>{if(!t||t.destroyed||!t.isVisible())return;let e=tf(t.getRenderBounds(),n);for(let t=nN(e.min[0],i);t<=nN(e.max[0],i);t+=1)for(let n=nN(e.min[1],i);n<=nN(e.max[1],i);n+=1)s["".concat(t,"|||").concat(n)]=!0}),s};function n_(t,e,n){return Math.min(...e.map(e=>n(t,e)))}let nF=(t,e,n,i)=>{if(!e)return[t];let{directionMap:s,offset:o}=i,r=tf(e.getRenderBounds(),o),a=Object.keys(s).reduce((e,i)=>{if(n.includes(i)){let n=s[i],[o,a]=tu(r),l=[t[0]+n.stepX*o,t[1]+n.stepY*a],h=function(t){let{min:[e,n],max:[i,s]}=t,o=[e,s],r=[i,s],a=[i,n],l=[e,n];return[[o,r],[r,a],[a,l],[l,o]]}(r);for(let n=0;n<h.length;n++){let i=tB([t,l],h[n]);i&&tv(i,r)&&e.push(i)}}return e},[]);return ty(t,r)||a.push(t),a.map(t=>nN(t,i.gridSize))},nz=(t,e,n,i,s,o,r)=>{let a=[],l=[o[0]===i[0]?i[0]:t[0]*r,o[1]===i[1]?i[1]:t[1]*r];a.unshift(l);let h=t,d=e[nL(h)];for(;d;){let t=d,i=h,s=nI(t,i,e,n);s&&(l=[t[0]===i[0]?l[0]:t[0]*r,t[1]===i[1]?l[1]:t[1]*r],a.unshift(l)),d=e[nL(t)],h=t}let c=s.map(t=>[t[0]*r,t[1]*r]),u=function(t,e,n){let i=t[0],s=n(t[0],e);for(let o=0;o<t.length;o++){let r=t[o],a=n(r,e);a<s&&(i=r,s=a)}return i}(c,l,tT);return a.unshift(u),a};class nZ{_innerAdd(t,e){let n=0,i=e-1;for(;i-n>1;){let e=Math.floor((n+i)/2);if(this.arr[e].value>t.value)i=e;else if(this.arr[e].value<t.value)n=e;else{this.arr.splice(e,0,t),this.map[t.id]=!0;return}}this.arr.splice(i,0,t),this.map[t.id]=!0}add(t){delete this.map[t.id];let e=this.arr.length;if(!e||this.arr[e-1].value<t.value){this.arr.push(t),this.map[t.id]=!0;return}this._innerAdd(t,e)}remove(t){this.map[t]&&delete this.map[t]}_clearAndGetMinId(){let t;for(let e=this.arr.length-1;e>=0;e--)this.map[this.arr[e].id]?t=this.arr[e].id:this.arr.splice(e,1);return t}_findFirstId(){for(;this.arr.length;){let t=this.arr.shift();if(this.map[t.id])return t.id}}minId(t){return t?this._clearAndGetMinId():this._findFirstId()}constructor(){this.arr=[],this.map={},this.arr=[],this.map={}}}class nW extends nC{getControlPoints(t){let{router:e}=t,{sourceNode:n,targetNode:i}=this,[s,o]=this.getEndpoints(t,!1),r=[];if(e){if("shortest-path"===e.type){let a=this.context.element.getNodes();(r=function(t,e,n,i){let s;let o=tL(t.getCenter()),r=tL(e.getCenter()),a=Object.assign(nk,i),{gridSize:l}=a,h=a.enableObstacleAvoidance?n:[t,e],d=nB(h,a),c=nN(o,l),u=nN(r,l),p=nF(o,t,a.startDirections,a),g=nF(r,e,a.endDirections,a);p.forEach(t=>delete d[nL(t)]),g.forEach(t=>delete d[nL(t)]);let f={},m={},y={},v={},b={},E=new nZ;for(let t=0;t<p.length;t++){let e=p[t],n=nL(e);f[n]=e,v[n]=0,b[n]=n_(e,g,a.distFunc),E.add({id:n,value:b[n]})}let x=g.map(t=>nL(t)),O=a.maximumLoops,S=1/0;for(let[t,e]of Object.entries(f))b[t]<=S&&(S=b[t],s=e);for(;Object.keys(f).length>0&&O>0;){let t=E.minId(!1);if(t)s=f[t];else break;let e=nL(s);if(x.includes(e))return nz(s,y,c,r,p,u,l);for(let t of(delete f[e],E.remove(e),m[e]=!0,Object.values(a.directionMap))){let n=tS(s,[t.stepX,t.stepY]),i=nL(n);if(m[i])continue;let o=nI(s,n,y,c);if(o>a.maxAllowedDirectionChange||d[i])continue;f[i]||(f[i]=n);let r=a.penalties[o],h=a.distFunc(s,n)+(isNaN(r)?l:r),u=v[e]+h,p=v[i];p&&u>=p||(y[i]=s,v[i]=u,b[i]=u+n_(n,g,a.distFunc),E.add({id:i,value:b[i]}))}O-=1}return[]}(n,i,a,e)).length||(r=e7(s,o,n,i,t.controlPoints,{padding:e.offset}))}else"orth"===e.type&&(r=e7(s,o,n,i,t.controlPoints,e))}else r=t.controlPoints;return r}getPoints(t){let e=this.getControlPoints(t),[n,i]=this.getEndpoints(t,!0,e);return[n,...e,i]}getKeyPath(t){let e=this.getPoints(t);return np(e,t.radius)}getLoopPath(t){let{sourcePort:e,targetPort:n,radius:i}=t,s=this.sourceNode,o=tp(s),r=Math.max(td(o),tc(o))/4,{placement:a,clockwise:l,dist:h=r}=eo(this.getGraphicStyle(t),"loop");return function(t,e,n,i,s,o,r){let a=nX(t),l=a[o||r],h=a[r||o],[d,c]=nf(t,n,i,l,h),u=function(t,e,n,i){let s=[],o=tp(t);if((0,R.Z)(e,n)){let t=tE(e,o);switch(t){case"left":s.push([e[0]-i,e[1]]),s.push([e[0]-i,e[1]+i]),s.push([e[0],e[1]+i]);break;case"right":s.push([e[0]+i,e[1]]),s.push([e[0]+i,e[1]+i]),s.push([e[0],e[1]+i]);break;case"top":s.push([e[0],e[1]-i]),s.push([e[0]+i,e[1]-i]),s.push([e[0]+i,e[1]]);break;case"bottom":s.push([e[0],e[1]+i]),s.push([e[0]+i,e[1]+i]),s.push([e[0]+i,e[1]])}}else{let t=tE(e,o),r=tE(n,o);if(t===r){let o,r;switch(t){case"left":o=Math.min(e[0],n[0])-i,s.push([o,e[1]]),s.push([o,n[1]]);break;case"right":o=Math.max(e[0],n[0])+i,s.push([o,e[1]]),s.push([o,n[1]]);break;case"top":r=Math.min(e[1],n[1])-i,s.push([e[0],r]),s.push([n[0],r]);break;case"bottom":r=Math.max(e[1],n[1])+i,s.push([e[0],r]),s.push([n[0],r])}}else{let a=(t,e)=>({left:[e[0]-i,e[1]],right:[e[0]+i,e[1]],top:[e[0],e[1]-i],bottom:[e[0],e[1]+i]})[t],l=a(t,e),h=a(r,n),d=nl(l,h,o);s.push(l,d,h)}}return s}(t,d,c,s);return l&&(d=n0(l,u[0])),h&&(c=n0(h,u[u.length-1])),np([d,...u,c],e)}(s,i,a,l,h,e,n)}constructor(t){super(ec({style:nW.defaultStyleProps},t))}}nW.defaultStyleProps={radius:0,controlPoints:[],router:!1};class nV extends nC{getKeyPath(t){let{curvePosition:e,curveOffset:n}=t,[i,s]=this.getEndpoints(t),o=t.controlPoint||nc(i,s,e,n);return[["M",i[0],i[1]],["Q",o[0],o[1],s[0],s[1]]]}constructor(t){super(ec({style:nV.defaultStyleProps},t))}}function nK(t){return t instanceof ez&&"node"===t.type}function nG(t){return t instanceof nC}function nU(t){return t instanceof e8}nV.defaultStyleProps={curvePosition:.5,curveOffset:30};let nH={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],default:[.5,.5]};function nY(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nH,i=!(arguments.length>3)||void 0===arguments[3]||arguments[3],s=[.5,.5],o=(0,tQ.Z)(e)?(0,ee.Z)(n,e.toLocaleLowerCase(),s):e;if(!i&&(0,tQ.Z)(e))return o;let[r,a]=o||s;return[t.min[0]+td(t)*r,t.min[1]+tc(t)*a]}function nX(t){if(!t)return{};let e=t.getPorts(),n=t.attributes.ports||[];return n.forEach((n,i)=>{var s;let{key:o,placement:r}=n;n$(n)&&(e[s=o||i]||(e[s]=tZ(t.getShape("key").getBounds(),r)))}),e}function n$(t){let{r:e}=t;return!e||0===Number(e)}function nq(t){return ta(t)?t:t.getPosition()}function nQ(t,e,n,i){let s,o;let r=nX(t);if(n)return r[n];let a=Object.values(r);if(0===a.length)return;let l=a.map(t=>nq(t)),h=function(t,e){let n=nX(t);if(e)return[nq(n[e])];let i=Object.values(n);return i.length>0?i.map(t=>nq(t)):[t.getCenter()]}(e,i),[d]=(s=1/0,o=[l[0],h[0]],l.forEach(t=>{h.forEach(e=>{let n=tM(t,e);n<s&&(s=n,o=[t,e])})}),o);return a.find(t=>nq(t)===d)}function nJ(t,e){return nU(t)||nK(t)?n1(t,e):n0(t,e)}function n0(t,e){if(!t||!e)return[0,0,0];if(ta(t))return t;if(t.attributes.linkToCenter)return t.getPosition();let n=ta(e)?e:nK(e)?e.getCenter():e.getPosition();return tY(n,t.getBounds())}function n1(t,e){if(!t||!e)return[0,0,0];let n=ta(e)?e:nK(e)?e.getCenter():e.getPosition();return t.getIntersectPoint(n)||t.getCenter()}function n3(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=e.split("-"),[r,a]=tZ(t,e),l=o.includes("left")?"right":o.includes("right")?"left":"center",h=o.includes("top")?"bottom":o.includes("bottom")?"top":"middle";return s&&(h="top"===h?"bottom":"bottom"===h?"top":h),{transform:"translate(".concat(r+n,", ").concat(a+i,")"),textBaseline:h,textAlign:l}}function n6(t,e){"update"in t?t.update(e):t.attr(e)}function n2(t){return(0,ee.Z)(t,"__to_be_destroyed__",!1)}class n4 extends ts{update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.on("node:".concat(e),this.onCollapseExpand),t.on("combo:".concat(e),this.onCollapseExpand)}unbindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.off("node:".concat(e),this.onCollapseExpand),t.off("combo:".concat(e),this.onCollapseExpand)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,to.Z)(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},n4.defaultOptions,e)),this.onCollapseExpand=t=>{var e,n,i,s;return e=this,n=void 0,i=void 0,s=function*(){if(!this.validate(t))return;let{target:e}=t;if(!(nK(e)||nG(e)||nU(e)))return;let n=e.id,{model:i,graph:s}=this.context,o=i.getElementDataById(n);if(!o)return!1;let{onCollapse:r,onExpand:a,animation:l}=this.options;et(o)?(yield s.expandElement(n,l),null==a||a(n)):(yield s.collapseElement(n,l),null==r||r(n))},new(i||(i=Promise))(function(t,o){function r(t){try{l(s.next(t))}catch(t){o(t)}}function a(t){try{l(s.throw(t))}catch(t){o(t)}}function l(e){var n;e.done?t(e.value):((n=e.value)instanceof i?n:new i(function(t){t(n)})).then(r,a)}l((s=s.apply(e,n||[])).next())})},this.bindEvents()}}n4.defaultOptions={enable:!0,animation:!0,trigger:b.DBLCLICK};var n8=n(6466),n9=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})};let n5="g6-create-edge-assist-node-id";class n7 extends ts{update(t){super.update(t),this.bindEvents()}bindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;this.unbindEvents(),"click"===e?(t.on(w.CLICK,this.handleCreateEdge),t.on(v.CLICK,this.handleCreateEdge),t.on(y.CLICK,this.cancelEdge),t.on(x.CLICK,this.cancelEdge)):(t.on(w.DRAG_START,this.handleCreateEdge),t.on(v.DRAG_START,this.handleCreateEdge),t.on(b.POINTER_UP,this.drop)),t.on(b.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(t)))}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,to.Z)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;t.off(w.CLICK,this.handleCreateEdge),t.off(v.CLICK,this.handleCreateEdge),t.off(y.CLICK,this.cancelEdge),t.off(x.CLICK,this.cancelEdge),t.off(w.DRAG_START,this.handleCreateEdge),t.off(v.DRAG_START,this.handleCreateEdge),t.off(b.POINTER_UP,this.drop),t.off(b.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},n7.defaultOptions,e)),this.drop=t=>n9(this,void 0,void 0,function*(){let{targetType:e}=t;["combo","node"].includes(e)&&this.source?yield this.handleCreateEdge(t):yield this.cancelEdge()}),this.handleCreateEdge=t=>n9(this,void 0,void 0,function*(){var e;if(!this.validate(t))return;let{graph:n,canvas:i,batch:s,element:o}=this.context,{style:r}=this.options;if(this.source){this.createEdge(t),yield this.cancelEdge();return}s.startBatch(),i.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([t.target.id])[0],n.addNodeData([{id:n5,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}]}}]),n.addEdgeData([{id:"g6-create-edge-assist-edge-id",source:this.source,target:n5,style:Object.assign({pointerEvents:"none"},r)}]),yield null===(e=o.draw({animation:!1}))||void 0===e?void 0:e.finished}),this.updateAssistEdge=t=>n9(this,void 0,void 0,function*(){var e;if(!this.source)return;let{model:n,element:i}=this.context;n.translateNodeTo(n5,[t.canvas.x,t.canvas.y]),yield null===(e=i.draw({animation:!1,silence:!0}))||void 0===e?void 0:e.finished}),this.createEdge=t=>{var e,n;let{graph:i}=this.context,{style:s,onFinish:o,onCreate:r}=this.options,a=null===(e=t.target)||void 0===e?void 0:e.id;if(void 0===a||void 0===this.source)return;let l=null===(n=this.getSelectedNodeIDs([t.target.id]))||void 0===n?void 0:n[0],h="".concat(this.source,"-").concat(l,"-").concat((0,n8.Z)()),d=r({id:h,source:this.source,target:l,style:s});i.addEdgeData([d]),o(d)},this.cancelEdge=()=>n9(this,void 0,void 0,function*(){var t;if(!this.source)return;let{graph:e,element:n,batch:i}=this.context;e.removeNodeData([n5]),this.source=void 0,yield null===(t=n.draw({animation:!1}))||void 0===t?void 0:t.finished,i.endBatch()}),this.bindEvents()}}n7.defaultOptions={animation:!0,enable:!0,style:{},trigger:"drag",onCreate:t=>t,onFinish:()=>{}};var it=n(83633),ie=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})};class ii extends ts{update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){let{trigger:t}=this.options;if((0,P.Z)(t)){let{up:e=[],down:n=[],left:i=[],right:s=[]}=t;this.shortcut.bind(e,t=>this.onTranslate([0,1],t)),this.shortcut.bind(n,t=>this.onTranslate([0,-1],t)),this.shortcut.bind(i,t=>this.onTranslate([1,0],t)),this.shortcut.bind(s,t=>this.onTranslate([-1,0],t))}else{let{graph:t}=this.context;t.on(b.DRAG_START,this.onDragStart),t.on(b.DRAG,this.onDrag),t.on(b.DRAG_END,this.onDragEnd)}}onTranslate(t,e){return ie(this,void 0,void 0,function*(){if(!this.validate(e))return;let{sensitivity:n}=this.options;yield this.translate(tD(t,-1*n),this.options.animation),this.invokeOnFinish()})}translate(t,e){return ie(this,void 0,void 0,function*(){t=this.clampByDirection(t),t=this.clampByRange(t),yield this.context.graph.translateBy(t,e)})}clampByDirection(t){let[e,n]=t,{direction:i}=this.options;return"x"===i?n=0:"y"===i&&(e=0),[e,n]}clampByRange(t){let[e,n]=t,{viewport:i,canvas:s}=this.context,[o,r]=s.getSize(),[a,l,h,d]=th(this.options.range),c=tf(tg(i.getCanvasCenter()),[r*a,o*l,r*h,o*d]),u=tw(i.getViewportCenter(),[e,n,0]);if(!ty(u,c)){let{min:[t,i],max:[s,o]}=c;(u[0]<t&&e>0||u[0]>s&&e<0)&&(e=0),(u[1]<i&&n>0||u[1]>o&&n<0)&&(n=0)}return[e,n]}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return"function"==typeof e?e(t):!!e}unbindEvents(){this.shortcut.unbindAll();let{graph:t}=this.context;t.off(b.DRAG_START,this.onDragStart),t.off(b.DRAG,this.onDrag),t.off(b.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}constructor(t,e){super(t,Object.assign({},ii.defaultOptions,e)),this.isDragging=!1,this.onDragStart=t=>{this.validate(t)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))},this.onDrag=t=>{if(!this.isDragging)return;let{x:e,y:n}=t.movement;(e|n)!=0&&this.translate([e,n],!1)},this.onDragEnd=()=>{var t,e;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),null===(e=(t=this.options).onFinish)||void 0===e||e.call(t)},this.invokeOnFinish=(0,it.Z)(()=>{var t,e;null===(e=(t=this.options).onFinish)||void 0===e||e.call(t)},300),this.shortcut=new t0(t.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}}ii.defaultOptions={enable:t=>!("targetType"in t)||"canvas"===t.targetType,sensitivity:10,direction:"both",range:1/0};var is=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})};class io extends ts{update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){let{graph:t,canvas:e}=this.context,n=e.getLayer().getContextService().$canvas;n&&(n.addEventListener("blur",this.onDragEnd),n.addEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(e=>{t.on("".concat(e,":").concat(b.DRAG_START),this.onDragStart),t.on("".concat(e,":").concat(b.DRAG),this.onDrag),t.on("".concat(e,":").concat(b.DRAG_END),this.onDragEnd),t.on("".concat(e,":").concat(b.POINTER_ENTER),this.setCursor),t.on("".concat(e,":").concat(b.POINTER_LEAVE),this.setCursor)}),["link"].includes(this.options.dropEffect)&&(t.on(v.DROP,this.onDrop),t.on(y.DROP,this.onDrop))}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(t)))}getDelta(t){let e=this.context.graph.getZoom();return tC([t.dx,t.dy],e)}onDragStart(t){var e;if(this.enable=this.validate(t),!this.enable)return;let{batch:n,canvas:i}=this.context;i.setCursor((null===(e=this.options.cursor)||void 0===e?void 0:e.grabbing)||"grabbing"),this.isDragging=!0,n.startBatch(),this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(t){if(!this.enable)return;let e=this.getDelta(t);this.options.shadow?this.moveShadow(e):this.moveElement(this.target,e)}onDragEnd(){var t,e,n;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";let{x:t=0,y:e=0}=this.shadow.attributes,[n,i]=tw([+t,+e],this.shadowOrigin);this.moveElement(this.target,[n,i])}this.showEdges(),null===(e=(t=this.options).onFinish)||void 0===e||e.call(t,this.target);let{batch:i,canvas:s}=this.context;i.endBatch(),s.setCursor((null===(n=this.options.cursor)||void 0===n?void 0:n.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,to.Z)(e)?e(t):!!e}moveElement(t,e){return is(this,void 0,void 0,function*(){let{graph:n,model:i}=this.context,{dropEffect:s}=this.options;"move"===s&&t.forEach(t=>i.refreshComboData(t)),n.translateElementBy(Object.fromEntries(t.map(t=>[t,e])),!1)})}moveShadow(t){if(!this.shadow)return;let{x:e=0,y:n=0}=this.shadow.attributes,[i,s]=t;this.shadow.attr({x:+e+i,y:+n+s})}createShadow(t){let e=eo(this.options,"shadow"),n=tm(t.map(t=>this.context.element.getElement(t).getBounds())),[i,s]=n.min;this.shadowOrigin=[i,s];let[o,r]=tu(n),a={width:o,height:r,x:i,y:s};this.shadow?this.shadow.attr(Object.assign(Object.assign(Object.assign({},e),a),{visibility:"visible"})):(this.shadow=new A.UL({style:Object.assign(Object.assign(Object.assign({$layer:"transient"},e),a),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||0===this.hiddenEdges.length||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){let{hideEdge:t,shadow:e}=this.options;if("none"===t||e)return;let{graph:n}=this.context;"all"===t?this.hiddenEdges=n.getEdgeData().map(U):this.hiddenEdges=Array.from(new Set(this.target.map(e=>n.getRelatedEdgesData(e,t).map(U)).flat())),n.hideElement(this.hiddenEdges)}unbindEvents(){let{graph:t,canvas:e}=this.context,n=e.getLayer().getContextService().$canvas;n&&(n.removeEventListener("blur",this.onDragEnd),n.removeEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(e=>{t.off("".concat(e,":").concat(b.DRAG_START),this.onDragStart),t.off("".concat(e,":").concat(b.DRAG),this.onDrag),t.off("".concat(e,":").concat(b.DRAG_END),this.onDragEnd),t.off("".concat(e,":").concat(b.POINTER_ENTER),this.setCursor),t.off("".concat(e,":").concat(b.POINTER_LEAVE),this.setCursor)}),t.off("combo:".concat(b.DROP),this.onDrop),t.off("canvas:".concat(b.DROP),this.onDrop)}destroy(){var t;this.unbindEvents(),null===(t=this.shadow)||void 0===t||t.destroy(),super.destroy()}constructor(t,e){super(t,Object.assign({},io.defaultOptions,e)),this.enable=!1,this.enableElements=["node","combo"],this.target=[],this.shadowOrigin=[0,0],this.hiddenEdges=[],this.isDragging=!1,this.onDrop=t=>is(this,void 0,void 0,function*(){var e;if("link"!==this.options.dropEffect)return;let{model:n,element:i}=this.context,s=t.target.id;this.target.forEach(t=>{let e=n.getParentData(t,N);e&&U(e)===s&&n.refreshComboData(s),n.setParent(t,s,N)}),yield null===(e=null==i?void 0:i.draw({animation:!0}))||void 0===e?void 0:e.finished}),this.setCursor=t=>{if(this.isDragging)return;let{type:e}=t,{canvas:n}=this.context,{cursor:i}=this.options;e===b.POINTER_ENTER?n.setCursor((null==i?void 0:i.grab)||"grab"):n.setCursor((null==i?void 0:i.default)||"default")},this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}}io.defaultOptions={animation:!0,enable:t=>["node","combo"].includes(t.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}};var ir=n(16754);class ia{constructor(t,e){this.context=t,this.options=e||{}}}var il=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};function ih(t){let{nodes:e,edges:n}=t,i={nodes:[],edges:[],combos:[]};return e.forEach(t=>{let e=t.data._isCombo?i.combos:i.nodes,{x:n,y:s,z:o=0}=t.data;null==e||e.push({id:t.id,style:{x:n,y:s,z:o}})}),n.forEach(t=>{let{id:e,source:n,target:s,data:{points:o=[],controlPoints:r=o.slice(1,o.length-1)}}=t;i.edges.push({id:e,source:n,target:s,style:Object.assign({},(null==r?void 0:r.length)?{controlPoints:r.map(tW)}:{})})}),i}function id(t,e){for(var n=arguments.length,i=Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];if(e in t)return t[e](...i);if("instance"in t){let n=t.instance;if(e in n)return n[e](...i)}return null}function ic(t,e){if(e in t)return t[e];if("instance"in t){let n=t.instance;if(e in n)return n[e]}return null}let iu="cachedStyle",ip=t=>"__".concat(t,"__");function ig(t,e){let n=Array.isArray(e)?e:[e];(0,ee.Z)(t,iu)||(0,en.Z)(t,iu,{}),n.forEach(e=>{(0,en.Z)((0,ee.Z)(t,iu),ip(e),t.attributes[e])})}function im(t,e){return(0,ee.Z)(t,[iu,ip(e)])}function iy(t,e){return ip(e) in((0,ee.Z)(t,iu)||{})}var iv=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})};class ib extends ts{bindEvents(){let{graph:t}=this.context;t.on(O.AFTER_TRANSFORM,this.fixElementSize),t.on(O.BEFORE_DRAW,this.resetTransform)}unbindEvents(){let{graph:t}=this.context;t.off(O.AFTER_TRANSFORM,this.fixElementSize),t.off(O.BEFORE_DRAW,this.resetTransform)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,to.Z)(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},ib.defaultOptions,e)),this.elementCache=new Map,this.isZoomEvent=t=>"scale"in t.data,this.fixElementSize=t=>iv(this,void 0,void 0,function*(){if(!this.isZoomEvent(t)||!this.validate(t))return;let{graph:e,element:n}=this.context,{state:i}=this.options,s=i?[...e.getElementDataByState("node",i),...e.getElementDataByState("edge",i),...e.getElementDataByState("combo",i)]:Object.values(e.getData()).flat();if(!s.length)return;let o=t.data.scale||e.getZoom();s.forEach(t=>{let i=U(t),s=null==n?void 0:n.getElement(i),r=e.getElementType(i),a=this.options[r];if(!a){this.elementCache.set(i,s),"edge"===r&&(s.style.transformOrigin="center"),s.setLocalScale(1/o);return}let l=function(t){let e=[],n=t=>{(null==t?void 0:t.children.length)&&t.children.forEach(t=>{e.push(t),n(t)})};return n(t),e}(s),h=Array.isArray(a)?a:[a];h.forEach(t=>{let{shape:e,fields:n}=t,i=e(l);n.forEach(t=>{iy(i,t)||ig(i,t);let e=im(i,t);(0,eV.Z)(e)&&(i.style[t]=e/o)})})})}),this.resetTransform=()=>iv(this,void 0,void 0,function*(){this.elementCache&&(this.elementCache.forEach(t=>t.setLocalScale(1)),this.elementCache.clear())}),this.bindEvents()}}ib.defaultOptions={enable:t=>t.data.scale<1,state:"selected",edge:[{shape:t=>t.find(t=>"key"===t.className),fields:["lineWidth"]},{shape:t=>t.find(t=>{var e;return(null===(e=t.parentElement)||void 0===e?void 0:e.className)==="label"&&"text"===t.className}),fields:["fontSize","lineHeight"]}]};class iE extends ts{bindEvents(){let{graph:t}=this.context;this.unbindEvents(),t6.forEach(e=>{t.on("".concat(e,":").concat(b.CLICK),this.focus)})}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,to.Z)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;t6.forEach(e=>{t.off("".concat(e,":").concat(b.CLICK),this.focus)})}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},iE.defaultOptions,e)),this.focus=t=>{var e,n,i,s;return e=this,n=void 0,i=void 0,s=function*(){if(!this.validate(t))return;let{graph:e}=this.context;yield e.focusElement(t.target.id,this.options.animation)},new(i||(i=Promise))(function(t,o){function r(t){try{l(s.next(t))}catch(t){o(t)}}function a(t){try{l(s.throw(t))}catch(t){o(t)}}function l(e){var n;e.done?t(e.value):((n=e.value)instanceof i?n:new i(function(t){t(n)})).then(r,a)}l((s=s.apply(e,n||[])).next())})},this.bindEvents()}}iE.defaultOptions={animation:{easing:"ease-in",duration:500},enable:!0};class ix extends ts{bindEvents(){let{graph:t}=this.context;this.unbindEvents(),t6.forEach(e=>{t.on("".concat(e,":").concat(b.POINTER_ENTER),this.hoverElement),t.on("".concat(e,":").concat(b.POINTER_LEAVE),this.hoverElement)});let e=this.context.canvas.document;e.addEventListener("".concat(b.DRAG_START),this.toggleFrozen),e.addEventListener("".concat(b.DRAG_END),this.toggleFrozen)}getActiveIds(t){let{graph:e}=this.context,{degree:n,direction:i}=this.options,s=t.target.id,o=e.getElementType(s);return n?t4(e,o,s,"function"==typeof n?n(t):n,i):[s]}validate(t){if(this.destroyed||this.isFrozen||this.context.graph.isCollapsingExpanding)return!1;let{enable:e}=this.options;return(0,to.Z)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;t6.forEach(e=>{t.off("".concat(e,":").concat(b.POINTER_ENTER),this.hoverElement),t.off("".concat(e,":").concat(b.POINTER_LEAVE),this.hoverElement)});let e=this.context.canvas.document;e.removeEventListener("".concat(b.DRAG_START),this.toggleFrozen),e.removeEventListener("".concat(b.DRAG_END),this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},ix.defaultOptions,e)),this.isFrozen=!1,this.toggleFrozen=t=>{this.isFrozen="dragstart"===t.type},this.hoverElement=t=>{if(!this.validate(t))return;let e=t.type===b.POINTER_ENTER;this.updateElementsState(t,e);let{onHover:n,onHoverEnd:i}=this.options;e?null==n||n(t):null==i||i(t)},this.updateElementsState=(t,e)=>{if(!this.options.state&&!this.options.inactiveState)return;let{graph:n}=this.context,{state:i,animation:s,inactiveState:o}=this.options,r=this.getActiveIds(t),a={};if(i&&Object.assign(a,this.getElementsState(r,i,e)),o){let t=H(n.getData(),!0).filter(t=>!r.includes(t));Object.assign(a,this.getElementsState(t,o,e))}n.setElementState(a,s)},this.getElementsState=(t,e,n)=>{let{graph:i}=this.context,s={};return t.forEach(t=>{let o=i.getElementState(t);n?s[t]=o.includes(e)?o:[...o,e]:s[t]=o.filter(t=>t!==e)}),s},this.bindEvents()}}ix.defaultOptions={animation:!1,enable:!0,degree:0,direction:"both",state:"active",inactiveState:void 0};class iO extends ts{bindEvents(){let{graph:t}=this.context;t.on(O.BEFORE_TRANSFORM,this.hideShapes),t.on(O.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){let{graph:t}=this.context;t.off(O.BEFORE_TRANSFORM,this.hideShapes),t.off(O.AFTER_TRANSFORM,this.showShapes)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,to.Z)(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},iO.defaultOptions,e)),this.isVisible=!0,this.setElementsVisibility=(t,e,n)=>{t.forEach(t=>{ex(t,e,!1,t=>!t.className||!(null==n?void 0:n.includes(t.className)))})},this.hideShapes=t=>{if(!this.validate(t)||!this.isVisible)return;let{element:e}=this.context,{shapes:n={}}=this.options;this.setElementsVisibility(e.getNodes(),"hidden",n.node),this.setElementsVisibility(e.getEdges(),"hidden",n.edge),this.setElementsVisibility(e.getCombos(),"hidden",n.combo),this.isVisible=!1},this.showShapes=(0,it.Z)(t=>{if(!this.validate(t)||this.isVisible)return;let{element:e}=this.context;this.setElementsVisibility(e.getNodes(),"visible"),this.setElementsVisibility(e.getEdges(),"visible"),this.setElementsVisibility(e.getCombos(),"visible"),this.isVisible=!0},this.options.debounce),this.bindEvents()}}iO.defaultOptions={enable:!0,debounce:200,shapes:{node:["key"]}};var iS=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})};class iw extends ts{update(t){super.update(t),this.bindEvents()}bindEvents(){var t,e;let{trigger:n}=this.options;if(this.shortcut.unbindAll(),(0,P.Z)(n)){null===(t=this.graphDom)||void 0===t||t.removeEventListener(b.WHEEL,this.onWheel);let{up:e=[],down:i=[],left:s=[],right:o=[]}=n;this.shortcut.bind(e,t=>this.scroll([0,-10],t)),this.shortcut.bind(i,t=>this.scroll([0,10],t)),this.shortcut.bind(s,t=>this.scroll([-10,0],t)),this.shortcut.bind(o,t=>this.scroll([10,0],t))}else null===(e=this.graphDom)||void 0===e||e.addEventListener(b.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement(t){let{sensitivity:e}=this.options;return t=tD(t,e),t=this.clampByDirection(t),t=this.clampByRange(t)}clampByDirection(t){let[e,n]=t,{direction:i}=this.options;return"x"===i?n=0:"y"===i&&(e=0),[e,n]}clampByRange(t){let[e,n]=t,{viewport:i,canvas:s}=this.context,[o,r]=s.getSize(),[a,l,h,d]=th(this.options.range),c=tf(tg(i.getCanvasCenter()),[r*a,o*l,r*h,o*d]),u=tw(i.getViewportCenter(),[e,n,0]);if(!ty(u,c)){let{min:[t,i],max:[s,o]}=c;(u[0]<t&&e>0||u[0]>s&&e<0)&&(e=0),(u[1]<i&&n>0||u[1]>o&&n<0)&&(n=0)}return[e,n]}scroll(t,e){return iS(this,void 0,void 0,function*(){if(!this.validate(e))return;let{onFinish:n}=this.options,i=this.context.graph,s=this.formatDisplacement(t);yield i.translateBy(s,!1),null==n||n()})}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,to.Z)(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),null===(t=this.graphDom)||void 0===t||t.removeEventListener(b.WHEEL,this.onWheel),super.destroy()}constructor(t,e){super(t,Object.assign({},iw.defaultOptions,e)),this.onWheel=t=>iS(this,void 0,void 0,function*(){this.options.preventDefault&&t.preventDefault();let e=t.deltaX,n=t.deltaY;yield this.scroll([-e,-n],t)}),this.shortcut=new t0(t.graph),this.bindEvents()}}iw.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0,range:1/0};var iD=n(15378),iC=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})};class iA extends ts{update(t){super.update(t),this.bindEvents()}bindEvents(){var t;let{trigger:e}=this.options;if(this.shortcut.unbindAll(),Array.isArray(e)&&(null===(t=this.context.canvas.getContainer())||void 0===t||t.addEventListener(b.WHEEL,this.preventDefault),this.shortcut.bind([...e,b.WHEEL],t=>{let{deltaX:e,deltaY:n}=t;this.zoom(-(null!=n?n:e),t,!1)})),"object"==typeof e){let{zoomIn:t=[],zoomOut:n=[],reset:i=[]}=e;this.shortcut.bind(t,t=>this.zoom(10,t,this.options.animation)),this.shortcut.bind(n,t=>this.zoom(-10,t,this.options.animation)),this.shortcut.bind(i,this.onReset)}}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,to.Z)(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),null===(t=this.context.canvas.getContainer())||void 0===t||t.removeEventListener(b.WHEEL,this.preventDefault),super.destroy()}constructor(t,e){super(t,Object.assign({},iA.defaultOptions,e)),this.zoom=(t,e,n)=>iC(this,void 0,void 0,function*(){let i;if(!this.validate(e))return;let{graph:s}=this.context;"viewport"in e&&(i=tW(e.viewport));let{sensitivity:o,onFinish:r}=this.options,a=1+(0,iD.Z)(t,-50,50)*o/100,l=s.getZoom();yield s.zoomTo(l*a,n,i),null==r||r()}),this.onReset=()=>iC(this,void 0,void 0,function*(){yield this.context.graph.zoomTo(1,this.options.animation)}),this.preventDefault=t=>{this.options.preventDefault&&t.preventDefault()},this.shortcut=new t0(t.graph),this.bindEvents()}}iA.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};var iM=n(74355),iT=n(93288),iR=n(28947),iP=n(83297),ik=n(53591),iL=n(80755),iN=n(69945),ij=n(69030),iI=n(92993),iB=n(30229),i_=n(97030),iF=n(91031),iz=n(73243),iZ=n(6117),iW=n(97067);let iV=t=>t?parseInt(t):0;function iK(t){let e=640,n=480,[i,s]=function(t){let e=getComputedStyle(t),n=t.clientWidth||iV(e.width),i=t.clientHeight||iV(e.height),s=iV(e.paddingLeft)+iV(e.paddingRight),o=iV(e.paddingTop)+iV(e.paddingBottom);return[n-s,i-o]}(t);return e=i||e,n=s||n,[Math.max((0,eV.Z)(e)?e:1,1),Math.max((0,eV.Z)(n)?n:1,1)]}function iG(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2?arguments[2]:void 0,i=document.createElement("div");return i.setAttribute("class","g6-".concat(t)),Object.assign(i.style,{position:"absolute",display:"block"}),e&&Object.assign(i.style,{inset:"0px",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none"}),n&&Object.assign(i.style,n),i}function iU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:document.body,o=document.getElementById(t);o&&o.remove();let r=document.createElement(e);return r.innerHTML=i,r.id=t,Object.assign(r.style,n),s.appendChild(r),r}class iH extends ti{}class iY extends iH{update(t){var e,n,i,s;let o=Object.create(null,{update:{get:()=>super.update}});return e=this,n=void 0,i=void 0,s=function*(){o.update.call(this,t),Object.assign(this.$element.style,(0,iW.Z)(this.options,["key","type"]))},new(i||(i=Promise))(function(t,o){function r(t){try{l(s.next(t))}catch(t){o(t)}}function a(t){try{l(s.throw(t))}catch(t){o(t)}}function l(e){var n;e.done?t(e.value):((n=e.value)instanceof i?n:new i(function(t){t(n)})).then(r,a)}l((s=s.apply(e,n||[])).next())})}destroy(){super.destroy(),this.$element.remove()}constructor(t,e){super(t,Object.assign({},iY.defaultOptions,e)),this.$element=iG("background");let n=this.context.canvas.getContainer();n.prepend(this.$element),this.update(e)}}iY.defaultOptions={transition:"background 0.5s",backgroundSize:"cover"};var iX=n(25470),i$=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};class iq extends iH{bindEvents(){this.context.graph.on(O.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(O.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new iX.CF(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){let t=this.options,{type:e,key:n,members:i,avoidMembers:s}=t,o=i$(t,["type","key","members","avoidMembers"]),r=Object.keys(o).reduce((t,e)=>(e in iX.vC?t.bubbleSetOptions[e]=o[e]:t.style[e]=o[e],t),{style:{},bubbleSetOptions:{}});return Object.assign({type:e,key:n,members:i,avoidMembers:s},r)}addMember(t){let e=Array.isArray(t)?t:[t];e.some(t=>this.options.avoidMembers.includes(t))&&(this.options.avoidMembers=this.options.avoidMembers.filter(t=>!e.includes(t))),this.options.members=[...new Set([...this.options.members,...e])],this.drawBubbleSets()}removeMember(t){let e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(t=>!e.includes(t)),this.drawBubbleSets()}updateMember(t){this.options.members=(0,to.Z)(t)?t(this.options.members):t,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(t){let e=Array.isArray(t)?t:[t];e.some(t=>this.options.members.includes(t))&&(this.options.members=this.options.members.filter(t=>!e.includes(t))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...e])],this.drawBubbleSets()}removeAvoidMember(t){let e=Array.isArray(t)?t:[t];this.options.avoidMembers.some(t=>e.includes(t))&&(this.options.avoidMembers=this.options.avoidMembers.filter(t=>!e.includes(t)),this.drawBubbleSets())}updateAvoidMember(t){this.options.avoidMembers=Array.isArray(t)?t:[t],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(O.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(O.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}constructor(t,e){super(t,(0,G.Z)({},iq.defaultOptions,e)),this.members=new Map,this.avoidMembers=new Map,this.bubbleSetOptions={},this.drawBubbleSets=()=>{let{style:t,bubbleSetOptions:e}=this.parseOptions();(0,R.Z)(this.bubbleSetOptions,e)||this.init(),this.bubbleSetOptions=Object.assign({},e);let n=Object.assign(Object.assign({},t),{d:this.getPath()});this.shape?this.shape.update(n):(this.shape=new eP({style:n}),this.context.canvas.appendChild(this.shape))},this.updateBubbleSetsPath=t=>{if(!this.shape)return;let e=U(t.data);[...this.options.members,...this.options.avoidMembers].includes(e)&&this.shape.update(Object.assign(Object.assign({},this.parseOptions().style),{d:this.getPath(e)}))},this.getPath=t=>{let{graph:e}=this.context,n=this.options.members,i=[...this.members.keys()],s=this.options.avoidMembers,o=[...this.avoidMembers.keys()];if(!t&&(0,R.Z)(n,i)&&(0,R.Z)(s,o))return this.path;let{enter:r=[],exit:a=[]}=te(i,n,t=>t),{enter:l=[],exit:h=[]}=te(o,s,t=>t);t&&(a.push(t),r.push(t));let d=(t,n,i)=>{t.forEach(t=>{let s=i?this.members:this.avoidMembers;if(n){let n;"edge"===e.getElementType(t)?([n]=iJ(e,t),this.bubbleSets.pushEdge(n)):([n]=iQ(e,t),this.bubbleSets[i?"pushMember":"pushNonMember"](n)),s.set(t,n)}else{let n=s.get(t);n&&("edge"===e.getElementType(t)?this.bubbleSets.removeEdge(n):this.bubbleSets[i?"removeMember":"removeNonMember"](n),s.delete(t))}})};d(a,!1,!0),d(r,!0,!0),d(h,!1,!1),d(l,!0,!1);let c=this.bubbleSets.compute(),u=c.sample(8).simplify(0).bSplines().simplify(0);return this.path=eT(u.points.map(tW)),this.path},this.bindEvents(),this.bubbleSets=new iX.CF(this.options)}}iq.defaultOptions=Object.assign({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},iX.vC);let iQ=(t,e)=>{let n=Array.isArray(e)?e:[e];return n.map(e=>{let n=t.getElementRenderBounds(e);return new iX.Ae(n.min[0],n.min[1],td(n),tc(n))})},iJ=(t,e)=>{let n=Array.isArray(e)?e:[e];return n.map(e=>{let n=t.getEdgeData(e),i=t.getElementPosition(n.source),s=t.getElementPosition(n.target);return iX.x1.from({x1:i[0],y1:i[1],x2:s[0],y2:s[1]})})};var i0=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})};class i1 extends iH{initElement(){this.$element=iG("contextmenu",!1,{zIndex:"99"});let{className:t}=this.options;t&&this.$element.classList.add(t);let e=this.context.canvas.getContainer();e.appendChild(this.$element),iU("g6-contextmenu-css","style",{},"\n  .g6-contextmenu {\n    font-size: 12px;\n    background-color: rgba(255, 255, 255, 0.96);\n    border-radius: 4px;\n    overflow: hidden;\n    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;\n    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;\n  }\n\n  .g6-contextmenu-ul {\n    max-width: 256px;\n    min-width: 96px;\n    list-style: none;\n    padding: 0;\n    margin: 0;\n  }\n\n  .g6-contextmenu-li {\n    padding: 8px 12px;\n    cursor: pointer;\n    user-select: none;\n  }\n\n  .g6-contextmenu-li:hover {\n    background-color: #f5f5f5;\n    cursor: pointer;\n  }\n",document.head)}show(t){return i0(this,void 0,void 0,function*(){let{enable:e,offset:n}=this.options;if("function"==typeof e&&!e(t)||!e){this.hide();return}let i=yield this.getDOMContent(t);i instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(i)):this.$element.innerHTML=i;let s=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left="".concat(t.client.x-s.left+n[0],"px"),this.$element.style.top="".concat(t.client.y-s.top+n[1],"px"),this.$element.style.display="block",this.targetElement=t.target})}hide(){this.$element.style.display="none",this.targetElement=null}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(t){return i0(this,void 0,void 0,function*(){let{getContent:e,getItems:n}=this.options;if(n){var i;return i=yield n(t),'\n    <ul class="g6-contextmenu-ul">\n      '.concat(i.map(t=>'<li  class="g6-contextmenu-li" value="'.concat(t.value,'">').concat(t.name,"</li>")).join(""),"\n    </ul>\n  ")}return yield e(t)})}bindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.on("canvas:".concat(e),this.onTriggerEvent),t.on("node:".concat(e),this.onTriggerEvent),t.on("edge:".concat(e),this.onTriggerEvent),t.on("combo:".concat(e),this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.off("canvas:".concat(e),this.onTriggerEvent),t.off("node:".concat(e),this.onTriggerEvent),t.off("edge:".concat(e),this.onTriggerEvent),t.off("combo:".concat(e),this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}constructor(t,e){super(t,Object.assign({},i1.defaultOptions,e)),this.targetElement=null,this.onTriggerEvent=t=>{var e;null===(e=t.preventDefault)||void 0===e||e.call(t),this.show(t)},this.onMenuItemClick=t=>{let{onClick:e,trigger:n}=this.options;if(t.target instanceof HTMLElement&&t.target.className.includes("g6-contextmenu-li")){let n=t.target.getAttribute("value");null==e||e(n,t.target,this.targetElement),this.hide()}"click"!==n&&this.hide()},this.initElement(),this.update(e)}}i1.defaultOptions={trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0};let i3={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8};class i6 extends iH{get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(t,e){let n="node"===t?this.options.nodeStyle:this.options.edgeStyle;return"function"==typeof n?n(e):n}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;let{graph:e}=this.context,{trigger:n,scaleRBy:i}=this.options,s=e.getCanvas().getLayer();["click","drag"].includes(n)&&s.addEventListener(b.CLICK,this.onEdgeFilter),"pointermove"===n?s.addEventListener(b.POINTER_MOVE,this.onEdgeFilter):"drag"===n&&(s.addEventListener(b.DRAG_START,this.onDragStart),s.addEventListener(b.DRAG,this.onDrag),s.addEventListener(b.DRAG_END,this.onDragEnd)),"wheel"===i&&(null===(t=this.graphDom)||void 0===t||t.addEventListener(b.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var t;let{graph:e}=this.context,{trigger:n,scaleRBy:i}=this.options,s=e.getCanvas().getLayer();["click","drag"].includes(n)&&s.removeEventListener(b.CLICK,this.onEdgeFilter),"pointermove"===n?s.removeEventListener(b.POINTER_MOVE,this.onEdgeFilter):"drag"===n&&(s.removeEventListener(b.DRAG_START,this.onDragStart),s.removeEventListener(b.DRAG,this.onDrag),s.removeEventListener(b.DRAG_END,this.onDragEnd)),"wheel"===i&&(null===(t=this.graphDom)||void 0===t||t.removeEventListener(b.WHEEL,this.scaleRByWheel))}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((t,e)=>{t.destroy(),this.shapes.delete(e)}),super.destroy()}constructor(t,e){super(t,Object.assign({},i6.defaultOptions,e)),this.shapes=new Map,this.r=this.options.r,this.onEdgeFilter=t=>{if("drag"===this.options.trigger&&this.isLensOn)return;let e=tW(t.canvas);this.renderLens(e),this.renderFocusElements()},this.renderLens=t=>{let e=Object.assign({},i3,this.options.style);this.isLensOn||(this.lens=new eZ({style:e}),this.canvas.appendChild(this.lens)),Object.assign(e,tV(t),{size:2*this.r}),this.lens.update(e)},this.getFilterData=()=>{let{filter:t}=this.options,{model:e}=this.context,n=e.getData();if(!t)return n;let{nodes:i,edges:s,combos:o}=n;return{nodes:i.filter(e=>t(U(e),"node")),edges:s.filter(e=>t(U(e),"edge")),combos:o.filter(e=>t(U(e),"combo"))}},this.getFocusElements=t=>{let{nodes:e,edges:n}=this.getFilterData(),i=e.filter(e=>tM(tF(e),t)<this.r),s=i.map(t=>U(t)),o=n.filter(t=>{let{source:e,target:n}=t,i=s.includes(e),o=s.includes(n);switch(this.options.nodeType){case"both":return i&&o;case"either":return i!==o;case"source":return i&&!o;case"target":return!i&&o;default:return!1}});return{nodes:i,edges:o}},this.renderFocusElements=()=>{let{element:t,graph:e}=this.context;if(!this.isLensOn)return;let n=this.lens.getCenter(),{nodes:i,edges:s}=this.getFocusElements(n),o=new Set,r=n=>{let i=U(n);o.add(i);let s=t.getElement(i);if(!s)return;let r=this.shapes.get(i)||s.cloneNode();r.setPosition(s.getPosition()),r.id=s.id,this.shapes.has(i)?Object.entries(s.attributes).forEach(t=>{let[e,n]=t;r.style[e]!==n&&(r.style[e]=n)}):(this.canvas.appendChild(r),this.shapes.set(i,r));let a=e.getElementType(i),l=this.getElementStyle(a,n);r.update(l)};i.forEach(r),s.forEach(r),this.shapes.forEach((t,e)=>{o.has(e)||(t.destroy(),this.shapes.delete(e))})},this.scaleRByWheel=t=>{var e;this.options.preventDefault&&t.preventDefault();let{clientX:n,clientY:i,deltaX:s,deltaY:o}=t,{graph:r,canvas:a}=this.context,l=r.getCanvasByClient([n,i]),h=null===(e=this.lens)||void 0===e?void 0:e.getCenter();if(!this.isLensOn||tM(l,h)>this.r)return;let{maxR:d,minR:c}=this.options,u=Math.min(...a.getSize())/2;this.r=Math.max(c||0,Math.min(d||u,this.r*(s+o>0?1/.95:.95))),this.renderLens(h),this.renderFocusElements()},this.isLensDragging=!1,this.onDragStart=t=>{var e;let n=tW(t.canvas),i=null===(e=this.lens)||void 0===e?void 0:e.getCenter();!this.isLensOn||tM(n,i)>this.r||(this.isLensDragging=!0)},this.onDrag=t=>{if(!this.isLensDragging)return;let e=tW(t.canvas);this.renderLens(e),this.renderFocusElements()},this.onDragEnd=()=>{this.isLensDragging=!1},this.bindEvents()}}i6.defaultOptions={trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:"wheel",preventDefault:!0};let i2={fill:"#ccc",fillOpacity:.1,lineWidth:2,stroke:"#000",strokeOpacity:.8,labelFontSize:12};class i4 extends iH{get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;let{graph:e}=this.context,{trigger:n,scaleRBy:i,scaleDBy:s}=this.options,o=e.getCanvas().getLayer();if(["click","drag"].includes(n)&&o.addEventListener(b.CLICK,this.onCreateFisheye),"pointermove"===n&&o.addEventListener(b.POINTER_MOVE,this.onCreateFisheye),"drag"===n||"drag"===i||"drag"===s){o.addEventListener(b.DRAG_START,this.onDragStart),o.addEventListener(b.DRAG_END,this.onDragEnd);let t="drag"===n?this.onDrag:"drag"===i?this.scaleRByDrag:this.scaleDByDrag;o.addEventListener(b.DRAG,t)}if("wheel"===i||"wheel"===s){let e="wheel"===i?this.scaleRByWheel:this.scaleDByWheel;null===(t=this.graphDom)||void 0===t||t.addEventListener(b.WHEEL,e,{passive:!1})}}unbindEvents(){var t;let{graph:e}=this.context,{trigger:n,scaleRBy:i,scaleDBy:s}=this.options,o=e.getCanvas().getLayer();if(["click","drag"].includes(n)&&o.removeEventListener(b.CLICK,this.onCreateFisheye),"pointermove"===n&&o.removeEventListener(b.POINTER_MOVE,this.onCreateFisheye),"drag"===n||"drag"===i||"drag"===s){o.removeEventListener(b.DRAG_START,this.onDragStart),o.removeEventListener(b.DRAG_END,this.onDragEnd);let t="drag"===n?this.onDrag:"drag"===i?this.scaleRByDrag:this.scaleDByDrag;o.removeEventListener(b.DRAG,t)}if("wheel"===i||"wheel"===s){let e="wheel"===i?this.scaleRByWheel:this.scaleDByWheel;null===(t=this.graphDom)||void 0===t||t.removeEventListener(b.WHEEL,e)}}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){var t;this.unbindEvents(),this.isLensOn&&(null===(t=this.lens)||void 0===t||t.destroy()),this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),super.destroy()}constructor(t,e){super(t,Object.assign({},i4.defaultOptions,e)),this.r=this.options.r,this.d=this.options.d,this.onCreateFisheye=t=>{if("drag"===this.options.trigger&&this.isLensOn)return;let e=tW(t.canvas);this.onMagnify(e)},this.onMagnify=t=>{t.some(isNaN)||(this.renderLens(t),this.renderFocusElements())},this.renderLens=t=>{let e=Object.assign({},i2,this.options.style);this.isLensOn||(this.lens=new eZ({style:e}),this.canvas.appendChild(this.lens)),Object.assign(e,tV(t),{size:2*this.r,label:this.options.showDPercent,labelText:this.getDPercent()}),this.lens.update(e)},this.getDPercent=()=>{let{minD:t,maxD:e}=this.options,n=Math.round((this.d-t)/(e-t)*100);return"".concat(n,"%")},this.prevMagnifiedStyleMap=new Map,this.prevOriginStyleMap=new Map,this.renderFocusElements=()=>{if(!this.isLensOn)return;let{graph:t}=this.context,e=this.lens.getCenter(),n=(this.d+1)*this.r,i=new Map,s=new Map,o=t.getNodeData();o.forEach(o=>{let r=tF(o),a=tM(r,e);if(a>this.r)return;let l=n*a/(this.d*a+this.r),[h,d]=r,[c,u]=e,p=U(o),g=this.getNodeStyle(o),f=(0,eQ.Z)(t.getElementRenderStyle(p),Object.keys(g));i.set(p,Object.assign(Object.assign({},tV([c+l*((h-c)/a),u+l*((d-u)/a)])),g)),s.set(p,Object.assign(Object.assign({},tV(r)),f))}),this.updateStyle(i,s)},this.getNodeStyle=t=>{let{nodeStyle:e}=this.options;return"function"==typeof e?e(t):e},this.updateStyle=(t,e)=>{let{graph:n,element:i}=this.context,{enter:s,exit:o,keep:r}=te(Array.from(this.prevMagnifiedStyleMap.keys()),Array.from(t.keys()),t=>t),a=new Set,l=(t,e)=>{let s=i.getElement(t);s.update(e),n.getRelatedEdgesData(t).forEach(t=>{a.add(U(t))})};[...s,...r].forEach(e=>{l(e,t.get(e))}),o.forEach(t=>{l(t,this.prevOriginStyleMap.get(t)),this.prevOriginStyleMap.delete(t)}),a.forEach(t=>{let e=i.getElement(t);null==e||e.update({})}),this.prevMagnifiedStyleMap=t,e.forEach((t,e)=>{this.prevOriginStyleMap.has(e)||this.prevOriginStyleMap.set(e,t)})},this.isWheelValid=t=>{if(this.options.preventDefault&&t.preventDefault(),!this.isLensOn)return!1;let{clientX:e,clientY:n}=t,i=this.context.graph.getCanvasByClient([e,n]),s=this.lens.getCenter();return!(tM(i,s)>this.r)},this.scaleR=t=>{let{maxR:e,minR:n}=this.options,i=Math.min(...this.context.canvas.getSize())/2;this.r=Math.max(n||0,Math.min(e||i,this.r*(t?1/.95:.95)))},this.scaleD=t=>{let{maxD:e,minD:n}=this.options,i=t?this.d+.1:this.d-.1;this.d=Math.max(n,Math.min(e,i))},this.scaleRByWheel=t=>{if(!this.isWheelValid(t))return;let{deltaX:e,deltaY:n}=t;this.scaleR(e+n>0);let i=this.lens.getCenter();this.onMagnify(i)},this.scaleDByWheel=t=>{if(!this.isWheelValid(t))return;let{deltaX:e,deltaY:n}=t;this.scaleD(e+n>0);let i=this.lens.getCenter();this.onMagnify(i)},this.isDragValid=t=>{if(this.options.preventDefault&&t.preventDefault(),!this.isLensOn)return!1;let e=tW(t.canvas),n=this.lens.getCenter();return!(tM(e,n)>this.r)},this.isLensDragging=!1,this.onDragStart=t=>{this.isDragValid(t)&&(this.isLensDragging=!0)},this.onDrag=t=>{if(!this.isLensDragging)return;let e=tW(t.canvas);this.onMagnify(e)},this.onDragEnd=()=>{this.isLensDragging=!1},this.scaleRByDrag=t=>{if(!this.isLensDragging)return;let{dx:e,dy:n}=t;this.scaleR(e-n>0);let i=this.lens.getCenter();this.onMagnify(i)},this.scaleDByDrag=t=>{if(!this.isLensDragging)return;let{dx:e,dy:n}=t;this.scaleD(e-n>0);let i=this.lens.getCenter();this.onMagnify(i)},this.bindEvents()}}i4.defaultOptions={trigger:"pointermove",r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};class i8 extends iH{bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();let{request:t=[],exit:e=[]}=this.options.trigger;this.shortcut.bind(t,this.request),this.shortcut.bind(e,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(t=>{document.addEventListener(t,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(t=>{document.removeEventListener(t,this.onFullscreenChange,!1)})}setGraphSize(){let t,e,n=!(arguments.length>0)||void 0===arguments[0]||arguments[0];n?(t=window.screen.width,e=window.screen.height,this.graphSize=this.context.graph.getSize()):[t,e]=this.graphSize,this.context.graph.setSize(t,e),this.context.graph.render()}request(){!document.fullscreenElement&&(document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled"))&&this.$el.requestFullscreen().catch(t=>{F.warn("Error attempting to enable full-screen: ".concat(t.message," (").concat(t.name,")"))})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}constructor(t,e){super(t,Object.assign({},i8.defaultOptions,e)),this.$el=this.context.canvas.getContainer(),this.graphSize=[0,0],this.onFullscreenChange=()=>{var t,e,n,i;let s=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(s),s?null===(e=(t=this.options).onEnter)||void 0===e||e.call(t):null===(i=(n=this.options).onExit)||void 0===i||i.call(n)},this.shortcut=new t0(t.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML="\n      :not(:root):fullscreen::backdrop {\n        background: transparent;\n      }\n    "}}i8.defaultOptions={trigger:{},autoFit:!0};class i9 extends iH{update(t){super.update(t),this.updateStyle()}bindEvents(){let{graph:t}=this.context;t.on(O.AFTER_TRANSFORM,this.onTransform)}updateStyle(){let{size:t,stroke:e,lineWidth:n,border:i,borderLineWidth:s,borderStroke:o,borderStyle:r}=this.options;Object.assign(this.$element.style,{border:i?"".concat(s,"px ").concat(r," ").concat(o):"none",backgroundImage:"linear-gradient(".concat(e," ").concat(n,"px, transparent ").concat(n,"px), linear-gradient(90deg, ").concat(e," ").concat(n,"px, transparent ").concat(n,"px)"),backgroundSize:"".concat(t,"px ").concat(t,"px")})}updateOffset(t){var e,n;this.offset=(e=tS(this.offset,t),n=this.options.size,e.map(t=>t%n)),this.$element.style.backgroundPosition="".concat(this.offset[0],"px ").concat(this.offset[1],"px")}destroy(){this.context.graph.off(O.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}constructor(t,e){super(t,Object.assign({},i9.defaultOptions,e)),this.$element=iG("grid-line"),this.offset=[0,0],this.onTransform=t=>{if(!this.options.follow)return;let{data:{translate:e}}=t;e&&this.updateOffset(e)};let n=this.context.canvas.getContainer();!function(t,e){let n=t.firstChild;n?t.insertBefore(e,n):t.appendChild(e)}(n,this.$element),this.updateStyle(),this.bindEvents()}}i9.defaultOptions={border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"};var i5=n(80216);function i7(t){let e={Added:new Map,Updated:new Map,Removed:new Map};return t.forEach(t=>{let{type:n,value:i}=t,s=U(i);if("NodeAdded"===n||"EdgeAdded"===n||"ComboAdded"===n)e.Added.set(s,t);else if("NodeUpdated"===n||"EdgeUpdated"===n||"ComboUpdated"===n){if(e.Added.has(s))e.Added.set(s,{type:n.replace("Updated","Added"),value:i});else if(e.Updated.has(s)){let{original:t}=e.Updated.get(s);e.Updated.set(s,{type:n,value:i,original:t})}else e.Removed.has(s)||e.Updated.set(s,t)}else("NodeRemoved"===n||"EdgeRemoved"===n||"ComboRemoved"===n)&&(e.Added.has(s)?e.Added.delete(s):(e.Updated.has(s)&&e.Updated.delete(s),e.Removed.set(s,t)))}),[...Array.from(e.Added.values()),...Array.from(e.Updated.values()),...Array.from(e.Removed.values())]}function st(t){let{NodeAdded:e=[],NodeUpdated:n=[],NodeRemoved:i=[],EdgeAdded:s=[],EdgeUpdated:o=[],EdgeRemoved:r=[],ComboAdded:a=[],ComboUpdated:l=[],ComboRemoved:h=[]}=(0,ef.Z)(t,t=>t.type);return{add:{nodes:e,edges:s,combos:a},update:{nodes:n,edges:o,combos:l},remove:{nodes:i,edges:r,combos:h}}}class se extends iH{canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var t,e,n,i;let s=this.undoStack.pop();if(s){this.executeCommand(s);let o=null===(e=(t=this.options).beforeAddCommand)||void 0===e?void 0:e.call(t,s,!1);if(!1===o)return;this.redoStack.push(s),null===(i=(n=this.options).afterAddCommand)||void 0===i||i.call(n,s,!1),this.notify(S.UNDO,s)}return this}redo(){let t=this.redoStack.pop();return t&&(this.executeCommand(t,!1),this.undoStackPush(t),this.notify(S.REDO,t)),this}undoAndCancel(){let t=this.undoStack.pop();return t&&(this.executeCommand(t,!1),this.redoStack=[],this.notify(S.CANCEL,t)),this}undoStackPush(t){var e,n,i,s;let{stackSize:o}=this.options;0!==o&&this.undoStack.length>=o&&this.undoStack.shift();let r=null===(n=(e=this.options).beforeAddCommand)||void 0===n?void 0:n.call(e,t,!0);!1!==r&&(this.undoStack.push(t),null===(s=(i=this.options).afterAddCommand)||void 0===s||s.call(i,t,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(S.CLEAR,null)}notify(t,e){this.emitter.emit(t,{cmd:e}),this.emitter.emit(S.CHANGE,{cmd:e})}on(t,e){this.emitter.on(t,e)}destroy(){let{graph:t}=this.context;t.off(O.AFTER_DRAW,this.addCommand),t.off(O.BATCH_START,this.initBatchCommand),t.off(O.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}constructor(t,e){var n;super(t,Object.assign({},se.defaultOptions,e)),n=this,this.batchChanges=null,this.batchAnimation=!1,this.undoStack=[],this.redoStack=[],this.freezed=!1,this.executeCommand=function(t){var e,i,s;let o=!(arguments.length>1)||void 0===arguments[1]||arguments[1];n.freezed=!0,null===(i=(e=n.options).executeCommand)||void 0===i||i.call(e,t);let r=o?t.original:t.current;n.context.graph.addData(r.add),n.context.graph.updateData(r.update),n.context.graph.removeData(H(r.remove,!1)),null===(s=n.context.element)||void 0===s||s.draw({silence:!0,animation:t.animation}),n.freezed=!1},this.addCommand=t=>{var e;if(!this.freezed){if(t.type===O.AFTER_DRAW){let{dataChanges:n=[],animation:i=!0}=t.data;if(null===(e=this.context.batch)||void 0===e?void 0:e.isBatching){if(!this.batchChanges)return;this.batchChanges.push(n),this.batchAnimation&&(this.batchAnimation=i);return}this.batchChanges=[n],this.batchAnimation=i}this.undoStackPush(function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i={animation:e,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:s,update:o,remove:r}=st(i7(t));return["nodes","edges","combos"].forEach(t=>{o[t]&&o[t].forEach(e=>{var s,o;let r=Object.assign({},e.value),a=Object.assign({},e.original);if(n){let t=n.graph.getElementType(U(e.original)),i="edge"===t?"stroke":"fill",s=n.element.getElementComputedStyle(t,e.original);a=Object.assign(Object.assign({},e.original),{style:Object.assign({[i]:s[i]},e.original.style)})}(function t(e,n){for(let i in e)(0,P.Z)(e[i])&&!Array.isArray(e[i])&&null!==e[i]?(n[i]||(n[i]={}),t(e[i],n[i])):void 0===n[i]&&(n[i]=V(i))})(r,a),(s=i.current.update)[t]||(s[t]=[]),i.current.update[t].push(r),(o=i.original.update)[t]||(o[t]=[]),i.original.update[t].push(a)}),s[t]&&s[t].forEach(e=>{var n,s;let o=Object.assign({},e.value);(n=i.current.add)[t]||(n[t]=[]),i.current.add[t].push(o),(s=i.original.remove)[t]||(s[t]=[]),i.original.remove[t].push(o)}),r[t]&&r[t].forEach(e=>{var n,s;let o=Object.assign({},e.value);(n=i.current.remove)[t]||(n[t]=[]),i.current.remove[t].push(o),(s=i.original.add)[t]||(s[t]=[]),i.original.add[t].push(o)})}),i}(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(S.ADD,this.undoStack[this.undoStack.length-1])}},this.initBatchCommand=t=>{let{initiate:e}=t.data;if(this.batchAnimation=!1,e)this.batchChanges=[];else{let t=this.undoStack.pop();t||(this.batchChanges=null)}},this.emitter=new i5.Z;let{graph:i}=this.context;i.on(O.AFTER_DRAW,this.addCommand),i.on(O.BATCH_START,this.initBatchCommand),i.on(O.BATCH_END,this.addCommand)}}se.defaultOptions={stackSize:0};var sn=n(97359),si=n.n(sn);let ss=(t,e,n)=>{if("sharp"===n)return[["M",t[0]-e,t[1]-e],["L",t[0]+e,t[1]-e],["L",t[0]+e,t[1]+e],["L",t[0]-e,t[1]+e],["Z"]];let i=[e,e,0,0,0];return[["M",t[0],t[1]-e],["A",...i,t[0],t[1]+e],["A",...i,t[0],t[1]-e]]},so=(t,e,n)=>{let i=[e,e,0,0,0],s="sharp"===n?tS(t[0],tA(tR(tw(t[0],t[1])),e)):t[0],o="sharp"===n?tS(t[1],tA(tR(tw(t[1],t[0])),e)):t[1],r=tA(tR(tk(tw(s,o),!1)),e),a=tA(r,-1),l=tS(s,r),h=tS(o,r),d=tS(o,a),c=tS(s,a);return"sharp"===n?[["M",l[0],l[1]],["L",h[0],h[1]],["L",d[0],d[1]],["L",c[0],c[1]],["Z"]]:[["M",l[0],l[1]],["L",h[0],h[1]],["A",...i,d[0],d[1]],["L",c[0],c[1]],["A",...i,l[0],l[1]]]},sr=(t,e)=>{let n=t$(t).map((n,i)=>{let s=(i-2+t.length)%t.length,o=(i-1+t.length)%t.length,r=(i+1)%t.length,a=t[s],l=t[o],h=t[r],d=tw(a,l),c=tw(l,n),u=tw(n,h),p=(t,e)=>tP(t,e,!0)<Math.PI,g=p(d,c),f=p(c,u),m=t=>tA(tR(tk(t,!1)),e),y=m(c);return[{p:tL(g?tS(l,m(d)):tS(l,y)),concave:g&&l},{p:tL(f?tS(n,m(u)):tS(n,y)),concave:f&&n}]}),i=[e,e,0,0,0],s=n.findIndex((t,e)=>!n[(e-1+n.length)%n.length][0].concave&&!n[(e-1+n.length)%n.length][1].concave&&!t[0].concave&&!t[0].concave&&!t[1].concave),o=n.slice(s).concat(n.slice(0,s)),r=[];return o.flatMap((t,e)=>{let s=[],a=o[n.length-1];return 0===e&&s.push(["M",...a[1].p]),t[0].concave?r.push(t[0].p,t[1].p):s.push(["A",...i,...t[0].p]),t[1].concave?r.unshift(t[1].p):s.push(["L",...t[1].p]),3===r.length&&(s.pop(),s.push(["C",...r.flat()]),r=[]),s})},sa=(t,e)=>{let n=t$(t).map((e,n)=>{let i=t[(n+1)%t.length];return{p:e,v:tR(tw(i,e))}});return n.forEach((i,s)=>{let o=s>0?s-1:t.length-1,r=n[o].v,a=tR(tS(r,tA(i.v,tP(r,i.v,!0)<Math.PI?1:-1)));i.p=tS(i.p,tA(a,e))}),eT(n.map(t=>t.p))},sl=(t,e)=>{let n=t.map((n,i)=>{let s=t[0===i?t.length-1:i-1],o=tN(tA(tR(tk(tw(s,n),!1)),e));return[tS(s,o),tS(n,o)]}),i=n.flat(),s=i.map((t,e)=>{if(e%2==0)return null;let n=[i[(e-1)%i.length],i[e%i.length]],s=[i[(e+1)%i.length],i[(e+2)%i.length]];return tB(n,s,!0)}).filter(Boolean);return s.map((t,e)=>[0===e?"M":"L",t[0],t[1]]).concat([["Z"]])};var sh=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};class sd extends iH{bindEvents(){this.context.graph.on(O.AFTER_RENDER,this.drawHull),this.context.graph.on(O.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(t){let e=this.options,{members:n,padding:i,corner:s}=e,o=sh(e,["members","padding","corner"]);return Object.assign(Object.assign({},o),{d:this.getHullPath(t)})}getPadding(){let{graph:t}=this.context,e=this.hullMemberIds.reduce((e,n)=>{let{halfExtents:i}=t.getElementRenderBounds(n),s=Math.max(i[0],i[1]);return Math.max(e,s)},0);return e+this.options.padding}addMember(t){let e=Array.isArray(t)?t:[t];this.options.members=[...new Set([...this.options.members,...e])],this.shape.update({d:this.getHullPath()})}removeMember(t){let e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(t=>!e.includes(t)),e.some(t=>this.hullMemberIds.includes(t))&&this.shape.update({d:this.getHullPath()})}updateMember(t){this.options.members=(0,to.Z)(t)?t(this.options.members):t,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.context.graph.off(O.AFTER_DRAW,this.drawHull),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}constructor(t,e){var n;super(t,Object.assign({},sd.defaultOptions,e)),n=this,this.hullMemberIds=[],this.drawHull=()=>{if(this.shape){let t=!(0,R.Z)(this.optionsCache,this.options);this.shape.update(this.getHullStyle(t))}else this.shape=new eP({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);this.optionsCache=Object.assign({},this.options)},this.updateHullPath=t=>{this.shape&&this.options.members.includes(U(t.data))&&this.shape.update({d:this.getHullPath(!0)})},this.getHullPath=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{graph:e}=n.context,i=n.getMember();if(0===i.length)return"";let s=i.map(t=>e.getNodeData(t)),o=si()(s.map(tF),n.options.concavity).slice(1).reverse(),r=o.flatMap(t=>s.filter(e=>(0,R.Z)(tF(e),t)).map(U));return(0,R.Z)(r,n.hullMemberIds)&&!t||(n.hullMemberIds=r,n.path=function(t,e,n){if(1===t.length)return ss(t[0],e,n);if(2===t.length)return so(t,e,n);switch(n){case"smooth":return sa(t,e);case"sharp":return sl(t,e);default:return sr(t,e)}}(o,n.getPadding(),n.options.corner)),n.path},this.bindEvents()}}sd.defaultOptions={members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2};var sc=n(67673),su=n(43228),sp=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};class sg extends iH{update(t){super.update(t),this.clear(),this.createElement()}clear(){var t;null===(t=this.element)||void 0===t||t.destroy(),this.element=null,this.draw=!1}updateElement(){if(!this.element)return;let t=this.element.getChildByIndex(0);t.update({itemMarkerOpacity:t=>{let{id:e}=t;return!this.selectedItems.length||this.selectedItems.includes(e)?1:.5},itemLabelOpacity:t=>{let{id:e}=t;return!this.selectedItems.length||this.selectedItems.includes(e)?1:.5}})}destroy(){this.clear(),this.context.graph.off(O.AFTER_DRAW,this.createElement),super.destroy()}constructor(t,e){super(t,Object.assign({},sg.defaultOptions,e)),this.typePrefix="__data__",this.element=null,this.draw=!1,this.fieldMap={node:new Map,edge:new Map,combo:new Map},this.selectedItems=[],this.bindEvents=()=>{let{graph:t}=this.context;t.on(O.AFTER_DRAW,this.createElement)},this.changeState=(t,e)=>{let{graph:n}=this.context,{typePrefix:i}=this,s=(0,ee.Z)(t,[i,"id"]),o=(0,ee.Z)(t,[i,"style","labelText"]),[r]=s.split("__"),a=this.fieldMap[r].get(o)||[];n.setElementState(Object.fromEntries(null==a?void 0:a.map(t=>[t,e])))},this.click=t=>{if("hover"===this.options.trigger)return;let e=(0,ee.Z)(t,[this.typePrefix,"id"]);this.selectedItems.includes(e)?(this.selectedItems=this.selectedItems.filter(t=>t!==e),this.changeState(t,[])):(this.selectedItems.push(e),this.changeState(t,"selected"))},this.mouseleave=t=>{"click"!==this.options.trigger&&(this.selectedItems=[],this.changeState(t,[]))},this.mouseenter=t=>{if("click"===this.options.trigger)return;let e=(0,ee.Z)(t,[this.typePrefix,"id"]);this.selectedItems.includes(e)?this.selectedItems=this.selectedItems.filter(t=>t!==e):(this.selectedItems.push(e),this.changeState(t,"active"))},this.setFieldMap=(t,e,n)=>{if(!t)return;let i=this.fieldMap[n];if(i){if(i.has(t)){let n=i.get(t);n&&(n.push(e),i.set(t,n))}else i.set(t,[e])}},this.getEvents=()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}),this.getMarkerData=(t,e)=>{if(!t)return[];let{model:n,element:i,graph:s}=this.context,{nodes:o,edges:r,combos:a}=n.getData(),l={},h=e=>(0,to.Z)(t)?t(e):t,d={node:"circle",edge:"line",combo:"rect"},c={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},u=(t,e)=>{let n=null==i?void 0:i.getElementComputedStyle(t,e);return n},p=(t,e)=>{t.forEach(t=>{let{id:n}=t,s=(0,ee.Z)(t,["data",h(t)]),o=(null==i?void 0:i.getElementType(e,t))||"circle",r=u(e,t),a=("edge"===e?null==r?void 0:r.stroke:null==r?void 0:r.fill)||"#1783ff";n&&s&&s.replace(/\s+/g,"")&&(this.setFieldMap(s,n,e),l[s]||(l[s]={id:"".concat(e,"__").concat(n),label:s,marker:c[o]||d[e],elementType:e,lineWidth:1,stroke:a,fill:a}))})};switch(e){case"node":p(o,"node");break;case"edge":p(r,"edge");break;case"combo":p(a,"combo");break;default:return[]}return Object.values(l)},this.layout=t=>{let{flexDirection:e,alignItems:n,justifyContent:i}={flexDirection:"row",alignItems:"flex-end",justifyContent:"center"},s={top:["row","flex-start","center"],bottom:["row","flex-end","center"],left:["column","flex-start","center"],right:["column","flex-end","center"]};return t in s&&([e,n,i]=s[t]),{display:"flex",flexDirection:e,justifyContent:i,alignItems:n}},this.createElement=()=>{if(this.draw){this.updateElement();return}let{canvas:t}=this.context,[e,n]=t.getSize(),i=this.options,{width:s=e,height:o=n,nodeField:r,edgeField:a,comboField:l,trigger:h,position:d}=i,c=sp(i,["width","height","nodeField","edgeField","comboField","trigger","position"]),u=this.getMarkerData(r,"node"),p=this.getMarkerData(a,"edge"),g=this.getMarkerData(l,"combo"),f=[...u,...g,...p],m=this.layout(d),y=new sc.A({style:Object.assign({width:s,height:o},m)}),v=Object.assign({width:s,height:o,data:f,itemMarkerLineWidth:t=>{let{lineWidth:e}=t;return e},itemMarker:t=>{let{marker:e}=t;return e},itemMarkerStroke:t=>{let{stroke:e}=t;return e},itemMarkerFill:t=>{let{fill:e}=t;return e},gridCol:u.length},c,this.getEvents()),b=new su.W({className:"legend",style:v});y.appendChild(b),t.appendChild(y),this.element=y,this.draw=!0},this.bindEvents()}}sg.defaultOptions={position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16};var sf=n(31922);class sm extends iH{update(t){this.unbindEvents(),super.update(t),"delay"in t&&this.setOnRender(),this.bindEvents()}setOnRender(){this.onRender=(0,it.Z)(()=>{this.renderMinimap(),this.renderMask()},this.options.delay,!0)}bindEvents(){let{graph:t}=this.context;t.on(O.AFTER_DRAW,this.onDraw),t.on(O.AFTER_RENDER,this.onRender),t.on(O.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){let{graph:t}=this.context;t.off(O.AFTER_DRAW,this.onDraw),t.off(O.AFTER_RENDER,this.onRender),t.off(O.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){let t=this.getElements(),e=this.initCanvas();this.setShapes(e,t)}getElements(){let{filter:t}=this.options,{model:e}=this.context,n=e.getData();if(!t)return n;let{nodes:i,edges:s,combos:o}=n;return{nodes:i.filter(e=>t(U(e),"node")),edges:s.filter(e=>t(U(e),"edge")),combos:o.filter(e=>t(U(e),"combo"))}}setShapes(t,e){let{nodes:n,edges:i,combos:s}=e,{shape:o}=this.options,{element:r}=this.context;if("key"===o){let e=new Set,o=n=>{let i=U(n);e.add(i);let s=r.getElement(i);if(!s)return;let o=s.getShape("key"),a=this.shapes.get(i)||o.cloneNode();a.setPosition(o.getPosition()),s.style.zIndex&&(a.style.zIndex=s.style.zIndex),a.id=s.id,this.shapes.has(i)?Object.entries(o.attributes).forEach(t=>{let[e,n]=t;a.style[e]!==n&&(a.style[e]=n)}):(t.appendChild(a),this.shapes.set(i,a))};i.forEach(o),s.forEach(o),n.forEach(o),this.shapes.forEach((n,i)=>{e.has(i)||(t.removeChild(n),this.shapes.delete(i))});return}let a=(t,e)=>{let n=r.getElement(t),i=n.getPosition();return e.setPosition(i),e};t.removeChildren(),i.forEach(e=>t.appendChild(o(U(e),"edge"))),s.forEach(e=>{t.appendChild(a(U(e),o(U(e),"combo")))}),n.forEach(e=>{t.appendChild(a(U(e),o(U(e),"node")))})}calculatePosition(){let{position:t,size:[e,n]}=this.options,{canvas:i}=this.context,[s,o]=i.getSize(),[r,a]=t_(t);return[r*(s-e),a*(o-n)]}createContainer(){let{container:t,className:e,size:[n,i],containerStyle:s}=this.options;if(t)return"string"==typeof t?document.querySelector(t):t;let o=document.createElement("div");o.classList.add("g6-minimap"),e&&o.classList.add(e);let[r,a]=this.calculatePosition();return Object.assign(o.style,Object.assign({position:"absolute",left:r+"px",top:a+"px",width:n+"px",height:i+"px"},s)),this.context.canvas.getContainer().appendChild(o)}initCanvas(){let{renderer:t,size:[e,n]}=this.options;if(this.canvas){let{width:i,height:s}=this.canvas.getConfig();(e!==i||n!==s)&&this.canvas.resize(e,n),t&&this.canvas.setRenderer(t)}else{let i=document.createElement("div"),s=this.createContainer();this.container=s,s.appendChild(i),this.canvas=new A.Xz({width:e,height:n,container:i,renderer:t||new eq.Th})}return this.setCamera(),this.canvas}createLandmark(t,e,n){let i="".concat(t.join(","),"-").concat(e.join(","),"-").concat(n);if(this.landmarkMap.has(i))return this.landmarkMap.get(i);let s=this.canvas.getCamera(),o=s.createLandmark(i,{position:t,focalPoint:e,zoom:n});return this.landmarkMap.set(i,o),o}setCamera(){var t;let{canvas:e}=this.context,n=null===(t=this.canvas)||void 0===t?void 0:t.getCamera();if(!n)return;let{size:[i,s],padding:o}=this.options,[r,a,l,h]=th(o),{min:d,max:c,center:u}=e.getBounds("elements"),p=c[0]-d[0],g=c[1]-d[1],f=this.createLandmark(u,u,Math.min((i-h-a)/p,(s-r-l)/g));n.gotoLandmark(f,0)}get maskBBox(){let{canvas:t}=this.context,e=t.getSize(),n=t.getCanvasByViewport([0,0]),i=t.getCanvasByViewport(e),s=this.canvas.canvas2Viewport(tV(n)),o=this.canvas.canvas2Viewport(tV(i)),r=o.x-s.x,a=o.y-s.y;return[s.x,s.y,r,a]}calculateMaskBBox(){let{size:[t,e]}=this.options,[n,i,s,o]=this.maskBBox;return n<0&&(s=sy(s+n,t),n=0),i<0&&(o=sy(o+i,e),i=0),n+s>t&&(s=sv(t-n,0)),i+o>e&&(o=sv(e-i,0)),[sy(n,t),sy(i,e),sv(s,0),sv(o,0)]}renderMask(){let{maskStyle:t}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart)),this.container.appendChild(this.mask),Object.assign(this.mask.style,Object.assign(Object.assign({},t),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}updateMask(){if(!this.mask)return;let[t,e,n,i]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:e+"px",left:t+"px",width:n+"px",height:i+"px"})}destroy(){var t;this.unbindEvents(),this.canvas.destroy(),null===(t=this.mask)||void 0===t||t.remove(),super.destroy()}constructor(t,e){super(t,Object.assign({},sm.defaultOptions,e)),this.onDraw=t=>{var e;null!==(e=null==t?void 0:t.data)&&void 0!==e&&e.render||this.onRender()},this.shapes=new Map,this.landmarkMap=new Map,this.mask=null,this.isMaskDragging=!1,this.onMaskDragStart=t=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(t.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))},this.onMaskDrag=t=>{if(!this.mask||!this.isMaskDragging)return;let{size:[e,n]}=this.options,{movementX:i,movementY:s}=t,{left:o,top:r,width:a,height:l}=this.mask.style,[,,h,d]=this.maskBBox,c=parseInt(o)+i,u=parseInt(r)+s,p=parseInt(a),g=parseInt(l);c<0&&(c=0),u<0&&(u=0),c+p>e&&(c=sv(e-p,0)),u+g>n&&(u=sv(n-g,0)),p<h&&(i>0?(c=sv(c-i,0),p=sy(p+i,e)):i<0&&(p=sy(p-i,e))),g<d&&(s>0?(u=sv(u-s,0),g=sy(g+s,n)):s<0&&(g=sy(g-s,n))),Object.assign(this.mask.style,{left:c+"px",top:u+"px",width:p+"px",height:g+"px"});let f=parseInt(o)-c,m=parseInt(r)-u;if(0===f&&0===m)return;let y=this.context.canvas.getCamera().getZoom(),v=this.canvas.getCamera().getZoom(),b=y/v;this.context.graph.translateBy([f*b,m*b],!1)},this.onMaskDragEnd=t=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(t.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))},this.onTransform=(0,sf.Z)(()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())},32,{leading:!0}),this.setOnRender(),this.bindEvents()}}sm.defaultOptions={size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"},delay:128};let sy=(t,e)=>Math.min(t,e),sv=(t,e)=>Math.max(t,e);var sb=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})};let sE={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"};class sx extends iH{getNodes(){var t;let{filter:e}=this.options,n=(null===(t=this.context.element)||void 0===t?void 0:t.getNodes())||[],i=n.filter(t=>{var e;return"hidden"!==(0,ee.Z)(t,["style","visibility"])&&(null===(e=this.context.viewport)||void 0===e?void 0:e.isInViewport(t.getRenderBounds()))});return e?i.filter(t=>e(t)):i}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(t){let{lineWidth:e}=this.options["".concat(t,"LineStyle")];return+(e||sE.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(t){let{verticalX:e,verticalMinY:n,verticalMaxY:i,horizontalY:s,horizontalMinX:o,horizontalMaxX:r}=t,[a,l]=this.context.canvas.getSize(),{offset:h}=this.options;null!==s?Object.assign(this.horizontalLine.style,{x1:h===1/0?0:o-h,y1:s,x2:h===1/0?a:r+h,y2:s,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",null!==e?Object.assign(this.verticalLine.style,{x1:e,y1:h===1/0?0:n-h,x2:e,y2:h===1/0?l:i+h,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(t){let e=this.context.graph.getZoom();return tC([t.dx,t.dy],e)}bindEvents(){return sb(this,void 0,void 0,function*(){let{graph:t}=this.context;t.on(w.DRAG_START,this.onDragStart),t.on(w.DRAG,this.onDrag),t.on(w.DRAG_END,this.onDragEnd)})}unbindEvents(){let{graph:t}=this.context;t.off(w.DRAG_START,this.onDragStart),t.off(w.DRAG,this.onDrag),t.off(w.DRAG_END,this.onDragEnd)}destroyElements(){var t,e;null===(t=this.horizontalLine)||void 0===t||t.destroy(),null===(e=this.verticalLine)||void 0===e||e.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},sx.defaultOptions,e)),this.initSnapline=()=>{let t=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=t.appendChild(new A.x1({style:Object.assign(Object.assign({},sE),this.options.horizontalLineStyle)}))),this.verticalLine||(this.verticalLine=t.appendChild(new A.x1({style:Object.assign(Object.assign({},sE),this.options.verticalLineStyle)})))},this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!0,this.autoSnapToLine=(t,e,n)=>sb(this,void 0,void 0,function*(){let{verticalX:i,horizontalY:s}=n,{tolerance:o}=this.options,{min:[r,a],max:[l,h],center:[d,c]}=e,u=0,p=0;null!==i&&(sO(l,i)<o&&(u=i-l),sO(r,i)<o&&(u=i-r),sO(d,i)<o&&(u=i-d),0!==u&&(this.isVerticalSticking=!0)),null!==s&&(sO(h,s)<o&&(p=s-h),sO(a,s)<o&&(p=s-a),sO(c,s)<o&&(p=s-c),0!==p&&(this.isHorizontalSticking=!0)),(0!==u||0!==p)&&(yield this.context.graph.translateElementBy({[t]:[u,p]},!1))}),this.enableSnap=t=>{let{target:e}=t;if(this.isHorizontalSticking||this.isVerticalSticking){let[n,i]=this.getDelta(t);if(this.isHorizontalSticking&&this.isVerticalSticking&&.5>=Math.abs(n)&&.5>=Math.abs(i))return this.context.graph.translateElementBy({[e.id]:[-n,-i]},!1),!1;if(this.isHorizontalSticking&&.5>=Math.abs(i))return this.context.graph.translateElementBy({[e.id]:[0,-i]},!1),!1;if(this.isVerticalSticking&&.5>=Math.abs(n))return this.context.graph.translateElementBy({[e.id]:[-n,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout(()=>{this.enableStick=!0},200)}return this.enableStick},this.calcSnaplineMetadata=(t,e)=>{let{tolerance:n,shape:i}=this.options,{min:[s,o],max:[r,a],center:[l,h]}=e,d=null,c=null,u=null,p=null,g=null,f=null;return this.getNodes().some(e=>{if((0,R.Z)(t.id,e.id))return!1;let m=sS(e,i).getRenderBounds(),{min:[y,v],max:[b,E],center:[x,O]}=m;return null===d&&(sO(x,l)<n?d=x:sO(y,s)<n?d=y:sO(y,r)<n?d=y:sO(b,r)<n?d=b:sO(b,s)<n&&(d=b),null!==d&&(c=Math.min(v,o),u=Math.max(E,a))),null===p&&(sO(O,h)<n?p=O:sO(v,o)<n?p=v:sO(v,a)<n?p=v:sO(E,a)<n?p=E:sO(E,o)<n&&(p=E),null!==p&&(g=Math.min(y,s),f=Math.max(b,r))),null!==d&&null!==p}),{verticalX:d,verticalMinY:c,verticalMaxY:u,horizontalY:p,horizontalMinX:g,horizontalMaxX:f}},this.onDragStart=()=>{this.initSnapline()},this.onDrag=t=>sb(this,void 0,void 0,function*(){let{target:e}=t;if(this.options.autoSnap){let e=this.enableSnap(t);if(!e)return}let n=sS(e,this.options.shape).getRenderBounds(),i=this.calcSnaplineMetadata(e,n);this.hideSnapline(),(null!==i.verticalX||null!==i.horizontalY)&&this.updateSnapline(i),this.options.autoSnap&&(yield this.autoSnapToLine(e.id,n,i))}),this.onDragEnd=()=>{this.hideSnapline()},this.bindEvents()}}sx.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0};let sO=(t,e)=>Math.abs(t-e),sS=(t,e)=>"function"==typeof e?e(t):t.getShape(e);var sw=n(57069),sD=n(83262),sC=n(91984),sA=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};let sM=["timestamp","time","date","datetime"];class sT extends iH{get padding(){return th(this.options.padding)}play(){var t;null===(t=this.timebar)||void 0===t||t.play()}pause(){var t;null===(t=this.timebar)||void 0===t||t.pause()}forward(){var t;null===(t=this.timebar)||void 0===t||t.forward()}backward(){var t;null===(t=this.timebar)||void 0===t||t.backward()}reset(){var t;null===(t=this.timebar)||void 0===t||t.reset()}update(t){super.update(t),this.backup(),Object.keys(t).forEach(t=>{"position"===t?this.upsertWrapper():this.upsertTimebar()})}backup(){this.originalData=sR(this.context.graph.getData())}upsertTimebar(){let{canvas:t}=this.context,e=this.options,{onChange:n,timebarType:i,data:s,x:o,y:r,width:a,height:l,mode:h}=e,d=sA(e,["onChange","timebarType","data","x","y","width","height","mode"]),c=t.getSize(),[u]=this.padding;this.upsertCanvas().ready.then(()=>{var t;let e=Object.assign(Object.assign({x:c[0]/2-a/2,y:u,onChange:t=>{let e=((0,sD.Z)(t)?t:[t,t]).map(t=>(0,sC.Z)(t)?t.getTime():t);"modify"===this.options.mode?this.filterElements(e):this.hiddenElements(e),null==n||n(e)}},d),{data:s.map(t=>(0,eV.Z)(t)?{time:t,value:0}:t),width:a,height:l,type:i});this.timebar?this.timebar.update(e):(this.timebar=new sw.s({style:e}),null===(t=this.canvas)||void 0===t||t.appendChild(this.timebar))})}upsertWrapper(){var t;if(!this.wrapper){let t=document.createElement("div");t.style.position="absolute",this.wrapper=t}let{x:e,y:n,className:i,position:s}=this.options;return i&&(this.wrapper.className=i),(0,eV.Z)(e)||(0,eV.Z)(n)?Object.assign(this.wrapper.style,{left:"".concat(null!=e?e:0,"px"),top:"".concat(null!=n?n:0,"px")}):Object.assign(this.wrapper.style,{["top"===s?"bottom":"top"]:"unset",["top"===s?"top":"bottom"]:"0px"}),null===(t=this.context.canvas.getContainer())||void 0===t||t.appendChild(this.wrapper),this.wrapper}upsertCanvas(){var t,e;let n=this.upsertWrapper();if(this.canvas)return this.canvas;let{height:i}=this.options,[s]=this.context.canvas.getSize(),[o,,r]=this.padding;return this.canvas=new A.Xz({container:n,width:s,height:i+o+r,renderer:(null===(e=(t=this.context.options).renderer)||void 0===e?void 0:e.call(t,"main"))||new eq.Th,supportsMutipleCanvasesInOneContainer:!0}),this.canvas}filterElements(t){var e,n,i,s;return e=this,n=void 0,i=void 0,s=function*(){var e;if(!this.originalData)return;let{elementTypes:n,getTime:i}=this.options,{graph:s,element:o}=this.context,r=sR(this.originalData);n.forEach(e=>{let n="".concat(e,"s");r[n]=(this.originalData[n]||[]).filter(e=>{let n=i(e);return!!sP(n,t)})});let a=[...r.nodes,...r.combos].map(t=>U(t));r.edges=r.edges.filter(t=>{let e=t.source,n=t.target;return a.includes(e)&&a.includes(n)}),s.setData(r),yield null===(e=o.draw({animation:!1,silence:!0}))||void 0===e?void 0:e.finished},new(i||(i=Promise))(function(t,o){function r(t){try{l(s.next(t))}catch(t){o(t)}}function a(t){try{l(s.throw(t))}catch(t){o(t)}}function l(e){var n;e.done?t(e.value):((n=e.value)instanceof i?n:new i(function(t){t(n)})).then(r,a)}l((s=s.apply(e,n||[])).next())})}hiddenElements(t){let{graph:e}=this.context,{elementTypes:n,getTime:i}=this.options,s=[],o=[];n.forEach(e=>{var n;let r=(null===(n=this.originalData)||void 0===n?void 0:n["".concat(e,"s")])||[];r.forEach(e=>{let n=U(e),r=i(e);sP(r,t)?o.push(n):s.push(n)})}),e.hideElement(s,!1),e.showElement(o,!1)}destroy(){var t,e,n;let{graph:i}=this.context;this.originalData&&i.setData(Object.assign({},this.originalData)),null===(t=this.timebar)||void 0===t||t.destroy(),null===(e=this.canvas)||void 0===e||e.destroy(),null===(n=this.wrapper)||void 0===n||n.remove(),this.originalData=void 0,this.wrapper=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}constructor(t,e){super(t,Object.assign({},sT.defaultOptions,e)),this.backup(),this.upsertTimebar()}}sT.defaultOptions={position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:t=>sk(t,sM,void 0),loop:!1};let sR=t=>{let{nodes:e=[],edges:n=[],combos:i=[]}=t;return{nodes:[...e],edges:[...n],combos:[...i]}},sP=(t,e)=>{if((0,eV.Z)(e))return t===e;let[n,i]=e;return t>=n&&t<=i},sk=(t,e,n)=>{var i;for(let n=0;n<e.length;n++){let s=e[n],o=null===(i=t.data)||void 0===i?void 0:i[s];if(o)return o}return n};var sL=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})};class sN extends iH{update(t){let e=Object.create(null,{update:{get:()=>super.update}});return sL(this,void 0,void 0,function*(){e.update.call(this,t);let{className:n,position:i,style:s}=this.options;this.$element.className="g6-toolbar ".concat(n||""),Object.assign(this.$element.style,s,function(t){let e={top:"unset",right:"unset",bottom:"unset",left:"unset"},n=t.split("-");return n.forEach(t=>{e[t]="8px"}),e.flexDirection=t.startsWith("top")||t.startsWith("bottom")?"row":"column",e}(i)),this.$element.innerHTML=yield this.getDOMContent()})}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return sL(this,void 0,void 0,function*(){let t=yield this.options.getItems();return t.map(t=>'\n          <div class="g6-toolbar-item" value="'.concat(t.value,'">\n            <svg aria-hidden="true" focusable="false">\n              <use xlink:href="#').concat(t.id,'"></use>\n            </svg>\n          </div>')).join("")})}constructor(t,e){super(t,Object.assign({},sN.defaultOptions,e)),this.$element=iG("toolbar",!1),this.onToolbarItemClick=t=>{let{onClick:e}=this.options;if(t.target instanceof Element&&t.target.className.includes("g6-toolbar-item")){let n=t.target.getAttribute("value");null==e||e(n,t.target)}};let n=this.context.canvas.getContainer();this.$element.style.display="flex",n.appendChild(this.$element),iU("g6-toolbar-css","style",{},"\n  .g6-toolbar {\n    position: absolute;\n    z-index: 100;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: center;\n    border-radius: 4px;\n    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);\n    opacity: 0.65;\n  }\n  .g6-toolbar .g6-toolbar-item {\n    display: inline-block;\n    width: 16px;\n    height: 16px;\n    padding: 4px;\n    cursor: pointer;\n    box-sizing: content-box;\n  }\n\n  .g6-toolbar .g6-toolbar-item:hover {\n    background-color: #f0f0f0;\n  }\n\n  .g6-toolbar .g6-toolbar-item svg {\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n  }\n",document.head),iU("g6-toolbar-svgicon","div",{display:"none"},'\n  <svg>\n    <symbol id="zoom-in" viewBox="64 64 896 896">\n      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>\n    </symbol>\n    <symbol id="zoom-out" viewBox="64 64 896 896">\n      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>\n    </symbol>\n    <symbol id="edit" viewBox="64 64 896 896">\n      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>\n    </symbol>\n    <symbol id="delete" viewBox="64 64 896 896">\n      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>\n    </symbol>\n    <symbol id="redo" viewBox="64 64 896 896">\n      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>\n    </symbol>\n    <symbol id="undo" viewBox="64 64 896 896">\n      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>\n    </symbol>\n    <symbol id="export" viewBox="64 64 896 896">\n      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>\n    </symbol>\n    <symbol id="auto-fit" viewBox="64 64 896 896">\n      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>\n      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>\n    </symbol>\n    <symbol id="reset" viewBox="64 64 896 896">\n      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>\n    </symbol>\n    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">\n      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>\n    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">\n      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>\n  </svg>\n'),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(e)}}sN.defaultOptions={position:"top-left"};var sj=n(60953);class sI extends iH{getEvents(){return"click"===this.options.trigger?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerenter":this.onPointerEnter,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerenter":this.onPointerEnter,"edge:pointermove":this.onPointerMove,"combo:pointerenter":this.onPointerEnter,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(t){var e;this.unbindEvents(),super.update(t),this.tooltipElement&&(null===(e=this.container)||void 0===e||e.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){let{canvas:t}=this.context,e=t.getContainer();e&&(this.container=e,this.tooltipElement=this.initTooltip())}unbindEvents(){let{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(n=>{t.off(n,e[n])})}bindEvents(){let{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(n=>{t.on(n,e[n])})}get tooltipStyleProps(){let{canvas:t}=this.context,{center:e}=t.getBounds(),n=t.getContainer(),{top:i,left:s}=n.getBoundingClientRect(),{style:o,position:r,enterable:a,container:l={x:-s,y:-i},title:h,offset:d}=this.options,[c,u]=e,[p,g]=t.getSize();return{x:c,y:u,container:l,title:h,bounding:{x:0,y:0,width:p,height:g},position:r,enterable:a,offset:d,style:o}}destroy(){var t;this.unbindEvents(),this.tooltipElement&&(null===(t=this.container)||void 0===t||t.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}constructor(t,e){super(t,Object.assign({},sI.defaultOptions,e)),this.currentTarget=null,this.tooltipElement=null,this.container=null,this.isEnable=t=>{let{enable:e}=this.options;return"function"==typeof e?e(t):e},this.onClick=t=>{let{target:{id:e}}=t;this.currentTarget===e?(this.hide(t),this.currentTarget=null):(this.currentTarget=e,this.show(t))},this.onPointerMove=t=>{let{target:e}=t;this.currentTarget&&e.id!==this.currentTarget&&this.show(t)},this.onPointerLeave=t=>{this.hide(t),this.currentTarget=null},this.onCanvasMove=t=>{this.hide(t),this.currentTarget=null},this.onPointerEnter=t=>{this.show(t)},this.showById=t=>{this.show({target:{id:t}})},this.getElementData=(t,e)=>{let{model:n}=this.context;switch(e){case"node":return n.getNodeData([t]);case"edge":return n.getEdgeData([t]);case"combo":return n.getComboData([t]);default:return[]}},this.show=t=>{let e,n;let{client:i,target:{id:s}}=t;if(n2(t.target)||!this.tooltipElement||!this.isEnable(t))return;let o=this.context.graph.getElementType(s),{getContent:r,title:a}=this.options;this.currentTarget=s;let l=this.getElementData(s,o);if(i)e=i.x,n=i.y;else{let t=(0,ee.Z)(l,"0.style",{x:0,y:0});e=t.x,n=t.y}let h={};if(r)h.content=r(t,l);else{let t=this.context.graph.getElementRenderStyle(s),e="node"===o?t.fill:t.stroke;h={title:a||o,data:l.map(t=>({name:"ID",value:t.id||"".concat(t.source," -> ").concat(t.target),color:e}))}}this.tooltipElement.update(Object.assign(Object.assign(Object.assign({},this.tooltipStyleProps),{x:e,y:n,style:{".tooltip":{visibility:"visible"}}}),h))},this.hide=t=>{var e;if(!t){null===(e=this.tooltipElement)||void 0===e||e.hide();return}if(!this.tooltipElement||!this.currentTarget)return;let{client:{x:n,y:i}}=t;this.tooltipElement.hide(n,i)},this.initTooltip=()=>{var t;let e=new sj.u({className:"tooltip",style:this.tooltipStyleProps});return null===(t=this.container)||void 0===t||t.appendChild(e.HTMLTooltipElement),e},this.render(),this.bindEvents()}}sI.defaultOptions={trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}};var sB=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})};function s_(t,e){i||(i=document.createElement("canvas")),i.width=t,i.height=e;let n=i.getContext("2d");return n.clearRect(0,0,t,e),i}var sF=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};class sz extends iH{update(t){var e,n,i,s;let o=Object.create(null,{update:{get:()=>super.update}});return e=this,n=void 0,i=void 0,s=function*(){o.update.call(this,t);let e=this.options,{width:n,height:i,text:s,imageURL:r}=e,a=sF(e,["width","height","text","imageURL"]);Object.keys(a).forEach(e=>{e.startsWith("background")&&(this.$element.style[e]=t[e])});let l=r?yield function(t,e,n,i){return sB(this,void 0,void 0,function*(){let s=s_(t,e),o=s.getContext("2d"),{rotate:r,opacity:a}=i;r&&o.rotate(r),a&&(o.globalAlpha=a);let l=new Image;return l.crossOrigin="anonymous",l.src=n,new Promise(n=>{l.onload=function(){let i=t>l.width?(t-l.width)/2:0,r=e>l.height?(e-l.height)/2:0;o.drawImage(l,0,0,l.width,l.height,i,r,t-2*i,e-2*r),n(s.toDataURL())}})})}(n,i,r,a):yield function(t,e,n,i){return sB(this,void 0,void 0,function*(){let s=s_(t,e),o=s.getContext("2d"),{rotate:r,opacity:a,textFill:l,textFontSize:h,textFontFamily:d,textFontVariant:c,textFontWeight:u,textAlign:p,textBaseline:g}=i;return o.textAlign=p,o.textBaseline=g,o.translate(t/2,e/2),o.font="".concat(h,"px ").concat(d," ").concat(c," ").concat(u),r&&o.rotate(r),a&&(o.globalAlpha=a),l&&(o.fillStyle=l,o.fillText("".concat(n),0,0)),s.toDataURL()})}(n,i,s,a);this.$element.style.backgroundImage="url(".concat(l,")")},new(i||(i=Promise))(function(t,o){function r(t){try{l(s.next(t))}catch(t){o(t)}}function a(t){try{l(s.throw(t))}catch(t){o(t)}}function l(e){var n;e.done?t(e.value):((n=e.value)instanceof i?n:new i(function(t){t(n)})).then(r,a)}l((s=s.apply(e,n||[])).next())})}destroy(){super.destroy(),this.$element.remove()}constructor(t,e){super(t,Object.assign({},sz.defaultOptions,e)),this.$element=iG("watermark");let n=this.context.canvas.getContainer();n.appendChild(this.$element),this.update(e)}}sz.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"};let sZ=["#7E92B5","#F4664A","#FFBE3A"],sW={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},sV={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function sK(t){let{bgColor:e,textColor:n,nodeColor:i,nodeColorDisabled:s,nodeStroke:o,nodeHaloStrokeOpacityActive:r=.15,nodeHaloStrokeOpacitySelected:a=.25,nodeOpacityDisabled:l=.06,nodeIconOpacityInactive:h=.85,nodeOpacityInactive:d=.25,nodeBadgePalette:c=sZ,nodePaletteOptions:u=sW,edgeColor:p,edgeColorDisabled:g,edgePaletteOptions:f=sV,comboColor:m,comboColorDisabled:y,comboStroke:v,comboStrokeDisabled:b,edgeColorInactive:E}=t;return{background:e,node:{palette:u,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:c,fill:i,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:n,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:i,portLineWidth:1,portStroke:o,portStrokeOpacity:.65,size:32,stroke:o,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:a,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:o},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:r},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:o,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:d,donutOpacity:d,fillOpacity:d,iconOpacity:h,labelFill:n,labelFillOpacity:d,strokeOpacity:d},disabled:{badgeBackgroundOpacity:.25,donutOpacity:l,fill:s,fillOpacity:l,iconFill:s,iconOpacity:.25,labelFill:n,labelFillOpacity:.25,strokeOpacity:l}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:f,style:{badgeBackgroundFill:p,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:n,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:p,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:E,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:g,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:e,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:m,halo:!1,haloLineWidth:12,haloStroke:v,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:n,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:v},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:y,fillOpacity:.25,labelOpacity:.25,stroke:b,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}let sG=sK({bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:{type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"}),sU=sK({bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"});class sH extends ti{beforeDraw(t,e){return t}afterLayout(){}}function sY(t,e,n,i,s){let o=U(i),r="".concat(n,"s"),a=s?i:t.add[r].get(o)||t.update[r].get(o)||t.remove[r].get(o)||i;Object.entries(t).forEach(t=>{let[n,i]=t;e===n?i[r].set(o,a):i[r].delete(o)})}let sX=(t,e,n,i)=>{let s="".concat(n,"s"),o=U(i);t.add[s].has(o)||t.update[s].has(o)||t[e][s].set(U(i),i)};class s${constructor(t){this.type=t}}class sq extends s${constructor(t,e){super(t),this.data=e}}class sQ extends s${constructor(t,e,n,i){super(t),this.animationType=e,this.animation=n,this.data=i}}class sJ extends s${constructor(t,e,n){super(t),this.elementType=e,this.data=n}}class s0 extends s${constructor(t,e){super(t),this.data=e}}function s1(t,e){t.emit(e.type,e)}class s3{getTasks(){let t=[...this.tasks];return this.tasks=[],t}add(t,e){this.tasks.push([t,e])}animate(t,e,n){var i,s,o;null===(i=null==e?void 0:e.before)||void 0===i||i.call(e);let r=this.getTasks().map(e=>{var i,s,o;let[r,a]=e,{element:l,elementType:h,stage:d}=r,c=function(t,e,n,i){var s,o;let{animation:r}=t,a=null===(s=null==t?void 0:t[e])||void 0===s?void 0:s.animation;if(!1===a)return[];let l=null==a?void 0:a[n];if(!1===l||!1===r||!1===i)return[];let h=null===(o=z(t)[e])||void 0===o?void 0:o.animation,d=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(function(t){if("string"==typeof t){let e=B(D.ANIMATION,t);return e||(F.warn("The animation of ".concat(t," is not registered.")),[])}return t})(t).map(t=>Object.assign(Object.assign(Object.assign(Object.assign({},L),(0,P.Z)(r)&&r),t),(0,P.Z)(i)&&i))};if(l)return d(l);if(!h)return[];let c=h[n];return!1===c?[]:d(c)}(this.context.options,h,d,t);null===(i=null==a?void 0:a.before)||void 0===i||i.call(a);let u=q(l,this.inferStyle(r,n),c);return u?(null===(s=null==a?void 0:a.beforeAnimate)||void 0===s||s.call(a,u),u.finished.then(()=>{var t,e;null===(t=null==a?void 0:a.afterAnimate)||void 0===t||t.call(a,u),null===(e=null==a?void 0:a.after)||void 0===e||e.call(a),this.animations.delete(u)})):null===(o=null==a?void 0:a.after)||void 0===o||o.call(a),u}).filter(Boolean);r.forEach(t=>this.animations.add(t));let a=Z(r);return a?(null===(s=null==e?void 0:e.beforeAnimate)||void 0===s||s.call(e,a),a.finished.then(()=>{var t,n;null===(t=null==e?void 0:e.afterAnimate)||void 0===t||t.call(e,a),null===(n=null==e?void 0:e.after)||void 0===n||n.call(e),this.release()})):null===(o=null==e?void 0:e.after)||void 0===o||o.call(e),a}inferStyle(t,e){var n,i;let{element:s,elementType:o,stage:r,originalStyle:a,modifiedStyle:l}=t,h={},d={};if("enter"===r)Object.assign(h,{opacity:0});else if("exit"===r)Object.assign(d,{opacity:0});else if("show"===r)Object.assign(h,{opacity:0}),Object.assign(d,{opacity:null!==(n=im(s,"opacity"))&&void 0!==n?n:V("opacity")});else if("hide"===r)Object.assign(h,{opacity:null!==(i=im(s,"opacity"))&&void 0!==i?i:V("opacity")}),Object.assign(d,{opacity:0});else if("collapse"===r){let{collapse:t}=e||{},{target:n,descendants:i,position:r}=t;if("node"===o){if(i.includes(s.id)){let[t,e,n]=r;Object.assign(d,{x:t,y:e,z:n})}}else if("combo"===o){if(s.id===n||i.includes(s.id)){let[t,e]=r;Object.assign(d,{x:t,y:e,childrenNode:a.childrenNode})}}else"edge"===o&&Object.assign(d,{sourceNode:l.sourceNode,targetNode:l.targetNode})}else if("expand"===r){let{expand:t}=e||{},{target:n,descendants:i,position:r}=t;if("node"===o){if(s.id===n||i.includes(s.id)){let[t,e,n]=r;Object.assign(h,{x:t,y:e,z:n})}}else if("combo"===o){if(s.id===n||i.includes(s.id)){let[t,e,n]=r;Object.assign(h,{x:t,y:e,z:n,childrenNode:l.childrenNode})}}else"edge"===o&&Object.assign(h,{sourceNode:l.sourceNode,targetNode:l.targetNode})}return[Object.keys(h).length>0?Object.assign({},a,h):a,Object.keys(d).length>0?Object.assign({},l,d):l]}stop(){this.animations.forEach(t=>t.cancel())}clear(){this.tasks=[]}release(){var t,e;let{canvas:n}=this.context,i=null===(e=null===(t=n.document)||void 0===t?void 0:t.timeline)||void 0===e?void 0:e.animationsWithPromises;i&&(n.document.timeline.animationsWithPromises=i.filter(t=>"finished"!==t.playState))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}constructor(t){this.tasks=[],this.animations=new Set,this.context=t}}class s6{emit(t){let{graph:e}=this.context;e.emit(t.type,t)}startBatch(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.batchCount++,1===this.batchCount&&this.emit(new sq(O.BATCH_START,{initiate:t}))}endBatch(){this.batchCount--,0===this.batchCount&&this.emit(new sq(O.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}constructor(t){this.batchCount=0,this.context=t}}class s2 extends tn{setBehaviors(t){this.setExtensions(t)}forwardEvents(){let t=this.context.canvas.getContainer();t&&[E.KEY_DOWN,E.KEY_UP].forEach(e=>{t.addEventListener(e,this.forwardContainerEvents)});let e=this.context.canvas.document;e&&[b.CLICK,b.DBLCLICK,b.POINTER_OVER,b.POINTER_LEAVE,b.POINTER_ENTER,b.POINTER_MOVE,b.POINTER_OUT,b.POINTER_DOWN,b.POINTER_UP,b.CONTEXT_MENU,b.DRAG_START,b.DRAG,b.DRAG_END,b.DRAG_ENTER,b.DRAG_OVER,b.DRAG_LEAVE,b.DROP,b.WHEEL].forEach(t=>{e.addEventListener(t,this.forwardCanvasEvents)})}destroy(){let t=this.context.canvas.getContainer();t&&[E.KEY_DOWN,E.KEY_UP].forEach(e=>{t.removeEventListener(e,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}constructor(t){super(t),this.currentTarget=null,this.currentTargetType=null,this.category="behavior",this.forwardCanvasEvents=t=>{let{target:e}=t,n=function(t){if(!t)return null;if(t instanceof A.BB)return{type:"canvas",element:t};let e=t;for(;e;){if(nK(e))return{type:"node",element:e};if(nG(e))return{type:"edge",element:e};if(nU(e))return{type:"combo",element:e};e=e.parentElement}return null}(e);if(!n)return;let{graph:i,canvas:s}=this.context,{type:o,element:r}=n;if("destroyed"in r&&(n2(r)||r.destroyed))return;let{type:a,detail:l,button:h}=t,d=Object.assign(Object.assign({},t),{target:r,targetType:o,originalTarget:e});a===b.POINTER_MOVE&&(this.currentTarget!==r&&(this.currentTarget&&i.emit("".concat(this.currentTargetType,":").concat(b.POINTER_LEAVE),Object.assign(Object.assign({},d),{type:b.POINTER_LEAVE,target:this.currentTarget})),r&&(Object.assign(d,{type:b.POINTER_ENTER}),i.emit("".concat(o,":").concat(b.POINTER_ENTER),d))),this.currentTarget=r,this.currentTargetType=o),a===b.CLICK&&2===h||(i.emit("".concat(o,":").concat(a),d),i.emit(a,d)),a===b.CLICK&&2===l&&(Object.assign(d,{type:b.DBLCLICK}),i.emit("".concat(o,":").concat(b.DBLCLICK),d),i.emit(b.DBLCLICK,d)),a===b.POINTER_DOWN&&2===h&&(Object.assign(d,{type:b.CONTEXT_MENU,preventDefault:()=>{var t;null===(t=s.getContainer())||void 0===t||t.addEventListener(b.CONTEXT_MENU,t=>t.preventDefault(),{once:!0})}}),i.emit("".concat(o,":").concat(b.CONTEXT_MENU),d),i.emit(b.CONTEXT_MENU,d))},this.forwardContainerEvents=t=>{this.context.graph.emit(t.type,t)},this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}}var s4=n(72225),s8=n(39559),s9=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})},s5=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};let s7=["background","main","label","transient"];class ot{getConfig(){return this.config}getLayer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.extends.layers[t]}getLayers(){return this.extends.layers}getRenderer(t){return this.extends.renderers[t]}getCamera(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.getLayer(t).getCamera()}getRoot(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.getLayer(t).getRoot()}getContextService(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.getLayer(t).getContextService()}setCursor(t){this.config.cursor=t,this.getLayer().setCursor(t)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}get ready(){return Promise.all(Object.entries(this.getLayers()).map(t=>{let[,e]=t;return e.ready}))}resize(t,e){Object.assign(this.extends.config,{width:t,height:e}),Object.values(this.getLayers()).forEach(n=>{let i=n.getCamera(),s=i.getPosition(),o=i.getFocalPoint();n.resize(t,e),i.setPosition(s),i.setFocalPoint(o)})}getBounds(t){return tm(Object.values(this.getLayers()).map(e=>{let n=t?e.getRoot().childNodes.find(e=>e.classList.includes(t)):e.getRoot();return n}).filter(t=>(null==t?void 0:t.childNodes.length)>0).map(t=>t.getBounds()))}getContainer(){let t=this.extends.config.container;return"string"==typeof t?document.getElementById(t):t}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(t,e){var n;let i=(null===(n=t.style)||void 0===n?void 0:n.$layer)||"main";return this.getLayer(i).appendChild(t,e)}setRenderer(t){if(t===this.extends.renderer)return;let e=oe(t);this.extends.renderers=e,Object.entries(e).forEach(t=>{let[e,n]=t;return this.getLayer(e).setRenderer(n)}),on(this.getLayers())}getCanvasByViewport(t){return tW(this.getLayer().viewport2Canvas(tV(t)))}getViewportByCanvas(t){return tW(this.getLayer().canvas2Viewport(tV(t)))}getViewportByClient(t){return tW(this.getLayer().client2Viewport(tV(t)))}getClientByViewport(t){return tW(this.getLayer().viewport2Client(tV(t)))}getClientByCanvas(t){return this.getClientByViewport(this.getViewportByCanvas(t))}getCanvasByClient(t){let e=this.getLayer(),n=e.client2Viewport(tV(t));return tW(e.viewport2Canvas(n))}toDataURL(){return s9(this,arguments,void 0,function*(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=window.devicePixelRatio||1,{mode:n="viewport"}=t,i=s5(t,["mode"]),[s,o,r,a]=[0,0,0,0];if("viewport"===n)[r,a]=this.getSize();else if("overall"===n){let t=this.getBounds(),e=tu(t);[s,o]=t.min,[r,a]=e}let l=(0,s8.L)('<div id="virtual-image"></div>'),h=new A.Xz({width:r,height:a,renderer:new eq.Th,devicePixelRatio:e,container:l,background:this.extends.config.background});yield h.ready,h.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),h.appendChild(this.getRoot().cloneNode(!0));let d=this.getLayer("label").getRoot().cloneNode(!0),c=h.viewport2Canvas({x:0,y:0}),u=this.getCanvasByViewport([0,0]);d.translate([u[0]-c.x,u[1]-c.y]),d.scale(1/this.getCamera().getZoom()),h.appendChild(d),h.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));let p=this.getCamera(),g=h.getCamera();if("viewport"===n)g.setZoom(p.getZoom()),g.setPosition(p.getPosition()),g.setFocalPoint(p.getFocalPoint());else if("overall"===n){let[t,e,n]=g.getPosition(),[i,r,a]=g.getFocalPoint();g.setPosition([t+s,e+o,n]),g.setFocalPoint([i+s,r+o,a])}let f=h.getContextService();return new Promise(t=>{h.addEventListener(A.$6.RERENDER,()=>s9(this,void 0,void 0,function*(){yield new Promise(t=>setTimeout(t,300));let e=yield f.toDataURL(i);t(e)}))})})}destroy(){Object.values(this.getLayers()).forEach(t=>{let e=t.getCamera();e.cancelLandmarkAnimation(),t.destroy()})}constructor(t){this.config=t;let{renderer:e,background:n,cursor:i}=t,s=s5(t,["renderer","background","cursor"]),o=oe(e),r=Object.fromEntries(s7.map(t=>{let e=new A.Xz(Object.assign(Object.assign({},s),{supportsMutipleCanvasesInOneContainer:!0,renderer:o[t],background:"background"===t?n:void 0}));return[t,e]}));on(r),this.extends={config:t,renderer:e,renderers:o,layers:r}}}function oe(t){return Object.fromEntries(s7.map(e=>{let n=(null==t?void 0:t(e))||new eq.Th;return"main"===e?n.registerPlugin(new s4.S({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):n.unregisterPlugin(n.getPlugin("dom-interaction")),[e,n]}))}function on(t){Object.entries(t).forEach(t=>{let[e,n]=t,i=n.getContextService().getDomElement();i.style.position="absolute",i.style.outline="none",i.tabIndex=1,"main"!==e&&(i.style.pointerEvents="none")})}var oi=n(68731),os=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};function oo(t,e){let{data:n,style:i}=t,s=os(t,["data","style"]),{data:o,style:r}=e,a=os(e,["data","style"]),l=Object.assign(Object.assign({},s),a);return(n||o)&&Object.assign(l,{data:Object.assign(Object.assign({},n),o)}),(i||r)&&Object.assign(l,{style:Object.assign(Object.assign({},i),r)}),l}function or(t){let{data:e,style:n}=t,i=os(t,["data","style"]);return e&&(i.data=Object.assign({},e)),n&&(i.style=Object.assign({},n)),i}function oa(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{states:n=[],data:i={},style:s={},children:o=[]}=t,r=os(t,["states","data","style","children"]),{states:a=[],data:l={},style:h={},children:d=[]}=e,c=os(e,["states","data","style","children"]),u=(t,e)=>t.length===e.length&&t.every((t,n)=>t===e[n]),p=(t,e)=>{let n=Object.keys(t),i=Object.keys(e);return n.length===i.length&&n.every(n=>t[n]===e[n])};return!!(p(r,c)&&u(o,d)&&u(n,a)&&p(i,l)&&p(s,h))}var ol=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};function oh(t){let{id:e=U(t),style:n,data:i}=t,s=ol(t,["id","style","data"]),o=Object.assign(Object.assign({},t),{style:Object.assign({},n),data:Object.assign({},i)});return"source"in t&&"target"in t?Object.assign({id:e,data:o},s):{id:e,data:o}}function od(t){return t.data}class oc{pushChange(t){if(this.isTraceless)return;let{type:e}=t;if(e===f.NodeUpdated||e===f.EdgeUpdated||e===f.ComboUpdated){let{value:n,original:i}=t;this.changes.push({value:or(n),original:or(i),type:e})}else this.changes.push({value:or(t.value),type:e})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(t){this.batchCount++,this.model.batch(t),this.batchCount--}silence(t){this.isTraceless=!0,t(),this.isTraceless=!1}isCombo(t){return this.comboIds.has(t)||this.latestRemovedComboIds.has(t)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(t){return this.model.getAllNodes().reduce((e,n)=>{let i=od(n);return this.isCombo(U(i))||(void 0===t?e.push(i):t.includes(U(i))&&e.push(i)),e},[])}getEdgeDatum(t){return od(this.model.getEdge(t))}getEdgeData(t){return this.model.getAllEdges().reduce((e,n)=>{let i=od(n);return void 0===t?e.push(i):t.includes(U(i))&&e.push(i),e},[])}getComboData(t){return this.model.getAllNodes().reduce((e,n)=>{let i=od(n);return this.isCombo(U(i))&&(void 0===t?e.push(i):t.includes(U(i))&&e.push(i)),e},[])}getRootsData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;return this.model.getRoots(t).map(od)}getAncestorsData(t,e){let{model:n}=this;return n.hasNode(t)&&n.hasTreeStructure(e)?n.getAncestors(t,e).map(od):[]}getDescendantsData(t){let e=this.getElementDataById(t),n=[];return t2(e,t=>{t!==e&&n.push(t)},t=>this.getChildrenData(U(t)),"TB"),n}getParentData(t,e){let{model:n}=this;if(!e){F.warn("The hierarchy structure key is not specified");return}if(!n.hasNode(t)||!n.hasTreeStructure(e))return;let i=n.getParent(t,e);return i?od(i):void 0}getChildrenData(t){let e="node"===this.getElementType(t)?j:N,{model:n}=this;return n.hasNode(t)&&n.hasTreeStructure(e)?n.getChildren(t,e).map(od):[]}getElementsDataByType(t){return"node"===t?this.getNodeData():"edge"===t?this.getEdgeData():"combo"===t?this.getComboData():[]}getElementDataById(t){let e=this.getElementType(t);return"edge"===e?this.getEdgeDatum(t):this.getNodeLikeDatum(t)}getNodeLikeDatum(t){let e=this.model.getNode(t);return od(e)}getNodeLikeData(t){return this.model.getAllNodes().reduce((e,n)=>{let i=od(n);return t?t.includes(U(i))&&e.push(i):e.push(i),e},[])}getElementDataByState(t,e){let n=this.getElementsDataByType(t);return n.filter(t=>{var n;return null===(n=t.states)||void 0===n?void 0:n.includes(e)})}getElementState(t){var e;return(null===(e=this.getElementDataById(t))||void 0===e?void 0:e.states)||[]}hasNode(t){return this.model.hasNode(t)&&!this.isCombo(t)}hasEdge(t){return this.model.hasEdge(t)}hasCombo(t){return this.model.hasNode(t)&&this.isCombo(t)}getRelatedEdgesData(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"both";return this.model.getRelatedEdges(t,e).map(od)}getNeighborNodesData(t){return this.model.getNeighbors(t).map(od)}setData(t){let{nodes:e=[],edges:n=[],combos:i=[]}=t,{nodes:s,edges:o,combos:r}=this.getData(),a=te(s,e,t=>U(t),oa),l=te(o,n,t=>U(t),oa),h=te(r,i,t=>U(t),oa);this.batch(()=>{this.addData({nodes:a.enter,edges:l.enter,combos:h.enter}),this.updateData({nodes:a.update,edges:l.update,combos:h.update}),this.removeData({nodes:a.exit.map(U),edges:l.exit.map(U),combos:h.exit.map(U)})})}addData(t){let{nodes:e,edges:n,combos:i}=t;this.batch(()=>{this.addComboData(i),this.addNodeData(e),this.addEdgeData(n)})}addNodeData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length&&(this.model.addNodes(t.map(t=>(this.pushChange({value:t,type:f.NodeAdded}),oh(t)))),this.updateNodeLikeHierarchy(t))}addEdgeData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length&&this.model.addEdges(t.map(t=>(this.pushChange({value:t,type:f.EdgeAdded}),oh(t))))}addComboData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!t.length)return;let{model:e}=this;e.hasTreeStructure(N)||e.attachTreeStructure(N),e.addNodes(t.map(t=>(this.comboIds.add(U(t)),this.pushChange({value:t,type:f.ComboAdded}),oh(t)))),this.updateNodeLikeHierarchy(t)}addChildrenData(t,e){let n=this.getNodeLikeDatum(t),i=e.map(U);this.addNodeData(e),this.updateNodeData([{id:t,children:[...n.children||[],...i]}]),this.addEdgeData(i.map(e=>({source:t,target:e})))}updateNodeLikeHierarchy(t){if(!this.enableUpdateNodeLikeHierarchy)return;let{model:e}=this;t.forEach(t=>{let n=U(t),i=t.combo;i&&(e.hasTreeStructure(N)||e.attachTreeStructure(N),this.setParent(n,t.combo,N));let s=t.children||[];if(s.length){e.hasTreeStructure(j)||e.attachTreeStructure(j);let t=s.filter(t=>e.hasNode(t));t.forEach(t=>this.setParent(t,n,j)),t.length!==s.length&&this.updateNodeData([{id:n,children:t}])}})}preventUpdateNodeLikeHierarchy(t){this.enableUpdateNodeLikeHierarchy=!1,t(),this.enableUpdateNodeLikeHierarchy=!0}updateData(t){let{nodes:e,edges:n,combos:i}=t;this.batch(()=>{this.updateNodeData(e),this.updateComboData(i),this.updateEdgeData(n)})}updateNodeData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!t.length)return;let{model:e}=this;this.batch(()=>{let n=[];t.forEach(t=>{let i=U(t),s=od(e.getNode(i));if(oa(s,t))return;let o=oo(s,t);this.pushChange({value:o,original:s,type:f.NodeUpdated}),e.mergeNodeData(i,o),n.push(o)}),this.updateNodeLikeHierarchy(n)})}refreshData(){let{nodes:t,edges:e,combos:n}=this.getData();t.forEach(t=>{this.pushChange({value:t,original:t,type:f.NodeUpdated})}),e.forEach(t=>{this.pushChange({value:t,original:t,type:f.EdgeUpdated})}),n.forEach(t=>{this.pushChange({value:t,original:t,type:f.ComboUpdated})})}syncNodeDatum(t){let{model:e}=this,n=U(t),i=od(e.getNode(n)),s=oo(i,t);e.mergeNodeData(n,s)}updateEdgeData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!t.length)return;let{model:e}=this;this.batch(()=>{t.forEach(t=>{let n=U(t),i=od(e.getEdge(n));if(oa(i,t))return;t.source&&i.source!==t.source&&e.updateEdgeSource(n,t.source),t.target&&i.target!==t.target&&e.updateEdgeTarget(n,t.target);let s=oo(i,t);this.pushChange({value:s,original:i,type:f.EdgeUpdated}),e.mergeEdgeData(n,s)})})}updateComboData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!t.length)return;let{model:e}=this;e.batch(()=>{let n=[];t.forEach(t=>{let i=U(t),s=od(e.getNode(i));if(oa(s,t))return;let o=oo(s,t);this.pushChange({value:o,original:s,type:f.ComboUpdated}),e.mergeNodeData(i,o),n.push(o)}),this.updateNodeLikeHierarchy(n)})}setParent(t,e,n){var i;let s=!(arguments.length>3)||void 0===arguments[3]||arguments[3];if(t===e)return;let o=this.getNodeLikeDatum(t),r=o.combo;if(e){let t=this.getNodeLikeDatum(e);if((null===(i=t.style)||void 0===i?void 0:i.zIndex)!==void 0){let n=(0,ee.Z)(t,["style","zIndex"],0)+(this.isCombo(e)?1:0);(0,en.Z)(o,["style","zIndex"],n)}}if(r!==e&&n===N){let n={id:t,combo:e};this.isCombo(t)?this.syncComboDatum(n):this.syncNodeDatum(n)}this.model.setParent(t,e,n),s&&n===N&&(0,oi.Z)([r,e]).forEach(t=>{void 0!==t&&this.refreshComboData(t)})}refreshComboData(t){let e=this.getComboData([t])[0],n=this.getAncestorsData(t,N);e&&this.pushChange({value:e,original:e,type:f.ComboUpdated}),n.forEach(t=>{this.pushChange({value:t,original:t,type:f.ComboUpdated})})}syncComboDatum(t){let{model:e}=this,n=U(t);if(!e.hasNode(n))return;let i=od(e.getNode(n)),s=oo(i,t);e.mergeNodeData(n,s)}getElementPosition(t){let e=this.getElementDataById(t);return tF(e)}translateNodeLikeBy(t,e){this.isCombo(t)?this.translateComboBy(t,e):this.translateNodeBy(t,e)}translateNodeLikeTo(t,e){this.isCombo(t)?this.translateComboTo(t,e):this.translateNodeTo(t,e)}translateNodeBy(t,e){let n=this.getElementPosition(t),i=tS(n,[...e,0].slice(0,3));this.translateNodeTo(t,i)}translateNodeTo(t,e){let[n=0,i=0,s=0]=e;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:t,style:{x:n,y:i,z:s}}])})}translateComboBy(t,e){let[n=0,i=0,s=0]=e;if([n,i,s].some(isNaN)||[n,i,s].every(t=>0===t))return;let o=this.getComboData([t])[0];if(!o)return;let r=new Set;t2(o,t=>{let e=U(t);if(r.has(e))return;r.add(e);let[o,a,l]=tF(t),h=oo(t,{style:{x:o+n,y:a+i,z:l+s}});this.pushChange({value:h,original:t,type:this.isCombo(e)?f.ComboUpdated:f.NodeUpdated}),this.model.mergeNodeData(e,h)},t=>this.getChildrenData(U(t)),"BT")}translateComboTo(t,e){var n;if(e.some(isNaN))return;let[i=0,s=0,o=0]=e,r=null===(n=this.getComboData([t]))||void 0===n?void 0:n[0];if(!r)return;let[a,l,h]=tF(r),d=i-a,c=s-l,u=o-h;t2(r,t=>{let e=U(t),[n,i,s]=tF(t),o=oo(t,{style:{x:n+d,y:i+c,z:s+u}});this.pushChange({value:o,original:t,type:this.isCombo(e)?f.ComboUpdated:f.NodeUpdated}),this.model.mergeNodeData(e,o)},t=>this.getChildrenData(U(t)),"BT")}removeData(t){let{nodes:e,edges:n,combos:i}=t;this.batch(()=>{this.removeEdgeData(n),this.removeNodeData(e),this.removeComboData(i),this.latestRemovedComboIds=new Set(i)})}removeNodeData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length&&this.batch(()=>{t.forEach(t=>{this.removeEdgeData(this.getRelatedEdgesData(t).map(U)),this.pushChange({value:this.getNodeData([t])[0],type:f.NodeRemoved}),this.removeNodeLikeHierarchy(t)}),this.model.removeNodes(t)})}removeEdgeData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length&&(t.forEach(t=>this.pushChange({value:this.getEdgeData([t])[0],type:f.EdgeRemoved})),this.model.removeEdges(t))}removeComboData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length&&this.batch(()=>{t.forEach(t=>{this.pushChange({value:this.getComboData([t])[0],type:f.ComboRemoved}),this.removeNodeLikeHierarchy(t),this.comboIds.delete(t)}),this.model.removeNodes(t)})}removeNodeLikeHierarchy(t){if(this.model.hasTreeStructure(N)){let e=this.getNodeLikeDatum(t).combo;this.setParent(t,void 0,N,!1),this.model.getChildren(t,N).forEach(t=>{let n=od(t),i=U(n);this.setParent(U(n),e,N,!1);let s=oo(n,{id:U(n),combo:e});this.pushChange({value:s,original:n,type:this.isCombo(i)?f.ComboUpdated:f.NodeUpdated}),this.model.mergeNodeData(U(n),s)}),(0,eJ.Z)(e)||this.refreshComboData(e)}}getElementType(t){if(this.model.hasNode(t))return this.isCombo(t)?"combo":"node";if(this.model.hasEdge(t))return"edge";throw Error(_("Unknown element type of id: ".concat(t)))}destroy(){let{model:t}=this,e=t.getAllNodes(),n=t.getAllEdges();t.removeEdges(n.map(t=>t.id)),t.removeNodes(e.map(t=>t.id)),this.context={}}constructor(){this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new ir.k}}var ou=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})};class op{init(){if(!this.container){let{canvas:t}=this.context;this.container=t.appendChild(new A.ZA({className:"elements"}))}}emit(t,e){e.silence||s1(this.context.graph,t)}forEachElementData(t){t6.forEach(e=>{let n=this.context.model.getElementsDataByType(e);t(e,n)})}getElementType(t,e){var n;let{options:i,graph:s}=this.context,o=(null===(n=i[t])||void 0===n?void 0:n.type)||e.type;return o?"string"==typeof o?o:o.call(s,e):"edge"===t?"line":"circle"}getTheme(t){return z(this.context.options)[t]||{}}getThemeStyle(t){return this.getTheme(t).style||{}}getThemeStateStyle(t,e){let{state:n={}}=this.getTheme(t);return Object.assign({},...e.map(t=>n[t]||{}))}computePaletteStyle(){let{options:t}=this.context;this.paletteStyle={},this.forEachElementData((e,n)=>{var i,s;let o=Object.assign({},em(null===(i=this.getTheme(e))||void 0===i?void 0:i.palette),em(null===(s=t[e])||void 0===s?void 0:s.palette));(null==o?void 0:o.field)&&Object.assign(this.paletteStyle,function(t,e){if(!e)return{};let{type:n,color:i,field:s,invert:o}=e,r=t=>{let e="string"==typeof i?B("palette",i):i;if("function"==typeof e){let n={};return t.forEach(t=>{let[i,s]=t;n[i]=e(o?1-s:s)}),n}if(Array.isArray(e)){let n=o?[...e].reverse():e,i={};return t.forEach(t=>{let[s,o]=t;i[s]=n[o%e.length]}),i}return{}},a=(t,e)=>{var n;return"string"==typeof t?null===(n=e.data)||void 0===n?void 0:n[t]:null==t?void 0:t(e)};if("group"===n){let e=(0,ef.Z)(t,t=>{if(!s)return"default";let e=a(s,t);return e?String(e):"default"}),n=Object.keys(e),i=r(n.map((t,e)=>[t,e])),o={};return Object.entries(e).forEach(t=>{let[e,n]=t;n.forEach(t=>{o[U(t)]=i[e]})}),o}if("value"===n){let[e,n]=t.reduce((t,e)=>{let[n,i]=t,o=a(s,e);if("number"!=typeof o)throw Error(_("Palette field ".concat(s," is not a number")));return[Math.min(n,o),Math.max(i,o)]},[1/0,-1/0]),i=n-e;return r(t.map(t=>[t.id,(a(s,t)-e)/i]))}}(n,o))})}getPaletteStyle(t,e){let n=this.paletteStyle[e];return n?"edge"===t?{stroke:n}:{fill:n}:{}}computeElementDefaultStyle(t,e){var n;let{options:i}=this.context,s=(null===(n=i[t])||void 0===n?void 0:n.style)||{};this.defaultStyle[U(e.datum)]=ed(s,e)}computeElementsDefaultStyle(t){let{graph:e}=this.context;this.forEachElementData((n,i)=>{let s=i.length;for(let o=0;o<s;o++){let s=i[o];(void 0===t||t.includes(U(s)))&&this.computeElementDefaultStyle(n,{datum:s,graph:e})}})}getDefaultStyle(t){return this.defaultStyle[t]||{}}getElementState(t){try{let{model:e}=this.context;return e.getElementState(t)}catch(t){return[]}}getElementStateStyle(t,e,n){var i,s;let{options:o}=this.context,r=(null===(s=null===(i=o[t])||void 0===i?void 0:i.state)||void 0===s?void 0:s[e])||{};return ed(r,n)}computeElementStatesStyle(t,e,n){this.stateStyle[U(n.datum)]=Object.assign({},...e.map(e=>this.getElementStateStyle(t,e,n)))}computeElementsStatesStyle(t){let{graph:e}=this.context;this.forEachElementData((n,i)=>{let s=i.length;for(let o=0;o<s;o++){let s=i[o];if(void 0===t||t.includes(U(s))){let t=this.getElementState(U(s));this.computeElementStatesStyle(n,t,{datum:s,graph:e})}}})}getStateStyle(t){return this.stateStyle[t]||{}}computeStyle(t,e){t&&["translate","zIndex"].includes(t)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(e),this.computeElementsStatesStyle(e))}getElement(t){return this.elementMap[t]}getElementZIndex(t){var e;let n=this.getElement(t);return n&&null!==(e=n.style.zIndex)&&void 0!==e?e:0}getNodes(){return this.context.model.getNodeData().map(t=>{let{id:e}=t;return this.elementMap[e]})}getEdges(){return this.context.model.getEdgeData().map(t=>this.elementMap[U(t)])}getCombos(){return this.context.model.getComboData().map(t=>{let{id:e}=t;return this.elementMap[e]})}getElementComputedStyle(t,e){let n=U(e),i=this.getThemeStyle(t),s=this.getPaletteStyle(t,n),o=e.style||{},r=this.getDefaultStyle(n),a=this.getThemeStateStyle(t,this.getElementState(n)),l=this.getStateStyle(n),h=Object.assign({},i,s,o,r,a,l);if("combo"===t){let t=this.context.model.getChildrenData(n),e=!!h.collapsed,i=e?[]:t.map(U).filter(t=>this.getElement(t));Object.assign(h,{childrenNode:i,childrenData:t})}return h}draw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{animation:!0};this.init();let e=this.computeChangesAndDrawData(t);if(!e)return null;let{dataChanges:n,drawData:i}=e;this.markDestroyElement(i),this.computeStyle(t.stage);let{add:s,update:o,remove:r}=i;this.destroyElements(r,t),this.createElements(s,t),this.updateElements(o,t);let{animation:a,silence:l}=t,{type:h="draw"}=t;return this.context.animation.animate(a,l?{}:{before:()=>this.emit(new sq(O.BEFORE_DRAW,{dataChanges:n,animation:a,render:"render"===h}),t),beforeAnimate:e=>this.emit(new sQ(O.BEFORE_ANIMATE,m.DRAW,e,i),t),afterAnimate:e=>this.emit(new sQ(O.AFTER_ANIMATE,m.DRAW,e,i),t),after:()=>this.emit(new sq(O.AFTER_DRAW,{dataChanges:n,animation:a,render:"render"===h}),t)})}computeChangesAndDrawData(t){let{model:e}=this.context,n=e.getChanges(),i=i7(n);if(0===i.length)return null;let{NodeAdded:s=[],NodeUpdated:o=[],NodeRemoved:r=[],EdgeAdded:a=[],EdgeUpdated:l=[],EdgeRemoved:h=[],ComboAdded:d=[],ComboUpdated:c=[],ComboRemoved:u=[]}=(0,ef.Z)(i,t=>t.type),p=t=>new Map(t.map(t=>{let e=t.value;return[U(e),e]})),g={add:{nodes:p(s),edges:p(a),combos:p(d)},update:{nodes:p(o),edges:p(l),combos:p(c)},remove:{nodes:p(r),edges:p(h),combos:p(u)}},f=this.transformData(g,t);return e.clearChanges(),{dataChanges:n,drawData:f}}transformData(t,e){let n=this.context.transform.getTransformInstance();return Object.values(n).reduce((t,n)=>n.beforeDraw(t,e),t)}createElement(t,e,n){var i,s;let o=U(e),r=this.getElement(o);if(r)return;let a=this.getElementType(t,e),l=this.getElementComputedStyle(t,e),h=B(t,a);if(!h)return F.warn("The element ".concat(a," of ").concat(t," is not registered."));if(this.emit(new sJ(O.BEFORE_ELEMENT_CREATE,t,e),n),"expand"===n.stage){let t=this.getElementZIndex(n.target);(!l.zIndex||l.zIndex<t)&&(l.zIndex=t+(null!==(i=l.zIndex)&&void 0!==i?i:0))}let d=this.container.appendChild(new h({id:o,style:Object.assign({context:this.context},l)}));this.shapeTypeMap[o]=a,this.elementMap[o]=d;let{stage:c="enter"}=n;null===(s=this.context.animation)||void 0===s||s.add({element:d,elementType:t,stage:c,originalStyle:Object.assign({},d.attributes),modifiedStyle:Object.assign(Object.assign({},d.attributes),l)},{after:()=>{var i;this.emit(new sJ(O.AFTER_ELEMENT_CREATE,t,e),n),null===(i=d.onCreate)||void 0===i||i.call(d)}})}createElements(t,e){let{nodes:n,edges:i,combos:s}=t;[["node",n],["combo",s],["edge",i]].forEach(t=>{let[n,i]=t;i.forEach(t=>this.createElement(n,t,e))})}getUpdateStageStyle(t,e,n){let{stage:i="update"}=n;if("translate"===i){if("node"!==t&&"combo"!==t)return{};{let{style:{x:t=0,y:n=0,z:i=0}={}}=e;return{x:t,y:n,z:i}}}return this.getElementComputedStyle(t,e)}updateElement(t,e,n){var i;let s=U(e),{stage:o="update"}=n,r=this.getElement(s);if(!r)return()=>null;this.emit(new sJ(O.BEFORE_ELEMENT_UPDATE,t,e),n);let a=this.getElementType(t,e),l=this.getUpdateStageStyle(t,e,n);this.shapeTypeMap[s]!==a&&(r.destroy(),delete this.shapeTypeMap[s],delete this.elementMap[s],this.createElement(t,e,{animation:!1,silence:!0}));let h="visibility"!==o?o:"hidden"===l.visibility?"hide":"show";"hide"===h&&delete l.visibility,null===(i=this.context.animation)||void 0===i||i.add({element:r,elementType:t,stage:h,originalStyle:Object.assign({},r.attributes),modifiedStyle:Object.assign(Object.assign({},r.attributes),l)},{before:()=>{let t=this.elementMap[s];"collapse"!==o&&n6(t,l),"visibility"===o&&(iy(t,"opacity")||ig(t,"opacity"),this.visibilityCache.set(t,"show"===h?"visible":"hidden"),"show"===h&&ex(t,"visible"))},after:()=>{var i;let r=this.elementMap[s];"collapse"===o&&n6(r,l),"hide"===h&&ex(r,this.visibilityCache.get(r)),this.emit(new sJ(O.AFTER_ELEMENT_UPDATE,t,e),n),null===(i=r.onUpdate)||void 0===i||i.call(r)}})}updateElements(t,e){let{nodes:n,edges:i,combos:s}=t;[["node",n],["combo",s],["edge",i]].forEach(t=>{let[n,i]=t;i.forEach(t=>this.updateElement(n,t,e))})}markDestroyElement(t){Object.values(t.remove).forEach(t=>{t.forEach(t=>{let e=U(t),n=this.getElement(e);n&&(0,en.Z)(n,"__to_be_destroyed__",!0)})})}destroyElement(t,e,n){var i;let{stage:s="exit"}=n,o=U(e),r=this.elementMap[o];if(!r)return()=>null;this.emit(new sJ(O.BEFORE_ELEMENT_DESTROY,t,e),n),null===(i=this.context.animation)||void 0===i||i.add({element:r,elementType:t,stage:s,originalStyle:Object.assign({},r.attributes),modifiedStyle:Object.assign({},r.attributes)},{after:()=>{var i;this.clearElement(o),r.destroy(),null===(i=r.onDestroy)||void 0===i||i.call(r),this.emit(new sJ(O.AFTER_ELEMENT_DESTROY,t,e),n)}})}destroyElements(t,e){let{nodes:n,edges:i,combos:s}=t;[["combo",s],["edge",i],["node",n]].forEach(t=>{let[n,i]=t;i.forEach(t=>this.destroyElement(n,t,e))})}clearElement(t){delete this.paletteStyle[t],delete this.defaultStyle[t],delete this.stateStyle[t],delete this.elementMap[t],delete this.shapeTypeMap[t]}collapseNode(t,e){return ou(this,void 0,void 0,function*(){var n;let{model:i,layout:s}=this.context,o=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!o)return;this.markDestroyElement(o.drawData);let r=yield s.simulate();i.updateData(r);let a=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!a)return;let{drawData:l}=a,{add:h,remove:d,update:c}=l;this.markDestroyElement(l);let u={animation:e,stage:"collapse",data:l};this.destroyElements(d,u),this.createElements(h,u),this.updateElements(c,u),yield null===(n=this.context.animation.animate(e,{beforeAnimate:t=>this.emit(new sQ(O.BEFORE_ANIMATE,m.COLLAPSE,t,l),u),afterAnimate:t=>this.emit(new sQ(O.AFTER_ANIMATE,m.COLLAPSE,t,l),u)},{collapse:{target:t,descendants:Array.from(d.nodes).map(t=>{let[,e]=t;return U(e)}),position:tF(c.nodes.get(t))}}))||void 0===n?void 0:n.finished})}expandNode(t,e){return ou(this,void 0,void 0,function*(){var n;let{model:i,layout:s}=this.context;if(!i.getAncestorsData(t,N).every(t=>et(t)))return;let o=tF(i.getNodeData([t])[0]),r=this.computeChangesAndDrawData({stage:"expand",animation:e});if(!r)return;let{drawData:{add:a}}=r;this.createElements(a,{animation:!1,stage:"expand",target:t}),this.context.animation.clear();let l=yield s.simulate();i.updateData(l),this.computeStyle("expand");let h=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!h)return;let{drawData:d}=h,{update:c}=d,u={animation:e,stage:"expand",data:d};a.edges.forEach(t=>c.edges.set(U(t),t)),a.nodes.forEach(t=>c.nodes.set(U(t),t)),this.updateElements(c,u),yield null===(n=this.context.animation.animate(e,{beforeAnimate:t=>this.emit(new sQ(O.BEFORE_ANIMATE,m.EXPAND,t,d),u),afterAnimate:t=>this.emit(new sQ(O.AFTER_ANIMATE,m.EXPAND,t,d),u)},{expand:{target:t,descendants:Array.from(a.nodes).map(t=>{let[,e]=t;return U(e)}),position:o}}))||void 0===n?void 0:n.finished})}collapseCombo(t,e){return ou(this,void 0,void 0,function*(){var n;let{model:i,element:s}=this.context;if(i.getAncestorsData(t,N).some(t=>et(t)))return;let o=s.getElement(t),r=o.getComboPosition(Object.assign(Object.assign({},o.attributes),{collapsed:!0})),a=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!a)return;let{dataChanges:l,drawData:h}=a;this.markDestroyElement(h);let{update:d,remove:c}=h,u={animation:e,stage:"collapse",data:h};this.destroyElements(c,u),this.updateElements(d,u);let p=t=>Array.from(t).map(t=>{let[,e]=t;return U(e)});yield null===(n=this.context.animation.animate(e,{before:()=>this.emit(new sq(O.BEFORE_DRAW,{dataChanges:l,animation:e}),u),beforeAnimate:t=>this.emit(new sQ(O.BEFORE_ANIMATE,m.COLLAPSE,t,h),u),afterAnimate:t=>this.emit(new sQ(O.AFTER_ANIMATE,m.COLLAPSE,t,h),u),after:()=>this.emit(new sq(O.AFTER_DRAW,{dataChanges:l,animation:e}),u)},{collapse:{target:t,descendants:[...p(c.nodes),...p(c.combos)],position:r}}))||void 0===n?void 0:n.finished})}expandCombo(t,e){return ou(this,void 0,void 0,function*(){var n;let{model:i}=this.context,s=tF(i.getComboData([t])[0]);this.computeStyle("expand");let o=this.computeChangesAndDrawData({stage:"expand",animation:e});if(!o)return;let{dataChanges:r,drawData:a}=o,{add:l,update:h}=a,d={animation:e,stage:"expand",data:a,target:t};this.createElements(l,d),this.updateElements(h,d);let c=t=>Array.from(t).map(t=>{let[,e]=t;return U(e)});yield null===(n=this.context.animation.animate(e,{before:()=>this.emit(new sq(O.BEFORE_DRAW,{dataChanges:r,animation:e}),d),beforeAnimate:t=>this.emit(new sQ(O.BEFORE_ANIMATE,m.EXPAND,t,a),d),afterAnimate:t=>this.emit(new sQ(O.AFTER_ANIMATE,m.EXPAND,t,a),d),after:()=>this.emit(new sq(O.AFTER_DRAW,{dataChanges:r,animation:e}),d)},{expand:{target:t,descendants:[...c(l.nodes),...c(l.combos)],position:s}}))||void 0===n?void 0:n.finished})}getFrontZIndex(t){let{model:e}=this.context,n=e.getElementType(t),i=e.getElementDataById(t),s=e.getData();if(Object.assign(s,{["".concat(n,"s")]:s["".concat(n,"s")].filter(e=>U(e)!==t)}),"combo"===n&&!et(i)){let n=e.getAncestorsData(t,N).map(U);s.nodes=s.nodes.filter(t=>!n.includes(U(t))),s.combos=s.combos.filter(t=>!n.includes(U(t))),s.edges=s.edges.filter(t=>{let{source:e,target:i}=t;return n.includes(e)&&n.includes(i)})}return Math.max(0,...Object.values(s).flat().map(t=>{let e=U(t);return this.getElementZIndex(e)}))+1}destroy(){this.container.destroy(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={},this.context={}}constructor(t){this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=t}}var og=n(15767),of=n(80345);class om extends i5.Z{constructor(t,e,n){super(),this.graph=t,this.layout=e,this.options=n,this.spawnWorker()}spawnWorker(){this.proxy=of.Ud(new Worker(n.tu(new URL(n.p+n.u(1230),n.b)),{type:void 0})),this.running&&(this.running=!1,this.execute())}execute(){var t;return(0,og.mG)(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;let e=this.layout.options,{onTick:n}=e,i=(0,og._T)(e,["onTick"]),s={};Object.keys(i).forEach(t=>{(0,to.Z)(i[t])||(s[t]=i[t])});let o={layout:{id:this.layout.id,options:s,iterations:null===(t=this.options)||void 0===t?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},r=new Float32Array([0]),[a]=yield this.proxy.calculateLayout(o,[r]);return a})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[of.Yy]()}isRunning(){return this.running}}var oy=n(90765),ov=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})},ob=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&0>e.indexOf(i)&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)0>e.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]]);return n};class oE{get presetOptions(){return{animation:!!K(this.context.options,!0)}}get options(){let{options:t}=this.context;return t.layout}getLayoutInstance(){return this.instances}layout(){return ov(this,void 0,void 0,function*(){if(!this.options)return;let t=Array.isArray(this.options)?this.options:[this.options],{graph:e}=this.context;for(let n of(s1(e,new sq(O.BEFORE_LAYOUT)),t)){let i=t.indexOf(n),s=this.getLayoutData(n),o=Object.assign(Object.assign({},this.presetOptions),n);s1(e,new sq(O.BEFORE_STAGE_LAYOUT,{options:o,index:i}));let r=yield this.stepLayout(s,o,i);s1(e,new sq(O.AFTER_STAGE_LAYOUT,{options:o,index:i})),n.animation||this.updateElementPosition(r,!1)}s1(e,new sq(O.AFTER_LAYOUT)),this.transformDataAfterLayout()})}transformDataAfterLayout(){let t=this.context.transform.getTransformInstance();Object.values(t).forEach(t=>t.afterLayout())}simulate(){return ov(this,void 0,void 0,function*(){if(!this.options)return{};let t=Array.isArray(this.options)?this.options:[this.options],e={};for(let n of t){let i=t.indexOf(n),s=this.getLayoutData(n),o=yield this.stepLayout(s,Object.assign(Object.assign(Object.assign({},this.presetOptions),n),{animation:!1}),i);e=o}return e})}stepLayout(t,e,n){return ov(this,void 0,void 0,function*(){return!function(t){let{type:e}=t;return["compact-box","mindmap","dendrogram","indented"].includes(e)}(e)?yield this.graphLayout(t,e,n):yield this.treeLayout(t,e,n)})}graphLayout(t,e,n){return ov(this,void 0,void 0,function*(){let{animation:i,enableWorker:s,iterations:o=300}=e,r=this.initGraphLayout(e);if(!r)return{};if(this.instances[n]=r,this.instance=r,s)return this.supervisor=new om(r.graphData2LayoutModel(t),r.instance,{iterations:o}),ih((yield this.supervisor.execute()));if((0,oy.h)(r))return i?yield r.execute(t,{onTick:t=>{this.updateElementPosition(t,!1)}}):(r.execute(t),r.stop(),r.tick(o));let a=yield r.execute(t);if(i){let t=this.updateElementPosition(a,i);yield null==t?void 0:t.finished}return a})}treeLayout(t,e,n){return ov(this,void 0,void 0,function*(){let{type:n,animation:i}=e,s=B("layout",n);if(!s)return{};let{nodes:o=[],edges:r=[]}=t,a=new ir.k({nodes:o.map(t=>({id:U(t),data:t.data||{}})),edges:r.map(t=>({id:U(t),source:t.source,target:t.target,data:t.data||{}}))});!function(t){if(t.hasTreeStructure(j))return;t.attachTreeStructure(j);let e=t.getAllEdges();for(let n of e){let{source:e,target:i}=n;t.setParent(i,e,j)}}(a);let l={nodes:[],edges:[]},h={nodes:[],edges:[]},d=a.getRoots(j);d.forEach(t=>{t2(t,t=>{t.children=a.getSuccessors(t.id)},t=>a.getSuccessors(t.id),"TB");let n=s(t,e),{x:i,y:o,z:r=0}=n;t2(n,t=>{let{id:e,x:n,y:s,z:a=0}=t;l.nodes.push({id:e,style:{x:i,y:o,z:r}}),h.nodes.push({id:e,style:{x:n,y:s,z:a}})},t=>t.children,"TB")});let c=this.inferTreeLayoutOffset(h);if(ox(h,c),i){ox(l,c),this.updateElementPosition(l,!1);let t=this.updateElementPosition(h,i);yield null==t?void 0:t.finished}return h})}inferTreeLayoutOffset(t){var e;let[n,i]=[1/0,-1/0],[s,o]=[1/0,-1/0];null===(e=t.nodes)||void 0===e||e.forEach(t=>{let{x:e=0,y:r=0}=t.style||{};n=Math.min(n,e),i=Math.max(i,e),s=Math.min(s,r),o=Math.max(o,r)});let{canvas:r}=this.context,a=r.getSize(),[l,h]=r.getCanvasByViewport([0,0]),[d,c]=r.getCanvasByViewport(a);return n>=l&&i<=d&&s>=h&&o<=c?[0,0]:[(l+d)/2-(n+i)/2,(h+c)/2-(s+o)/2]}stopLayout(){this.instance&&(0,oy.h)(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(t){let{nodeFilter:e=()=>!0}=t,{nodes:n,edges:i,combos:s}=this.context.model.getData(),o=t=>this.context.element.getElement(t),r=n.filter(t=>{let n=U(t),i=o(n);return!(!i||n2(i))&&e(t)}),a=new Map(r.map(t=>[U(t),t])),l=i.filter(t=>{let{source:e,target:n}=t;return!!(a.has(e)&&a.has(n))});return{nodes:r,edges:l,combos:s}}initGraphLayout(t){var e,n;let{element:i,viewport:s}=this.context,{type:o,enableWorker:r,animation:a,iterations:l}=t,h=ob(t,["type","enableWorker","animation","iterations"]),[d,c]=s.getCanvasSize(),u=[d/2,c/2],p=null!==(e=null==t?void 0:t.nodeSize)&&void 0!==e?e:t=>{let e=null==i?void 0:i.getElement(t.id),{size:n}=(null==e?void 0:e.attributes)||{};return Math.max(...el(n))},g=B("layout",o);if(!g)return F.warn("The layout of ".concat(o," is not registered."));let f=Object.getPrototypeOf(g.prototype)===ia.prototype?g:(n=this.context,class extends ia{execute(t,e){var n,i,s,o;return n=this,i=void 0,s=void 0,o=function*(){return ih((yield this.instance.execute(this.graphData2LayoutModel(t),this.transformOptions((0,G.Z)({},this.options,e)))))},new(s||(s=Promise))(function(t,e){function r(t){try{l(o.next(t))}catch(t){e(t)}}function a(t){try{l(o.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):((n=e.value)instanceof s?n:new s(function(t){t(n)})).then(r,a)}l((o=o.apply(n,i||[])).next())})}transformOptions(t){let{onTick:e}=t;return e&&(t.onTick=t=>e(ih(t))),t}graphData2LayoutModel(t){let{nodes:e=[],edges:i=[],combos:s=[]}=t,o=e.map(t=>{let e=U(t),{data:n,style:i,combo:s}=t,o=il(t,["data","style","combo"]),r={id:e,data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),{data:n}),s?{parentId:s}:{}),{style:i}),o)};return(null==i?void 0:i.x)&&Object.assign(r.data,{x:i.x}),(null==i?void 0:i.y)&&Object.assign(r.data,{y:i.y}),(null==i?void 0:i.z)&&Object.assign(r.data,{z:i.z}),r}),r=new Map(o.map(t=>[t.id,t])),a=i.filter(t=>{let{source:e,target:n}=t;return r.has(e)&&r.has(n)}).map(t=>{let{source:e,target:n,data:i,style:s}=t;return{id:U(t),source:e,target:n,data:Object.assign({},i),style:Object.assign({},s)}}),l=s.map(t=>({id:U(t),data:Object.assign({_isCombo:!0},t.data),style:Object.assign({},t.style)})),h=new ir.k({nodes:[...o,...l],edges:a});return n.model.model.hasTreeStructure(N)&&(h.attachTreeStructure(N),o.forEach(t=>{let e=n.model.model.getParent(t.id,N);e&&h.hasNode(e.id)&&h.setParent(t.id,e.id,N)})),h}constructor(t,e){if(super(t,e),this.instance=new g({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){let t=this.instance;this.stop=t.stop.bind(t),this.tick=e=>{let n=t.tick(e);return ih(n)}}}}),m=new f(this.context),y={nodeSize:p,width:d,height:c,center:u};switch(m.id){case"d3-force":case"d3-force-3d":Object.assign(y,{center:{x:d/2,y:c/2,z:0}})}return(0,G.Z)(m.options,y,h),m}updateElementPosition(t,e){let{model:n,element:i}=this.context;return i?(n.updateData(t),i.draw({animation:e,silence:!0})):null}destroy(){var t;this.stopLayout(),this.context={},null===(t=this.supervisor)||void 0===t||t.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}constructor(t){this.instances=[],this.context=t}}let ox=(t,e)=>{var n;let[i,s]=e;null===(n=t.nodes)||void 0===n||n.forEach(t=>{if(t.style){let{x:e=0,y:n=0}=t.style;t.style.x=e+i,t.style.y=n+s}else t.style={x:i,y:s}})};class oO extends tn{setPlugins(t){this.setExtensions(t)}getPluginInstance(t){let e=this.extensionMap[t];if(e)return e;F.warn("Cannot find the plugin ".concat(t,", will try to find it by type."));let n=this.extensions.find(e=>e.type===t);if(n)return this.extensionMap[n.key]}constructor(t){super(t),this.category="plugin",this.setPlugins(this.context.options.plugins||[])}}let oS=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class ow extends tn{getTransforms(){}setTransforms(t){this.setExtensions([...oS.slice(0,oS.length-1),...t,oS[oS.length-1]])}getTransformInstance(t){return t?this.extensionMap[t]:this.extensionMap}constructor(t){super(t),this.category="transform",this.setTransforms(this.context.options.transforms||[])}}var oD=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})};class oC{get padding(){return th(this.context.options.padding)}get paddingOffset(){let[t,e,n,i]=this.padding,[s,o,r]=[(i-e)/2,(t-n)/2,0];return[s,o,r]}get camera(){let{canvas:t}=this.context;return new Proxy(t.getCamera(),{get:(e,n)=>{let i=Object.entries(t.getLayers()).filter(t=>{let[e]=t;return!["main"].includes(e)}),s=i.map(t=>{let[,e]=t;return e.getCamera()}),o=e[n];if("function"==typeof o)return function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];let a=o.apply(e,i);return s.forEach(t=>{t[n].apply(t,i)}),a}}})}createLandmark(t){return this.camera.createLandmark("landmark-".concat(this.landmarkCounter++),t)}getAnimation(t){let e=K(this.context.options,t);return!!e&&(0,eQ.Z)(Object.assign({},e),["easing","duration"])}getCanvasSize(){let{canvas:t}=this.context,{width:e=0,height:n=0}=t.getConfig();return[e,n]}getCanvasCenter(){let{canvas:t}=this.context,{width:e=0,height:n=0}=t.getConfig();return[e/2,n/2,0]}getViewportCenter(){let[t,e]=this.camera.getPosition();return[t,e,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(t){let{camera:e}=this,{mode:n,translate:i=[]}=t,s=this.getZoom(),o=e.getPosition(),r=e.getFocalPoint(),[a,l]=this.getCanvasCenter(),[h=0,d=0,c=0]=i,u=tC([-h,-d,-c],s);return"relative"===n?{position:tS(o,u),focalPoint:tS(r,u)}:{position:tS([a,l,o[2]],u),focalPoint:tS([a,l,r[2]],u)}}getRotateOptions(t){let{mode:e,rotate:n=0}=t,i="relative"===e?this.camera.getRoll()+n:n;return{roll:i}}getZoomOptions(t){let{zoomRange:e}=this.context.options,n=this.camera.getZoom(),{mode:i,scale:s=1}=t;return(0,iD.Z)("relative"===i?n*s:s,...e)}transform(t,e){return oD(this,void 0,void 0,function*(){let{graph:n}=this.context,{translate:i,rotate:s,scale:o,origin:r}=t;this.cancelAnimation();let a=this.getAnimation(e);if(s1(n,new s0(O.BEFORE_TRANSFORM,t)),!s&&o&&!i&&r&&!a){this.camera.setZoomByViewportPoint(this.getZoomOptions(t),r),s1(n,new s0(O.AFTER_TRANSFORM,t));return}let l={};if(i&&Object.assign(l,this.getTranslateOptions(t)),(0,eV.Z)(s)&&Object.assign(l,this.getRotateOptions(t)),(0,eV.Z)(o)&&Object.assign(l,{zoom:this.getZoomOptions(t)}),a)return s1(n,new sQ(O.BEFORE_ANIMATE,m.TRANSFORM,null,t)),new Promise(e=>{this.transformResolver=e,this.camera.gotoLandmark(this.createLandmark(l),Object.assign(Object.assign({},a),{onfinish:()=>{s1(n,new sQ(O.AFTER_ANIMATE,m.TRANSFORM,null,t)),s1(n,new s0(O.AFTER_TRANSFORM,t)),this.transformResolver=void 0,e()}}))});this.camera.gotoLandmark(this.createLandmark(l),{duration:0}),s1(n,new s0(O.AFTER_TRANSFORM,t))})}fitView(t,e){return oD(this,void 0,void 0,function*(){let[n,i,s,o]=this.padding,{when:r="always",direction:a="both"}=t||{},[l,h]=this.context.canvas.getSize(),d=l-o-i,c=h-n-s,u=this.context.canvas.getBounds(),p=this.getBBoxInViewport(u),[g,f]=tu(p);if("overflow"===r&&!("x"===a&&g>=d||"y"===a&&f>=c||"both"===a&&g>=d&&f>=c))return yield this.fitCenter(e);let m=d/g,y=c/f,v="x"===a?m:"y"===a?y:Math.min(m,y),b=this.getAnimation(e);yield this.transform({mode:"relative",scale:v,translate:tS(tw(this.getCanvasCenter(),this.getBBoxInViewport(u).center),tC(this.paddingOffset,v))},b)})}fitCenter(t){return oD(this,void 0,void 0,function*(){let e=this.context.canvas.getBounds();yield this.focus(e,t)})}focusElements(t,e){return oD(this,void 0,void 0,function*(){let{element:n}=this.context;if(!n)return;let i=tm(t.map(t=>n.getElement(t).getRenderBounds()));yield this.focus(i,e)})}focus(t,e){return oD(this,void 0,void 0,function*(){let n=this.context.graph.getViewportByCanvas(t.center),i=this.getCanvasCenter(),s=tw(i,n);yield this.transform({mode:"relative",translate:tS(s,this.paddingOffset)},e)})}getBBoxInViewport(t){let{min:e,max:n}=t,{graph:i}=this.context,[s,o]=i.getViewportByCanvas(e),[r,a]=i.getViewportByCanvas(n),l=new A.mN;return l.setMinMax([s,o,0],[r,a,0]),l}isInViewport(t){let{graph:e}=this.context,n=this.getCanvasSize(),[i,s]=e.getCanvasByViewport([0,0]),[o,r]=e.getCanvasByViewport(n),a=new A.mN;return a.setMinMax([i,s,0],[o,r,0]),ta(t)?ty(t,a):a.intersects(t)}cancelAnimation(){var t,e;(null===(t=this.camera.landmarks)||void 0===t?void 0:t.length)&&this.camera.cancelLandmarkAnimation(),null===(e=this.transformResolver)||void 0===e||e.call(this)}constructor(t){this.landmarkCounter=0,this.context=t;let[e,n]=this.paddingOffset,{zoom:i,rotation:s,x:o=e,y:r=n}=t.options;this.transform({mode:"absolute",scale:i,translate:[o,r],rotate:s},!1)}}var oA=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((i=i.apply(t,e||[])).next())})};class oM extends i5.Z{getOptions(){return this.options}setOptions(t){this._setOptions(t,!1)}_setOptions(t,e){if(this.updateCanvas(t),e){let{data:e}=t;e&&this.addData(e);return}Object.assign(this.options,t);let{behaviors:n,combo:i,data:s,edge:o,layout:r,node:a,plugins:l,theme:h,transforms:d}=t;n&&this.setBehaviors(n),s&&this.setData(s),a&&this.setNode(a),o&&this.setEdge(o),i&&this.setCombo(i),r&&this.setLayout(r),h&&this.setTheme(h),l&&this.setPlugins(l),d&&this.setTransforms(d)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(t,e){var n;Object.assign(this.options,{width:t,height:e}),null===(n=this.context.canvas)||void 0===n||n.resize(t,e)}setZoomRange(t){this.options.zoomRange=t}getZoomRange(){return this.options.zoomRange}setNode(t){this.options.node=t,this.context.model.refreshData()}setEdge(t){this.options.edge=t,this.context.model.refreshData()}setCombo(t){this.options.combo=t,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(t){this.options.theme=(0,to.Z)(t)?t(this.getTheme()):t}setLayout(t){this.options.layout=(0,to.Z)(t)?t(this.getLayout()):t}getLayout(){return this.options.layout}setBehaviors(t){var e;this.options.behaviors=(0,to.Z)(t)?t(this.getBehaviors()):t,null===(e=this.context.behavior)||void 0===e||e.setBehaviors(this.options.behaviors)}updateBehavior(t){this.setBehaviors(e=>e.map(e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e))}getBehaviors(){return this.options.behaviors||[]}setPlugins(t){var e;this.options.plugins=(0,to.Z)(t)?t(this.getPlugins()):t,null===(e=this.context.plugin)||void 0===e||e.setPlugins(this.options.plugins)}updatePlugin(t){this.setPlugins(e=>e.map(e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e))}getPlugins(){return this.options.plugins||[]}getPluginInstance(t){return this.context.plugin.getPluginInstance(t)}setTransforms(t){var e;this.options.transforms=(0,to.Z)(t)?t(this.getTransforms()):t,null===(e=this.context.transform)||void 0===e||e.setTransforms(this.options.transforms)}updateTransform(t){this.setTransforms(e=>e.map(e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(t){return Array.isArray(t)?t.map(t=>this.context.model.getElementDataById(t)):this.context.model.getElementDataById(t)}getNodeData(t){var e;return void 0===t?this.context.model.getNodeData():Array.isArray(t)?this.context.model.getNodeData(t):null===(e=this.context.model.getNodeData([t]))||void 0===e?void 0:e[0]}getEdgeData(t){var e;return void 0===t?this.context.model.getEdgeData():Array.isArray(t)?this.context.model.getEdgeData(t):null===(e=this.context.model.getEdgeData([t]))||void 0===e?void 0:e[0]}getComboData(t){var e;return void 0===t?this.context.model.getComboData():Array.isArray(t)?this.context.model.getComboData(t):null===(e=this.context.model.getComboData([t]))||void 0===e?void 0:e[0]}setData(t){this.context.model.setData((0,to.Z)(t)?t(this.getData()):t)}addData(t){this.context.model.addData((0,to.Z)(t)?t(this.getData()):t)}addNodeData(t){this.context.model.addNodeData((0,to.Z)(t)?t(this.getNodeData()):t)}addEdgeData(t){this.context.model.addEdgeData((0,to.Z)(t)?t(this.getEdgeData()):t)}addComboData(t){this.context.model.addComboData((0,to.Z)(t)?t(this.getComboData()):t)}addChildrenData(t,e){this.context.model.addChildrenData(t,e)}updateData(t){this.context.model.updateData((0,to.Z)(t)?t(this.getData()):t)}updateNodeData(t){this.context.model.updateNodeData((0,to.Z)(t)?t(this.getNodeData()):t)}updateEdgeData(t){this.context.model.updateEdgeData((0,to.Z)(t)?t(this.getEdgeData()):t)}updateComboData(t){this.context.model.updateComboData((0,to.Z)(t)?t(this.getComboData()):t)}removeData(t){this.context.model.removeData((0,to.Z)(t)?t(this.getData()):t)}removeNodeData(t){this.context.model.removeNodeData((0,to.Z)(t)?t(this.getNodeData()):t)}removeEdgeData(t){this.context.model.removeEdgeData((0,to.Z)(t)?t(this.getEdgeData()):t)}removeComboData(t){this.context.model.removeComboData((0,to.Z)(t)?t(this.getComboData()):t)}getElementType(t){return this.context.model.getElementType(t)}getRelatedEdgesData(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"both";return this.context.model.getRelatedEdgesData(t,e)}getNeighborNodesData(t){return this.context.model.getNeighborNodesData(t)}getAncestorsData(t,e){return this.context.model.getAncestorsData(t,e)}getParentData(t,e){return this.context.model.getParentData(t,e)}getChildrenData(t){return this.context.model.getChildrenData(t)}getDescendantsData(t){return this.context.model.getDescendantsData(t)}getElementDataByState(t,e){return this.context.model.getElementDataByState(t,e)}initCanvas(){return oA(this,void 0,void 0,function*(){var t;if(this.context.canvas)return yield this.context.canvas.ready;let{container:e="container",width:n,height:i,renderer:s,cursor:o,background:r,devicePixelRatio:a=null!==(t=window.devicePixelRatio)&&void 0!==t?t:1}=this.options;if(e instanceof ot)this.context.canvas=e,o&&e.setCursor(o),s&&e.setRenderer(s),yield e.ready;else{let t=(0,tQ.Z)(e)?document.getElementById(e):e,l=iK(t);this.emit(O.BEFORE_CANVAS_INIT,{container:t,width:n,height:i});let h=new ot({container:t,width:n||l[0],height:i||l[1],background:r,renderer:s,cursor:o,devicePixelRatio:a});this.context.canvas=h,yield h.ready,this.emit(O.AFTER_CANVAS_INIT,{canvas:h})}})}updateCanvas(t){var e,n;let{renderer:i,cursor:s,height:o,width:r}=t,a=this.context.canvas;a&&(i&&(this.emit(O.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),a.setRenderer(i),this.emit(O.AFTER_RENDERER_CHANGE,{renderer:i})),s&&a.setCursor(s),((0,eV.Z)(r)||(0,eV.Z)(o))&&this.setSize(null!==(e=null!=r?r:this.options.width)&&void 0!==e?e:0,null!==(n=null!=o?o:this.options.height)&&void 0!==n?n:0))}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new s6(this.context)),this.context.plugin||(this.context.plugin=new oO(this.context)),this.context.viewport||(this.context.viewport=new oC(this.context)),this.context.transform||(this.context.transform=new ow(this.context)),this.context.element||(this.context.element=new op(this.context)),this.context.animation||(this.context.animation=new s3(this.context)),this.context.layout||(this.context.layout=new oE(this.context)),this.context.behavior||(this.context.behavior=new s2(this.context))}prepare(){return oA(this,void 0,void 0,function*(){if(yield Promise.resolve(),this.destroyed)throw Error(_("The graph instance has been destroyed"));yield this.initCanvas(),this.initRuntime()})}render(){return oA(this,void 0,void 0,function*(){yield this.prepare(),s1(this,new sq(O.BEFORE_RENDER));let t=this.context.element.draw({type:"render"});yield Promise.all([null==t?void 0:t.finished,this.context.layout.layout()]),yield this.autoFit(),s1(this,new sq(O.AFTER_RENDER))})}draw(){return oA(this,void 0,void 0,function*(){var t;yield this.prepare(),yield null===(t=this.context.element.draw())||void 0===t?void 0:t.finished})}layout(){return oA(this,void 0,void 0,function*(){yield this.context.layout.layout()})}stopLayout(){this.context.layout.stopLayout()}clear(){return oA(this,void 0,void 0,function*(){this.context.model.setData({}),yield this.draw()})}destroy(){s1(this,new sq(O.BEFORE_DESTROY));let{layout:t,animation:e,element:n,model:i,canvas:s,behavior:o,plugin:r}=this.context;null==r||r.destroy(),null==o||o.destroy(),null==t||t.destroy(),null==e||e.destroy(),null==n||n.destroy(),i.destroy(),null==s||s.destroy(),this.options={},this.context={},this.off(),window.removeEventListener("resize",this.onResize),this.destroyed=!0,s1(this,new sq(O.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(t,e){let n=t&&e?[t,e]:iK(this.context.canvas.getContainer());(0,R.Z)(n,this.getSize())||(s1(this,new sq(O.BEFORE_SIZE_CHANGE,{size:n})),this.context.canvas.resize(...n),s1(this,new sq(O.AFTER_SIZE_CHANGE,{size:n})))}fitView(t,e){return oA(this,void 0,void 0,function*(){var n;yield null===(n=this.context.viewport)||void 0===n?void 0:n.fitView(t,e)})}fitCenter(t){return oA(this,void 0,void 0,function*(){var e;yield null===(e=this.context.viewport)||void 0===e?void 0:e.fitCenter(t)})}autoFit(){return oA(this,void 0,void 0,function*(){let{autoFit:t}=this.context.options;if(t){if((0,tQ.Z)(t))"view"===t?yield this.fitView():"center"===t&&(yield this.fitCenter());else{let{type:e,animation:n}=t;"view"===e?yield this.fitView(t.options,n):"center"===e&&(yield this.fitCenter(n))}}})}focusElement(t,e){return oA(this,void 0,void 0,function*(){var n;yield null===(n=this.context.viewport)||void 0===n?void 0:n.focusElements(Array.isArray(t)?t:[t],e)})}zoomBy(t,e,n){return oA(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",scale:t,origin:n},e)})}zoomTo(t,e,n){return oA(this,void 0,void 0,function*(){this.context.viewport.transform({mode:"absolute",scale:t,origin:n},e)})}getZoom(){return this.context.viewport.getZoom()}rotateBy(t,e,n){return oA(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",rotate:t,origin:n},e)})}rotateTo(t,e,n){return oA(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",rotate:t,origin:n},e)})}getRotation(){return this.context.viewport.getRotation()}translateBy(t,e){return oA(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",translate:t},e)})}translateTo(t,e){return oA(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",translate:t},e)})}getPosition(){return tw([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(t,e){return oA(this,arguments,void 0,function*(t,e){var n;let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],[s,o]=(0,P.Z)(t)?[t,null==e||e]:[{[t]:e},i];Object.entries(s).forEach(t=>{let[e,n]=t;return this.context.model.translateNodeLikeBy(e,n)}),yield null===(n=this.context.element.draw({animation:o,stage:"translate"}))||void 0===n?void 0:n.finished})}translateElementTo(t,e){return oA(this,arguments,void 0,function*(t,e){var n;let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],[s,o]=(0,P.Z)(t)?[t,null==e||e]:[{[t]:e},i];Object.entries(s).forEach(t=>{let[e,n]=t;return this.context.model.translateNodeLikeTo(e,n)}),yield null===(n=this.context.element.draw({animation:o,stage:"translate"}))||void 0===n?void 0:n.finished})}getElementPosition(t){return this.context.model.getElementPosition(t)}getElementRenderStyle(t){return(0,iW.Z)(this.context.element.getElement(t).attributes,["context"])}setElementVisibility(t,e){return oA(this,arguments,void 0,function*(t,e){var n;let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],[s,o]=(0,P.Z)(t)?[t,null==e||e]:[{[t]:e},i],r={nodes:[],edges:[],combos:[]};Object.entries(s).forEach(t=>{let[e,n]=t,i=this.getElementType(e);r["".concat(i,"s")].push({id:e,style:{visibility:n}})});let{model:a,element:l}=this.context;a.preventUpdateNodeLikeHierarchy(()=>{a.updateData(r)}),yield null===(n=l.draw({animation:o,stage:"visibility"}))||void 0===n?void 0:n.finished})}showElement(t,e){return oA(this,void 0,void 0,function*(){let n=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(n.map(t=>[t,"visible"])),e)})}hideElement(t,e){return oA(this,void 0,void 0,function*(){let n=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(n.map(t=>[t,"hidden"])),e)})}getElementVisibility(t){var e,n;let i=this.context.element.getElement(t);return null!==(n=null===(e=null==i?void 0:i.style)||void 0===e?void 0:e.visibility)&&void 0!==n?n:"visible"}setElementZIndex(t,e){return oA(this,void 0,void 0,function*(){var n;let i={nodes:[],edges:[],combos:[]},s=(0,P.Z)(t)?t:{[t]:e};Object.entries(s).forEach(t=>{let[e,n]=t,s=this.getElementType(e);i["".concat(s,"s")].push({id:e,style:{zIndex:n}})});let{model:o,element:r}=this.context;o.preventUpdateNodeLikeHierarchy(()=>o.updateData(i)),yield null===(n=r.draw({animation:!1,stage:"zIndex"}))||void 0===n?void 0:n.finished})}frontElement(t){return oA(this,void 0,void 0,function*(){let e=Array.isArray(t)?t:[t],{model:n,element:i}=this.context,s={};e.map(t=>{let e=i.getFrontZIndex(t),o=n.getElementType(t);if("combo"===o){let o=n.getAncestorsData(t,N).at(-1)||this.getComboData(t),r=[o,...n.getDescendantsData(U(o))],a=e-i.getElementZIndex(t);r.forEach(t=>{s[U(t)]=this.getElementZIndex(U(t))+a});let{internal:l}=nm(r.map(U),t=>n.getRelatedEdgesData(t));l.forEach(t=>{let e=U(t);s[e]=this.getElementZIndex(e)+a})}else s[t]=e}),yield this.setElementZIndex(s)})}getElementZIndex(t){var e,n,i;let{model:s,element:o}=this.context;return null!==(i=null===(n=null===(e=s.getElementDataById(t))||void 0===e?void 0:e.style)||void 0===n?void 0:n.zIndex)&&void 0!==i?i:o.getElementZIndex(t)}setElementState(t,e){return oA(this,arguments,void 0,function*(t,e){var n;let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],[s,o]=(0,P.Z)(t)?[t,null==e||e]:[{[t]:e},i],r=t=>t?Array.isArray(t)?t:[t]:[],a={nodes:[],edges:[],combos:[]};Object.entries(s).forEach(t=>{let[e,n]=t,i=this.getElementType(e);a["".concat(i,"s")].push({id:e,states:r(n)})}),this.updateData(a),yield null===(n=this.context.element.draw({animation:o}))||void 0===n?void 0:n.finished})}getElementState(t){return this.context.model.getElementState(t)}getElementRenderBounds(t){return this.context.element.getElement(t).getRenderBounds()}collapseElement(t){return oA(this,arguments,void 0,function*(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{model:n,element:i}=this.context;if(et(n.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;let s=n.getElementType(t);yield this.frontElement(t),this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!0),"node"===s?yield i.collapseNode(t,e):"combo"===s&&(yield i.collapseCombo(t,e)),this.isCollapsingExpanding=!1})}expandElement(t){return oA(this,arguments,void 0,function*(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{model:n,element:i}=this.context;if(!et(n.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;let s=n.getElementType(t);this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!1),"node"===s?yield i.expandNode(t,e):"combo"===s&&(yield i.expandCombo(t,e)),this.isCollapsingExpanding=!1})}setElementCollapsibility(t,e){let n=this.getElementType(t);"node"===n?this.updateNodeData([{id:t,style:{collapsed:e}}]):"combo"===n&&this.updateComboData([{id:t,style:{collapsed:e}}])}toDataURL(){return oA(this,arguments,void 0,function*(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.context.canvas.toDataURL(t)})}getCanvasByViewport(t){return this.context.canvas.getCanvasByViewport(t)}getViewportByCanvas(t){return this.context.canvas.getViewportByCanvas(t)}getClientByCanvas(t){return this.context.canvas.getClientByCanvas(t)}getCanvasByClient(t){return this.context.canvas.getCanvasByClient(t)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(t,e,n){return super.on(t,e,n)}once(t,e){return super.once(t,e)}off(t,e){return super.off(t,e)}constructor(t){super(),this.destroyed=!1,this.context={model:new oc},this.isCollapsingExpanding=!1,this.onResize=(0,it.Z)(()=>{this.resize()},300),this.options=Object.assign({},oM.defaultOptions,t),this._setOptions(this.options,!0),this.context.graph=this,this.options.autoResize&&window.addEventListener("resize",this.onResize)}}oM.defaultOptions={autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]};let oT=(t,e)=>{let{source:n,target:i}=e,s=t.getElementDataById(n),o=t.getElementDataById(i),r=ny(s,e=>t.getParentData(e,N)),a=ny(o,e=>t.getParentData(e,N)),l=U(r),h=U(a),d={sourceNode:l,targetNode:h};return e.style?Object.assign(e.style,d):e.style=d,e};var oR=n(92776);let oP=(t,e,n)=>{let[i,s]=e,[o,r]=n;return s===i?o:o+(t-i)/(s-i)*(r-o)},ok=(t,e,n)=>{let[i,s]=e,[o,r]=n;return o+Math.log(t-i+1)/Math.log(s-i+1)*(r-o)},oL=function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,[s,o]=e,[r,a]=n;return r+Math.pow((t-s)/(o-s),i)*(a-r)},oN=(t,e,n)=>{let[i,s]=e,[o,r]=n;return o+Math.sqrt((t-i)/(s-i))*(r-o)};class oj extends sH{beforeDraw(t){let{model:e}=this.context,n=e.getNodeData(),i=el(this.options.maxSize),s=el(this.options.minSize),o=this.getCentralities(this.options.centrality),r=o.size>0?Math.max(...o.values()):0,a=o.size>0?Math.min(...o.values()):0;return n.forEach(e=>{var n;let l=this.assignSizeByCentrality(o.get(U(e))||0,a,r,s,i,this.options.scale),h=null===(n=this.context.element)||void 0===n?void 0:n.getElement(U(e));X(t,h?"update":"add","node",(0,G.Z)(e,{style:{size:l}}))}),t}getCentralities(t){var e;let{model:n}=this.context,i=n.getData();if("function"==typeof t)return t(i);switch(t.type){case"degree":{let s=new Map;return null===(e=i.nodes)||void 0===e||e.forEach(e=>{let i=n.getRelatedEdgesData(U(e),t.direction).length;s.set(U(e),i)}),s}case"betweenness":return oB(i,t.directed,t.weightPropertyName);case"closeness":return o_(i,t.directed,t.weightPropertyName);case"eigenvector":return oz(i,t.directed);case"pagerank":return oF(i,t.epsilon,t.linkProb);default:return oI(i)}}constructor(t,e){super(t,(0,G.Z)({},oj.defaultOptions,e)),this.assignSizeByCentrality=(t,e,n,i,s,o)=>{let r=[e,n],a=[i[0],s[0]],l=[i[1],s[1]],h=[i[2],s[2]],d=(t,e)=>{if("function"==typeof o)return o(t,r,e);switch(o){case"linear":return oP(t,r,e);case"log":return ok(t,r,e);case"pow":return oL(t,r,e,2);case"sqrt":return oN(t,r,e);default:return e[0]}};return[d(t,a),d(t,l),d(t,h)]}}}oj.defaultOptions={centrality:{type:"degree"},maxSize:80,minSize:20,scale:"log"};let oI=t=>{var e;let n=new Map;return null===(e=t.nodes)||void 0===e||e.forEach(t=>{n.set(U(t),0)}),n},oB=(t,e,n)=>{let i=oI(t),{nodes:s=[]}=t;return s.forEach(o=>{s.forEach(s=>{if(o!==s){let{allPath:r}=(0,oR.ni)(t,U(o),U(s),e,n),a=r.length;r.flat().forEach(t=>{t!==U(o)&&t!==U(s)&&i.set(t,i.get(t)+1/a)})}})}),i},o_=(t,e,n)=>{let i=new Map,{nodes:s=[]}=t;return s.forEach(o=>{let r=s.reduce((i,s)=>{if(o!==s){let{length:r}=(0,oR.ni)(t,U(o),U(s),e,n);i+=r}return i},0);i.set(U(o),1/r)}),i},oF=(t,e,n)=>{var i;let s=new Map,o=(0,oR.EF)(t,e,n);return null===(i=t.nodes)||void 0===i||i.forEach(t=>{s.set(U(t),o[U(t)])}),s},oz=(t,e)=>{let{nodes:n=[]}=t,i=oZ(t,e),s=oW(i,n.length),o=new Map;return n.forEach((t,e)=>{o.set(U(t),s[e])}),o},oZ=(t,e)=>{let{nodes:n=[],edges:i=[]}=t,s=Array(n.length).fill(null).map(()=>Array(n.length).fill(0));return i.forEach(t=>{let{source:i,target:o}=t,r=n.findIndex(t=>U(t)===i),a=n.findIndex(t=>U(t)===o);e?s[r][a]=1:(s[r][a]=1,s[a][r]=1)}),s},oW=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6,s=Array(e).fill(1),o=1/0;for(let r=0;r<n&&o>i;r++){let n=Array(e).fill(0);for(let i=0;i<e;i++)for(let o=0;o<e;o++)n[i]+=t[i][o]*s[o];let i=Math.sqrt(n.reduce((t,e)=>t+e*e,0));for(let t=0;t<e;t++)n[t]/=i;o=Math.sqrt(n.reduce((t,e,n)=>t+(e-s[n])*e,0)),s=n}return s};class oV extends sH{get ref(){return this.context.model.getRootsData()[0]}afterLayout(){var t;let e=tF(this.ref),{graph:n,model:i}=this.context,s=i.getData();null===(t=s.nodes)||void 0===t||t.forEach(t=>{if(U(t)===U(this.ref))return;let s=tj(tw(tF(t),e)),o=Math.abs(s)>Math.PI/2,r=!t.children||0===t.children.length,a=el(n.getElementRenderStyle(U(t)).size)[0]/2,l=(r?1:-1)*(a+this.options.offset),h="translate(".concat(l*Math.cos(s),",").concat(l*Math.sin(s),")"),d="rotate(".concat(o?(0,A.BV)(s)+180:(0,A.BV)(s),"deg)");i.updateNodeData([{id:U(t),style:{labelTextAlign:o===r?"right":"left",labelTextBaseline:"middle",labelTransform:"".concat(h," ").concat(d)}}])}),n.draw()}constructor(t,e){super(t,Object.assign({},oV.defaultOptions,e))}}oV.defaultOptions={offset:5};var oK=n(29803);let oG=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"];class oU extends sH{beforeDraw(t){let e=this.getAffectedParallelEdges(t);return 0===e.size||("bundle"===this.options.mode?this.applyBundlingStyle(t,e,this.options.distance):this.applyMergingStyle(t,e)),t}constructor(t,e){super(t,Object.assign({},oU.defaultOptions,e)),this.cacheMergeStyle=new Map,this.getAffectedParallelEdges=t=>{let{add:{edges:e},update:{nodes:n,edges:i,combos:s},remove:{edges:o}}=t,{model:r}=this.context,a=new Map,l=(t,e)=>{let n=r.getRelatedEdgesData(e);n.forEach(t=>!a.has(U(t))&&a.set(U(t),t))};n.forEach(l),s.forEach(l);let h=t=>{let e=r.getEdgeData().map(t=>oT(r,t)),n=oY(t,e,!0);n.forEach(t=>!a.has(U(t))&&a.set(U(t),t))};if(o.size&&o.forEach(h),e.size&&e.forEach(h),i.size){let t=st(i7(r.getChanges())).update.edges;i.forEach(e=>{var n;h(e);let i=null===(n=t.find(t=>U(t.value)===U(e)))||void 0===n?void 0:n.original;i&&!oX(e,i)&&h(i)})}(0,eO.Z)(this.options.edges)||a.forEach((t,e)=>!this.options.edges.includes(e)&&a.delete(e));let d=r.getEdgeData().map(U);return new Map([...a].sort((t,e)=>d.indexOf(t[0])-d.indexOf(e[0])))},this.applyBundlingStyle=(t,e,n)=>{let{edgeMap:i,reverses:s}=oH(e);i.forEach(e=>{e.forEach((e,i,o)=>{var r;let a=Object.assign(e,{type:"quadratic",style:(()=>{let t=o.length,r={};if(e.source===e.target){let t=oG.length;r.loopPlacement=oG[i%t],r.loopDist=Math.floor(i/t)*n+50}else if(1===t)r.curveOffset=0;else{let o=(i%2==0?1:-1)*(s["".concat(e.source,"|").concat(e.target,"|").concat(i)]?-1:1);r.curveOffset=t%2==1?o*Math.ceil(i/2)*n*2:o*(Math.floor(i/2)*n*2+n)}return Object.assign({},e.style,r)})()}),l=null===(r=this.context.element)||void 0===r?void 0:r.getElement(U(e));l?X(t,"update","edge",a,!0):X(t,"add","edge",a,!0)})})},this.resetEdgeStyle=t=>{let e=t.style||{},n=this.cacheMergeStyle.get(U(t))||{};return Object.keys(n).forEach(i=>{(0,R.Z)(e[i],n[i])&&(t[i]?e[i]=t[i]:delete e[i])}),Object.assign(t,{style:e})},this.applyMergingStyle=(t,e)=>{let{edgeMap:n,reverses:i}=oH(e);n.forEach(e=>{var n;if(1===e.length){let i=e[0],s=null===(n=this.context.element)||void 0===n?void 0:n.getElement(U(i));X(t,s?"update":"add","edge",this.resetEdgeStyle(i),!0);return}let s=e.map((t,e)=>{let{source:n,target:s,style:o={}}=t,{startArrow:r,endArrow:a}=o,l={},[h,d]=i["".concat(n,"|").concat(s,"|").concat(e)]?["endArrow","startArrow"]:["startArrow","endArrow"];return(0,oK.Z)(r)&&(l[h]=r),(0,oK.Z)(a)&&(l[d]=a),l}).reduce((t,e)=>Object.assign(Object.assign({},t),e),{});e.forEach((e,n,i)=>{var o;if(0===n){let n=Object.assign({},(0,to.Z)(this.options.style)?this.options.style(i):this.options.style,{childrenData:i});this.cacheMergeStyle.set(U(e),n);let r=Object.assign(Object.assign({},e),{type:"line",style:Object.assign(Object.assign({},s),n)}),a=null===(o=this.context.element)||void 0===o?void 0:o.getElement(U(e));X(t,a?"update":"add","edge",r,!0)}else X(t,"remove","edge",e)})})}}}oU.defaultOptions={mode:"bundle",edges:void 0,distance:15};let oH=t=>{let e=new Map,n=new Set,i={};for(let[s,o]of t){if(n.has(s))continue;let{source:r,target:a}=o,l="".concat(r,"-").concat(a);for(let[h,d]of(e.has(l)||e.set(l,[]),e.get(l).push(o),n.add(s),t))!n.has(h)&&oX(o,d)&&(e.get(l).push(d),n.add(h),r===d.target&&a===d.source&&(i["".concat(d.source,"|").concat(d.target,"|").concat(e.get(l).length-1)]=!0))}return{edgeMap:e,reverses:i}},oY=(t,e,n)=>e.filter(e=>(n||U(e)!==U(t))&&oX(e,t)),oX=(t,e)=>{let{sourceNode:n,targetNode:i}=t.style||{},{sourceNode:s,targetNode:o}=e.style||{};return n===s&&i===o||n===o&&i===s},o$={animation:{"combo-collapse":tt,"combo-expand":tt,"node-collapse":Q,"node-expand":Q,"path-in":J,"path-out":J,fade:[{fields:["opacity"]}],translate:[{fields:["x","y"]}]},behavior:{"brush-select":t1,"click-select":t7,"collapse-expand":n4,"create-edge":n7,"drag-canvas":ii,"drag-element-force":class extends io{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(t=>["d3-force","d3-force-3d"].includes(null==t?void 0:t.id))}validate(t){return!!this.context.layout&&(this.forceLayoutInstance?super.validate(t):(F.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1))}moveElement(t,e){var n,i,s,o;return n=this,i=void 0,s=void 0,o=function*(){let n=this.forceLayoutInstance;this.context.graph.getNodeData(t).forEach((i,s)=>{let{x:o=0,y:r=0}=i.style||{};n&&id(n,"setFixedPosition",t[s],[...tS([+o,+r],e)])})},new(s||(s=Promise))(function(t,e){function r(t){try{l(o.next(t))}catch(t){e(t)}}function a(t){try{l(o.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):((n=e.value)instanceof s?n:new s(function(t){t(n)})).then(r,a)}l((o=o.apply(n,i||[])).next())})}onDragStart(t){if(this.enable=this.validate(t),!this.enable)return;this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);let e=this.forceLayoutInstance;e&&ic(e,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(t=>{let{x:n=0,y:i=0}=t.style||{};e&&id(e,"setFixedPosition",U(t),[+n,+i])})}onDrag(t){if(!this.enable)return;let e=this.getDelta(t);this.moveElement(this.target,e)}onDragEnd(){let t=this.forceLayoutInstance;t&&ic(t,"simulation").alphaTarget(0),this.context.graph.getNodeData(this.target).forEach(e=>{t&&id(t,"setFixedPosition",U(e),[null,null,null])})}},"drag-element":io,"fix-element-size":ib,"focus-element":iE,"hover-activate":ix,"lasso-select":class extends t1{onPointerDown(t){if(!super.validate(t)||!super.isKeydown()||this.points)return;let{canvas:e}=this.context;this.pathShape=new A.y$({id:"g6-lasso-select",style:this.options.style}),e.appendChild(this.pathShape),this.points=[t3(t)]}onPointerMove(t){var e;if(!this.points)return;let{immediately:n,mode:i}=this.options;this.points.push(t3(t)),null===(e=this.pathShape)||void 0===e||e.setAttribute("d",function(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=[];return t.forEach((t,e)=>{n.push([0===e?"M":"L",...t])}),e&&n.push(["Z"]),n}(this.points)),n&&"default"===i&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var t;null===(t=this.pathShape)||void 0===t||t.remove(),this.pathShape=void 0,this.points=void 0}},"optimize-viewport-transform":iO,"scroll-canvas":iw,"zoom-canvas":iA},combo:{circle:class extends e8{drawKeyShape(t,e){return this.upsert("key",A.Cd,this.getKeyStyle(t),e)}getKeyStyle(t){let{collapsed:e}=t,n=super.getKeyStyle(t),[i]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},n),e&&eo(n,"collapsed")),{r:i/2})}getCollapsedKeySize(t){let[e,n]=el(t.collapsedSize),i=Math.max(e,n)/2;return[2*i,2*i,0]}getExpandedKeySize(t){let e=this.getContentBBox(t),[n,i]=tu(e),s=Math.sqrt(Math.pow(n,2)+Math.pow(i,2))/2;return[2*s,2*s,0]}getIntersectPoint(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getShape("key").getBounds();return tY(t,n,e)}constructor(t){super(t)}},rect:class extends e8{drawKeyShape(t,e){return this.upsert("key",A.UL,this.getKeyStyle(t),e)}getKeyStyle(t){let e=super.getKeyStyle(t),[n,i]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},e),t.collapsed&&eo(e,"collapsed")),{width:n,height:i,x:-n/2,y:-i/2})}constructor(t){super(t)}}},edge:{cubic:nA,line:nP,polyline:nW,quadratic:nV,"cubic-horizontal":nM,"cubic-radial":nT,"cubic-vertical":nR},layout:{"antv-dagre":iT.b,"combo-combined":iP.u,"compact-box":iM.compactBox,"force-atlas2":ij.E,circular:iR.S,concentric:ik.W,"d3-force":iL.j,dagre:iN.V,dendrogram:iM.dendrogram,force:iI.y,fruchterman:iB.O,grid:i_.M,indented:iM.indented,mds:iF.A,mindmap:iM.mindmap,radial:iz.D,random:iZ._},node:{circle:eZ,diamond:class extends eW{getPoints(t){let[e,n]=this.getSize(t);return[[0,-n/2],[e/2,0],[0,n/2],[-e/2,0]]}constructor(t){super(t)}},ellipse:e$,hexagon:class extends eW{getOuterR(t){return t.outerR||Math.min(...this.getSize(t))/2}getPoints(t){var e;return[[0,e=this.getOuterR(t)],[e*Math.sqrt(3)/2,e/2],[e*Math.sqrt(3)/2,-e/2],[0,-e],[-e*Math.sqrt(3)/2,-e/2],[-e*Math.sqrt(3)/2,e/2]]}getIconStyle(t){let e=super.getIconStyle(t),n=.8*this.getOuterR(t);return!!e&&Object.assign({width:n,height:n},e)}constructor(t){super(t)}},html:e1,image:e6,rect:class extends ez{getKeyStyle(t){let[e,n]=this.getSize(t);return Object.assign(Object.assign({},super.getKeyStyle(t)),{width:e,height:n,x:-e/2,y:-n/2})}getIconStyle(t){let e=super.getIconStyle(t),{width:n,height:i}=this.getShape("key").attributes;return!!e&&Object.assign({width:.8*n,height:.8*i},e)}drawKeyShape(t,e){return this.upsert("key",A.UL,this.getKeyStyle(t),e)}constructor(t){super(t)}},star:class extends eW{getInnerR(t){return t.innerR||3*this.getOuterR(t)/8}getOuterR(t){return Math.min(...this.getSize(t))/2}getPoints(t){var e,n;return[[0,-(e=this.getOuterR(t))],[(n=this.getInnerR(t))*Math.cos(3*Math.PI/10),-n*Math.sin(3*Math.PI/10)],[e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[n*Math.cos(Math.PI/10),n*Math.sin(Math.PI/10)],[e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[0,n],[-e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[-n*Math.cos(Math.PI/10),n*Math.sin(Math.PI/10)],[-e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[-n*Math.cos(3*Math.PI/10),-n*Math.sin(3*Math.PI/10)]]}getIconStyle(t){let e=super.getIconStyle(t),n=2*this.getInnerR(t)*.8;return!!e&&Object.assign({width:n,height:n},e)}getPortXY(t,e){let{placement:n="top"}=e,i=this.getShape("key").getLocalBounds(),s=function(t,e){let n={};return n.top=[0,-t],n.left=[-t*Math.cos(Math.PI/10),-t*Math.sin(Math.PI/10)],n["left-bottom"]=[-t*Math.cos(3*Math.PI/10),t*Math.sin(3*Math.PI/10)],n.bottom=[0,e],n["right-bottom"]=[t*Math.cos(3*Math.PI/10),t*Math.sin(3*Math.PI/10)],n.right=n.default=[t*Math.cos(Math.PI/10),-t*Math.sin(Math.PI/10)],n}(this.getOuterR(t),this.getInnerR(t));return nY(i,n,s,!1)}constructor(t){super(t)}},donut:eG,triangle:e2},palette:{spectral:["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],tableau:["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],oranges:["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],greens:["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],blues:["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"]},theme:{dark:sG,light:sU},plugin:{"bubble-sets":iq,"edge-filter-lens":i6,"grid-line":i9,background:iY,contextmenu:i1,fisheye:i4,fullscreen:i8,history:se,hull:sd,legend:sg,minimap:sm,snapline:sx,timebar:sT,toolbar:sN,tooltip:sI,watermark:sz},transform:{"arrange-draw-order":class extends sH{beforeDraw(t){let{model:e}=this.context,n=t.add.combos,i=t=>{let n=[];return t.forEach((t,i)=>{let s=e.getAncestorsData(i,"combo"),o=s.map(t=>U(t)).reverse();n.push([i,t,o.length])}),new Map(n.sort((t,e)=>{let[,,n]=t,[,,i]=e;return i-n}).map(t=>{let[e,n]=t;return[e,n]}))};return t.add.combos=i(n),t.update.combos=i(t.update.combos),t}},"collapse-expand-combo":class extends sH{beforeDraw(t,e){if("visibility"===e.stage||!this.context.model.model.hasTreeStructure(N))return t;let{model:n}=this.context,{add:i,update:s}=t,o=[...t.update.combos.entries(),...t.add.combos.entries()];for(;o.length;){let[e,r]=o.pop();if(et(r)){let r=n.getDescendantsData(e),a=r.map(U),{internal:l,external:h}=nm(a,t=>n.getRelatedEdgesData(t));r.forEach(e=>{let i=U(e),s=o.findIndex(t=>{let[e]=t;return e===i});-1!==s&&o.splice(s,1);let r=n.getElementType(i);sY(t,"remove",r,e)}),l.forEach(e=>sY(t,"remove","edge",e)),h.forEach(t=>{var e;let n=U(t),o=null===(e=this.context.element)||void 0===e?void 0:e.getElement(n);o?s.edges.set(n,t):i.edges.set(n,t)})}else{let i=n.getChildrenData(e),s=i.map(U),{edges:r}=nm(s,t=>n.getRelatedEdgesData(t));[...i,...r].forEach(e=>{var i;let s=U(e),r=n.getElementType(s),a=null===(i=this.context.element)||void 0===i?void 0:i.getElement(s);a?sY(t,"update",r,e):sY(t,"add",r,e),"combo"===r&&o.push([s,e])})}}return t}},"collapse-expand-node":class extends sH{getElement(t){return this.context.element.getElement(t)}handleExpand(t,e){if(sX(e,"add","node",t),et(t))return;let n=U(t);sX(e,"add","node",t);let i=this.context.model.getRelatedEdgesData(n,"out");i.forEach(t=>{sY(e,"add","edge",t)});let s=this.context.model.getChildrenData(n);s.forEach(t=>{this.handleExpand(t,e)})}beforeDraw(t){let{graph:e,model:n}=this.context;if(!n.model.hasTreeStructure(j))return t;let{add:{nodes:i,edges:s},update:{nodes:o}}=t,r=new Map,a=new Map;i.forEach((t,e)=>{et(t)&&r.set(e,t)}),s.forEach(t=>{if("node"!==e.getElementType(t.source))return;let n=e.getNodeData(t.source);et(n)&&r.set(t.source,n)}),o.forEach((t,e)=>{let n=this.getElement(e);if(!n)return;let i=n.attributes.collapsed;et(t)?i||r.set(e,t):i&&a.set(e,t)});let l=new Set;return r.forEach((e,i)=>{let s=n.getDescendantsData(i);s.forEach(e=>{let i=U(e);if(l.has(i))return;sY(t,"remove","node",e);let s=n.getRelatedEdgesData(i);s.forEach(e=>{sY(t,"remove","edge",e)}),l.add(i)})}),a.forEach((e,i)=>{let s=n.getAncestorsData(i,j);if(s.some(et)){sY(t,"remove","node",e);return}this.handleExpand(e,t)}),t}},"get-edge-actual-ends":class extends sH{beforeDraw(t){let{add:e,update:n}=t,{model:i}=this.context;return[...e.edges.entries(),...n.edges.entries()].forEach(t=>{let[,e]=t;oT(i,e)}),t}},"map-node-size":oj,"place-radial-labels":oV,"process-parallel-edges":oU,"update-related-edges":class extends sH{beforeDraw(t,e){let{stage:n}=e;if("visibility"===n)return t;let{model:i}=this.context,{update:{nodes:s,edges:o,combos:r}}=t,a=(t,e)=>{let n=i.getRelatedEdgesData(e);n.forEach(t=>!o.has(U(t))&&o.set(U(t),t))};return s.forEach(a),r.forEach(a),t}}},shape:{circle:A.Cd,ellipse:A.Pj,group:A.ZA,html:A.k9,image:ek,line:A.x1,path:A.y$,polygon:A.mg,polyline:A.aH,rect:A.UL,text:A.xv,label:eC,badge:eA}};A.GZ.enableCSSParsing=!1,Object.entries(o$).forEach(t=>{let[e,n]=t;Object.entries(n).forEach(t=>{let[n,i]=t;!function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=I[t][e];!i&&s?s!==n&&F.warn("The extension ".concat(e," of ").concat(t," has been registered before.")):Object.assign(I[t],{[e]:n})}(e,n,i)})})},18515:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var i=n(10686),s=n(42736),o=n(90266);function r(t,e,n){return e=(0,i.Z)(e),(0,o.Z)(t,(0,s.Z)()?Reflect.construct(e,n||[],(0,i.Z)(t).constructor):e.apply(t,n))}}}]);