(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1633],{92776:function(t,e,i){"use strict";i.d(e,{ni:function(){return p},EF:function(){return f}});var n,r=function(t,e){return t===e},s=function(){function t(t,e){void 0===e&&(e=null),this.value=t,this.next=e}return t.prototype.toString=function(t){return t?t(this.value):"".concat(this.value)},t}(),o=function(){function t(t){void 0===t&&(t=r),this.head=null,this.tail=null,this.compare=t}return t.prototype.prepend=function(t){var e=new s(t,this.head);return this.head=e,this.tail||(this.tail=e),this},t.prototype.append=function(t){var e=new s(t);return this.head?(this.tail.next=e,this.tail=e,this):(this.head=e,this.tail=e,this)},t.prototype.delete=function(t){if(!this.head)return null;for(var e=null;this.head&&this.compare(this.head.value,t);)e=this.head,this.head=this.head.next;var i=this.head;if(null!==i)for(;i.next;)this.compare(i.next.value,t)?(e=i.next,i.next=i.next.next):i=i.next;return this.compare(this.tail.value,t)&&(this.tail=i),e},t.prototype.find=function(t){var e=t.value,i=void 0===e?void 0:e,n=t.callback,r=void 0===n?void 0:n;if(!this.head)return null;for(var s=this.head;s;){if(r&&r(s.value)||void 0!==i&&this.compare(s.value,i))return s;s=s.next}return null},t.prototype.deleteTail=function(){var t=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,t;for(var e=this.head;e.next;)e.next.next?e=e.next:e.next=null;return this.tail=e,t},t.prototype.deleteHead=function(){if(!this.head)return null;var t=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),t},t.prototype.fromArray=function(t){var e=this;return t.forEach(function(t){return e.append(t)}),this},t.prototype.toArray=function(){for(var t=[],e=this.head;e;)t.push(e),e=e.next;return t},t.prototype.reverse=function(){for(var t=this.head,e=null,i=null;t;)i=t.next,t.next=e,e=t,t=i;this.tail=this.head,this.head=e},t.prototype.toString=function(t){return void 0===t&&(t=void 0),this.toArray().map(function(e){return e.toString(t)}).toString()},t}();!function(){function t(){this.linkedList=new o}t.prototype.isEmpty=function(){return!this.linkedList.head},t.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},t.prototype.enqueue=function(t){this.linkedList.append(t)},t.prototype.dequeue=function(){var t=this.linkedList.deleteHead();return t?t.value:null},t.prototype.toString=function(t){return this.linkedList.toString(t)}}();var a=function(t,e,i){void 0===e&&(e=[]);var n=e.filter(function(e){return e.source===t||e.target===t});return"target"===i?n.filter(function(e){return e.source===t}).map(function(t){return t.target}):"source"===i?n.filter(function(e){return e.target===t}).map(function(t){return t.source}):n.map(function(e){return e.source===t?e.target:e.source})},l=function(t){var e={},i=t.nodes,n=t.edges;return(void 0===i?[]:i).forEach(function(t){e[t.id]={degree:0,inDegree:0,outDegree:0}}),(void 0===n?[]:n).forEach(function(t){e[t.source].degree++,e[t.source].outDegree++,e[t.target].degree++,e[t.target].inDegree++}),e},h=i(15767),d=i(69499),c=function(t,e,i){for(var n,r=1/0,s=0;s<e.length;s++){var o=e[s].id;!i[o]&&t[o]<=r&&(r=t[o],n=e[s])}return n},u=function(t,e,i,n){var r=t.nodes,s=void 0===r?[]:r,o=t.edges,a=void 0===o?[]:o,l=[],u={},p={},g={};s.forEach(function(t,i){var n=t.id;l.push(n),p[n]=1/0,n===e&&(p[n]=0)});for(var f=s.length,y=0;y<f;y++)!function(t){var e=c(p,s,u),r=e.id;if(u[r]=!0,p[r]!==1/0){var o=[];(i?a.filter(function(t){return t.source===r}):a.filter(function(t){return t.source===r||t.target===r})).forEach(function(t){var i=t.target,s=t.source,o=i===r?s:i,a=n&&t[n]?t[n]:1;p[o]>p[e.id]+a?(p[o]=p[e.id]+a,g[o]=[e.id]):p[o]===p[e.id]+a&&g[o].push(e.id)})}}(0);g[e]=[e];var m={};for(var v in p)p[v]!==1/0&&function t(e,i,n,r){if(e===i)return[e];if(r[i])return r[i];for(var s=[],o=0,a=n[i];o<a.length;o++){var l=t(e,a[o],n,r);if(!l)return;for(var c=0;c<l.length;c++){var u=l[c];(0,d.kJ)(u)?s.push((0,h.ev)((0,h.ev)([],u,!0),[i],!1)):s.push([u,i])}}return r[i]=s,r[i]}(e,v,g,m);var b={};for(var v in m)b[v]=m[v][0];return{length:p,path:b,allPath:m}},p=function(t,e,i,n,r){var s=u(t,e,n,r),o=s.length,a=s.path,l=s.allPath;return{length:o[i],path:a[i],allPath:l[i]}};!function(){function t(t){this.arr=t}t.prototype.getArr=function(){return this.arr||[]},t.prototype.add=function(e){var i,n=e.arr;if(!(null===(i=this.arr)||void 0===i?void 0:i.length))return new t(n);if(!(null==n?void 0:n.length))return new t(this.arr);if(this.arr.length===n.length){var r=[];for(var s in this.arr)r[s]=this.arr[s]+n[s];return new t(r)}},t.prototype.subtract=function(e){var i,n=e.arr;if(!(null===(i=this.arr)||void 0===i?void 0:i.length))return new t(n);if(!(null==n?void 0:n.length))return new t(this.arr);if(this.arr.length===n.length){var r=[];for(var s in this.arr)r[s]=this.arr[s]-n[s];return new t(r)}},t.prototype.avg=function(e){var i=[];if(0!==e)for(var n in this.arr)i[n]=this.arr[n]/e;return new t(i)},t.prototype.negate=function(){var e=[];for(var i in this.arr)e[i]=-this.arr[i];return new t(e)},t.prototype.squareEuclideanDistance=function(t){var e,i=t.arr;if(!(null===(e=this.arr)||void 0===e?void 0:e.length)||!(null==i?void 0:i.length))return 0;if(this.arr.length===i.length){var n=0;for(var r in this.arr)n+=Math.pow(this.arr[r]-t.arr[r],2);return n}},t.prototype.euclideanDistance=function(t){var e,i=t.arr;if(!(null===(e=this.arr)||void 0===e?void 0:e.length)||!(null==i?void 0:i.length))return 0;if(this.arr.length===i.length){var n=0;for(var r in this.arr)n+=Math.pow(this.arr[r]-t.arr[r],2);return Math.sqrt(n)}console.error("The two vectors are unequal in length.")},t.prototype.normalize=function(){var e=[],i=(0,d.d9)(this.arr);i.sort(function(t,e){return t-e});var n=i[i.length-1],r=i[0];for(var s in this.arr)e[s]=(this.arr[s]-r)/(n-r);return new t(e)},t.prototype.norm2=function(){if(!(null===(t=this.arr)||void 0===t?void 0:t.length))return 0;var t,e=0;for(var i in this.arr)e+=Math.pow(this.arr[i],2);return Math.sqrt(e)},t.prototype.dot=function(t){var e,i=t.arr;if(!(null===(e=this.arr)||void 0===e?void 0:e.length)||!(null==i?void 0:i.length))return 0;if(this.arr.length===i.length){var n=0;for(var r in this.arr)n+=this.arr[r]*t.arr[r];return n}console.error("The two vectors are unequal in length.")},t.prototype.equal=function(t){var e,i=t.arr;if((null===(e=this.arr)||void 0===e?void 0:e.length)!==(null==i?void 0:i.length))return!1;for(var n in this.arr)if(this.arr[n]!==i[n])return!1;return!0}}(),(n||(n={})).EuclideanDistance="euclideanDistance",function(){function t(t){this.count=t.length,this.parent={};for(var e=0;e<t.length;e++){var i=t[e];this.parent[i]=i}}t.prototype.find=function(t){for(;this.parent[t]!==t;)t=this.parent[t];return t},t.prototype.union=function(t,e){var i=this.find(t),n=this.find(e);i!==n&&(i<n?(this.parent[e]!==e&&this.union(this.parent[e],t),this.parent[e]=this.parent[t]):(this.parent[t]!==t&&this.union(this.parent[t],e),this.parent[t]=this.parent[e]))},t.prototype.connected=function(t,e){return this.find(t)===this.find(e)}}();var g=function(t,e){return t-e};!function(){function t(t){void 0===t&&(t=g),this.compareFn=t,this.list=[]}t.prototype.getLeft=function(t){return 2*t+1},t.prototype.getRight=function(t){return 2*t+2},t.prototype.getParent=function(t){return 0===t?null:Math.floor((t-1)/2)},t.prototype.isEmpty=function(){return this.list.length<=0},t.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},t.prototype.delMin=function(){var t=this.top(),e=this.list.pop();return this.list.length>0&&(this.list[0]=e,this.moveDown(0)),t},t.prototype.insert=function(t){if(null!==t){this.list.push(t);var e=this.list.length-1;return this.moveUp(e),!0}return!1},t.prototype.moveUp=function(t){for(var e=this.getParent(t);t&&t>0&&this.compareFn(this.list[e],this.list[t])>0;){var i=this.list[e];this.list[e]=this.list[t],this.list[t]=i,t=e,e=this.getParent(t)}},t.prototype.moveDown=function(t){var e,i=t,n=this.getLeft(t),r=this.getRight(t),s=this.list.length;null!==n&&n<s&&this.compareFn(this.list[i],this.list[n])>0?i=n:null!==r&&r<s&&this.compareFn(this.list[i],this.list[r])>0&&(i=r),t!==i&&(e=[this.list[i],this.list[t]],this.list[t]=e[0],this.list[i]=e[1],this.moveDown(i))}}();var f=function(t,e,i){"number"!=typeof e&&(e=1e-6),"number"!=typeof i&&(i=.85);for(var n,r=1,s=0,o=1e3,h=t.nodes,d=void 0===h?[]:h,c=t.edges,u=void 0===c?[]:c,p=d.length,g={},f={},y=0;y<p;++y){var m=d[y],v=m.id;g[v]=1/p,f[v]=1/p}for(var b=l(t);o>0&&r>e;){s=0;for(var y=0;y<p;++y){var m=d[y],v=m.id;if(n=0,0===b[m.id].inDegree)g[v]=0;else{for(var E=a(v,u,"source"),x=0;x<E.length;++x){var O=E[x],w=b[O].outDegree;w>0&&(n+=f[O]/w)}g[v]=i*n,s+=g[v]}}s=(1-s)/p,r=0;for(var y=0;y<p;++y){var m=d[y],v=m.id;r+=Math.abs((n=g[v]+s)-f[v]),f[v]=n}o-=1}return f},y=function(t,e,i,n){void 0===t&&(t=-1),void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===n&&(n="-1"),this.id=t,this.from=e,this.to=i,this.label=n},m=function(){function t(t,e){void 0===t&&(t=-1),void 0===e&&(e="-1"),this.id=t,this.label=e,this.edges=[],this.edgeMap={}}return t.prototype.addEdge=function(t){this.edges.push(t),this.edgeMap[t.id]=t},t}(),v=function(){function t(t,e,i){void 0===t&&(t=-1),void 0===e&&(e=!0),void 0===i&&(i=!1),this.id=t,this.edgeIdAutoIncrease=e,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=i}return t.prototype.getNodeNum=function(){return this.nodes.length},t.prototype.addNode=function(t,e){if(!this.nodeMap[t]){var i=new m(t,e);this.nodes.push(i),this.nodeMap[t]=i,this.nodeLabelMap[e]||(this.nodeLabelMap[e]=[]),this.nodeLabelMap[e].push(t)}},t.prototype.addEdge=function(t,e,i,n){if((this.edgeIdAutoIncrease||void 0===t)&&(t=this.counter++),!this.nodeMap[e]||!this.nodeMap[i]||!this.nodeMap[i].edgeMap[t]){var r=new y(t,e,i,n);if(this.edges.push(r),this.edgeMap[t]=r,this.nodeMap[e].addEdge(r),this.edgeLabelMap[n]||(this.edgeLabelMap[n]=[]),this.edgeLabelMap[n].push(r),!this.directed){var s=new y(t,i,e,n);this.nodeMap[i].addEdge(s),this.edgeLabelMap[n].push(s)}}},t}(),b=function(){function t(t,e,i,n,r){this.fromNode=t,this.toNode=e,this.nodeEdgeNodeLabel={nodeLabel1:i||"-1",edgeLabel:n||"-1",nodeLabel2:r||"-1"}}return t.prototype.equalTo=function(t){return this.fromNode===t.formNode&&this.toNode===t.toNode&&this.nodeEdgeNodeLabel===t.nodeEdgeNodeLabel},t.prototype.notEqualTo=function(t){return!this.equalTo(t)},t}(),E=function(){function t(){this.rmpath=[],this.dfsEdgeList=[]}return t.prototype.equalTo=function(t){var e=this.dfsEdgeList.length;if(e!==t.length)return!1;for(var i=0;i<e;i++)if(this.dfsEdgeList[i]!==t[i])return!1;return!0},t.prototype.notEqualTo=function(t){return!this.equalTo(t)},t.prototype.pushBack=function(t,e,i,n,r){return this.dfsEdgeList.push(new b(t,e,i,n,r)),this.dfsEdgeList},t.prototype.toGraph=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1);var i=new v(t,!0,e);return this.dfsEdgeList.forEach(function(t){var e=t.fromNode,n=t.toNode,r=t.nodeEdgeNodeLabel,s=r.nodeLabel1,o=r.edgeLabel,a=r.nodeLabel2;"-1"!==s&&i.addNode(e,s),"-1"!==a&&i.addNode(n,a),"-1"!==s&&a!==s&&i.addEdge(void 0,e,n,o)}),i},t.prototype.buildRmpath=function(){this.rmpath=[];for(var t=void 0,e=this.dfsEdgeList.length,i=e-1;i>=0;i--){var n=this.dfsEdgeList[i],r=n.fromNode,s=n.toNode;r<s&&(void 0===t||s===t)&&(this.rmpath.push(i),t=r)}return this.rmpath},t.prototype.getNodeNum=function(){var t={};return this.dfsEdgeList.forEach(function(e){t[e.fromNode]||(t[e.fromNode]=!0),t[e.toNode]||(t[e.toNode]=!0)}),Object.keys(t).length},t}(),x=function(){function t(t){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],t){for(;t;){var e=t.edge;this.edges.push(e),this.nodesUsed[e.from]=1,this.nodesUsed[e.to]=1,this.edgesUsed[e.id]=1,t=t.preNode}this.edges=this.edges.reverse()}}return t.prototype.hasNode=function(t){return 1===this.nodesUsed[t.id]},t.prototype.hasEdge=function(t){return 1===this.edgesUsed[t.id]},t}();!function(){function t(t){var e=t.graphs,i=t.minSupport,n=t.minNodeNum,r=t.maxNodeNum,s=t.top,o=t.directed,a=t.verbose;this.graphs=e,this.dfsCode=new E,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=void 0===i?2:i,this.top=void 0===s?10:s,this.directed=void 0!==o&&o,this.counter=0,this.maxNodeNum=void 0===r?4:r,this.minNodeNum=void 0===n?1:n,this.verbose=void 0!==a&&a,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}t.prototype.findForwardRootEdges=function(t,e){var i=this,n=[],r=t.nodeMap;return e.edges.forEach(function(t){(i.directed||e.label<=r[t.to].label)&&n.push(t)}),n},t.prototype.findBackwardEdge=function(t,e,i,n){if(!this.directed&&e===i)return null;for(var r=t.nodeMap,s=r[i.to].edges,o=s.length,a=0;a<o;a++){var l=s[a];if(!n.hasEdge(l)&&l.to===e.from){if(this.directed){if(r[e.from].label<r[i.to].label||r[e.from].label===r[i.to].label&&e.label<=l.label)return l}else if(e.label<l.label||e.label===l.label&&r[e.to].label<=r[i.to].label)return l}}return null},t.prototype.findForwardPureEdges=function(t,e,i,n){for(var r=[],s=e.to,o=t.nodeMap[s].edges,a=o.length,l=0;l<a;l++){var h=o[l],d=t.nodeMap[h.to];i<=d.label&&!n.hasNode(d)&&r.push(h)}return r},t.prototype.findForwardRmpathEdges=function(t,e,i,n){for(var r=[],s=t.nodeMap,o=s[e.to].label,a=s[e.from].edges,l=a.length,h=0;h<l;h++){var d=a[h],c=s[d.to].label;!(e.to===d.to||i>c||n.hasNode(s[d.to]))&&(e.label<d.label||e.label===d.label&&o<=c)&&r.push(d)}return r},t.prototype.getSupport=function(t){var e={};return t.forEach(function(t){e[t.graphId]||(e[t.graphId]=!0)}),Object.keys(e).length},t.prototype.findMinLabel=function(t){var e=void 0;return Object.keys(t).forEach(function(i){var n=t[i],r=n.nodeLabel1,s=n.edgeLabel,o=n.nodeLabel2;if(!e){e={nodeLabel1:r,edgeLabel:s,nodeLabel2:o};return}(r<e.nodeLabel1||r===e.nodeLabel1&&s<e.edgeLabel||r===e.nodeLabel1&&s===e.edgeLabel&&o<e.nodeLabel2)&&(e={nodeLabel1:r,edgeLabel:s,nodeLabel2:o})}),e},t.prototype.isMin=function(){var t=this,e=this.dfsCode;if(this.verbose&&console.log("isMin checking",e),1===e.dfsEdgeList.length)return!0;var i=this.directed,n=e.toGraph(-1,i),r=n.nodeMap,s=new E,o={};n.nodes.forEach(function(e){t.findForwardRootEdges(n,e).forEach(function(t){var i=r[t.to],s="".concat(e.label,"-").concat(t.label,"-").concat(i.label);o[s]||(o[s]={projected:[],nodeLabel1:e.label,edgeLabel:t.label,nodeLabel2:i.label});var a={graphId:n.id,edge:t,preNode:null};o[s].projected.push(a)})});var a=this.findMinLabel(o);if(a)return s.dfsEdgeList.push(new b(0,1,a.nodeLabel1,a.edgeLabel,a.nodeLabel2)),function o(a){for(var l=s.buildRmpath(),h=s.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,d=s.dfsEdgeList[l[0]].toNode,c={},u=!1,p=0,g=i?-1:0,f=function(e){if(u)return"break";a.forEach(function(i){var r=new x(i),o=t.findBackwardEdge(n,r.edges[l[e]],r.edges[l[0]],r);o&&(c[o.label]||(c[o.label]={projected:[],edgeLabel:o.label}),c[o.label].projected.push({graphId:n.id,edge:c,preNode:i}),p=s.dfsEdgeList[l[e]].fromNode,u=!0)})},y=l.length-1;y>g&&"break"!==f(y);y--);if(u){var m=t.findMinLabel(c);s.dfsEdgeList.push(new b(d,p,"-1",m.edgeLabel,"-1"));var v=s.dfsEdgeList.length-1;return t.dfsCode.dfsEdgeList[v]===s.dfsEdgeList[v]&&o(c[m.edgeLabel].projected)}var E={};u=!1;var O=0;a.forEach(function(e){var i=new x(e),s=t.findForwardPureEdges(n,i.edges[l[0]],h,i);s.length>0&&(u=!0,O=d,s.forEach(function(t){var i="".concat(t.label,"-").concat(r[t.to].label);E[i]||(E[i]={projected:[],edgeLabel:t.label,nodeLabel2:r[t.to].label}),E[i].projected.push({graphId:n.id,edge:t,preNode:e})}))});for(var w=l.length,y=0;y<w&&"break"!==function(e){if(u)return"break";var i=l[e];a.forEach(function(e){var o=new x(e),a=t.findForwardRmpathEdges(n,o.edges[i],h,o);a.length>0&&(u=!0,O=s.dfsEdgeList[i].fromNode,a.forEach(function(t){var i="".concat(t.label,"-").concat(r[t.to].label);E[i]||(E[i]={projected:[],edgeLabel:t.label,nodeLabel2:r[t.to].label}),E[i].projected.push({graphId:n.id,edge:t,preNode:e})}))})}(y);y++);if(!u)return!0;var S=t.findMinLabel(E);s.dfsEdgeList.push(new b(O,d+1,"-1",S.edgeLabel,S.nodeLabel2));var D=s.dfsEdgeList.length-1;return e.dfsEdgeList[D]===s.dfsEdgeList[D]&&o(E["".concat(S.edgeLabel,"-").concat(S.nodeLabel2)].projected)}(o["".concat(a.nodeLabel1,"-").concat(a.edgeLabel,"-").concat(a.nodeLabel2)].projected)},t.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var t=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push((0,d.d9)(t))}},t.prototype.subGraphMining=function(t){var e=this;if(!(this.getSupport(t)<this.minSupport)&&this.isMin()){this.report();var i=this.dfsCode.getNodeNum(),n=this.dfsCode.buildRmpath(),r=this.dfsCode.dfsEdgeList[n[0]].toNode,s=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,o={},a={};t.forEach(function(t){for(var l=e.graphs[t.graphId],h=l.nodeMap,d=new x(t),c=n.length-1;c>=0;c--){var u=e.findBackwardEdge(l,d.edges[n[c]],d.edges[n[0]],d);if(u){var p="".concat(e.dfsCode.dfsEdgeList[n[c]].fromNode,"-").concat(u.label);a[p]||(a[p]={projected:[],toNodeId:e.dfsCode.dfsEdgeList[n[c]].fromNode,edgeLabel:u.label}),a[p].projected.push({graphId:t.graphId,edge:u,preNode:t})}}if(!(i>=e.maxNodeNum)){e.findForwardPureEdges(l,d.edges[n[0]],s,d).forEach(function(e){var i="".concat(r,"-").concat(e.label,"-").concat(h[e.to].label);o[i]||(o[i]={projected:[],fromNodeId:r,edgeLabel:e.label,nodeLabel2:h[e.to].label}),o[i].projected.push({graphId:t.graphId,edge:e,preNode:t})});for(var g=function(i){e.findForwardRmpathEdges(l,d.edges[n[i]],s,d).forEach(function(r){var s="".concat(e.dfsCode.dfsEdgeList[n[i]].fromNode,"-").concat(r.label,"-").concat(h[r.to].label);o[s]||(o[s]={projected:[],fromNodeId:e.dfsCode.dfsEdgeList[n[i]].fromNode,edgeLabel:r.label,nodeLabel2:h[r.to].label}),o[s].projected.push({graphId:t.graphId,edge:r,preNode:t})})},c=0;c<n.length;c++)g(c)}}),Object.keys(a).forEach(function(t){var i=a[t],n=i.toNodeId,s=i.edgeLabel;e.dfsCode.dfsEdgeList.push(new b(r,n,"-1",s,"-1")),e.subGraphMining(a[t].projected),e.dfsCode.dfsEdgeList.pop()}),Object.keys(o).forEach(function(t){var i=o[t],n=i.fromNodeId,s=i.edgeLabel,a=i.nodeLabel2;e.dfsCode.dfsEdgeList.push(new b(n,r+1,"-1",s,a)),e.subGraphMining(o[t].projected),e.dfsCode.dfsEdgeList.pop()})}},t.prototype.generate1EdgeFrequentSubGraphs=function(){var t=this.graphs,e=this.directed,i=this.minSupport,n=this.frequentSize1Subgraphs,r={},s={},o={},a={};return Object.keys(t).forEach(function(i){var n=t[i],l=n.nodeMap;n.nodes.forEach(function(t,n){var h=t.label,d="".concat(i,"-").concat(h);if(!o[d]){var c=r[h]||0;c++,r[h]=c}o[d]={graphKey:i,label:h},t.edges.forEach(function(t){var n=h,r=l[t.to].label;if(!e&&n>r){var o=r;r=n,n=o}var d=t.label,c="".concat(i,"-").concat(n,"-").concat(d,"-").concat(r),u="".concat(n,"-").concat(d,"-").concat(r);if(!s[u]){var p=s[u]||0;p++,s[u]=p}a[c]={graphId:i,nodeLabel1:n,edgeLabel:d,nodeLabel2:r}})})}),Object.keys(r).forEach(function(t){if(!(r[t]<i)){var e={nodes:[],edges:[]};e.nodes.push({id:"0",label:t}),n.push(e)}}),n},t.prototype.run=function(){var t=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var e=this.graphs;this.directed;var i={};Object.keys(e).forEach(function(n){var r=e[n],s=r.nodeMap;r.nodes.forEach(function(e){t.findForwardRootEdges(r,e).forEach(function(t){var r=s[t.to],o="".concat(e.label,"-").concat(t.label,"-").concat(r.label);i[o]||(i[o]={projected:[],nodeLabel1:e.label,edgeLabel:t.label,nodeLabel2:r.label}),i[o].projected.push({graphId:n,edge:t,preNode:null})})})}),Object.keys(i).forEach(function(e){var n=i[e],r=n.projected,s=n.nodeLabel1,o=n.edgeLabel,a=n.nodeLabel2;t.dfsCode.dfsEdgeList.push(new b(0,1,s,o,a)),t.subGraphMining(r),t.dfsCode.dfsEdgeList.pop()})}}}(),function(){function t(t){void 0===t&&(t=10),this.linkedList=new o,this.maxStep=t}Object.defineProperty(t.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return!this.linkedList.head},t.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},t.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},t.prototype.push=function(t){this.linkedList.prepend(t),this.length>this.maxStep&&this.linkedList.deleteTail()},t.prototype.pop=function(){var t=this.linkedList.deleteHead();return t?t.value:null},t.prototype.toArray=function(){return this.linkedList.toArray().map(function(t){return t.value})},t.prototype.clear=function(){for(;!this.isEmpty();)this.pop()}}()},57069:function(t,e,i){"use strict";i.d(e,{s:function(){return H}});var n=i(15767),r=i(15378),s=i(7719),o=i(18687),a=i(59142),l=i(98557),h=i(23113);function d(t,e){var i={YYYY:t.getFullYear(),MM:t.getMonth()+1,DD:t.getDate(),HH:t.getHours(),mm:t.getMinutes(),ss:t.getSeconds()},n=e;return Object.keys(i).forEach(function(t){var e=i[t];n=n.replace(t,"YYYY"===t?"".concat(e):"".concat(e).padStart(2,"0"))}),n}var c=i(72874),u=i(46247),p=i(1918),g=i(97067),f=i(43292),y=i(31016),m=i(88146),v=i(99982),b=function(t){function e(i){var n=t.call(this,(0,a.n)({},e.defaultOptions,i))||this;return n.hoverColor="#f5f5f5",n.selectedColor="#e6f7ff",n.background=n.appendChild(new o.UL({})),n.label=n.background.appendChild(new o.ZA({})),n}return(0,n.ZT)(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return(0,p.j)(this.style.padding)},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(){var t=this.style,e=t.label,i=t.value,n=(0,h.zs)(this.attributes,"label");(0,f.Ys)(this.label).maybeAppend(".label",function(){return(0,m.S)(e)}).attr("className","label").styles(n),this.label.attr("__data__",i)},e.prototype.renderBackground=function(){var t=this.label.getBBox(),e=(0,n.CR)(this.padding,4),i=e[0],r=e[1],s=e[2],o=e[3],a=t.width,l=t.height,d=l+i+s,c=(0,h.zs)(this.attributes,"background"),u=this.style,p=u.width,g=u.height,f=u.selected;this.background.attr((0,n.pi)((0,n.pi)({},c),{width:Math.max(a+o+r,void 0===p?0:p),height:Math.max(d,void 0===g?0:g),fill:f?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(o,", ").concat((d-l)/2,")")})},e.prototype.render=function(){this.renderLabel(),this.renderBackground()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("pointerenter",function(){t.style.selected||t.background.attr("fill",t.hoverColor)}),this.addEventListener("pointerleave",function(){t.style.selected||t.background.attr("fill",t.style.backgroundFill)});var e=this;this.addEventListener("click",function(){var i=t.style,n=i.label,r=i.value,s=i.onClick;null==s||s(r,{label:n,value:r},e)})},e.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},e}(s.w),E=function(t){function e(i){var n,r,s=t.call(this,(0,a.n)({},e.defaultOptions,i))||this;s.currentValue=null===(n=e.defaultOptions.style)||void 0===n?void 0:n.defaultValue,s.isPointerInSelect=!1,s.select=s.appendChild(new o.UL({className:"select",style:{cursor:"pointer",width:0,height:0}})),s.dropdown=s.appendChild(new o.UL({className:"dropdown"}));var l=s.style.defaultValue;return l&&(null===(r=s.style.options)||void 0===r?void 0:r.some(function(t){return t.value===l}))&&(s.currentValue=l),s}return(0,n.ZT)(e,t),e.prototype.setValue=function(t){this.currentValue=t,this.render()},e.prototype.getValue=function(){return this.currentValue},Object.defineProperty(e.prototype,"dropdownPadding",{get:function(){return(0,p.j)(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),e.prototype.renderSelect=function(){var t,e=this,i=this.style,r=i.x,s=i.y,o=i.width,a=i.height,l=i.bordered,d=i.showDropdownIcon,c=(0,h.zs)(this.attributes,"select"),u=(0,h.zs)(this.attributes,"placeholder");this.select.attr((0,n.pi)((0,n.pi)({x:r,y:s,width:o,height:a},c),{fill:"#fff",strokeWidth:l?1:0}));var p=this.dropdownPadding;d&&(0,f.Ys)(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(r+o-10-p[1]-p[3],", ").concat(s+a/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var g=null===(t=this.style.options)||void 0===t?void 0:t.find(function(t){return t.value===e.currentValue}),y=(0,n.pi)({x:r+p[3]},u);(0,f.Ys)(this.select).selectAll(".placeholder").data(g?[]:[1]).join(function(t){return t.append("text").attr("className","placeholder").styles(y).style("y",function(){return s+(a-this.getBBox().height)/2})},function(t){return t.styles(y)},function(t){return t.remove()});var v=(0,h.zs)(this.attributes,"optionLabel"),b=(0,n.pi)({x:r+p[3]},v);(0,f.Ys)(this.select).selectAll(".value").data(g?[g]:[]).join(function(t){return t.append(function(t){return(0,m.S)(t.label)}).attr("className","value").styles(b).style("y",function(){return s+(a-this.getBBox().height)/2})},function(t){return t.styles(b)},function(t){return t.remove()})},e.prototype.renderDropdown=function(){var t,e,i=this,r=this.style,s=r.x,a=r.y,l=r.width,d=r.height,c=r.options,u=r.onSelect,p=r.open,g=(0,h.zs)(this.attributes,"dropdown"),y=(0,h.zs)(this.attributes,"option"),m=this.dropdownPadding;(0,f.Ys)(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(c,function(t){return t.value}).join(function(t){return t.append(function(t){return new b({className:"dropdown-item",style:(0,n.pi)((0,n.pi)((0,n.pi)({},t),y),{width:l-m[1]-m[3],selected:t.value===i.currentValue,onClick:function(t,e,n){i.setValue(t),null==u||u(t,e,n),i.dispatchEvent(new o.Aw("change",{detail:{value:t,option:e,item:n}})),(0,v.Cp)(i.dropdown)}})})}).each(function(t,e){var i,n=(null===(i=this.parentNode)||void 0===i?void 0:i.children).reduce(function(t,i,n){return n<e&&(t+=i.getBBox().height),t},0);this.attr("transform","translate(".concat(m[3],", ").concat(m[0]+n,")"))})},function(t){return t.update(function(t){return{selected:t.value===i.currentValue}})},function(t){return t.remove()});var E=null===(e=null===(t=this.dropdown.getElementsByClassName("dropdown-container"))||void 0===t?void 0:t[0])||void 0===e?void 0:e.getBBox(),x=g.spacing;this.dropdown.attr((0,n.pi)({transform:"translate(".concat(s,", ").concat(a+d+x,")"),width:E.width+m[1]+m[3],height:E.height+m[0]+m[2]},g)),p||(0,v.Cp)(this.dropdown)},e.prototype.render=function(){this.renderSelect(),this.renderDropdown()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("click",function(t){t.stopPropagation()}),this.select.addEventListener("click",function(){"visible"===t.dropdown.style.visibility?(0,v.Cp)(t.dropdown):(0,v.$Z)(t.dropdown)}),this.addEventListener("pointerenter",function(){t.isPointerInSelect=!0}),this.addEventListener("pointerleave",function(){t.isPointerInSelect=!1}),null==document||document.addEventListener("click",function(){t.isPointerInSelect||(0,v.Cp)(t.dropdown)})},e.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"请选择",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},e}(s.w),x=function(t){function e(i){var n=t.call(this,(0,a.n)({},{style:{backgroundOpacity:e.backgroundOpacities.default}},e.defaultOptions,i))||this;return n.showBackground=!0,n.background=n.appendChild(new o.UL({})),n.icon=n.appendChild(new o.ZA({})),n}return(0,n.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return(0,p.j)(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconSize",{get:function(){var t=this.attributes.size,e=(0,n.CR)(this.padding,4),i=e[0],r=e[1],s=e[2];return Math.max(t-Math.max(e[3]+r,i+s),2*this.lineWidth+1)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.attributes,e=t.x,i=t.y,r=t.size,s=r/2,o=(0,h.zs)(this.attributes,"background");this.background.attr((0,n.pi)({x:e-s,y:i-s,width:r,height:r},o))},e.prototype.showIndicator=function(){if(this.label){var t=this.attributes.size,e=this.background.getBBox(),i=e.x,n=e.y;this.indicator.update({x:i+t/2,y:n-5,labelText:this.label,visibility:"visible"})}},e.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},e.prototype.connectedCallback=function(){t.prototype.connectedCallback.call(this);var e,i=this.attributes.size,n=this.background.getBBox(),r=n.x,s=n.y,o=null===(e=this.ownerDocument)||void 0===e?void 0:e.defaultView;o&&(this.indicator=o.appendChild(new y.z({style:{x:r+i/2,y:s-i/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},e.prototype.disconnectedCallback=function(){this.indicator.destroy()},e.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},e.prototype.bindEvents=function(){var t=this,i=this.attributes.onClick;if(this.addEventListener("click",function(){null==i||i(t)}),this.showBackground){var n=function(){return t.background.attr({opacity:e.backgroundOpacities.default})};this.addEventListener("pointerenter",function(){t.background.attr({opacity:e.backgroundOpacities.hover}),t.showIndicator()}),this.addEventListener("pointerleave",function(){n(),t.hideIndicator()}),this.addEventListener("pointerdown",function(){t.background.attr({opacity:e.backgroundOpacities.active})}),this.addEventListener("pointerup",function(){n()})}},e.tag="IconBase",e.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},e.backgroundOpacities={default:0,hover:.8,active:1},e}(s.w),O=function(t,e){return void 0===e&&(e="#565758"),new o.y$({style:{fill:e,d:"M ".concat(t,",").concat(t," L -").concat(t,",0 L ").concat(t,",-").concat(t," Z"),transformOrigin:"center"}})},w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,n.ZT)(e,t),e.prototype.arcPath=function(t,e,i){var r=(0,n.CR)([i,i],2),s=r[0],o=r[1],a=function(n){return[t+i*Math.cos(n),e+i*Math.sin(n)]},l=(0,n.CR)(a(-5/4*Math.PI),2),h=l[0],d=l[1],c=(0,n.CR)(a(1/4*Math.PI),2),u=c[0],p=c[1];return"M".concat(h,",").concat(d,",A").concat(s,",").concat(o,",0,1,1,").concat(u,",").concat(p)},Object.defineProperty(e.prototype,"label",{get:function(){return"重置"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=this.lineWidth,o=s+.5;(0,f.Ys)(this.icon).maybeAppend(".reset","path").styles({stroke:n,lineWidth:s,d:this.arcPath(e,i,r/2-s),markerStart:O(o,n)})},e}(x),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,n.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"快退"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=r/2,o=r/2/1.7320508075688772;(0,f.Ys)(this.icon).maybeAppend(".backward","polygon").styles({points:[[e,i],[e,i-o],[e-s,i],[e,i+o],[e,i],[e+s,i-o],[e+s,i+o],[e,i]],fill:n})},e}(x),D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,n.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"快进"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=r/2,o=r/2/1.7320508075688772;(0,f.Ys)(this.icon).maybeAppend(".forward","polygon").styles({points:[[e,i],[e,i-o],[e+s,i],[e,i+o],[e,i],[e-s,i-o],[e-s,i+o],[e,i]],fill:n})},e}(x),M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,n.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"播放"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=r/3*1.3856406460551018;(0,f.Ys)(this.icon).maybeAppend(".play","polygon").styles({points:[[e+s,i],[e-s/2,i-r/2*.8],[e-s/2,i+r/2*.8],[e+s,i]],fill:n})},e}(x),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,n.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"暂停"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=r/3;(0,f.Ys)(this.icon).maybeAppend(".pause","polygon").styles({points:[[e-s,i-r/2],[e-s,i+r/2],[e-s/2,i+r/2],[e-s/2,i-r/2],[e-s,i-r/2],[e+s/2,i-r/2],[e+s/2,i+r/2],[e+s,i+r/2],[e+s,i-r/2]],fill:n})},e}(x),T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,n.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"范围时间"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=this.lineWidth;(0,f.Ys)(this.icon).maybeAppend(".left-line","line").styles({x1:e-r/2,y1:i-r/2,x2:e-r/2,y2:i+r/2,stroke:n,lineWidth:s}),(0,f.Ys)(this.icon).maybeAppend(".right-line","line").styles({x1:e+r/2,y1:i-r/2,x2:e+r/2,y2:i+r/2,stroke:n,lineWidth:s}),(0,f.Ys)(this.icon).maybeAppend(".left-arrow","line").styles({x1:e,y1:i,x2:e-r/2+2*s,y2:i,stroke:n,lineWidth:s,markerEnd:O(2*s,n)}),(0,f.Ys)(this.icon).maybeAppend(".right-arrow","line").styles({x1:e,y1:i,x2:e+r/2-2*s,y2:i,stroke:n,lineWidth:s,markerEnd:O(2*s,n)})},e}(x),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,n.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"单一时间"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=this.lineWidth;(0,f.Ys)(this.icon).maybeAppend(".line","line").styles({x1:e,y1:i-r/2,x2:e,y2:i+r/2,stroke:n,lineWidth:s}),(0,f.Ys)(this.icon).maybeAppend(".left-arrow","line").styles({x1:e-r/2-2*s,y1:i,x2:e-2*s,y2:i,stroke:n,lineWidth:s,markerEnd:O(2*s,n)}),(0,f.Ys)(this.icon).maybeAppend(".right-arrow","line").styles({x1:e+r/2+2*s,y1:i,x2:e+2*s,y2:i,stroke:n,lineWidth:s,markerEnd:O(2*s,n)})},e}(x),A=function(t){return[[-t/2,-t/2],[-t/2,t/2],[t/2,t/2]]},R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,n.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"折线图"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,r=t.color,s=this.iconSize,o=this.lineWidth,a=(s-2*o-o)/4,l=(s-2*o-o)/2,h=(0,n.CR)([e-s/2+o,i+s/2-2*o],2),d=h[0],c=h[1];(0,f.Ys)(this.icon).maybeAppend(".coordinate","polyline").styles({points:A(s).map(function(t){var r=(0,n.CR)(t,2);return[r[0]+e,r[1]+i]}),stroke:r,lineWidth:o}),(0,f.Ys)(this.icon).maybeAppend(".line","polyline").styles({points:[[d,c],[d+a,c-l],[d+2*a,c],[d+4*a,c-2*l]],stroke:r,lineWidth:o})},e}(x),L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,n.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"条形图"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.data,e=this.attributes,i=e.x,r=e.y,s=e.color,o=this.iconSize,a=this.lineWidth,l=(o-a)/t.length,h=(o-2*a)/4,d=(0,n.CR)([i-o/2+2*a,r+o/2-a],2),c=d[0],u=d[1];(0,f.Ys)(this.icon).maybeAppend(".coordinate","polyline").styles({points:A(o).map(function(t){var e=(0,n.CR)(t,2);return[e[0]+i,e[1]+r]}),stroke:s,lineWidth:a}),(0,f.Ys)(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map(function(t,e){return{value:t,index:e}})).join(function(t){return t.append("line").attr("className","column").style("x1",function(t){return c+l*t.index}).style("y1",u).style("x2",function(t){return c+l*t.index}).style("y2",function(t){return u-h*t.value}).styles({y1:u,stroke:s,lineWidth:a})})},e}(x),k=function(t){function e(e){var i=t.call(this,(0,a.n)({},{style:{color:"#d8d9d9"}},e))||this;return i.showBackground=!1,i}return(0,n.ZT)(e,t),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=this.lineWidth;(0,f.Ys)(this.icon).maybeAppend(".split","line").styles({x1:e,y1:i-r/2,x2:e,y2:i+r/2,stroke:n,lineWidth:s})},e}(x),N=function(t){function e(){var e=t.apply(this,(0,n.ev)([],(0,n.CR)(arguments),!1))||this;return e.showBackground=!1,e}return(0,n.ZT)(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return(0,p.j)(0)},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.iconSize,e=this.attributes,i=e.x,s=e.y,o=e.speed,a=(0,g.Z)(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),l=(0,r.Z)(t,20,1/0),h=(0,n.pi)((0,n.pi)({},a),{x:i-l/2,y:s-10,width:l,height:20,defaultValue:void 0===o?1:o,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:t/5,placeholderFontSize:t/2,optionPadding:0,optionLabelFontSize:t/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});(0,f.Ys)(this.icon).maybeAppend(".speed",function(){return new E({style:h})}).attr("className","speed").each(function(){this.update(h)})},e.tag="SpeedSelect",e}(x),j=function(t){function e(e){var i=t.call(this,e)||this;return i.icon=i.appendChild(new o.ZA({})),i.currentType=i.attributes.type,i}return(0,n.ZT)(e,t),e.prototype.getType=function(){return this.currentType},e.prototype.render=function(){var t=this,e=this.attributes,i=(e.onChange,(0,n._T)(e,["onChange"]));(0,f.Ys)(this.icon).selectAll(".icon").data([this.currentType]).join(function(e){return e.append(function(e){var i,r=null===(i=t.toggles.find(function(t){return(0,n.CR)(t,1)[0]===e}))||void 0===i?void 0:i[1];if(!r)throw Error("Invalid type: ".concat(e));return new r({})}).attr("className","icon").styles(i,!1).update({})},function(t){return t.styles({restStyles:i}).update({})},function(t){return t.remove()})},e.prototype.bindEvents=function(){var t=this,e=this.attributes.onChange;this.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation();var r=(t.toggles.findIndex(function(e){return(0,n.CR)(e,1)[0]===t.currentType})+1)%t.toggles.length,s=t.toggles[r][0];null==e||e(t.currentType),t.currentType=s,t.render()})},e.tag="ToggleIcon",e}(s.w),I=function(t){function e(e){var i=t.call(this,(0,a.n)({},{style:{type:"play"}},e))||this;return i.toggles=[["play",M],["pause",C]],i}return(0,n.ZT)(e,t),e}(j),B=function(t){function e(e){var i=t.call(this,(0,a.n)({},{style:{type:"range"}},e))||this;return i.toggles=[["range",T],["value",P]],i}return(0,n.ZT)(e,t),e}(j),F=function(t){function e(e){var i=t.call(this,(0,a.n)({},{style:{type:"column"}},e))||this;return i.toggles=[["line",R],["column",L]],i}return(0,n.ZT)(e,t),e}(j),_={reset:w,speed:N,backward:S,playPause:I,forward:D,selectionType:B,chartType:F,split:k},z=function(t){function e(i){var n=t.call(this,(0,a.n)({},e.defaultOptions,i))||this;return n.background=n.appendChild(new o.UL({})),n.functions=n.appendChild(new o.ZA({})),n}return(0,n.ZT)(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return(0,p.j)(this.attributes.padding)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.style,e=t.x,i=t.y,r=t.width,s=t.height,o=(0,h.zs)(this.attributes,"background");this.background.attr((0,n.pi)({x:e,y:i,width:r,height:s},o))},e.prototype.renderFunctions=function(){var t,e=this,i=this.attributes,r=i.functions,s=i.iconSize,o=i.iconSpacing,a=i.x,l=i.y,h=i.width,d=i.height,c=i.align,u=(0,n.CR)(this.padding,4),p=u[1],g=u[3],f=r.reduce(function(t,e){return t.length&&e.length?t.concat.apply(t,(0,n.ev)(["split"],(0,n.CR)(e),!1)):t.concat.apply(t,(0,n.ev)([],(0,n.CR)(e),!1))},[]),y=f.length*(s+o)-o,m={left:g+s/2,center:(h-y)/2+s/2,right:h-y-g-p+s/2}[c]||0;null===(t=this.speedSelect)||void 0===t||t.destroy(),this.functions.removeChildren(),f.forEach(function(t,i){var r,h=_[t],c={x:a+i*(s+o)+m,y:l+d/2,size:s};if(h===N?(c.speed=e.attributes.speed,c.onSelect=function(i){return e.handleFunctionChange(t,{value:i})}):[I,B,F].includes(h)?(c.onChange=function(i){return e.handleFunctionChange(t,{value:i})},h===I&&(c.type="play"===e.attributes.state?"pause":"play"),h===B&&(c.type="range"===e.attributes.selectionType?"value":"range"),h===F&&(c.type="line"===e.attributes.chartType?"column":"line")):c.onClick=function(){return e.handleFunctionChange(t,{value:t})},h===N){var u=null===(r=e.ownerDocument)||void 0===r?void 0:r.defaultView;u&&(e.speedSelect=new h({style:(0,n.pi)((0,n.pi)({},c),{zIndex:100})}),u.appendChild(e.speedSelect))}else e.functions.appendChild(new h({style:c}))})},e.prototype.disconnectedCallback=function(){var e;t.prototype.disconnectedCallback.call(this),null===(e=this.speedSelect)||void 0===e||e.destroy()},e.prototype.render=function(){this.renderBackground(),this.renderFunctions()},e.prototype.handleFunctionChange=function(t,e){var i=this.attributes.onChange;null==i||i(t,e)},e.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},e}(s.w),Z=function(t){function e(i){var n=t.call(this,(0,a.n)({},e.defaultOptions,i))||this;return n.bindEvents(),n}return(0,n.ZT)(e,t),e.prototype.bindEvents=function(){var t=this;this.addEventListener("mouseenter",function(){t.attr("lineWidth",Math.ceil(+(t.style.r||0)/2))}),this.addEventListener("mouseleave",function(){t.attr("lineWidth",0)})},e.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},e}(o.Cd),$=function(t){function e(i){return t.call(this,(0,a.n)({},e.defaultOptions,i))||this}return(0,n.ZT)(e,t),e.prototype.renderBackground=function(){var t=this.attributes,e=t.x,i=t.y,r=t.width,s=t.height,o=(0,h.zs)(this.attributes,"background");(0,f.Ys)(this).maybeAppend("background","rect").attr("className","background").styles((0,n.pi)({x:e-r/2,y:i-s/2,width:r,height:s},o))},e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,r=t.iconSize,s=(0,h.zs)(this.attributes,"icon"),o=r/2;(0,f.Ys)(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles((0,n.pi)({x1:e-1,y1:i-o,x2:e-1,y2:i+o},s)),(0,f.Ys)(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles((0,n.pi)({x1:e+1,y1:i-o,x2:e+1,y2:i+o},s))},e.prototype.renderBorder=function(){var t=this.attributes,e=t.x,i=t.y,r=t.width,s=t.height,o=t.type,a=(0,h.zs)(this.attributes,"border"),l="start"===o?+r/2:-r/2;(0,f.Ys)(this).maybeAppend("border","line").attr("className","border").styles((0,n.pi)({x1:l+e,y1:i-s/2,x2:l+e,y2:i+s/2},a))},e.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},e.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},e}(s.w);function V(t){var e=String(Math.floor(t/3600)).padStart(2,"0"),i=String(Math.floor(t%3600/60)).padStart(2,"0"),n=String(Math.floor(t%60)).padStart(2,"0");return t<3600?"".concat(i,":").concat(n):"".concat(e,":").concat(i,":").concat(n)}var H=function(t){function e(i){var r=t.call(this,(0,a.n)({},e.defaultOptions,i))||this;r.axis=r.appendChild(new c.R({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),r.timeline=r.appendChild(new u.i({style:{onChange:function(t){r.handleSliderChange(t)}}})),r.controller=r.appendChild(new z({})),r.states={},r.handleSliderChange=function(t){var e,i=Array.isArray(e=r.states.values)?(0,n.ev)([],(0,n.CR)(e),!1):e;r.setBySliderValues(t),r.dispatchOnChange(i)};var s=r.attributes,o=s.selectionType,l=s.chartType,h=s.speed,d=s.state,p=s.playMode,g=s.values;return r.states={chartType:l,playMode:p,selectionType:o,speed:h,state:d},r.setByTimebarValues(g),r}return(0,n.ZT)(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.data.sort(function(t,e){return t.time<e.time?-1:t.time>e.time?1:0})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){var t,e=this.attributes,i=e.x,n=e.y,s=e.width,o=e.height,a=e.type,h=e.controllerHeight,d=(0,r.Z)(+o-h,0,+o),c=new l.b(i,n+ +o-h,+s,h),u=0;"chart"===a?(u=35,t=new l.b(i,n+d-u,+s,u)):t=new l.b;var p="time"===a?10:d;return{axisBBox:t,controllerBBox:c,timelineBBox:new l.b(i,n+("time"===a?d:d-p),+s,p-u)}},enumerable:!1,configurable:!0}),e.prototype.setBySliderValues=function(t){var e,i,r=this.data,s=(0,n.CR)(Array.isArray(t)?t:[0,t],2),o=s[0],a=s[1],l=r.length,h=r[Math.floor(o*l)],d=r[Math.ceil(a*l)-(Array.isArray(t)?0:1)];this.states.values=[null!==(e=null==h?void 0:h.time)&&void 0!==e?e:r[0].time,null!==(i=null==d?void 0:d.time)&&void 0!==i?i:1/0]},e.prototype.setByTimebarValues=function(t){var e,i,r,s=this.data,o=(0,n.CR)(Array.isArray(t)?t:[void 0,t],2),a=o[0],l=o[1],h=s.find(function(t){return t.time===a}),d=s.find(function(t){return t.time===l});this.states.values=[null!==(e=null==h?void 0:h.time)&&void 0!==e?e:null===(i=s[0])||void 0===i?void 0:i.time,null!==(r=null==d?void 0:d.time)&&void 0!==r?r:1/0]},e.prototype.setByIndex=function(t){var e,i,r,s,o=this.data,a=(0,n.CR)(t,2),l=a[0],h=a[1];this.states.values=[null!==(i=null===(e=o[l])||void 0===e?void 0:e.time)&&void 0!==i?i:o[0].time,null!==(s=null===(r=this.data[h])||void 0===r?void 0:r.time)&&void 0!==s?s:1/0]},Object.defineProperty(e.prototype,"sliderValues",{get:function(){var t,e=this.states,i=e.values,r=e.selectionType,s=(0,n.CR)(Array.isArray(i)?i:[void 0,i],2),o=s[0],a=s[1],l=this.data,h=l.length,d="value"===r;return[(t=l.findIndex(function(t){return t.time===o}),d?0:t>-1?t/h:0),function(){if(a===1/0)return 1;var t=l.findIndex(function(t){return t.time===a});return t>-1?t/h:d?.5:1}()]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var t=this.states,e=t.values,i=t.selectionType,r=(0,n.CR)(Array.isArray(e)?e:[this.data[0].time,e],2),s=r[0],o=r[1];return"value"===i?o:[s,o]},enumerable:!1,configurable:!0}),e.prototype.getDatumByRatio=function(t){var e=this.data,i=e.length;return e[Math.floor(t*(i-1))]},Object.defineProperty(e.prototype,"chartHandleIconShape",{get:function(){var t=this.states.selectionType,e=this.space.timelineBBox.height;return"range"===t?function(t){return new $({style:{type:t,height:e,iconSize:e/6}})}:function(){return new o.x1({style:{x1:0,y1:-e/2,x2:0,y2:e/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),e.prototype.getChartStyle=function(t){var e=this,i=t.x,r=t.y,s=t.width,o=t.height,a=this.states,l=a.selectionType,c=a.chartType,u=this.data,p=this.attributes,g=p.type,f=p.labelFormatter,y=(0,h.zs)(this.attributes,"chart"),m=(y.type,(0,n._T)(y,["type"])),v="range"===l;if("time"===g)return(0,n.pi)({handleIconShape:function(){return new Z({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:v?-15:0,autoFitLabel:v,handleSpacing:v?-15:0,trackFill:"#edeeef",trackLength:s,trackOpacity:.5,trackRadius:o/2,trackSize:o/2,type:l,values:this.sliderValues,formatter:function(t){if(f)return f(t);var i=e.getDatumByRatio(t).time;return"number"==typeof i?V(i):d(i,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(i,", ").concat(r,")"),zIndex:1},m);var b=u.map(function(t){return t.value});return(0,n.pi)({handleIconOffset:"range"===l?5:0,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:b,sparklineType:c,sparklineScale:.8,trackLength:s,trackSize:o,type:l,values:this.sliderValues,transform:"translate(".concat(i,", ").concat(r,")"),zIndex:1},m)},e.prototype.renderChart=function(t){void 0===t&&(t=this.space.timelineBBox),this.timeline.update(this.getChartStyle(t))},e.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},e.prototype.getAxisStyle=function(t){var e=this.data,i=this.attributes,r=i.interval,s=i.labelFormatter,o=(0,h.zs)(this.attributes,"axis"),a=t.x,l=t.y,c=t.width,u=(0,n.ev)((0,n.ev)([],(0,n.CR)(e),!1),[{time:0}],!1).map(function(t,e,i){var n=t.time;return{label:"".concat(n),value:e/(i.length-1),time:n}});return(0,n.pi)({startPos:[a,l],endPos:[a+c,l],data:u,labelFilter:function(t,e){return e<u.length-1},labelFormatter:function(t){var e=t.time;return s?s(e):"number"==typeof e?V(e):function(t,e){var i=new Date(t);switch(e){case"half-hour":case"hour":case"four-hour":if([0,6,12,18].includes(i.getHours())&&0===i.getMinutes())return d(i,"HH:mm\nYYYY-MM-DD");return d(i,"HH:mm");case"half-day":if(12>i.getHours())return"AM\n".concat(d(i,"YYYY-MM-DD"));return"PM";case"day":if([1,10,20].includes(i.getDate()))return d(i,"DD\nYYYY-MM");return d(i,"DD");case"week":if(7>=i.getDate())return d(i,"DD\nYYYY-MM");return d(i,"DD");case"month":if([0,6].includes(i.getMonth()))return d(i,"MM月\nYYYY");return d(i,"MM月");case"season":if([0].includes(i.getMonth()))return d(i,"MM月\nYYYY");return d(i,"MM月");case"year":return d(i,"YYYY");default:return d(i,"YYYY-MM-DD HH:mm")}}(e,r)}},o)},e.prototype.renderAxis=function(t){void 0===t&&(t=this.space.axisBBox),"chart"===this.attributes.type&&this.axis.update(this.getAxisStyle(t))},e.prototype.renderController=function(t){void 0===t&&(t=this.space.controllerBBox);var e=this.attributes.type,i=this.states,r=i.state,s=i.speed,o=i.selectionType,a=i.chartType,l=(0,h.zs)(this.attributes,"controller"),d=this,c=(0,n.pi)((0,n.pi)((0,n.pi)({},t),{iconSize:20,speed:s,state:r,selectionType:o,chartType:a,onChange:function(t,e){var i=e.value;switch(t){case"reset":d.internalReset();break;case"speed":d.handleSpeedChange(i);break;case"backward":d.internalBackward();break;case"playPause":"play"===i?d.internalPlay():d.internalPause();break;case"forward":d.internalForward();break;case"selectionType":d.handleSelectionTypeChange(i);break;case"chartType":d.handleChartTypeChange(i)}}}),l);"time"===e&&(c.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(c)},e.prototype.dispatchOnChange=function(t){var e=this.data,i=this.attributes.onChange,r=this.states,s=r.values,o=r.selectionType,a=(0,n.CR)(s,2),l=a[0],h=a[1],d=h===1/0?e.at(-1).time:h,c="range"===o?[l,d]:d;(!t||(Array.isArray(t)?!Array.isArray(c)||t[0]!==c[0]||t[1]!==c[1]&&t[1]!==1/0&&c[1]!==1/0:Array.isArray(c)||t!==c))&&null!=i&&i("range"===o?[l,d]:d)},e.prototype.internalReset=function(t){var e,i,n=this.states.selectionType;this.internalPause(),this.setBySliderValues("range"===n?[0,1]:[0,0]),this.renderController(),this.updateSelection(),t||(null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onReset)||void 0===i||i.call(e),this.dispatchOnChange())},e.prototype.reset=function(){this.internalReset()},e.prototype.moveSelection=function(t,e){var i,s,o,a,l,h,d=this.data,c=d.length,u=this.states,p=u.values,g=u.selectionType,f=u.playMode,y=(0,n.CR)(p,2),m=y[0],v=y[1],b=d.findIndex(function(t){return t.time===m}),E=d.findIndex(function(t){return t.time===v});-1===E&&(E=c);var x="backward"===t?-1:1;"range"===g?"acc"===f?(h=[b,E+x],-1===x&&b===E&&(h=[b,c])):h=[b+x,E+x]:h=[b,E+x];var O=(i=h,o=(s=(0,n.CR)(i.sort(function(t,e){return t-e}),2))[0],a=s[1],l=function(t){return(0,r.Z)(t,0,c)},a>c?"value"===g?[0,0]:"acc"===f?[l(o),l(o)]:[0,l(a-o)]:o<0?"acc"===f?[0,l(a)]:[l(o+c-a),c]:[l(o),l(a)]);return this.setByIndex(O),this.updateSelection(),O},e.prototype.internalBackward=function(t){var e,i,n=this.moveSelection("backward",t);return t||(null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onBackward)||void 0===i||i.call(e),this.dispatchOnChange()),n},e.prototype.backward=function(){this.internalBackward()},e.prototype.internalPlay=function(t){var e,i,n=this,r=this.data,s=this.attributes.loop,o=this.states.speed,a=void 0===o?1:o;this.playInterval=window.setInterval(function(){n.internalForward()[1]!==r.length||s||(n.internalPause(),n.renderController())},1e3/a),this.states.state="play",t||null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onPlay)||void 0===i||i.call(e)},e.prototype.play=function(){this.internalPlay()},e.prototype.internalPause=function(t){var e,i;clearInterval(this.playInterval),this.states.state="pause",t||null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onPause)||void 0===i||i.call(e)},e.prototype.pause=function(){this.internalPause()},e.prototype.internalForward=function(t){var e,i,n=this.moveSelection("forward",t);return t||(null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onForward)||void 0===i||i.call(e),this.dispatchOnChange()),n},e.prototype.forward=function(){this.internalForward()},e.prototype.handleSpeedChange=function(t){var e,i;this.states.speed=t,"play"===this.states.state&&(this.internalPause(!0),this.internalPlay(!0)),null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onSpeedChange)||void 0===i||i.call(e,t)},e.prototype.handleSelectionTypeChange=function(t){var e,i;this.states.selectionType=t,this.renderChart(),null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onSelectionTypeChange)||void 0===i||i.call(e,t)},e.prototype.handleChartTypeChange=function(t){var e,i;this.states.chartType=t,this.renderChart(),null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onChartTypeChange)||void 0===i||i.call(e,t)},e.prototype.render=function(){var t=this.space,e=t.axisBBox,i=t.controllerBBox,n=t.timelineBBox;this.renderController(i),this.renderAxis(e),this.renderChart(n),"play"===this.states.state&&this.internalPlay()},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.internalPause(!0)},e.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},e}(s.w)},36052:function(t,e,i){"use strict";let n;i.d(e,{rk:function(){return sO},kJ:function(){return og},k9:function(){return it},Wp:function(){return nC},aH:function(){return iQ},jD:function(){return tv},_8:function(){return ew},TA:function(){return tQ},z2:function(){return sC},RN:function(){return oy}});var r,s,o,a,l,h,d,c,u,p,g,f,y,m,v,b,E,x,O,w,S,D,M={};i.r(M),i.d(M,{circle:function(){return iP},diamond:function(){return iR},rect:function(){return ik},simple:function(){return ij},triangle:function(){return iA},triangleRect:function(){return iN},vee:function(){return iL}});var C=i(18687),T=i(18599),P=i(89148),A=i(99666),R=i(70373);let L={duration:500},k={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"};(r=f||(f={})).NodeAdded="NodeAdded",r.NodeUpdated="NodeUpdated",r.NodeRemoved="NodeRemoved",r.EdgeAdded="EdgeAdded",r.EdgeUpdated="EdgeUpdated",r.EdgeRemoved="EdgeRemoved",r.ComboAdded="ComboAdded",r.ComboUpdated="ComboUpdated",r.ComboRemoved="ComboRemoved",(s=y||(y={})).DRAW="draw",s.COLLAPSE="collapse",s.EXPAND="expand",s.TRANSFORM="transform",(o=m||(m={})).CLICK="canvas:click",o.DBLCLICK="canvas:dblclick",o.POINTER_OVER="canvas:pointerover",o.POINTER_LEAVE="canvas:pointerleave",o.POINTER_ENTER="canvas:pointerenter",o.POINTER_MOVE="canvas:pointermove",o.POINTER_OUT="canvas:pointerout",o.POINTER_DOWN="canvas:pointerdown",o.POINTER_UP="canvas:pointerup",o.CONTEXT_MENU="canvas:contextmenu",o.DRAG_START="canvas:dragstart",o.DRAG="canvas:drag",o.DRAG_END="canvas:dragend",o.DRAG_ENTER="canvas:dragenter",o.DRAG_OVER="canvas:dragover",o.DRAG_LEAVE="canvas:dragleave",o.DROP="canvas:drop",o.WHEEL="canvas:wheel",(a=v||(v={})).CLICK="combo:click",a.DBLCLICK="combo:dblclick",a.POINTER_OVER="combo:pointerover",a.POINTER_LEAVE="combo:pointerleave",a.POINTER_ENTER="combo:pointerenter",a.POINTER_MOVE="combo:pointermove",a.POINTER_OUT="combo:pointerout",a.POINTER_DOWN="combo:pointerdown",a.POINTER_UP="combo:pointerup",a.CONTEXT_MENU="combo:contextmenu",a.DRAG_START="combo:dragstart",a.DRAG="combo:drag",a.DRAG_END="combo:dragend",a.DRAG_ENTER="combo:dragenter",a.DRAG_OVER="combo:dragover",a.DRAG_LEAVE="combo:dragleave",a.DROP="combo:drop",(l=b||(b={})).CLICK="click",l.DBLCLICK="dblclick",l.POINTER_OVER="pointerover",l.POINTER_LEAVE="pointerleave",l.POINTER_ENTER="pointerenter",l.POINTER_MOVE="pointermove",l.POINTER_OUT="pointerout",l.POINTER_DOWN="pointerdown",l.POINTER_UP="pointerup",l.CONTEXT_MENU="contextmenu",l.DRAG_START="dragstart",l.DRAG="drag",l.DRAG_END="dragend",l.DRAG_ENTER="dragenter",l.DRAG_OVER="dragover",l.DRAG_LEAVE="dragleave",l.DROP="drop",l.KEY_DOWN="keydown",l.KEY_UP="keyup",l.WHEEL="wheel",l.PINCH="pinch",(h=E||(E={})).KEY_DOWN="keydown",h.KEY_UP="keyup",(d=x||(x={})).CLICK="edge:click",d.DBLCLICK="edge:dblclick",d.POINTER_OVER="edge:pointerover",d.POINTER_LEAVE="edge:pointerleave",d.POINTER_ENTER="edge:pointerenter",d.POINTER_MOVE="edge:pointermove",d.POINTER_OUT="edge:pointerout",d.POINTER_DOWN="edge:pointerdown",d.POINTER_UP="edge:pointerup",d.CONTEXT_MENU="edge:contextmenu",d.DRAG_ENTER="edge:dragenter",d.DRAG_OVER="edge:dragover",d.DRAG_LEAVE="edge:dragleave",d.DROP="edge:drop",(c=O||(O={})).BEFORE_CANVAS_INIT="beforecanvasinit",c.AFTER_CANVAS_INIT="aftercanvasinit",c.BEFORE_SIZE_CHANGE="beforesizechange",c.AFTER_SIZE_CHANGE="aftersizechange",c.BEFORE_ELEMENT_CREATE="beforeelementcreate",c.AFTER_ELEMENT_CREATE="afterelementcreate",c.BEFORE_ELEMENT_UPDATE="beforeelementupdate",c.AFTER_ELEMENT_UPDATE="afterelementupdate",c.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",c.AFTER_ELEMENT_DESTROY="afterelementdestroy",c.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",c.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",c.BEFORE_DRAW="beforedraw",c.AFTER_DRAW="afterdraw",c.BEFORE_RENDER="beforerender",c.AFTER_RENDER="afterrender",c.BEFORE_ANIMATE="beforeanimate",c.AFTER_ANIMATE="afteranimate",c.BEFORE_LAYOUT="beforelayout",c.AFTER_LAYOUT="afterlayout",c.BEFORE_STAGE_LAYOUT="beforestagelayout",c.AFTER_STAGE_LAYOUT="afterstagelayout",c.BEFORE_TRANSFORM="beforetransform",c.AFTER_TRANSFORM="aftertransform",c.BATCH_START="batchstart",c.BATCH_END="batchend",c.BEFORE_DESTROY="beforedestroy",c.AFTER_DESTROY="afterdestroy",c.BEFORE_RENDERER_CHANGE="beforerendererchange",c.AFTER_RENDERER_CHANGE="afterrendererchange",(u=w||(w={})).UNDO="undo",u.REDO="redo",u.CANCEL="cancel",u.ADD="add",u.CLEAR="clear",u.CHANGE="change",(p=S||(S={})).CLICK="node:click",p.DBLCLICK="node:dblclick",p.POINTER_OVER="node:pointerover",p.POINTER_LEAVE="node:pointerleave",p.POINTER_ENTER="node:pointerenter",p.POINTER_MOVE="node:pointermove",p.POINTER_OUT="node:pointerout",p.POINTER_DOWN="node:pointerdown",p.POINTER_UP="node:pointerup",p.CONTEXT_MENU="node:contextmenu",p.DRAG_START="node:dragstart",p.DRAG="node:drag",p.DRAG_END="node:dragend",p.DRAG_ENTER="node:dragenter",p.DRAG_OVER="node:dragover",p.DRAG_LEAVE="node:dragleave",p.DROP="node:drop";let N="combo",j="tree";(g=D||(D={})).NODE="node",g.EDGE="edge",g.COMBO="combo",g.THEME="theme",g.PALETTE="palette",g.LAYOUT="layout",g.BEHAVIOR="behavior",g.PLUGIN="plugin",g.ANIMATION="animation",g.TRANSFORM="transform",g.SHAPE="shape";let I={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function B(t,e){var i;let n=null===(i=I[t])||void 0===i?void 0:i[e];if(n)return n}function F(t){return`[G6 v5.0.49] ${t}`}let _={mute:!1,debug:t=>{_.mute||console.debug(F(t))},info:t=>{_.mute||console.info(F(t))},warn:t=>{_.mute||console.warn(F(t))},error:t=>{_.mute||console.error(F(t))}};function z(t){let{theme:e}=t;if(!e)return{};let i=B(D.THEME,e);return i||(_.warn(`The theme of ${e} is not registered.`),{})}function Z(t,e){if(Array.isArray(t)&&0===t.length)return null;let i=Array.isArray(t)?t[0]:t,n=Array.isArray(t)?t.slice(1):e||[];return new Proxy(i,{get:(t,e)=>"function"!=typeof t[e]||["onframe","onfinish"].includes(e)?"finished"===e?Promise.all([i.finished,...n.map(t=>t.finished)]):Reflect.get(t,e):(...i)=>{t[e](...i),n.forEach(t=>{var n;return null===(n=t[e])||void 0===n?void 0:n.call(t,...i)})},set:(t,e,i)=>(["onframe","onfinish"].includes(e)||n.forEach(t=>{t[e]=i}),Reflect.set(t,e,i))})}function $(t){let e=t.reduce((t,e)=>(Object.entries(e).forEach(([e,i])=>{void 0===t[e]?t[e]=[i]:t[e].push(i)}),t),{});Object.entries(e).forEach(([i,n])=>{(n.length!==t.length||n.some(t=>(0,P.Z)(t))||n.every(t=>!["sourceNode","targetNode","childrenNode"].includes(i)&&(0,A.Z)(t,n[0])))&&delete e[i]});let i=Object.entries(e).reduce((t,[e,i])=>(i.forEach((i,n)=>{t[n]?t[n][e]=i:t[n]={[e]:i}}),t),[]);return 0!==t.length&&0===i.length&&i.push(...[{_:0},{_:0}]),i}function V(t){switch(t){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function H(t,e){let{animation:i}=t;if(!1===i||!1===e)return!1;let n=Object.assign({},L);return(0,R.Z)(i)&&Object.assign(n,i),(0,R.Z)(e)&&Object.assign(n,e),n}var W=i(26912);function G(t,e,i,n=[]){if(!n&&0===t&&0===e&&0===i)return null;if(Array.isArray(n)){let r=-1,s=[];for(let o=0;o<n.length;o++){let a=n[o];if("translate"===a[0]){if(a[1]===t&&a[2]===e)return null;r=o,s.push(["translate",t,e])}else if("translate3d"===a[0]){if(a[1]===t&&a[2]===e&&a[3]===i)return null;r=o,s.push(["translate3d",t,e,null!=i?i:0])}else s.push(a)}return(-1===r&&s.splice(0,0,(0,W.Z)(i)?["translate3d",t,e,null!=i?i:0]:["translate",t,e]),0===s.length)?null:s}let r=n?n.replace(/translate(3d)?\([^)]*\)/g,""):"";return 0===i?`translate(${t}, ${e})${r}`:`translate3d(${t}, ${e}, ${i})${r}`}var Y=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};let U=(t,e,i)=>{let n;if(!i.length)return null;let[r,s]=e,o=e=>{var i;if(!e)return{shape:t,fromStyle:r,toStyle:s};{let n=t.getShape(e);if(!n)return null;let o=`get${(0,T.Z)(e)}Style`,a=(null===(i=null==t?void 0:t[o])||void 0===i?void 0:i.bind(t))||(t=>t),l=(null==a?void 0:a(r))||{},h=(null==a?void 0:a(s))||{};return{shape:n,fromStyle:l,toStyle:h}}},a=i.map(t=>{var{fields:e,shape:i,states:r}=t,s=Y(t,["fields","shape","states"]);let a=o(i);if(!a)return null;let{shape:l,fromStyle:h,toStyle:d}=a,c=[{},{}];if(e.forEach(t=>{var e,i;Object.assign(c[0],{[t]:null!==(e=h[t])&&void 0!==e?e:V(t)}),Object.assign(c[1],{[t]:null!==(i=d[t])&&void 0!==i?i:V(t)})}),c.some(t=>Object.keys(t).some(t=>["x","y","z"].includes(t)))){let{x:t=0,y:e=0,z:i,transform:n=""}=l.attributes||{};c.forEach(r=>{var s,o,a;r.transform=G(null!==(s=r.x)&&void 0!==s?s:t,null!==(o=r.y)&&void 0!==o?o:e,null!==(a=r.z)&&void 0!==a?a:i,n)})}let u=l.animate($(c),s);return void 0===i&&(n=u),u}).filter(Boolean),l=n||(null==a?void 0:a[0]);return l?Z(l,a.filter(t=>t!=t)):null},K=[{fields:["x","y"]}],X=[{fields:["sourceNode","targetNode"]}],q=[{fields:["childrenNode","x","y"]}];var J=i(91531),Q=i(26218),tt=i(31922),te=i(21914);function ti(t){return t instanceof Float32Array||!!Array.isArray(t)&&(2===t.length||3===t.length)&&t.every(t=>"number"==typeof t)}function tn(t,e,i){return t>=e&&t<=i}function tr(t=0){if(Array.isArray(t)){let[e=0,i=e,n=e,r=i]=t;return[e,i,n,r]}return[t,t,t,t]}function ts(t){return t.max[0]-t.min[0]}function to(t){return t.max[1]-t.min[1]}function ta(t){return[ts(t),to(t)]}function tl(t,e){let i=ti(t)?th(t):t.getShape("key").getBounds();return e?td(i,e):i}function th(t){let[e,i,n=0]=t,r=new C.mN;return r.setMinMax([e,i,n],[e,i,n]),r}function td(t,e){let[i,n,r,s]=tr(e),[o,a,l]=t.min,[h,d,c]=t.max,u=new C.mN;return u.setMinMax([o-s,a-i,l],[h+n,d+r,c]),u}function tc(t){if(0===t.length)return new C.mN;if(1===t.length)return t[0];let e=new C.mN;e.setMinMax(t[0].min,t[0].max);for(let i=1;i<t.length;i++){let n=t[i];e.setMinMax([Math.min(e.min[0],n.min[0]),Math.min(e.min[1],n.min[1]),Math.min(e.min[2],n.min[2])],[Math.max(e.max[0],n.max[0]),Math.max(e.max[1],n.max[1]),Math.max(e.max[2],n.max[2])])}return e}function tu(t,e){return tn(t[0],e.min[0],e.max[0])&&tn(t[1],e.min[1],e.max[1])}function tp(t,e,i=!1){let{min:[n,r],max:[s,o]}=e,a=(t[1]===r||t[1]===o)&&(i||tn(t[0],n,s)),l=(t[0]===n||t[0]===s)&&(i||tn(t[1],r,o));return a||l}function tg(t,e){let{center:i}=e;return t[0]===i[0]&&t[1]===i[1]}function tf(t,e){let[i,n]=t,[r,s]=e.min,[o,a]=e.max,l=i-r,h=o-i,d=n-s,c=a-n,u=Math.min(l,h,d,c);return u===l?"left":u===h?"right":u===d?"top":u===c?"bottom":"left"}function ty(t,e){let i=(0,te.Z)(t);if(tu(t,e)){let n=tf(t,e);switch(n){case"left":i[0]=e.min[0];break;case"right":i[0]=e.max[0];break;case"top":i[1]=e.min[1];break;case"bottom":i[1]=e.max[1]}}else{let[n,r]=t,[s,o]=e.min,[a,l]=e.max;i[0]=tn(n,s,a)?n:n<s?s:a,i[1]=tn(r,o,l)?r:r<o?o:l}return i}var tm=i(92776);function tv(t){if(void 0!==t.id)return t.id;if(void 0!==t.source&&void 0!==t.target)return`${t.source}-${t.target}`;throw Error(F("The datum does not have available id."))}function tb(t,e){let i={nodes:(t.nodes||[]).map(tv),edges:(t.edges||[]).map(tv),combos:(t.combos||[]).map(tv)};return e?Object.values(i).flat():i}let tE=(t,e,i)=>{var n;switch(i.type){case"degree":{let r=new Map;return null===(n=t.nodes)||void 0===n||n.forEach(t=>{let n=e(tv(t),i.direction).length;r.set(tv(t),n)}),r}case"betweenness":return tO(t,i.directed,i.weightPropertyName);case"closeness":return tw(t,i.directed,i.weightPropertyName);case"eigenvector":return tD(t,i.directed);case"pagerank":return tS(t,i.epsilon,i.linkProb);default:return tx(t)}},tx=t=>{var e;let i=new Map;return null===(e=t.nodes)||void 0===e||e.forEach(t=>{i.set(tv(t),0)}),i},tO=(t,e,i)=>{let n=tx(t),{nodes:r=[]}=t;return r.forEach(s=>{r.forEach(r=>{if(s!==r){let{allPath:o}=(0,tm.ni)(t,tv(s),tv(r),e,i),a=o.length;o.flat().forEach(t=>{t!==tv(s)&&t!==tv(r)&&n.set(t,n.get(t)+1/a)})}})}),n},tw=(t,e,i)=>{let n=new Map,{nodes:r=[]}=t;return r.forEach(s=>{let o=r.reduce((n,r)=>{if(s!==r){let{length:o}=(0,tm.ni)(t,tv(s),tv(r),e,i);n+=o}return n},0);n.set(tv(s),1/o)}),n},tS=(t,e,i)=>{var n;let r=new Map,s=(0,tm.EF)(t,e,i);return null===(n=t.nodes)||void 0===n||n.forEach(t=>{r.set(tv(t),s[tv(t)])}),r},tD=(t,e)=>{let{nodes:i=[]}=t,n=tM(t,e),r=tC(n,i.length),s=new Map;return i.forEach((t,e)=>{s.set(tv(t),r[e])}),s},tM=(t,e)=>{let{nodes:i=[],edges:n=[]}=t,r=Array(i.length).fill(null).map(()=>Array(i.length).fill(0));return n.forEach(({source:t,target:n})=>{let s=i.findIndex(e=>tv(e)===t),o=i.findIndex(t=>tv(t)===n);e?r[s][o]=1:(r[s][o]=1,r[o][s]=1)}),r},tC=(t,e,i=100,n=1e-6)=>{let r=Array(e).fill(1),s=1/0;for(let o=0;o<i&&s>n;o++){let i=Array(e).fill(0);for(let n=0;n<e;n++)for(let s=0;s<e;s++)i[n]+=t[n][s]*r[s];let n=Math.sqrt(i.reduce((t,e)=>t+e*e,0));for(let t=0;t<e;t++)i[t]/=n;s=Math.sqrt(i.reduce((t,e,i)=>t+(e-r[i])*e,0)),r=i}return r};function tT(t,e,i,n=A.Z){let r=new Map(t.map(t=>[i(t),t])),s=new Map(e.map(t=>[i(t),t])),o=new Set(r.keys()),a=new Set(s.keys()),l=[],h=[],d=[],c=[];return a.forEach(t=>{o.has(t)?n(r.get(t),s.get(t))?c.push(s.get(t)):h.push(s.get(t)):l.push(s.get(t))}),o.forEach(t=>{a.has(t)||d.push(r.get(t))}),{enter:l,exit:d,keep:c,update:h}}function tP(t,e,i){let n=t=>{(!i||i(t))&&(t.style.visibility=e)};t.forEach(t=>{n(t)})}class tA{constructor(t){this.extensions=[],this.extensionMap={},this.context=t}setExtensions(t){let e=function(t,e,i){let n={},r=t=>(t in n||(n[t]=0),`${e}-${t}-${n[t]++}`);return i.map(e=>"string"==typeof e?{type:e,key:r(e)}:"function"==typeof e?e.call(t):e.key?e:Object.assign(Object.assign({},e),{key:r(e.type)}))}(this.context.graph,this.category,t),{enter:i,update:n,exit:r,keep:s}=tT(this.extensions,e,t=>t.key);this.createExtensions(i),this.updateExtensions([...n,...s]),this.destroyExtensions(r),this.extensions=e}createExtension(t){let{category:e}=this,{key:i,type:n}=t,r=B(e,n);if(!r)return _.warn(`The extension ${n} of ${e} is not registered.`);let s=new r(this.context,t);s.initialized=!0,this.extensionMap[i]=s}createExtensions(t){t.forEach(t=>this.createExtension(t))}updateExtension(t){let{key:e}=t,i=this.extensionMap[e];i&&i.update(t)}updateExtensions(t){t.forEach(t=>this.updateExtension(t))}destroyExtension(t){let e=this.extensionMap[t];e&&(e.initialized&&!e.destroyed&&e.destroy(),delete this.extensionMap[t])}destroyExtensions(t){t.forEach(({key:t})=>this.destroyExtension(t))}destroy(){this.destroyExtensions(this.extensions),this.context={},this.extensions=[],this.extensionMap={}}}class tR{constructor(t,e){this.events=[],this.initialized=!1,this.destroyed=!1,this.context=t,this.options=e}update(t){this.options=Object.assign(this.options,t)}destroy(){this.context={},this.options={},this.destroyed=!0}}class tL extends tR{}class tk extends tL{constructor(t,e){super(t,Object.assign({},tk.defaultOptions,e)),this.isOverlapping=(t,e)=>e.some(e=>t.intersects(e)),this.occupiedBounds=[],this.detectLabelCollision=t=>{let e=this.context.viewport,i={show:[],hide:[]};return this.occupiedBounds=[],t.forEach(t=>{let n=t.getShape("label").getRenderBounds();e.isInViewport(n,!0)&&!this.isOverlapping(n,this.occupiedBounds)?(i.show.push(t),this.occupiedBounds.push(td(n,this.options.padding))):i.hide.push(t)}),i},this.hideLabelIfExceedViewport=(t,e)=>{let{exit:i}=tT(t,e,t=>t.id);null==i||i.forEach(this.hideLabel)},this.nodeCentralities=new Map,this.sortNodesByCentrality=(t,e)=>{let{model:i}=this.context,n=i.getData(),r=i.getRelatedEdgesData.bind(i),s=t.map(t=>(this.nodeCentralities.has(t.id)||(this.nodeCentralities=tE(n,r,e)),{node:t,centrality:this.nodeCentralities.get(t.id)}));return s.sort((t,e)=>e.centrality-t.centrality).map(t=>t.node)},this.sortLabelElementsInView=t=>{let{sort:e,sortNode:i,sortCombo:n,sortEdge:r}=this.options,{model:s}=this.context;if((0,J.Z)(e))return t.sort((t,i)=>e(s.getElementDataById(t.id),s.getElementDataById(i.id)));let{node:o=[],edge:a=[],combo:l=[]}=(0,Q.Z)(t,t=>t.type),h=(0,J.Z)(n)?l.sort((t,e)=>n(...s.getComboData([t.id,e.id]))):l,d=(0,J.Z)(i)?o.sort((t,e)=>i(...s.getNodeData([t.id,e.id]))):this.sortNodesByCentrality(o,i),c=(0,J.Z)(r)?a.sort((t,e)=>r(...s.getEdgeData([t.id,e.id]))):a;return[...h,...d,...c]},this.labelElementsInView=[],this.isFirstRender=!0,this.onToggleVisibility=t=>{var e;if((null===(e=t.data)||void 0===e?void 0:e.stage)==="zIndex")return;if(!this.validate(t)){this.hiddenElements.size>0&&(this.hiddenElements.forEach(this.showLabel),this.hiddenElements.clear());return}let i=this.isFirstRender?this.getLabelElements():this.getLabelElementsInView();this.hideLabelIfExceedViewport(this.labelElementsInView,i),this.labelElementsInView=i;let n=this.sortLabelElementsInView(this.labelElementsInView),{show:r,hide:s}=this.detectLabelCollision(n);for(let t=r.length-1;t>=0;t--)this.showLabel(r[t]);s.forEach(this.hideLabel)},this.hiddenElements=new Map,this.hideLabel=t=>{let e=t.getShape("label");e&&tP(e,"hidden"),this.hiddenElements.set(t.id,t)},this.showLabel=t=>{let e=t.getShape("label");e&&tP(e,"visible"),t.toFront(),this.hiddenElements.delete(t.id)},this.onTransform=(0,tt.Z)(this.onToggleVisibility,this.options.throttle,{leading:!0}),this.enableToggle=!0,this.toggle=t=>{this.enableToggle&&this.onToggleVisibility(t)},this.onBeforeRender=()=>{this.enableToggle=!1},this.onAfterRender=t=>{this.onToggleVisibility(t),this.enableToggle=!0},this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents(),this.onToggleVisibility({})}getLabelElements(){let{elementMap:t}=this.context.element,e=[];for(let i in t){let n=t[i];n.isVisible()&&n.getShape("label")&&e.push(n)}return e}getLabelElementsInView(){let t=this.context.viewport;return this.getLabelElements().filter(e=>t.isInViewport(e.getShape("key").getRenderBounds()))}bindEvents(){let{graph:t}=this.context;t.on(O.BEFORE_RENDER,this.onBeforeRender),t.on(O.AFTER_RENDER,this.onAfterRender),t.on(O.AFTER_DRAW,this.toggle),t.on(O.AFTER_LAYOUT,this.toggle),t.on(O.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){let{graph:t}=this.context;t.off(O.BEFORE_RENDER,this.onBeforeRender),t.off(O.AFTER_RENDER,this.onAfterRender),t.off(O.AFTER_DRAW,this.toggle),t.off(O.AFTER_LAYOUT,this.toggle),t.off(O.AFTER_TRANSFORM,this.onTransform)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,J.Z)(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}tk.defaultOptions={enable:!0,throttle:100,padding:0,sortNode:{type:"degree"}};var tN=i(48690);let tj=[0,0,0];function tI(t,e){return t.map((t,i)=>t+e[i])}function tB(t,e){return t.map((t,i)=>t-e[i])}function tF(t,e){return"number"==typeof e?t.map(t=>t*e):t.map((t,i)=>t*e[i])}function t_(t,e){return"number"==typeof e?t.map(t=>t/e):t.map((t,i)=>t/e[i])}function tz(t,e){return t.map(t=>t*e)}function tZ(t,e){return Math.sqrt(t.reduce((t,i,n)=>t+Math.pow(i-e[n]||0,2),0))}function t$(t,e){return t.reduce((t,i,n)=>t+Math.abs(i-e[n]),0)}function tV(t){let e=t.reduce((t,e)=>t+Math.pow(e,2),0);return t.map(t=>t/Math.sqrt(e))}function tH(t,e,i=!1){let n=t[0]*e[1]-t[1]*e[0],r=Math.acos(tF(t,e).reduce((t,e)=>t+e,0)/(tZ(t,tj)*tZ(e,tj)));return i&&n<0&&(r=2*Math.PI-r),r}function tW(t,e=!0){return e?[-t[1],t[0]]:[t[1],-t[0]]}function tG(t,e){return t.map(t=>t%e)}function tY(t){return[t[0],t[1]]}function tU(t){return 2===t.length?[t[0],t[1],0]:t}function tK(t){let[e,i]=t;return e||i?Math.atan2(i,e):0}function tX(t,e){let[i,n]=t,[r,s]=e,o=tB(i,n),a=tB(r,s);return(function(t,e){let i=tU(t),n=tU(e);return[i[1]*n[2]-i[2]*n[1],i[2]*n[0]-i[0]*n[2],i[0]*n[1]-i[1]*n[0]]})(o,a).every(t=>0===t)}function tq(t,e,i=!1){if(tX(t,e))return;let[n,r]=t,[s,o]=e,a=((n[0]-s[0])*(s[1]-o[1])-(n[1]-s[1])*(s[0]-o[0]))/((n[0]-r[0])*(s[1]-o[1])-(n[1]-r[1])*(s[0]-o[0])),l=o[0]-s[0]?(n[0]-s[0]+a*(r[0]-n[0]))/(o[0]-s[0]):(n[1]-s[1]+a*(r[1]-n[1]))/(o[1]-s[1]);if(i||tn(a,0,1)&&tn(l,0,1))return[n[0]+a*(r[0]-n[0]),n[1]+a*(r[1]-n[1])]}function tJ(t){if(Array.isArray(t))return tn(t[0],0,1)&&tn(t[1],0,1)?t:[.5,.5];let e=t.split("-"),i=e.includes("left")?0:e.includes("right")?1:.5,n=e.includes("top")?0:e.includes("bottom")?1:.5;return[i,n]}function tQ(t){let{x:e=0,y:i=0,z:n=0}=t.style||{};return[+e,+i,+n]}function t0(t){let{x:e,y:i,z:n}=t.style||{};return void 0!==e||void 0!==i||void 0!==n}function t1(t,e="center"){let i=tJ(e);return function(t,e){let[i,n]=e,{min:r,max:s}=t;return[r[0]+i*(s[0]-r[0]),r[1]+n*(s[1]-r[1])]}(t,i)}function t2(t){var e;return[t.x,t.y,null!==(e=t.z)&&void 0!==e?e:0]}function t3(t){var e;return{x:t[0],y:t[1],z:null!==(e=t[2])&&void 0!==e?e:0}}function t6(t,e=0){return t.map(t=>parseFloat(t.toFixed(e)))}function t8(t,e,i,n=!1){if((0,A.Z)(t,e))return t;let r=n?tB(t,e):tB(e,t),s=tV(r),o=[s[0]*i,s[1]*i];return tI(tY(t),o)}function t4(t,e){return[2*e[0]-t[0],2*e[1]-t[1]]}function t9(t,e,i,n=!0,r=!1){for(let s=0;s<i.length;s++){let o=i[s],a=i[(s+1)%i.length];n&&(o=tI(e,o),a=tI(e,a));let l=r?t4(t,e):t,h=tq([e,l],[o,a]);if(h)return{point:h,line:[o,a]}}return{point:e,line:void 0}}function t5(t,e,i=!1){let n=e.center,r=i?t4(t,n):t,s=tB(r,e.center),o=Math.atan2(s[1],s[0]);if(isNaN(o))return n;let a=ts(e)/2,l=to(e)/2,h=n[0]+a*Math.cos(o),d=n[1]+l*Math.sin(o);return[h,d]}function t7(t,e){let[i,n]=e[0],[r,s]=e[1],[o,a]=t,l=r-i,h=s-n;if(0===l&&0===h)return[i,n];let d=((o-i)*l+(a-n)*h)/(l*l+h*h);d>1?d=1:d<0&&(d=0);let c=i+d*l,u=n+d*h;return[c,u]}function et(t,e=!0){let i=function(t){let e=t.reduce((t,e)=>tI(t,e),[0,0]);return t_(e,t.length)}(t);return t.sort(([t,n],[r,s])=>{let o=Math.atan2(n-i[1],t-i[0]),a=Math.atan2(s-i[1],r-i[0]);return e?a-o:o-a})}function ee(t,e){return[t,[t[0],e[1]],e,[e[0],t[1]]]}var ei=i(27412);class en{constructor(t,e,i){if(this.phase=e,this.pointerByTouch=[],this.initialDistance=null,this.emitter=t,en.instance)return en.callbacks[this.phase].push(i),en.instance;this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.bindEvents(),en.instance=this,en.callbacks[this.phase].push(i)}bindEvents(){let{emitter:t}=this;t.on(b.POINTER_DOWN,this.onPointerDown),t.on(b.POINTER_MOVE,this.onPointerMove),t.on(b.POINTER_UP,this.onPointerUp)}updatePointerPosition(t,e,i){let n=this.pointerByTouch.findIndex(e=>e.pointerId===t);n>=0&&(this.pointerByTouch[n]={x:e,y:i,pointerId:t})}onPointerDown(t){let{x:e,y:i}=t.client||{};if(void 0!==e&&void 0!==i&&(this.pointerByTouch.push({x:e,y:i,pointerId:t.pointerId}),"touch"===t.pointerType&&2===this.pointerByTouch.length)){en.isPinching=!0;let e=this.pointerByTouch[0].x-this.pointerByTouch[1].x,i=this.pointerByTouch[0].y-this.pointerByTouch[1].y;this.initialDistance=Math.sqrt(e*e+i*i),en.callbacks.pinchstart.forEach(e=>e(t,{scale:0}))}}onPointerMove(t){if(2!==this.pointerByTouch.length||null===this.initialDistance)return;let{x:e,y:i}=t.client||{};if(void 0===e||void 0===i)return;this.updatePointerPosition(t.pointerId,e,i);let n=this.pointerByTouch[0].x-this.pointerByTouch[1].x,r=this.pointerByTouch[0].y-this.pointerByTouch[1].y,s=Math.sqrt(n*n+r*r)/this.initialDistance;en.callbacks.pinchmove.forEach(e=>e(t,{scale:(s-1)*5}))}onPointerUp(t){var e;en.callbacks.pinchend.forEach(e=>e(t,{scale:0})),en.isPinching=!1,this.initialDistance=null,this.pointerByTouch=[],null===(e=en.instance)||void 0===e||e.tryDestroy()}destroy(){this.emitter.off(b.POINTER_DOWN,this.onPointerDown),this.emitter.off(b.POINTER_MOVE,this.onPointerMove),this.emitter.off(b.POINTER_UP,this.onPointerUp),en.instance=null}off(t,e){let i=en.callbacks[t].indexOf(e);i>-1&&en.callbacks[t].splice(i,1),this.tryDestroy()}tryDestroy(){Object.values(en.callbacks).every(t=>0===t.length)&&this.destroy()}}en.isPinching=!1,en.instance=null,en.callbacks={pinchstart:[],pinchmove:[],pinchend:[]};let er=t=>t.map(t=>(0,ei.Z)(t)?t.toLocaleLowerCase():t);class es{constructor(t){this.map=new Map,this.boundHandlePinch=()=>{},this.recordKey=new Set,this.onKeyDown=t=>{(null==t?void 0:t.key)&&(this.recordKey.add(t.key),this.trigger(t))},this.onKeyUp=t=>{(null==t?void 0:t.key)&&this.recordKey.delete(t.key)},this.onWheel=t=>{this.triggerExtendKey(b.WHEEL,t)},this.onDrag=t=>{this.triggerExtendKey(b.DRAG,t)},this.handlePinch=(t,e)=>{this.triggerExtendKey(b.PINCH,Object.assign(Object.assign({},t),e))},this.onFocus=()=>{this.recordKey.clear()},this.emitter=t,this.bindEvents()}bind(t,e){0!==t.length&&(t.includes(b.PINCH)&&!this.pinchHandler&&(this.boundHandlePinch=this.handlePinch.bind(this),this.pinchHandler=new en(this.emitter,"pinchmove",this.boundHandlePinch)),this.map.set(t,e))}unbind(t,e){this.map.forEach((i,n)=>{(0,A.Z)(n,t)&&(!e||e===i)&&this.map.delete(n)})}unbindAll(){this.map.clear()}match(t){let e=er(Array.from(this.recordKey)).sort(),i=er(t).sort();return(0,A.Z)(e,i)}bindEvents(){var t;let{emitter:e}=this;e.on(b.KEY_DOWN,this.onKeyDown),e.on(b.KEY_UP,this.onKeyUp),e.on(b.WHEEL,this.onWheel),e.on(b.DRAG,this.onDrag),null===(t=globalThis.addEventListener)||void 0===t||t.call(globalThis,"focus",this.onFocus)}trigger(t){this.map.forEach((e,i)=>{this.match(i)&&e(t)})}triggerExtendKey(t,e){this.map.forEach((i,n)=>{n.includes(t)&&(0,A.Z)(Array.from(this.recordKey),n.filter(e=>e!==t))&&i(e)})}destroy(){var t,e;this.unbindAll(),this.emitter.off(b.KEY_DOWN,this.onKeyDown),this.emitter.off(b.KEY_UP,this.onKeyUp),this.emitter.off(b.WHEEL,this.onWheel),this.emitter.off(b.DRAG,this.onDrag),null===(t=this.pinchHandler)||void 0===t||t.off("pinchmove",this.boundHandlePinch),null===(e=globalThis.removeEventListener)||void 0===e||e.call(globalThis,"blur",this.onFocus)}}class eo extends tL{constructor(t,e){super(t,(0,tN.Z)({},eo.defaultOptions,e)),this.shortcut=new es(t.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(t){if(!this.validate(t)||!this.isKeydown()||this.startPoint)return;let{canvas:e,graph:i}=this.context,n=Object.assign({},this.options.style);this.options.style.lineWidth&&(n.lineWidth=+this.options.style.lineWidth/i.getZoom()),this.rectShape=new C.UL({id:"g6-brush-select",style:n}),e.appendChild(this.rectShape),this.startPoint=[t.canvas.x,t.canvas.y]}onPointerMove(t){var e;if(!this.startPoint)return;let{immediately:i,mode:n}=this.options;this.endPoint=ea(t),null===(e=this.rectShape)||void 0===e||e.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),i&&"default"===n&&this.updateElementsStates(ee(this.startPoint,this.endPoint))}onPointerUp(t){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=ea(t),this.updateElementsStates(ee(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){let{graph:t}=this.context,e=Object.values(t.getData()).reduce((t,e)=>Object.assign({},t,e.reduce((t,e)=>{var i;let n=null===(i=e.states||[])||void 0===i?void 0:i.filter(t=>t!==this.options.state);return t[tv(e)]=n,t},{})),{});t.setElementState(e,this.options.animation)}updateElementsStates(t){let{graph:e}=this.context,{enableElements:i,state:n,mode:r,onSelect:s}=this.options,o=this.selector(e,t,i),a={};switch(r){case"union":o.forEach(t=>{a[t]=[...e.getElementState(t),n]});break;case"diff":o.forEach(t=>{let i=e.getElementState(t);a[t]=i.includes(n)?i.filter(t=>t!==n):[...i,n]});break;case"intersect":o.forEach(t=>{let i=e.getElementState(t);a[t]=i.includes(n)?[n]:[]});break;default:o.forEach(t=>{a[t]=[n]})}(0,J.Z)(s)&&(a=s(a)),e.setElementState(a,this.options.animation)}selector(t,e,i){if(!i||0===i.length)return[];let n=[],r=t.getData();if(i.forEach(i=>{r[`${i}s`].forEach(i=>{let r=tv(i);"hidden"!==t.getElementVisibility(r)&&function(t,e,i,n){let r=t[0],s=t[1],o=!1;void 0===i&&(i=0),void 0===n&&(n=e.length);let a=n-i;for(let t=0,n=a-1;t<a;n=t++){let a=e[t+i][0],l=e[t+i][1],h=e[n+i][0],d=e[n+i][1],c=l>s!=d>s&&r<(h-a)*(s-l)/(d-l)+a;c&&(o=!o)}return o}(t.getElementPosition(r),e)&&n.push(r)})}),i.includes("edge")){let t=r.edges;null==t||t.forEach(t=>{let{source:e,target:i}=t;n.includes(e)&&n.includes(i)&&n.push(tv(t))})}return n}clearBrush(){var t;null===(t=this.rectShape)||void 0===t||t.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){let{trigger:t}=this.options,e=Array.isArray(t)?t:[t];return this.shortcut.match(e.filter(t=>"drag"!==t))}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,J.Z)(e)?e(t):!!e}bindEvents(){let{graph:t}=this.context;t.on(b.POINTER_DOWN,this.onPointerDown),t.on(b.POINTER_MOVE,this.onPointerMove),t.on(b.POINTER_UP,this.onPointerUp),t.on(m.CLICK,this.clearStates)}unbindEvents(){let{graph:t}=this.context;t.off(b.POINTER_DOWN,this.onPointerDown),t.off(b.POINTER_MOVE,this.onPointerMove),t.off(b.POINTER_UP,this.onPointerUp),t.off(m.CLICK,this.clearStates)}update(t){this.unbindEvents(),this.options=(0,tN.Z)(this.options,t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}eo.defaultOptions={animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}};let ea=t=>[t.canvas.x,t.canvas.y],el=["node","edge","combo"];function eh(t,e,i,n,r=0){"TB"===n&&e(t,r);let s=i(t);if(s)for(let t of s)eh(t,e,i,n,r+1);"BT"===n&&e(t,r)}function ed(t,e,i,n,r="both"){if("combo"===e||"node"===e)return ec(t,i,n,r);let s=t.getEdgeData(i);if(!s)return[];let o=ec(t,s.source,n-1,r),a=ec(t,s.target,n-1,r);return Array.from(new Set([...o,...a,i]))}function ec(t,e,i,n="both"){let r=new Set,s=new Set,o=new Set;return!function(t,e,i){let n=[[t,0]];for(;n.length;){let[t,r]=n.shift();e(t,r);let s=i(t);if(s)for(let t of s)n.push([t,r+1])}}(e,(e,r)=>{r>i||(o.add(e),t.getRelatedEdgesData(e,n).forEach(t=>{let e=tv(t);!s.has(e)&&r<i&&(o.add(e),s.add(e))}))},e=>t.getRelatedEdgesData(e,n).map(t=>t.source===e?t.target:t.source).filter(t=>!r.has(t)&&(r.add(t),!0))),Array.from(o)}function eu(t){return t.states||[]}var ep=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class eg extends tL{constructor(t,e){super(t,Object.assign({},eg.defaultOptions,e)),this.onClickSelect=t=>ep(this,void 0,void 0,function*(){var e,i;this.validate(t)&&(yield this.updateState(t),null===(i=(e=this.options).onClick)||void 0===i||i.call(e,t))}),this.onClickCanvas=t=>ep(this,void 0,void 0,function*(){var e,i;this.validate(t)&&(yield this.clearState(),null===(i=(e=this.options).onClick)||void 0===i||i.call(e,t))}),this.shortcut=new es(t.graph),this.bindEvents()}bindEvents(){let{graph:t}=this.context;this.unbindEvents(),el.forEach(e=>{t.on(`${e}:${b.CLICK}`,this.onClickSelect)}),t.on(m.CLICK,this.onClickCanvas)}get isMultipleSelect(){let{multiple:t,trigger:e}=this.options;return t&&this.shortcut.match(e)}getNeighborIds(t){let{target:e,targetType:i}=t,{graph:n}=this.context,{degree:r}=this.options;return ed(n,i,e.id,"function"==typeof r?r(t):r).filter(t=>t!==e.id)}updateState(t){return ep(this,void 0,void 0,function*(){let{state:e,unselectedState:i,neighborState:n,animation:r}=this.options;if(!e&&!n&&!i)return;let{target:s}=t,{graph:o}=this.context,a=o.getElementData(s.id),l=eu(a).includes(e)?"unselect":"select",h={},d=this.isMultipleSelect,c=[s.id],u=this.getNeighborIds(t);if(d){if(Object.assign(h,this.getDataStates()),"select"===l){let t=(t,e)=>{t.forEach(t=>{let n=new Set(o.getElementState(t));n.add(e),n.delete(i),h[t]=Array.from(n)})};t(c,e),t(u,n),i&&Object.keys(h).forEach(t=>{let r=h[t];r.includes(e)||r.includes(n)||r.includes(i)||h[t].push(i)})}else{let t=h[s.id];h[s.id]=t.filter(t=>t!==e&&t!==n),t.includes(i)||h[s.id].push(i),u.forEach(t=>{h[t]=h[t].filter(t=>t!==n),h[t].includes(e)||h[t].push(i)})}}else if("select"===l){Object.assign(h,this.getClearStates(!!i));let t=(t,e)=>{t.forEach(t=>{h[t]||(h[t]=o.getElementState(t)),h[t].push(e)})};t(c,e),t(u,n),i&&Object.keys(h).forEach(t=>{c.includes(t)||u.includes(t)||h[t].push(i)})}else Object.assign(h,this.getClearStates());yield o.setElementState(h,r)})}getDataStates(){let{graph:t}=this.context,{nodes:e,edges:i,combos:n}=t.getData(),r={};return[...e,...i,...n].forEach(t=>{r[tv(t)]=eu(t)}),r}getClearStates(t=!1){let{graph:e}=this.context,{state:i,unselectedState:n,neighborState:r}=this.options,s=new Set([i,n,r]),{nodes:o,edges:a,combos:l}=e.getData(),h={};return[...o,...a,...l].forEach(e=>{let i=eu(e),n=i.filter(t=>!s.has(t));t?h[tv(e)]=n:n.length!==i.length&&(h[tv(e)]=n)}),h}clearState(){return ep(this,void 0,void 0,function*(){let{graph:t}=this.context;yield t.setElementState(this.getClearStates(),this.options.animation)})}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,J.Z)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;el.forEach(e=>{t.off(`${e}:${b.CLICK}`,this.onClickSelect)}),t.off(m.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}}function ef(t){var e;return!!(null===(e=t.style)||void 0===e?void 0:e.collapsed)}eg.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0};var ey=i(22040),em=i(28767),ev=i(2159);function eb(t,e){if(!t.startsWith(e))return!1;let i=t[e.length];return i>="A"&&i<="Z"}function eE(t,e){let i=Object.entries(t).reduce((t,[i,n])=>("className"===i||"class"===i||eb(i,e)&&Object.assign(t,{[function(t,e,i=!0){if(!e||!eb(t,e))return t;let n=t.slice(e.length);return i?(0,ev.Z)(n):n}(i,e)]:n}),t),{});if("opacity"in t){let n=`${e}${(0,T.Z)("opacity")}`,r=t.opacity;if(n in t){let e=t[n];Object.assign(i,{opacity:r*e})}else Object.assign(i,{opacity:r})}return i}function ex(t,e){let i=e.length;return Object.keys(t).reduce((n,r)=>{if(r.startsWith(e)){let e=r.slice(i);n[e]=t[r]}return n},{})}function eO(t,e){let i="string"==typeof e?[e]:e,n={};return Object.keys(t).forEach(e=>{i.find(t=>e.startsWith(t))||(n[e]=t[e])}),n}function ew(t=0){if("number"==typeof t)return[t,t,t];let[e,i=e,n=e]=t;return[e,i,n]}var eS=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};function eD(t,e){let{datum:i,graph:n}=e;return"function"==typeof t?t.call(n,i):Object.fromEntries(Object.entries(t).map(([t,e])=>"function"==typeof e?[t,e.call(n,i)]:[t,e]))}function eM(t,e){let i=(null==t?void 0:t.style)||{},n=(null==e?void 0:e.style)||{};for(let t in i)t in n||(n[t]=i[t]);return Object.assign({},t,e,{style:n})}function eC(t){if(t)return"string"==typeof t||"function"==typeof t||Array.isArray(t)?{type:"group",field:t=>t.id,color:t,invert:!1}:t}function eT(t){let e="string"==typeof t?B("palette",t):t;if("function"!=typeof e)return e}function eP(t,e){let i=2*t;return"string"==typeof e?i=t*Number(e.replace("%",""))/100:"number"==typeof e&&(i=e),isNaN(i)&&(i=2*t),i}function eA(t,e,i=1,n=!1){let r=(t.max[0]-t.min[0])*(n?i:1);return eP(r,e)}var eR=i(70591);class eL extends C.b_{constructor(t){eN(t.style),super(t),this.shapeMap={},this.animateMap={},this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(t,e,i,n,r){var s,o,a,l,h,d,c,u;let p=this.shapeMap[t];if(!1===i){p&&(null===(s=null==r?void 0:r.beforeDestroy)||void 0===s||s.call(r,p),n.removeChild(p),delete this.shapeMap[t],null===(o=null==r?void 0:r.afterDestroy)||void 0===o||o.call(r,p));return}let g="string"==typeof e?B(D.SHAPE,e):e;if(!g)throw Error(F(`Shape ${e} not found`));if(!p||p.destroyed||!(p instanceof g)){p&&(null===(a=null==r?void 0:r.beforeDestroy)||void 0===a||a.call(r,p),null==p||p.destroy(),null===(l=null==r?void 0:r.afterDestroy)||void 0===l||l.call(r,p)),null===(h=null==r?void 0:r.beforeCreate)||void 0===h||h.call(r);let e=new g({className:t,style:i});return n.appendChild(e),this.shapeMap[t]=e,null===(d=null==r?void 0:r.afterCreate)||void 0===d||d.call(r,e),e}return null===(c=null==r?void 0:r.beforeUpdate)||void 0===c||c.call(r,p),no(p,i),null===(u=null==r?void 0:r.afterUpdate)||void 0===u||u.call(r,p),p}update(t={}){let e=Object.assign({},this.attributes,t);eN(e),function(t,e){let{zIndex:i,transform:n,transformOrigin:r,visibility:s,cursor:o,clipPath:a,component:l}=e,h=i1(e,["zIndex","transform","transformOrigin","visibility","cursor","clipPath","component"]);Object.assign(t.attributes,h),n&&t.setAttribute("transform",n),(0,W.Z)(i)&&t.setAttribute("zIndex",i),r&&t.setAttribute("transformOrigin",r),s&&t.setAttribute("visibility",s),o&&t.setAttribute("cursor",o),a&&t.setAttribute("clipPath",a),l&&t.setAttribute("component",l)}(this,e),this.render(e,this),this.setVisibility()}bindEvents(){}getGraphicStyle(t){return function(t){let{x:e,y:i,z:n,class:r,className:s,transform:o,transformOrigin:a,zIndex:l,visibility:h}=t,d=eS(t,["x","y","z","class","className","transform","transformOrigin","zIndex","visibility"]);return d}(t)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(t,e){if(0===t.length)return null;let i=[];if(void 0!==t[0].x||void 0!==t[0].y||void 0!==t[0].z){let{x:e=0,y:i=0,z:n=0}=this.attributes;t.forEach(t=>{let{x:r=e,y:s=i,z:o=n}=t;Object.assign(t,{transform:o?[["translate3d",r,s,o]]:[["translate",r,s]]})})}let n=super.animate(t,e);if(n&&(ek(this,n),i.push(n)),Array.isArray(t)&&t.length>0){let n=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(t[0]).some(t=>!n.includes(t))){Object.entries(this.shapeMap).forEach(([n,r])=>{let s=`get${(0,T.Z)(n)}Style`,o=this[s];if((0,J.Z)(o)){let n=t.map(t=>o.call(this,Object.assign(Object.assign({},this.attributes),t))),s=r.animate($(n),e);s&&(ek(r,s),i.push(s))}});let n=(n,r)=>{if(!(0,eR.Z)(n)){let s=`get${(0,T.Z)(r)}Style`,o=this[s];if((0,J.Z)(o)){let r=t.map(t=>o.call(this,Object.assign(Object.assign({},this.attributes),t)));Object.entries(r[0]).map(([t])=>{let s=r.map(e=>e[t]),o=n[t];if(o){let t=o.animate($(s),e);t&&(ek(o,t),i.push(t))}})}}};this.compositeShapes.forEach(([t,e])=>{let i=ex(this.shapeMap,e);n(i,t)})}}return Z(i)}getShape(t){return this.shapeMap[t]}setVisibility(){let{visibility:t}=this.attributes;tP(this,t)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}function ek(t,e){null==e||e.finished.then(()=>{let i=t.activeAnimations.findIndex(t=>t===e);i>-1&&t.activeAnimations.splice(i,1)})}function eN(t){if(!t)return{};if("x"in t||"y"in t||"z"in t){let{x:e=0,y:i=0,z:n,transform:r}=t,s=G(e,i,n,r);s&&(t.transform=s)}return t}var ej=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};class eI extends eL{constructor(t){super(eM({style:eI.defaultStyleProps},t))}isTextStyle(t){return eb(t,"label")}isBackgroundStyle(t){return eb(t,"background")}getTextStyle(t){let e=this.getGraphicStyle(t),{padding:i}=e,n=ej(e,["padding"]);return eO(n,"background")}getBackgroundStyle(t){if(!1===t.background)return!1;let e=this.getGraphicStyle(t),{wordWrap:i,wordWrapWidth:n,padding:r}=e,s=eE(e,"background"),{min:[o,a],center:[l,h],halfExtents:[d,c]}=this.shapeMap.text.getGeometryBounds(),[u,p,g,f]=tr(r),y=2*d+f+p,{width:m,height:v}=s;m&&v?Object.assign(s,{x:l-Number(m)/2,y:h-Number(v)/2}):Object.assign(s,{x:o-f,y:a-u,width:i?Math.min(y,n+f+p):y,height:2*c+u+g});let{radius:b}=s;if("string"==typeof b&&b.endsWith("%")){let t=Number(b.replace("%",""))/100;s.radius=Math.min(+s.width,+s.height)*t}return s}render(t=this.parsedAttributes,e=this){this.upsert("text",C.xv,this.getTextStyle(t),e),this.upsert("background",C.UL,this.getBackgroundStyle(t),e)}getGeometryBounds(){let t=this.getShape("background")||this.getShape("text");return t.getGeometryBounds()}}eI.defaultStyleProps={padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};class eB extends eL{constructor(t){super(eM({style:eB.defaultStyleProps},t))}getBadgeStyle(t){return this.getGraphicStyle(t)}render(t=this.parsedAttributes,e=this){this.upsert("label",eI,this.getBadgeStyle(t),e)}getGeometryBounds(){let t=this.getShape("label"),e=t.getShape("background")||t.getShape("text");return e.getGeometryBounds()}}eB.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1};let eF={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]},e_=t=>{if(t.length<2)return[["M",0,0],["L",0,0]];let e=t[0],i=t[1],n=t[t.length-1],r=t[t.length-2];t.unshift(r,n),t.push(e,i);let s=[["M",n[0],n[1]]];for(let e=1;e<t.length-2;e+=1){let[i,n]=t[e-1],[r,o]=t[e],[a,l]=t[e+1],[h,d]=e!==t.length-2?t[e+2]:[a,l],c=r+(a-i)/6,u=o+(l-n)/6,p=a-(h-r)/6,g=l-(d-o)/6;s.push(["C",c,u,p,g,a,l])}return s};var ez=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};class eZ extends eL{constructor(t){super(eM({style:eZ.defaultStyleProps},t))}getLabelStyle(t){if(!t.label||!t.d||0===t.d.length)return!1;let e=eE(this.getGraphicStyle(t),"label"),{maxWidth:i,offsetX:n,offsetY:r,autoRotate:s,placement:o,closeToPath:a}=e,l=ez(e,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),h=this.shapeMap.key,d=null==h?void 0:h.getRenderBounds();return Object.assign(function(t,e,i,n,r,s,o){var a;let l,h;let[d,c]=t1(t,e),u={textAlign:"left"===e?"right":"right"===e?"left":"center",textBaseline:"top"===e?"bottom":"bottom"===e?"top":"middle",transform:[["translate",d+i,c+n]]};if("center"===e||!r)return u;let p=function(t){let e=[],i="string"==typeof t?function(t){let e=t.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),i=[],n="",r={};for(;e.length>0;){let t=e.shift();t in eF?n=t:e.unshift(t),r={type:n},eF[n].forEach(i=>{t=e.shift(),r[i]=t}),"M"===n?n="L":"m"===n&&(n="l");let[s,...o]=Object.values(r);i.push([s,...o.map(Number)])}return i}(t):t;return i.forEach(t=>{let i=t[0];if("Z"===i){e.push(e[0]);return}if("A"!==i)for(let i=1;i<t.length;i+=2)e.push([t[i],t[i+1],0]);else{let i=t.length;e.push([t[i-2],t[i-1],0])}}),e}(s);if(!p||p.length<=3)return u;let g=p.map((t,e)=>{let i=p[(e+1)%p.length];return(0,A.Z)(t,i)?null:[t,i]}).filter(Boolean),f=(a=[d,c],l=1/0,h=[[0,0],[0,0]],g.forEach(t=>{let e=function(t,e){let i=t7(t,e);return tZ(t,i)}(a,t);e<l&&(l=e,h=t)}),h),y=t7([d,c],f);if(y&&f&&(u.transform=[["translate",y[0]+i,y[1]+n]],o)){let t=Math.atan((f[0][1]-f[1][1])/(f[0][0]-f[1][0]));u.transform.push(["rotate",t/Math.PI*180]),u.textAlign="center",("right"===e||"left"===e)&&(t>0?u.textBaseline="right"===e?"bottom":"top":u.textBaseline="right"===e?"top":"bottom")}return u}(d,o,n,r,a,t.d,s),{wordWrapWidth:eA(d,i)},l)}getKeyStyle(t){return this.getGraphicStyle(t)}render(t,e){this.upsert("key",C.y$,this.getKeyStyle(t),e),this.upsert("label",eI,this.getLabelStyle(t),e)}}eZ.defaultStyleProps={label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};class e$ extends C.Ee{constructor(t){super(t),this.onMounted=()=>{this.handleRadius()},this.onAttrModified=()=>{this.handleRadius()},eH=this,this.isMutationObserved=!0,this.addEventListener(C.Dk.MOUNTED,this.onMounted),this.addEventListener(C.Dk.ATTR_MODIFIED,this.onAttrModified)}handleRadius(){let{radius:t,clipPath:e,width:i=0,height:n=0}=this.attributes;if(t&&i&&n){let[r,s]=this.getBounds().min,o={x:r,y:s,radius:t,width:i,height:n};if(e)Object.assign(this.parsedStyle.clipPath.style,o);else{let t=new C.UL({style:o});this.style.clipPath=t}}else e&&(this.style.clipPath=null)}}let eV=new WeakMap,eH=null,eW=t=>{if(eH&&(function(t){let e=[],i=t.parentNode;for(;i;)e.push(i),i=i.parentNode;return e})(eH).includes(t)){let e=eV.get(t);e?e.includes(eH)||e.push(eH):eV.set(t,[eH])}},eG=t=>{let e=eV.get(t);e&&e.forEach(t=>t.handleRadius())};class eY extends eL{constructor(t){super(t)}isImage(){let{src:t}=this.attributes;return!!t}getIconStyle(t=this.attributes){let{width:e=0,height:i=0}=t,n=this.getGraphicStyle(t);return this.isImage()?Object.assign({x:-e/2,y:-i/2},n):Object.assign({textBaseline:"middle",textAlign:"center"},n)}render(t=this.attributes,e=this){this.upsert("icon",this.isImage()?e$:C.xv,this.getIconStyle(t),e)}}class eU extends eL{get context(){return this.config.context}get parsedAttributes(){return this.attributes}onframe(){}animate(t,e){let i=super.animate(t,e);return i&&(i.onframe=()=>this.onframe(),i.finished.then(()=>this.onframe())),i}}var eK=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};class eX extends eU{constructor(t){super(eM({style:eX.defaultStyleProps},t)),this.type="node"}getSize(t=this.attributes){let{size:e}=t;return ew(e)}getKeyStyle(t){let e=this.getGraphicStyle(t);return Object.assign(eO(e,["label","halo","icon","badge","port"]))}getLabelStyle(t){if(!1===t.label||!t.labelText)return!1;let e=eE(this.getGraphicStyle(t),"label"),{placement:i,maxWidth:n,offsetX:r,offsetY:s}=e,o=eK(e,["placement","maxWidth","offsetX","offsetY"]),a=this.getShape("key").getLocalBounds();return Object.assign(nr(a,i,r,s),{wordWrapWidth:eA(a,n)},o)}getHaloStyle(t){if(!1===t.halo)return!1;let e=this.getKeyStyle(t),{fill:i}=e,n=eK(e,["fill"]),r=eE(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign(Object.assign({},n),{stroke:i}),r)}getIconStyle(t){if(!1===t.icon||!t.iconText&&!t.iconSrc)return!1;let e=eE(this.getGraphicStyle(t),"icon");return Object.assign(function(t,e){let i=ew(t),n={};return e.text&&!e.fontSize&&(n={fontSize:.5*Math.min(...i)}),!e.src||e.width&&e.height||(n={width:.5*i[0],height:.5*i[1]}),n}(t.size,e),e)}getBadgesStyle(t){var e;let i=ex(this.shapeMap,"badge-"),n={};if(Object.keys(i).forEach(t=>{n[t]=!1}),!1===t.badge||!(null===(e=t.badges)||void 0===e?void 0:e.length))return n;let{badges:r=[],badgePalette:s,opacity:o=1}=t,a=eK(t,["badges","badgePalette","opacity"]),l=eT(s),h=eE(this.getGraphicStyle(a),"badge");return r.forEach((t,e)=>{n[e]=Object.assign(Object.assign({backgroundFill:l?l[e%(null==l?void 0:l.length)]:void 0,opacity:o},h),this.getBadgeStyle(t))}),n}getBadgeStyle(t){let e=this.getShape("key"),{placement:i="top",offsetX:n,offsetY:r}=t,s=eK(t,["placement","offsetX","offsetY"]),o=nr(e.getLocalBounds(),i,n,r,!0);return Object.assign(Object.assign({},o),s)}getPortsStyle(t){var e;let i=this.getPorts(),n={};if(Object.keys(i).forEach(t=>{n[t]=!1}),!1===t.port||!(null===(e=t.ports)||void 0===e?void 0:e.length))return n;let r=eE(this.getGraphicStyle(t),"port"),{ports:s=[]}=t;return s.forEach((e,i)=>{let s=e.key||i,o=Object.assign(Object.assign({},r),e);if(i5(o))n[s]=!1;else{let[i,r]=this.getPortXY(t,e);n[s]=Object.assign({transform:[["translate",i,r]]},o)}}),n}getPortXY(t,e){let{placement:i="left"}=e,n=this.getShape("key");return i4(function(t,e){if(!t)return e.getLocalBounds();let i=t.canvas.getLayer(),n=e.cloneNode();tP(n,"hidden"),i.appendChild(n);let r=n.getLocalBounds();return n.destroy(),r}(this.context,n),i)}getPorts(){return ex(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(t,e=!1){let i=this.getShape("key").getBounds();return function(t,e,i=!1){let n=t1(e,"center"),r=[t1(e,"left-top"),t1(e,"right-top"),t1(e,"right-bottom"),t1(e,"left-bottom")];return t9(t,n,r,!1,i).point}(t,i,e)}drawHaloShape(t,e){let i=this.getHaloStyle(t),n=this.getShape("key");this.upsert("halo",n.constructor,i,e)}drawIconShape(t,e){let i=this.getIconStyle(t);this.upsert("icon",eY,i,e),eW(this)}drawBadgeShapes(t,e){let i=this.getBadgesStyle(t);Object.keys(i).forEach(t=>{let n=i[t];this.upsert(`badge-${t}`,eB,n,e)})}drawPortShapes(t,e){let i=this.getPortsStyle(t);Object.keys(i).forEach(t=>{let n=i[t],r=`port-${t}`;this.upsert(r,C.Cd,n,e)})}drawLabelShape(t,e){let i=this.getLabelStyle(t);this.upsert("label",eI,i,e)}_drawKeyShape(t,e){return this.drawKeyShape(t,e)}render(t=this.parsedAttributes,e=this){this._drawKeyShape(t,e),this.getShape("key")&&(this.drawHaloShape(t,e),this.drawIconShape(t,e),this.drawBadgeShapes(t,e),this.drawLabelShape(t,e),this.drawPortShapes(t,e))}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&eG(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}}eX.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0};class eq extends eX{constructor(t){super(eM({style:eq.defaultStyleProps},t))}drawKeyShape(t,e){return this.upsert("key",C.Cd,this.getKeyStyle(t),e)}getKeyStyle(t){let e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{r:Math.min(...this.getSize(t))/2})}getIconStyle(t){let e=super.getIconStyle(t),{r:i}=this.getShape("key").attributes,n=2*i*.8;return!!e&&Object.assign({width:n,height:n},e)}getIntersectPoint(t,e=!1){let i=this.getShape("key").getBounds();return t5(t,i,e)}}eq.defaultStyleProps={size:32};class eJ extends eX{constructor(t){super(t)}get parsedAttributes(){return this.attributes}drawKeyShape(t,e){return this.upsert("key",C.mg,this.getKeyStyle(t),e)}getKeyStyle(t){let e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{points:this.getPoints(t)})}getIntersectPoint(t,e=!1){var i,n;let{points:r}=this.getShape("key").attributes,s=[+((null===(i=this.attributes)||void 0===i?void 0:i.x)||0),+((null===(n=this.attributes)||void 0===n?void 0:n.y)||0)];return t9(t,s,r,!0,e).point}}var eQ=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};class e0 extends eq{constructor(t){super(eM({style:e0.defaultStyleProps},t))}parseOuterR(){let{size:t}=this.parsedAttributes;return Math.min(...ew(t))/2}parseInnerR(){let{innerR:t}=this.parsedAttributes;return(0,ei.Z)(t)?parseInt(t)/100*this.parseOuterR():t}drawDonutShape(t,e){let{donuts:i}=t;if(!(null==i?void 0:i.length))return;let n=i.map(t=>(0,W.Z)(t)?{value:t}:t),r=eE(this.getGraphicStyle(t),"donut"),s=eT(t.donutPalette);if(!s)return;let o=n.reduce((t,e)=>{var i;return t+(null!==(i=e.value)&&void 0!==i?i:0)},0),a=this.parseOuterR(),l=this.parseInnerR(),h=0;n.forEach((t,i)=>{let{value:d=0,color:c=s[i%s.length]}=t,u=eQ(t,["value","color"]),p=(0===o?1/n.length:d/o)*360;this.upsert(`round${i}`,C.y$,Object.assign(Object.assign(Object.assign({},r),{d:e6(a,l,h,h+p),fill:c}),u),e),h+=p})}render(t,e=this){super.render(t,e),this.drawDonutShape(t,e)}}e0.defaultStyleProps={innerR:"50%",donuts:[],donutPalette:"tableau"};let e1=(t,e,i,n)=>[t+Math.sin(n)*i,e-Math.cos(n)*i],e2=(t,e,i,n)=>n<=0||i<=n?[["M",t-i,e],["A",i,i,0,1,1,t+i,e],["A",i,i,0,1,1,t-i,e],["Z"]]:[["M",t-i,e],["A",i,i,0,1,1,t+i,e],["A",i,i,0,1,1,t-i,e],["Z"],["M",t+n,e],["A",n,n,0,1,0,t-n,e],["A",n,n,0,1,0,t+n,e],["Z"]],e3=(t,e,i,n,r,s)=>{let[o,a]=[r/360*2*Math.PI,s/360*2*Math.PI],l=[e1(t,e,n,o),e1(t,e,i,o),e1(t,e,i,a),e1(t,e,n,a)],h=a-o>Math.PI?1:0;return[["M",l[0][0],l[0][1]],["L",l[1][0],l[1][1]],["A",i,i,0,h,1,l[2][0],l[2][1]],["L",l[3][0],l[3][1]],["A",n,n,0,h,0,l[0][0],l[0][1]],["Z"]]},e6=(t=0,e=0,i,n)=>{let[r,s]=[0,0];return Math.abs(i-n)%360<1e-6?e2(r,s,t,e):e3(r,s,t,e,i,n)};class e8 extends eX{constructor(t){super(eM({style:e8.defaultStyleProps},t))}drawKeyShape(t,e){return this.upsert("key",C.Pj,this.getKeyStyle(t),e)}getKeyStyle(t){let e=super.getKeyStyle(t),[i,n]=this.getSize(t);return Object.assign(Object.assign({},e),{rx:i/2,ry:n/2})}getIconStyle(t){let e=super.getIconStyle(t),{rx:i,ry:n}=this.getShape("key").attributes,r=2*Math.min(+i,+n)*.8;return!!e&&Object.assign({width:r,height:r},e)}getIntersectPoint(t,e=!1){let i=this.getShape("key").getBounds();return t5(t,i,e)}}e8.defaultStyleProps={size:[45,35]};var e4=i(57796),e9=i(88458),e5=i(36179),e7=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};class it extends eX{constructor(t){super(Object.assign(Object.assign({},t),{style:Object.assign({},it.defaultStyleProps,t.style)})),this.rootPointerEvent=new C.nR(null),this.forwardEvents=t=>{let e=this.context.canvas,i=e.context.renderingContext.root.ownerDocument.defaultView,n=this.normalizeToPointerEvent(t,i);n.forEach(n=>{let r=this.bootstrapEvent(this.rootPointerEvent,n,i,t);(0,em.Z)(e.context.eventService,"mappingTable.pointerupoutside",[]),e.context.eventService.mapEvent(r)})}}get eventService(){return this.context.canvas.context.eventService}get events(){return[b.CLICK,b.POINTER_DOWN,b.POINTER_MOVE,b.POINTER_UP,b.POINTER_OVER,b.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}render(t=this.parsedAttributes,e=this){this.drawKeyShape(t,e),this.drawPortShapes(t,e)}getKeyStyle(t){let e=(0,e9.Z)(t,["dx","dy","innerHTML","pointerEvents","cursor"]),{dx:i=0,dy:n=0}=e,r=e7(e,["dx","dy"]),[s,o]=this.getSize(t);return Object.assign(Object.assign({x:i,y:n},r),{width:s,height:o})}drawKeyShape(t,e){let i=this.getKeyStyle(t),{x:n,y:r,width:s=0,height:o=0}=i,a=this.upsert("key-container",C.UL,{x:n,y:r,width:s,height:o,opacity:0},e);return this.upsert("key",C.k9,i,a)}connectedCallback(){let t=this.context.canvas.getRenderer("main"),e=t instanceof e4.Th;if(!e)return;let i=this.getDomElement();this.events.forEach(t=>{i.addEventListener(t,this.forwardEvents)})}attributeChangedCallback(t,e,i){"zIndex"===t&&e!==i&&(this.getDomElement().style.zIndex=i)}destroy(){let t=this.getDomElement();this.events.forEach(e=>{t.removeEventListener(e,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(t,e){let i=[];if(e.isTouchEvent(t))for(let e=0;e<t.changedTouches.length;e++){let n=t.changedTouches[e];(0,e5.Z)(n.button)&&(n.button=0),(0,e5.Z)(n.buttons)&&(n.buttons=1),(0,e5.Z)(n.isPrimary)&&(n.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,e5.Z)(n.width)&&(n.width=n.radiusX||1),(0,e5.Z)(n.height)&&(n.height=n.radiusY||1),(0,e5.Z)(n.tiltX)&&(n.tiltX=0),(0,e5.Z)(n.tiltY)&&(n.tiltY=0),(0,e5.Z)(n.pointerType)&&(n.pointerType="touch"),(0,e5.Z)(n.pointerId)&&(n.pointerId=n.identifier||0),(0,e5.Z)(n.pressure)&&(n.pressure=n.force||.5),(0,e5.Z)(n.twist)&&(n.twist=0),(0,e5.Z)(n.tangentialPressure)&&(n.tangentialPressure=0),n.isNormalized=!0,n.type=t.type,i.push(n)}else e.isMouseEvent(t)&&((0,e5.Z)(t.isPrimary)&&(t.isPrimary=!0),(0,e5.Z)(t.width)&&(t.width=1),(0,e5.Z)(t.height)&&(t.height=1),(0,e5.Z)(t.tiltX)&&(t.tiltX=0),(0,e5.Z)(t.tiltY)&&(t.tiltY=0),(0,e5.Z)(t.pointerType)&&(t.pointerType="mouse"),(0,e5.Z)(t.pointerId)&&(t.pointerId=1),(0,e5.Z)(t.pressure)&&(t.pressure=.5),(0,e5.Z)(t.twist)&&(t.twist=0),(0,e5.Z)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),i.push(t);return i}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}bootstrapEvent(t,e,i,n){t.view=i,t.originalEvent=null,t.nativeEvent=n,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);let{x:r,y:s}=this.getViewportXY(e);t.viewport.x=r,t.viewport.y=s;let[o,a]=this.context.canvas.getCanvasByViewport([r,s]);return t.canvas.x=o,t.canvas.y=a,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=n.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t}getViewportXY(t){let e,i;let{offsetX:n,offsetY:r,clientX:s,clientY:o}=t;if((0,P.Z)(n)||(0,P.Z)(r)){let t=this.eventService.client2Viewport({x:s,y:o});e=t.x,i=t.y}else e=n,i=r;return{x:e,y:i}}onframe(){super.onframe();let{opacity:t}=this.attributes;this.getDomElement().style.opacity=`${t}`}}it.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"};var ie=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};class ii extends eX{constructor(t){super(eM({style:ii.defaultStyleProps},t))}getKeyStyle(t){let[e,i]=this.getSize(t),n=super.getKeyStyle(t),{fillOpacity:r,opacity:s=r}=n,o=ie(n,["fillOpacity","opacity"]);return Object.assign(Object.assign({opacity:s},o),{width:e,height:i,x:-e/2,y:-i/2})}getBounds(){return this.getShape("key").getBounds()}getHaloStyle(t){if(!1===t.halo)return!1;let e=this.getShape("key").attributes,{fill:i,stroke:n}=e;ie(e,["fill","stroke"]);let r=eE(this.getGraphicStyle(t),"halo"),s=Number(r.lineWidth),[o,a]=tI(this.getSize(t),[s,s]),{lineWidth:l}=r;return Object.assign(Object.assign({},r),{fill:"transparent",lineWidth:l/2,width:o-l/2,height:a-l/2,x:-(o-l/2)/2,y:-(a-l/2)/2})}getIconStyle(t){let e=super.getIconStyle(t),[i,n]=this.getSize(t);return!!e&&Object.assign({width:.8*i,height:.8*n},e)}drawKeyShape(t,e){let i=this.upsert("key",e$,this.getKeyStyle(t),e);return eW(this),i}drawHaloShape(t,e){this.upsert("halo",C.UL,this.getHaloStyle(t),e)}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&eG(this)}}ii.defaultStyleProps={size:32};class ir extends eJ{constructor(t){super(eM({style:ir.defaultStyleProps},t))}getPoints(t){let{direction:e}=t,[i,n]=this.getSize(t);return function(t,e,i){let n=e/2,r=t/2,s={up:[[-r,n],[r,n],[0,-n]],left:[[-r,0],[r,n],[r,-n]],right:[[-r,n],[-r,-n],[r,0]],down:[[-r,-n],[r,-n],[0,n]]};return s[i]||s.up}(i,n,e)}getPortXY(t,e){let{direction:i}=t,{placement:n="top"}=e,r=this.getShape("key").getLocalBounds(),[s,o]=this.getSize(t),a=function(t,e,i){let n=e/2,r=t/2,s={};return"down"===i?(s.bottom=s.default=[0,n],s.right=[r,-n],s.left=[-r,-n]):"left"===i?(s.top=[r,-n],s.bottom=[r,n],s.left=s.default=[-r,0]):"right"===i?(s.top=[-r,-n],s.bottom=[-r,n],s.right=s.default=[r,0]):(s.left=[-r,n],s.top=s.default=[0,-n],s.right=[r,n]),s}(s,o,i);return i4(r,n,a,!1)}getIconStyle(t){let{icon:e,iconText:i,iconSrc:n,direction:r}=t;if(!1===e||(0,eR.Z)(i||n))return!1;let s=eE(this.getGraphicStyle(t),"icon"),o=this.getShape("key").getLocalBounds(),[a,l]=function(t,e){let{center:i}=t,[n,r]=ta(t),s="up"===e||"down"===e?i[0]:"right"===e?i[0]-n/6:i[0]+n/6,o="left"===e||"right"===e?i[1]:"down"===e?i[1]-r/6:i[1]+r/6;return[s,o]}(o,r),h=2*function(t,e){let[i,n]=ta(t);return[i,n]="up"===e||"down"===e?[i,n]:[n,i],(Math.pow(n,2)-Math.pow(Math.sqrt(Math.pow(i/2,2)+Math.pow(n,2))-i/2,2))/(2*n)}(o,r)*.8;return Object.assign({x:a,y:l,width:h,height:h},s)}}ir.defaultStyleProps={size:40,direction:"up"};var is=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};class io extends eX{constructor(t){super(eM({style:io.defaultStyleProps},t)),this.type="combo",this.updateComboPosition(this.parsedAttributes)}getKeySize(t){let{collapsed:e,childrenNode:i=[]}=t;return 0===i.length?this.getEmptyKeySize(t):e?this.getCollapsedKeySize(t):this.getExpandedKeySize(t)}getEmptyKeySize(t){let{padding:e,collapsedSize:i}=t,[n,r,s,o]=tr(e);return tI(ew(i),[o+r,n+s,0])}getCollapsedKeySize(t){return ew(t.collapsedSize)}getExpandedKeySize(t){let e=this.getContentBBox(t);return[ts(e),to(e),0]}getContentBBox(t){let{childrenNode:e=[],padding:i}=t,n=e.map(t=>this.context.element.getElement(t)).filter(Boolean);if(0===n.length){let e=new C.mN,{x:i=0,y:n=0,size:r}=t,[s,o]=ew(r);return e.setMinMax([i-s/2,n-o/2,0],[i+s/2,n+o/2,0]),e}let r=tc(n.map(t=>t.getBounds()));return i?td(r,i):r}drawCollapsedMarkerShape(t,e){let i=this.getCollapsedMarkerStyle(t);this.upsert("collapsed-marker",eY,i,e),eW(this)}getCollapsedMarkerStyle(t){if(!t.collapsed||!t.collapsedMarker)return!1;let e=eE(this.getGraphicStyle(t),"collapsedMarker"),{type:i}=e,n=is(e,["type"]),r=this.getShape("key"),[s,o]=t1(r.getLocalBounds(),"center"),a=Object.assign(Object.assign({},n),{x:s,y:o});if(i){let e=this.getCollapsedMarkerText(i,t);Object.assign(a,{text:e})}return a}getCollapsedMarkerText(t,e){let{childrenData:i=[]}=e,{model:n}=this.context;return"descendant-count"===t?n.getDescendantsData(this.id).length.toString():"child-count"===t?i.length.toString():"node-count"===t?n.getDescendantsData(this.id).filter(t=>"node"===n.getElementType(tv(t))).length.toString():(0,J.Z)(t)?t(i):""}getComboPosition(t){let{x:e=0,y:i=0,collapsed:n,childrenData:r=[]}=t;if(0===r.length)return[+e,+i,0];if(n){let{model:t}=this.context,n=t.getDescendantsData(this.id).filter(e=>!t.isCombo(tv(e)));if(n.length>0&&n.some(t0)){let t=n.reduce((t,e)=>tI(t,tQ(e)),[0,0,0]);return t_(t,n.length)}return[+e,+i,0]}return this.getContentBBox(t).center}getComboStyle(t){let[e,i]=this.getComboPosition(t);return{x:e,y:i,transform:[["translate",e,i]]}}updateComboPosition(t){let e=this.getComboStyle(t);Object.assign(this.style,e);let{x:i,y:n}=e;this.context.model.syncNodeLikeDatum({id:this.id,style:{x:i,y:n}}),eG(this)}render(t,e=this){super.render(t,e),this.drawCollapsedMarkerShape(t,e)}update(t={}){super.update(t),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(t,e){let i=super.animate(this.attributes.collapsed?t:t.map(t=>{var{x:e,y:i,z:n,transform:r}=t;return is(t,["x","y","z","transform"])}),e);return i?new Proxy(i,{set:(t,e,i)=>("currentTime"===e&&Promise.resolve().then(()=>this.onframe()),Reflect.set(t,e,i))}):i}}io.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"};var ia=i(82425);let il={padding:10};function ih(t,e,i,n,r,s){let{padding:o}=Object.assign(il,s),a=tl(i,o),l=tl(n,o),h=[t,...r,e],d=null,c=[];for(let t=0,e=h.length;t<e-1;t++){var u,p;let i=t+1,n=h[t],r=h[i],s=(u=n,p=r,u[1]===p[1]||u[0]===p[0]),g=null;if(0===t){if(i===e-1){if(a.intersects(l))g=iv(n,r,a,l);else if(tg(n,a)||tg(r,l))s||(g=function(t,e,i,n){let r=iy(t,e,i),s=tU(r.points[0]);if(tu(s,n)){r=iy(e,t,n);let o=tU(r.points[0]);if(tu(o,i)){let a=t8(t,s,ip(i,iu(t,s))/2),l=t8(e,o,ip(n,iu(e,o))/2),h=[(a[0]+l[0])/2,(a[1]+l[1])/2],d=iy(t,h,i),c=im(h,e,n,d.direction);r.points=[d.points[0],c.points[0]],r.direction=c.direction}}return r}(n,r,a,l));else{let t=ty(n,a),e=ty(r,l);(g=ig(t,e,iu(t,e))).points.unshift(t),g.points.push(e)}}else tu(r,a)?g=iv(n,r,a,tl(r,o),d):s||(g=iy(n,r,a))}else i===e-1?tu(n,l)?g=iv(n,r,tl(n,o),l,d):s||(g=im(n,r,l,d)):s||(g=ig(n,r,d));g?(c.push(...g.points),d=g.direction):d=iu(n,r),i<e-1&&c.push(r)}return c.map(tY)}let id={N:"S",S:"N",W:"E",E:"W"},ic={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function iu(t,e){let[i,n]=t,[r,s]=e;return i===r?n>s?"N":"S":n===s?i>r?"W":"E":null}function ip(t,e){return"N"===e||"S"===e?to(t):ts(t)}function ig(t,e,i){let n=[t[0],e[1]],r=[e[0],t[1]],s=iu(t,n),o=iu(t,r),a=i?id[i]:null,l=s===i||s!==a&&o!==i?n:r;return{points:[l],direction:iu(l,e)}}function iy(t,e,i){if(tg(t,i)){let n=ib(t,e,i);return{points:[n],direction:iu(n,e)}}{let n=ty(t,i),r=["left","right"].includes(tf(t,i)),s=r?[e[0],n[1]]:[n[0],e[1]];return{points:[s],direction:iu(s,e)}}}function im(t,e,i,n){let r=tg(e,i)?e:ty(e,i),s=[[r[0],t[1]],[t[0],r[1]]],o=s.filter(t=>!tu(t,i)&&!tp(t,i,!0)),a=o.filter(e=>iu(e,t)!==n);if(a.length>0){let i=a.find(e=>iu(t,e)===n)||a[0];return{points:[i],direction:iu(i,e)}}{let r=(0,ia.Z)(s,o)[0],a=t8(e,r,ip(i,n)/2),l=ib(a,t,i);return{points:[l,a],direction:iu(a,e)}}}function iv(t,e,i,n,r){let s;let o=tc([i,n]),a=tZ(e,o.center)>tZ(t,o.center),[l,h]=a?[e,t]:[t,e],d=to(o)+ts(o);if(r){let t=[l[0]+d*Math.cos(ic[r]),l[1]+d*Math.sin(ic[r])];s=t8(ty(t,o),t,.01)}else s=t8(ty(l,o),l,-.01);let c=ib(s,h,o),u=[t6(s,2),t6(c,2)];if((0,A.Z)(t6(s),t6(c))){let t=tH(tB(s,l),[1,0,0])+Math.PI/2;c=t6(t8(ty(c=[h[0]+d*Math.cos(t),h[1]+d*Math.sin(t),0],o),h,-.01),2);let e=ib(s,c,o);u=[s,e,c]}return{points:a?u.reverse():u,direction:a?iu(s,e):iu(c,e)}}function ib(t,e,i){let n=[t[0],e[1]];return tu(n,i)&&(n=[e[0],t[1]]),n}function iE(t,e,i,n,r){let s="number"==typeof e?e:.5;"start"===e&&(s=0),"end"===e&&(s=.99);let o=t2(t.getPoint(s)),a=t2(t.getPoint(s+.01)),l="start"===e?"left":"end"===e?"right":"center";if(o[1]===a[1]||!i){let[e,i]=ix(t,s,n,r);return{transform:[["translate",e,i]],textAlign:l}}let h=Math.atan2(a[1]-o[1],a[0]-o[0]),d=a[0]<o[0];d&&(l="center"===l?l:"left"===l?"right":"left",n*=-1,h+=Math.PI);let[c,u]=ix(t,s,n,r,h),p=[["translate",c,u],["rotate",h/Math.PI*180]];return{textAlign:l,transform:p}}function ix(t,e,i,n,r){let[s,o]=t2(t.getPoint(e)),a=i,l=n;return r&&(a=i*Math.cos(r)-n*Math.sin(r),l=i*Math.sin(r)+n*Math.cos(r)),[s+a,o+l]}function iO(t,e,i,n){if((0,A.Z)(t,e))return t;let r=tB(e,t),s=[t[0]+i*r[0],t[1]+i*r[1]],o=tV(tW(r,!1));return s[0]+=n*o[0],s[1]+=n*o[1],s}function iw(t,e,i){return[["M",t[0],t[1]],["C",i[0][0],i[0][1],i[1][0],i[1][1],e[0],e[1]]]}function iS(t,e=0,i=!1){let n=t.length-1,r=t[0],s=t[n],o=t.slice(1,n),a=[["M",r[0],r[1]]];return o.forEach((t,i)=>{let n=o[i-1]||r,l=o[i+1]||s;if(!tX([n,t],[t,l])&&e){let[i,r]=function(t,e,i,n){let r=t$(t,e),s=t$(i,e),o=Math.min(n,Math.min(r,s)/2),a=[e[0]-o/r*(e[0]-t[0]),e[1]-o/r*(e[1]-t[1])],l=[e[0]-o/s*(e[0]-i[0]),e[1]-o/s*(e[1]-i[1])];return[a,l]}(n,t,l,e);a.push(["L",i[0],i[1]],["Q",t[0],t[1],r[0],r[1]],["L",r[0],r[1]])}else a.push(["L",t[0],t[1]])}),a.push(["L",s[0],s[1]]),i&&a.push(["Z"]),a}let iD=t=>{let e=Math.PI/2,i=to(t)/2,n=ts(t)/2,r=Math.atan2(i,n)/2,s=Math.atan2(n,i)/2;return{top:[-e-s,-e+s],"top-right":[-e+s,-r],"right-top":[-e+s,-r],right:[-r,r],"bottom-right":[r,e-s],"right-bottom":[r,e-s],bottom:[e-s,e+s],"bottom-left":[e+s,Math.PI-r],"left-bottom":[e+s,Math.PI-r],left:[Math.PI-r,Math.PI+r],"top-left":[Math.PI+r,-e-s],"left-top":[Math.PI+r,-e-s]}};function iM(t,e,i,n,r){let s=tl(t),o=t.getCenter(),a=n&&i7(n),l=r&&i7(r);if(!a||!l){let n=iD(s),r=n[e][0],h=n[e][1],[d,c]=ta(s),u=Math.max(d,c),p=tI(o,[u*Math.cos(r),u*Math.sin(r),0]),g=tI(o,[u*Math.cos(h),u*Math.sin(h),0]);a=nn(t,p),l=nn(t,g),i||([a,l]=[l,a])}return[a,l]}function iC(t,e){let i=new Set,n=new Set,r=new Set;return t.forEach(s=>{let o=e(s);o.forEach(e=>{i.add(e),t.includes(e.source)&&t.includes(e.target)?n.add(e):r.add(e)})}),{edges:Array.from(i),internal:Array.from(n),external:Array.from(r)}}function iT(t,e){let i=[],n=t;for(;n;){i.push(n);let t=e(tv(n));if(t)n=t;else break}if(i.some(t=>{var e;return null===(e=t.style)||void 0===e?void 0:e.collapsed})){let t=i.reverse().findIndex(ef);return i[t]||i.at(-1)}return t}let iP=(t,e)=>{let i=Math.max(t,e)/2;return[["M",-t/2,0],["A",i,i,0,1,0,2*i-t/2,0],["A",i,i,0,1,0,-t/2,0],["Z"]]},iA=(t,e)=>[["M",-t/2,0],["L",t/2,-e/2],["L",t/2,e/2],["Z"]],iR=(t,e)=>[["M",-t/2,0],["L",0,-e/2],["L",t/2,0],["L",0,e/2],["Z"]],iL=(t,e)=>[["M",-t/2,0],["L",t/2,-e/2],["L",4*t/5-t/2,0],["L",t/2,e/2],["Z"]],ik=(t,e)=>[["M",-t/2,-e/2],["L",t/2,-e/2],["L",t/2,e/2],["L",-t/2,e/2],["Z"]],iN=(t,e)=>{let i=t/2,n=t/7,r=t-n;return[["M",-i,0],["L",0,-e/2],["L",0,e/2],["Z"],["M",r-i,-e/2],["L",r+n-i,-e/2],["L",r+n-i,e/2],["L",r-i,e/2],["Z"]]},ij=(t,e)=>[["M",t/2,-e/2],["L",-t/2,0],["L",t/2,0],["L",-t/2,0],["L",t/2,e/2]];var iI=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};class iB extends eU{constructor(t){super(eM({style:iB.defaultStyleProps},t)),this.type="edge"}get sourceNode(){let{sourceNode:t}=this.parsedAttributes;return this.context.element.getElement(t)}get targetNode(){let{targetNode:t}=this.parsedAttributes;return this.context.element.getElement(t)}getKeyStyle(t){let e=this.getGraphicStyle(t),{loop:i}=e,n=iI(e,["loop"]),{sourceNode:r,targetNode:s}=this,o=i&&r&&s&&r===s?this.getLoopPath(t):this.getKeyPath(t),a={d:o};return C.y$.PARSED_STYLE_LIST.forEach(t=>{t in n&&(a[t]=n[t])}),a}getLoopPath(t){let{sourcePort:e,targetPort:i}=t,n=this.sourceNode,r=tl(n),s=Math.max(ts(r),to(r)),{placement:o,clockwise:a,dist:l=s}=eE(this.getGraphicStyle(t),"loop");return function(t,e,i,n,r,s){let o=t.getPorts()[r||s],a=t.getPorts()[s||r],[l,h]=iM(t,e,i,o,a),d=function(t,e,i,n){let r=t.getCenter();if((0,A.Z)(e,i)){let t=tB(e,r),s=[n*Math.sign(t[0])||n/2,n*Math.sign(t[1])||-n/2,0];return[tI(e,s),tI(i,tF(s,[1,-1,1]))]}return[t8(r,e,tZ(r,e)+n),t8(r,i,tZ(r,i)+n)]}(t,l,h,n);return o&&(l=ni(o,d[0])),a&&(h=ni(a,d.at(-1))),iw(l,h,d)}(n,o,a,l,e,i)}getEndpoints(t,e=!0,i=[]){let{sourcePort:n,targetPort:r}=t,{sourceNode:s,targetNode:o}=this,[a,l]=function(t,e,i,n){let r=nt(t,e,i,n),s=nt(e,t,n,i);return[r,s]}(s,o,n,r);if(!e){let t=a?i7(a):s.getCenter(),e=l?i7(l):o.getCenter();return[t,e]}let h="function"==typeof i?i():i,d=ne(a||s,h[0]||l||o),c=ne(l||o,h[h.length-1]||a||s);return[d,c]}getHaloStyle(t){if(!1===t.halo)return!1;let e=this.getKeyStyle(t),i=eE(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign({},e),i)}getLabelStyle(t){if(!1===t.label||!t.labelText)return!1;let e=eE(this.getGraphicStyle(t),"label"),{placement:i,offsetX:n,offsetY:r,autoRotate:s,maxWidth:o}=e,a=iI(e,["placement","offsetX","offsetY","autoRotate","maxWidth"]),l=iE(this.shapeMap.key,i,s,n,r),h=this.shapeMap.key.getLocalBounds(),d=function(t,e,i=1){let n=tZ(t[0],t[1])*i;return eP(n,e)}([h.min,h.max],o);return Object.assign({wordWrapWidth:d},l,a)}getBadgeStyle(t){if(!1===t.badge||!t.badgeText)return!1;let e=eE(t,"badge"),{offsetX:i,offsetY:n,placement:r}=e,s=iI(e,["offsetX","offsetY","placement"]);return Object.assign(s,function(t,e,i,n,r){var s,o;let a=(null===(s=t.badge)||void 0===s?void 0:s.getGeometryBounds().halfExtents[0])*2||0,l=(null===(o=t.label)||void 0===o?void 0:o.getGeometryBounds().halfExtents[0])*2||0;return iE(t.key,i,!0,(l?(l/2+a/2)*("suffix"===e?1:-1):0)+n,r)}(this.shapeMap,r,t.labelPlacement,i,n))}drawArrow(t,e){var i;let n="start"===e,r=t["start"===e?"startArrow":"endArrow"],s=this.shapeMap.key;if(r){let e=this.getArrowStyle(t,n),[i,r,o]=n?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],a=s.parsedStyle[i];if(a)a.attr(e);else{let t=e.src?C.Ee:C.y$,n=new t({style:e});s.style[i]=n}s.style[r]=t[o]||e.width/2+ +e.lineWidth}else{let t=n?"markerStart":"markerEnd";null===(i=s.style[t])||void 0===i||i.destroy(),s.style[t]=null}}getArrowStyle(t,e){var i;let n=this.getShape("key").attributes,r=eE(this.getGraphicStyle(t),e?"startArrow":"endArrow"),{size:s,type:o}=r,a=iI(r,["size","type"]),[l,h]=ew((i=n.lineWidth,s||(i<4?10:4===i?12:2.5*i))),d=(0,J.Z)(o)?o:M[o]||iA,c=d(l,h);return Object.assign((0,e9.Z)(n,["stroke","strokeOpacity","fillOpacity"]),{width:l,height:h},Object.assign({},c&&{d:c,fill:"simple"===o?"":n.stroke}),a)}drawLabelShape(t,e){let i=this.getLabelStyle(t);this.upsert("label",eI,i,e)}drawHaloShape(t,e){let i=this.getHaloStyle(t);this.upsert("halo",C.y$,i,e)}drawBadgeShape(t,e){let i=this.getBadgeStyle(t);this.upsert("badge",eB,i,e)}drawSourceArrow(t){this.drawArrow(t,"start")}drawTargetArrow(t){this.drawArrow(t,"end")}drawKeyShape(t,e){let i=this.getKeyStyle(t);return this.upsert("key",C.y$,i,e)}render(t=this.parsedAttributes,e=this){this.drawKeyShape(t,e),this.getShape("key")&&(this.drawSourceArrow(t),this.drawTargetArrow(t),this.drawLabelShape(t,e),this.drawHaloShape(t,e),this.drawBadgeShape(t,e))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(t,e){let i=super.animate(t,e);return i?new Proxy(i,{set:(t,e,i)=>("currentTime"===e&&Promise.resolve().then(()=>this.onframe()),Reflect.set(t,e,i))}):i}}iB.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0};class iF extends iB{constructor(t){super(eM({style:iF.defaultStyleProps},t))}getKeyPath(t){let[e,i]=this.getEndpoints(t),{controlPoints:n,curvePosition:r,curveOffset:s}=t,o=this.getControlPoints(e,i,(0,W.Z)(r)?[r,1-r]:r,(0,W.Z)(s)?[s,-s]:s,n);return iw(e,i,o)}getControlPoints(t,e,i,n,r){return(null==r?void 0:r.length)===2?r:[iO(t,e,i[0],n[0]),iO(t,e,i[1],n[1])]}}iF.defaultStyleProps={curvePosition:.5,curveOffset:20};class i_ extends iF{constructor(t){super(eM({style:i_.defaultStyleProps},t))}getControlPoints(t,e,i,n){let r=e[0]-t[0];return[[t[0]+r*i[0]+n[0],t[1]],[e[0]-r*i[1]+n[1],e[1]]]}}i_.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class iz extends iF{constructor(t){super(eM({style:iz.defaultStyleProps},t))}get ref(){return this.context.model.getRootsData()[0]}getEndpoints(t){if(this.sourceNode.id===this.ref.id)return super.getEndpoints(t);let e=tQ(this.ref),i=this.sourceNode.getIntersectPoint(e,!0),n=this.targetNode.getIntersectPoint(e);return[i,n]}toRadialCoordinate(t){let e=tQ(this.ref),i=tZ(t,e),n=tK(tB(t,e));return[i,n]}getControlPoints(t,e,i,n){let[r,s]=this.toRadialCoordinate(t),[o]=this.toRadialCoordinate(e),a=o-r;return[[t[0]+(a*i[0]+n[0])*Math.cos(s),t[1]+(a*i[0]+n[0])*Math.sin(s)],[e[0]-(a*i[1]-n[0])*Math.cos(s),e[1]-(a*i[1]-n[0])*Math.sin(s)]]}}iz.defaultStyleProps={curvePosition:.5,curveOffset:20};class iZ extends iF{constructor(t){super(eM({style:iZ.defaultStyleProps},t))}getControlPoints(t,e,i,n){let r=e[1]-t[1];return[[t[0],t[1]+r*i[0]+n[0]],[e[0],e[1]-r*i[1]+n[1]]]}}iZ.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class i$ extends iB{constructor(t){super(eM({style:i$.defaultStyleProps},t))}getKeyPath(t){let[e,i]=this.getEndpoints(t);return[["M",e[0],e[1]],["L",i[0],i[1]]]}}i$.defaultStyleProps={};let iV={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:t$},iH=t=>`${Math.round(t[0])}|||${Math.round(t[1])}`;function iW(t,e){let i=t=>Math.round(t/e);return(0,W.Z)(t)?i(t):t.map(i)}function iG(t,e){let i=e[0]-t[0],n=e[1]-t[1];return i||n?Math.atan2(n,i):0}function iY(t,e,i,n){let r=iG(t,e),s=i[iH(t)],o=iG(s||n,t);return function(t,e){let i=Math.abs(t-e);return i>Math.PI?2*Math.PI-i:i}(o,r)}let iU=(t,e)=>{let{offset:i,gridSize:n}=e,r={};return t.forEach(t=>{if(!t||t.destroyed||!t.isVisible())return;let e=td(t.getRenderBounds(),i);for(let t=iW(e.min[0],n);t<=iW(e.max[0],n);t+=1)for(let i=iW(e.min[1],n);i<=iW(e.max[1],n);i+=1)r[`${t}|||${i}`]=!0}),r};function iK(t,e,i){return Math.min(...e.map(e=>i(t,e)))}let iX=(t,e,i,n)=>{if(!e)return[t];let{directionMap:r,offset:s}=n,o=td(e.getRenderBounds(),s),a=Object.keys(r).reduce((e,n)=>{if(i.includes(n)){let i=r[n],[s,a]=ta(o),l=[t[0]+i.stepX*s,t[1]+i.stepY*a],h=function(t){let{min:[e,i],max:[n,r]}=t,s=[e,r],o=[n,r],a=[n,i],l=[e,i];return[[s,o],[o,a],[a,l],[l,s]]}(o);for(let i=0;i<h.length;i++){let n=tq([t,l],h[i]);n&&tp(n,o)&&e.push(n)}}return e},[]);return tu(t,o)||a.push(t),a.map(t=>iW(t,n.gridSize))},iq=(t,e,i,n,r,s,o)=>{let a=[],l=[s[0]===n[0]?n[0]:t[0]*o,s[1]===n[1]?n[1]:t[1]*o];a.unshift(l);let h=t,d=e[iH(h)];for(;d;){let t=d,n=h,r=iY(t,n,e,i);r&&(l=[t[0]===n[0]?l[0]:t[0]*o,t[1]===n[1]?l[1]:t[1]*o],a.unshift(l)),d=e[iH(t)],h=t}let c=r.map(t=>[t[0]*o,t[1]*o]),u=function(t,e,i){let n=t[0],r=i(t[0],e);for(let s=0;s<t.length;s++){let o=t[s],a=i(o,e);a<r&&(n=o,r=a)}return n}(c,l,t$);return a.unshift(u),a};class iJ{constructor(){this.arr=[],this.map={},this.arr=[],this.map={}}_innerAdd(t,e){let i=0,n=e-1;for(;n-i>1;){let e=Math.floor((i+n)/2);if(this.arr[e].value>t.value)n=e;else if(this.arr[e].value<t.value)i=e;else{this.arr.splice(e,0,t),this.map[t.id]=!0;return}}this.arr.splice(n,0,t),this.map[t.id]=!0}add(t){delete this.map[t.id];let e=this.arr.length;if(!e||this.arr[e-1].value<t.value){this.arr.push(t),this.map[t.id]=!0;return}this._innerAdd(t,e)}remove(t){this.map[t]&&delete this.map[t]}_clearAndGetMinId(){let t;for(let e=this.arr.length-1;e>=0;e--)this.map[this.arr[e].id]?t=this.arr[e].id:this.arr.splice(e,1);return t}_findFirstId(){for(;this.arr.length;){let t=this.arr.shift();if(this.map[t.id])return t.id}}minId(t){return t?this._clearAndGetMinId():this._findFirstId()}}class iQ extends iB{constructor(t){super(eM({style:iQ.defaultStyleProps},t))}getControlPoints(t){let{router:e}=t,{sourceNode:i,targetNode:n}=this,[r,s]=this.getEndpoints(t,!1),o=[];if(e){if("shortest-path"===e.type){let a=this.context.element.getNodes();(o=function(t,e,i,n){let r;let s=tY(t.getCenter()),o=tY(e.getCenter()),a=Object.assign(iV,n),{gridSize:l}=a,h=a.enableObstacleAvoidance?i:[t,e],d=iU(h,a),c=iW(s,l),u=iW(o,l),p=iX(s,t,a.startDirections,a),g=iX(o,e,a.endDirections,a);p.forEach(t=>delete d[iH(t)]),g.forEach(t=>delete d[iH(t)]);let f={},y={},m={},v={},b={},E=new iJ;for(let t=0;t<p.length;t++){let e=p[t],i=iH(e);f[i]=e,v[i]=0,b[i]=iK(e,g,a.distFunc),E.add({id:i,value:b[i]})}let x=g.map(t=>iH(t)),O=a.maximumLoops,w=1/0;for(let[t,e]of Object.entries(f))b[t]<=w&&(w=b[t],r=e);for(;Object.keys(f).length>0&&O>0;){let t=E.minId(!1);if(t)r=f[t];else break;let e=iH(r);if(x.includes(e))return iq(r,m,c,o,p,u,l);for(let t of(delete f[e],E.remove(e),y[e]=!0,Object.values(a.directionMap))){let i=tI(r,[t.stepX,t.stepY]),n=iH(i);if(y[n])continue;let s=iY(r,i,m,c);if(s>a.maxAllowedDirectionChange||d[n])continue;f[n]||(f[n]=i);let o=a.penalties[s],h=a.distFunc(r,i)+(isNaN(o)?l:o),u=v[e]+h,p=v[n];p&&u>=p||(m[n]=r,v[n]=u,b[n]=u+iK(i,g,a.distFunc),E.add({id:n,value:b[n]}))}O-=1}return[]}(i,n,a,e)).length||(o=ih(r,s,i,n,t.controlPoints,{padding:e.offset}))}else"orth"===e.type&&(o=ih(r,s,i,n,t.controlPoints,e))}else o=t.controlPoints;return o}getPoints(t){let e=this.getControlPoints(t),[i,n]=this.getEndpoints(t,!0,e);return[i,...e,n]}getKeyPath(t){let e=this.getPoints(t);return iS(e,t.radius)}getLoopPath(t){let{sourcePort:e,targetPort:i,radius:n}=t,r=this.sourceNode,s=tl(r),o=Math.max(ts(s),to(s))/4,{placement:a,clockwise:l,dist:h=o}=eE(this.getGraphicStyle(t),"loop");return function(t,e,i,n,r,s,o){let a=i9(t),l=a[s||o],h=a[o||s],[d,c]=iM(t,i,n,l,h),u=function(t,e,i,n){let r=[],s=tl(t);if((0,A.Z)(e,i)){let t=tf(e,s);switch(t){case"left":r.push([e[0]-n,e[1]]),r.push([e[0]-n,e[1]+n]),r.push([e[0],e[1]+n]);break;case"right":r.push([e[0]+n,e[1]]),r.push([e[0]+n,e[1]+n]),r.push([e[0],e[1]+n]);break;case"top":r.push([e[0],e[1]-n]),r.push([e[0]+n,e[1]-n]),r.push([e[0]+n,e[1]]);break;case"bottom":r.push([e[0],e[1]+n]),r.push([e[0]+n,e[1]+n]),r.push([e[0]+n,e[1]])}}else{let t=tf(e,s),o=tf(i,s);if(t===o){let s,o;switch(t){case"left":s=Math.min(e[0],i[0])-n,r.push([s,e[1]]),r.push([s,i[1]]);break;case"right":s=Math.max(e[0],i[0])+n,r.push([s,e[1]]),r.push([s,i[1]]);break;case"top":o=Math.min(e[1],i[1])-n,r.push([e[0],o]),r.push([i[0],o]);break;case"bottom":o=Math.max(e[1],i[1])+n,r.push([e[0],o]),r.push([i[0],o])}}else{let a=(t,e)=>({left:[e[0]-n,e[1]],right:[e[0]+n,e[1]],top:[e[0],e[1]-n],bottom:[e[0],e[1]+n]})[t],l=a(t,e),h=a(o,i),d=ib(l,h,s);r.push(l,d,h)}}return r}(t,d,c,r);return l&&(d=ni(l,u[0])),h&&(c=ni(h,u.at(-1))),iS([d,...u,c],e)}(r,n,a,l,h,e,i)}}iQ.defaultStyleProps={radius:0,controlPoints:[],router:!1};class i0 extends iB{constructor(t){super(eM({style:i0.defaultStyleProps},t))}getKeyPath(t){let{curvePosition:e,curveOffset:i}=t,[n,r]=this.getEndpoints(t),s=t.controlPoint||iO(n,r,e,i);return[["M",n[0],n[1]],["Q",s[0],s[1],r[0],r[1]]]}}i0.defaultStyleProps={curvePosition:.5,curveOffset:30};var i1=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};function i2(t){return t instanceof eX&&"node"===t.type}function i3(t){return t instanceof iB}function i6(t){return t instanceof io}let i8={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],"left-top":[0,0],"top-left":[0,0],"left-bottom":[0,1],"bottom-left":[0,1],"right-top":[1,0],"top-right":[1,0],"right-bottom":[1,1],"bottom-right":[1,1],default:[.5,.5]};function i4(t,e,i=i8,n=!0){let r=[.5,.5],s=(0,ei.Z)(e)?(0,ey.Z)(i,e.toLocaleLowerCase(),r):e;if(!n&&(0,ei.Z)(e))return s;let[o,a]=s||r;return[t.min[0]+ts(t)*o,t.min[1]+to(t)*a]}function i9(t){if(!t)return{};let e=t.getPorts(),i=t.attributes.ports||[];return i.forEach((i,n)=>{var r;let{key:s,placement:o}=i;i5(i)&&(e[r=s||n]||(e[r]=t1(t.getShape("key").getBounds(),o)))}),e}function i5(t){let{r:e}=t;return!e||0===Number(e)}function i7(t){return ti(t)?t:t.getPosition()}function nt(t,e,i,n){let r,s;let o=i9(t);if(i)return o[i];let a=Object.values(o);if(0===a.length)return;let l=a.map(t=>i7(t)),h=function(t,e){let i=i9(t);if(e)return[i7(i[e])];let n=Object.values(i);return n.length>0?n.map(t=>i7(t)):[t.getCenter()]}(e,n),[d]=(r=1/0,s=[l[0],h[0]],l.forEach(t=>{h.forEach(e=>{let i=tZ(t,e);i<r&&(r=i,s=[t,e])})}),s);return a.find(t=>i7(t)===d)}function ne(t,e){return i6(t)||i2(t)?nn(t,e):ni(t,e)}function ni(t,e){if(!t||!e)return[0,0,0];if(ti(t))return t;if(t.attributes.linkToCenter)return t.getPosition();let i=ti(e)?e:i2(e)?e.getCenter():e.getPosition();return t5(i,t.getBounds())}function nn(t,e){if(!t||!e)return[0,0,0];let i=ti(e)?e:i2(e)?e.getCenter():e.getPosition();return t.getIntersectPoint(i)||t.getCenter()}function nr(t,e="bottom",i=0,n=0,r=!1){let s=e.split("-"),[o,a]=t1(t,e),[l,h]=r?["bottom","top"]:["top","bottom"],d=s.includes("top")?h:s.includes("bottom")?l:"middle",c=s.includes("left")?"right":s.includes("right")?"left":"center";return{transform:[["translate",o+i,a+n]],textBaseline:d,textAlign:c}}function ns(t){return"hidden"!==(0,ey.Z)(t,["style","visibility"])}function no(t,e){"update"in t?t.update(e):t.attr(e)}function na(t){return(0,ey.Z)(t,"__to_be_destroyed__",!1)}class nl extends tL{constructor(t,e){super(t,Object.assign({},nl.defaultOptions,e)),this.onCollapseExpand=t=>{var e,i,n,r;return e=this,i=void 0,n=void 0,r=function*(){if(!this.validate(t))return;let{target:e}=t;if(!(i2(e)||i3(e)||i6(e)))return;let i=e.id,{model:n,graph:r}=this.context,s=n.getElementDataById(i);if(!s)return!1;let{onCollapse:o,onExpand:a,animation:l,align:h}=this.options;ef(s)?(yield r.expandElement(i,{animation:l,align:h}),null==a||a(i)):(yield r.collapseElement(i,{animation:l,align:h}),null==o||o(i))},new(n||(n=Promise))(function(t,s){function o(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(e){var i;e.done?t(e.value):((i=e.value)instanceof n?i:new n(function(t){t(i)})).then(o,a)}l((r=r.apply(e,i||[])).next())})},this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.on(`node:${e}`,this.onCollapseExpand),t.on(`combo:${e}`,this.onCollapseExpand)}unbindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.off(`node:${e}`,this.onCollapseExpand),t.off(`combo:${e}`,this.onCollapseExpand)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,J.Z)(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}nl.defaultOptions={enable:!0,animation:!0,trigger:b.DBLCLICK,align:!0};var nh=i(6466),nd=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};let nc="g6-create-edge-assist-node-id";class nu extends tL{constructor(t,e){super(t,Object.assign({},nu.defaultOptions,e)),this.drop=t=>nd(this,void 0,void 0,function*(){let{targetType:e}=t;["combo","node"].includes(e)&&this.source?yield this.handleCreateEdge(t):yield this.cancelEdge()}),this.handleCreateEdge=t=>nd(this,void 0,void 0,function*(){var e,i,n;if(!this.validate(t))return;let{graph:r,canvas:s,batch:o,element:a}=this.context,{style:l}=this.options;if(this.source){this.createEdge(t),yield this.cancelEdge();return}o.startBatch(),s.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([t.target.id])[0];let h=r.getElementData(this.source);r.addNodeData([{id:nc,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}],x:null===(e=h.style)||void 0===e?void 0:e.x,y:null===(i=h.style)||void 0===i?void 0:i.y}}]),r.addEdgeData([{id:"g6-create-edge-assist-edge-id",source:this.source,target:nc,style:Object.assign({pointerEvents:"none"},l)}]),yield null===(n=a.draw({animation:!1}))||void 0===n?void 0:n.finished}),this.updateAssistEdge=t=>nd(this,void 0,void 0,function*(){var e;if(!this.source)return;let{model:i,element:n}=this.context;i.translateNodeTo(nc,[t.canvas.x,t.canvas.y]),yield null===(e=n.draw({animation:!1,silence:!0}))||void 0===e?void 0:e.finished}),this.createEdge=t=>{var e,i;let{graph:n}=this.context,{style:r,onFinish:s,onCreate:o}=this.options,a=null===(e=t.target)||void 0===e?void 0:e.id;if(void 0===a||void 0===this.source)return;let l=null===(i=this.getSelectedNodeIDs([t.target.id]))||void 0===i?void 0:i[0],h=`${this.source}-${l}-${(0,nh.Z)()}`,d=o({id:h,source:this.source,target:l,style:r});d&&(n.addEdgeData([d]),s(d))},this.cancelEdge=()=>nd(this,void 0,void 0,function*(){var t;if(!this.source)return;let{graph:e,element:i,batch:n}=this.context;e.removeNodeData([nc]),this.source=void 0,yield null===(t=i.draw({animation:!1}))||void 0===t?void 0:t.finished,n.endBatch()}),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;this.unbindEvents(),"click"===e?(t.on(S.CLICK,this.handleCreateEdge),t.on(v.CLICK,this.handleCreateEdge),t.on(m.CLICK,this.cancelEdge),t.on(x.CLICK,this.cancelEdge)):(t.on(S.DRAG_START,this.handleCreateEdge),t.on(v.DRAG_START,this.handleCreateEdge),t.on(b.POINTER_UP,this.drop)),t.on(b.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(t)))}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,J.Z)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;t.off(S.CLICK,this.handleCreateEdge),t.off(v.CLICK,this.handleCreateEdge),t.off(m.CLICK,this.cancelEdge),t.off(x.CLICK,this.cancelEdge),t.off(S.DRAG_START,this.handleCreateEdge),t.off(v.DRAG_START,this.handleCreateEdge),t.off(b.POINTER_UP,this.drop),t.off(b.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}}nu.defaultOptions={animation:!0,enable:!0,style:{},trigger:"drag",onCreate:t=>t,onFinish:()=>{}};var np=i(83633),ng=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class nf extends tL{constructor(t,e){super(t,Object.assign({},nf.defaultOptions,e)),this.isDragging=!1,this.onDragStart=t=>{this.validate(t)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))},this.onDrag=t=>{var e,i,n,r;if(!this.isDragging||en.isPinching)return;let s=null!==(i=null===(e=t.movement)||void 0===e?void 0:e.x)&&void 0!==i?i:t.dx,o=null!==(r=null===(n=t.movement)||void 0===n?void 0:n.y)&&void 0!==r?r:t.dy;(s|o)!=0&&this.translate([s,o],!1)},this.onDragEnd=()=>{var t,e;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),null===(e=(t=this.options).onFinish)||void 0===e||e.call(t)},this.invokeOnFinish=(0,np.Z)(()=>{var t,e;null===(e=(t=this.options).onFinish)||void 0===e||e.call(t)},300),this.shortcut=new es(t.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){let{trigger:t}=this.options;if((0,R.Z)(t)){let{up:e=[],down:i=[],left:n=[],right:r=[]}=t;this.shortcut.bind(e,t=>this.onTranslate([0,1],t)),this.shortcut.bind(i,t=>this.onTranslate([0,-1],t)),this.shortcut.bind(n,t=>this.onTranslate([1,0],t)),this.shortcut.bind(r,t=>this.onTranslate([-1,0],t))}else{let{graph:t}=this.context;t.on(b.DRAG_START,this.onDragStart),t.on(b.DRAG,this.onDrag),t.on(b.DRAG_END,this.onDragEnd)}}onTranslate(t,e){return ng(this,void 0,void 0,function*(){if(!this.validate(e))return;let{sensitivity:i}=this.options;yield this.translate(tF(t,-1*i),this.options.animation),this.invokeOnFinish()})}translate(t,e){return ng(this,void 0,void 0,function*(){t=this.clampByDirection(t),t=this.clampByRange(t),t=this.clampByRotation(t),yield this.context.graph.translateBy(t,e)})}clampByRotation([t,e]){let i=this.context.graph.getRotation();if(i%360==0)return[t,e];let n=i*Math.PI/180,r=Math.cos(n),s=Math.sin(n);return[t*r-e*s,t*s+e*r]}clampByDirection([t,e]){let{direction:i}=this.options;return"x"===i?e=0:"y"===i&&(t=0),[t,e]}clampByRange([t,e]){let{viewport:i,canvas:n}=this.context,[r,s]=n.getSize(),[o,a,l,h]=tr(this.options.range),d=td(th(i.getCanvasCenter()),[s*o,r*a,s*l,r*h]),c=tB(i.getViewportCenter(),[t,e,0]);if(!tu(c,d)){let{min:[i,n],max:[r,s]}=d;(c[0]<i&&t>0||c[0]>r&&t<0)&&(t=0),(c[1]<n&&e>0||c[1]>s&&e<0)&&(e=0)}return[t,e]}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return"function"==typeof e?e(t):!!e}unbindEvents(){this.shortcut.unbindAll();let{graph:t}=this.context;t.off(b.DRAG_START,this.onDragStart),t.off(b.DRAG,this.onDrag),t.off(b.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}}nf.defaultOptions={enable:t=>!("targetType"in t)||"canvas"===t.targetType,sensitivity:10,direction:"both",range:1/0};var ny=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class nm extends tL{constructor(t,e){super(t,Object.assign({},nm.defaultOptions,e)),this.enable=!1,this.enableElements=["node","combo"],this.target=[],this.shadowOrigin=[0,0],this.hiddenEdges=[],this.isDragging=!1,this.onDrop=t=>ny(this,void 0,void 0,function*(){var e;if("link"!==this.options.dropEffect)return;let{model:i,element:n}=this.context,r=t.target.id;this.target.forEach(t=>{let e=i.getParentData(t,N);e&&tv(e)===r&&i.refreshComboData(r),i.setParent(t,r,N)}),yield null===(e=null==n?void 0:n.draw({animation:!0}))||void 0===e?void 0:e.finished}),this.setCursor=t=>{if(this.isDragging)return;let{type:e}=t,{canvas:i}=this.context,{cursor:n}=this.options;e===b.POINTER_ENTER?i.setCursor((null==n?void 0:n.grab)||"grab"):i.setCursor((null==n?void 0:n.default)||"default")},this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){let{graph:t,canvas:e}=this.context,i=e.getLayer().getContextService().$canvas;i&&(i.addEventListener("blur",this.onDragEnd),i.addEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(e=>{t.on(`${e}:${b.DRAG_START}`,this.onDragStart),t.on(`${e}:${b.DRAG}`,this.onDrag),t.on(`${e}:${b.DRAG_END}`,this.onDragEnd),t.on(`${e}:${b.POINTER_ENTER}`,this.setCursor),t.on(`${e}:${b.POINTER_LEAVE}`,this.setCursor)}),["link"].includes(this.options.dropEffect)&&(t.on(v.DROP,this.onDrop),t.on(m.DROP,this.onDrop))}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(t)))}getDelta(t){let e=this.context.graph.getZoom();return t_([t.dx,t.dy],e)}onDragStart(t){var e;if(this.enable=this.validate(t),!this.enable)return;let{batch:i,canvas:n,graph:r}=this.context;n.setCursor((null===(e=this.options.cursor)||void 0===e?void 0:e.grabbing)||"grabbing"),this.isDragging=!0,i.startBatch();let s=t.target.id,o=r.getElementState(s);o.includes(this.options.state)?this.target=this.getSelectedNodeIDs([s]):this.target=[s],this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(t){if(!this.enable)return;let e=this.getDelta(t);this.options.shadow?this.moveShadow(e):this.moveElement(this.target,e)}onDragEnd(){var t,e,i;if(!this.enable)return;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";let{x:t=0,y:e=0}=this.shadow.attributes,[i,n]=tB([+t,+e],this.shadowOrigin);this.moveElement(this.target,[i,n])}this.showEdges(),null===(e=(t=this.options).onFinish)||void 0===e||e.call(t,this.target);let{batch:n,canvas:r}=this.context;n.endBatch(),r.setCursor((null===(i=this.options.cursor)||void 0===i?void 0:i.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(t){if(this.destroyed||na(t.target)||this.context.graph.isCollapsingExpanding)return!1;let{enable:e}=this.options;return(0,J.Z)(e)?e(t):!!e}moveElement(t,e){return ny(this,void 0,void 0,function*(){let{graph:i,model:n}=this.context,{dropEffect:r}=this.options;"move"===r&&t.forEach(t=>n.refreshComboData(t)),i.translateElementBy(Object.fromEntries(t.map(t=>[t,e])),!1)})}moveShadow(t){if(!this.shadow)return;let{x:e=0,y:i=0}=this.shadow.attributes,[n,r]=t;this.shadow.attr({x:+e+n,y:+i+r})}createShadow(t){let e=eE(this.options,"shadow"),i=tc(t.map(t=>this.context.element.getElement(t).getBounds())),[n,r]=i.min;this.shadowOrigin=[n,r];let[s,o]=ta(i),a={width:s,height:o,x:n,y:r};this.shadow?this.shadow.attr(Object.assign(Object.assign(Object.assign({},e),a),{visibility:"visible"})):(this.shadow=new C.UL({style:Object.assign(Object.assign(Object.assign({$layer:"transient"},e),a),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||0===this.hiddenEdges.length||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){let{hideEdge:t,shadow:e}=this.options;if("none"===t||e)return;let{graph:i}=this.context;"all"===t?this.hiddenEdges=i.getEdgeData().map(tv):this.hiddenEdges=Array.from(new Set(this.target.map(e=>i.getRelatedEdgesData(e,t).map(tv)).flat())),i.hideElement(this.hiddenEdges)}unbindEvents(){let{graph:t,canvas:e}=this.context,i=e.getLayer().getContextService().$canvas;i&&(i.removeEventListener("blur",this.onDragEnd),i.removeEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(e=>{t.off(`${e}:${b.DRAG_START}`,this.onDragStart),t.off(`${e}:${b.DRAG}`,this.onDrag),t.off(`${e}:${b.DRAG_END}`,this.onDragEnd),t.off(`${e}:${b.POINTER_ENTER}`,this.setCursor),t.off(`${e}:${b.POINTER_LEAVE}`,this.setCursor)}),t.off(`combo:${b.DROP}`,this.onDrop),t.off(`canvas:${b.DROP}`,this.onDrop)}destroy(){var t;this.unbindEvents(),null===(t=this.shadow)||void 0===t||t.destroy(),super.destroy()}}nm.defaultOptions={animation:!0,enable:t=>["node","combo"].includes(t.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}};var nv=i(16754);class nb{constructor(t,e){this.context=t,this.options=e||{}}}var nE=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};function nx(t){let{nodes:e,edges:i}=t,n={nodes:[],edges:[],combos:[]};return e.forEach(t=>{let e=t.data._isCombo?n.combos:n.nodes,{x:i,y:r,z:s=0}=t.data;null==e||e.push({id:t.id,style:{x:i,y:r,z:s}})}),i.forEach(t=>{let{id:e,source:i,target:r,data:{points:s=[],controlPoints:o=s.slice(1,s.length-1)}}=t;n.edges.push({id:e,source:i,target:r,style:Object.assign({},(null==o?void 0:o.length)?{controlPoints:o.map(t2)}:{})})}),n}function nO(t,e,...i){if(e in t)return t[e](...i);if("instance"in t){let n=t.instance;if(e in n)return n[e](...i)}return null}function nw(t,e){if(e in t)return t[e];if("instance"in t){let i=t.instance;if(e in i)return i[e]}return null}var nS=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class nD extends tL{constructor(t,e){super(t,Object.assign({},nD.defaultOptions,e)),this.isZoomEvent=t=>!!(t.data&&"scale"in t.data),this.relatedEdgeToUpdate=new Set,this.zoom=this.context.graph.getZoom(),this.fixElementSize=t=>nS(this,void 0,void 0,function*(){if(!this.validate(t))return;let{graph:e}=this.context,{state:i,nodeFilter:n,edgeFilter:r,comboFilter:s}=this.options,o=(i?e.getElementDataByState("node",i):e.getNodeData()).filter(n),a=(i?e.getElementDataByState("edge",i):e.getEdgeData()).filter(r),l=(i?e.getElementDataByState("combo",i):e.getComboData()).filter(s),h=this.isZoomEvent(t)?this.zoom=Math.max(.01,Math.min(t.data.scale,10)):this.zoom,d=[...o,...l];d.length>0&&d.forEach(t=>this.fixNodeLike(t,h)),this.updateRelatedEdges(),a.length>0&&a.forEach(t=>this.fixEdge(t,h))}),this.cachedStyles=new Map,this.getOriginalFieldValue=(t,e,i)=>{var n;let r=this.cachedStyles.get(t)||[],s=(null===(n=r.find(t=>t.shape===e))||void 0===n?void 0:n.style)||{};return i in s||(s[i]=e.attributes[i],this.cachedStyles.set(t,[...r.filter(t=>t.shape!==e),{shape:e,style:s}])),s[i]},this.scaleEntireElement=(t,e,i)=>{e.setLocalScale(1/i);let n=this.cachedStyles.get(t)||[];n.push({shape:e}),this.cachedStyles.set(t,n)},this.scaleSpecificShapes=(t,e,i)=>{let n=function(t){let e=[],i=t=>{(null==t?void 0:t.children.length)&&t.children.forEach(t=>{e.push(t),i(t)})};return i(t),e}(t),r=Array.isArray(i)?i:[i];r.forEach(i=>{let{shape:r,fields:s}=i,o="function"==typeof r?r(n):t.getShape(r);if(o){if(!s){this.scaleEntireElement(t.id,o,e);return}s.forEach(i=>{let n=this.getOriginalFieldValue(t.id,o,i);(0,W.Z)(n)&&(o.style[i]=n/e)})}})},this.skipIfExceedViewport=t=>{let{viewport:e}=this.context;return!(null==e?void 0:e.isInViewport(t.getRenderBounds(),!1,30))},this.fixNodeLike=(t,e)=>{let i=tv(t),{element:n,model:r}=this.context,s=n.getElement(i);if(!s||this.skipIfExceedViewport(s))return;let o=r.getRelatedEdgesData(i);o.forEach(t=>this.relatedEdgeToUpdate.add(tv(t)));let a=this.options[s.type];if(!a){this.scaleEntireElement(i,s,e);return}this.scaleSpecificShapes(s,e,a)},this.fixEdge=(t,e)=>{let i=tv(t),n=this.context.element.getElement(i);if(!n||this.skipIfExceedViewport(n))return;let r=this.options.edge;if(!r){n.style.transformOrigin="center",this.scaleEntireElement(i,n,e);return}this.scaleSpecificShapes(n,e,r)},this.updateRelatedEdges=()=>{let{element:t}=this.context;this.relatedEdgeToUpdate.size>0&&this.relatedEdgeToUpdate.forEach(e=>{let i=t.getElement(e);null==i||i.update({})}),this.relatedEdgeToUpdate.clear()},this.resetTransform=t=>nS(this,void 0,void 0,function*(){var e;null!==(e=t.data)&&void 0!==e&&e.firstRender||(this.options.reset?this.restoreCachedStyles():this.fixElementSize({data:{scale:this.zoom}}))}),this.bindEvents()}restoreCachedStyles(){if(this.cachedStyles.size>0){this.cachedStyles.forEach(t=>{t.forEach(({shape:t,style:e})=>{if((0,eR.Z)(e))t.setLocalScale(1);else{if(this.options.state)return;Object.entries(e).forEach(([e,i])=>t.style[e]=i)}})});let{graph:t,element:e}=this.context,i=Object.keys(Object.fromEntries(this.cachedStyles)).filter(e=>e&&"node"===t.getElementType(e));if(i.length>0){let n=new Set;i.forEach(e=>{t.getRelatedEdgesData(e).forEach(t=>n.add(tv(t)))}),n.forEach(t=>{let i=null==e?void 0:e.getElement(t);null==i||i.update({})})}}}bindEvents(){let{graph:t}=this.context;t.on(O.AFTER_DRAW,this.resetTransform),t.on(O.AFTER_TRANSFORM,this.fixElementSize)}unbindEvents(){let{graph:t}=this.context;t.off(O.AFTER_DRAW,this.resetTransform),t.off(O.AFTER_TRANSFORM,this.fixElementSize)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,J.Z)(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}nD.defaultOptions={enable:t=>t.data.scale<1,nodeFilter:()=>!0,edgeFilter:()=>!0,comboFilter:()=>!0,edge:[{shape:"key",fields:["lineWidth"]},{shape:"halo",fields:["lineWidth"]},{shape:"label"}],reset:!1};class nM extends tL{constructor(t,e){super(t,Object.assign({},nM.defaultOptions,e)),this.focus=t=>{var e,i,n,r;return e=this,i=void 0,n=void 0,r=function*(){if(!this.validate(t))return;let{graph:e}=this.context;yield e.focusElement(t.target.id,this.options.animation)},new(n||(n=Promise))(function(t,s){function o(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(e){var i;e.done?t(e.value):((i=e.value)instanceof n?i:new n(function(t){t(i)})).then(o,a)}l((r=r.apply(e,i||[])).next())})},this.bindEvents()}bindEvents(){let{graph:t}=this.context;this.unbindEvents(),el.forEach(e=>{t.on(`${e}:${b.CLICK}`,this.focus)})}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,J.Z)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;el.forEach(e=>{t.off(`${e}:${b.CLICK}`,this.focus)})}destroy(){this.unbindEvents(),super.destroy()}}nM.defaultOptions={animation:{easing:"ease-in",duration:500},enable:!0};class nC extends tL{constructor(t,e){super(t,Object.assign({},nC.defaultOptions,e)),this.isFrozen=!1,this.toggleFrozen=t=>{this.isFrozen="dragstart"===t.type},this.hoverElement=t=>{if(!this.validate(t))return;let e=t.type===b.POINTER_ENTER;this.updateElementsState(t,e);let{onHover:i,onHoverEnd:n}=this.options;e?null==i||i(t):null==n||n(t)},this.updateElementsState=(t,e)=>{if(!this.options.state&&!this.options.inactiveState)return;let{graph:i}=this.context,{state:n,animation:r,inactiveState:s}=this.options,o=this.getActiveIds(t),a={};if(n&&Object.assign(a,this.getElementsState(o,n,e)),s){let t=tb(i.getData(),!0).filter(t=>!o.includes(t));Object.assign(a,this.getElementsState(t,s,e))}i.setElementState(a,r)},this.getElementsState=(t,e,i)=>{let{graph:n}=this.context,r={};return t.forEach(t=>{let s=n.getElementState(t);i?r[t]=s.includes(e)?s:[...s,e]:r[t]=s.filter(t=>t!==e)}),r},this.bindEvents()}bindEvents(){let{graph:t}=this.context;this.unbindEvents(),el.forEach(e=>{t.on(`${e}:${b.POINTER_ENTER}`,this.hoverElement),t.on(`${e}:${b.POINTER_LEAVE}`,this.hoverElement)});let e=this.context.canvas.document;e.addEventListener(`${b.DRAG_START}`,this.toggleFrozen),e.addEventListener(`${b.DRAG_END}`,this.toggleFrozen)}getActiveIds(t){let{graph:e}=this.context,{degree:i,direction:n}=this.options,r=t.target.id;return i?ed(e,t.targetType,r,"function"==typeof i?i(t):i,n):[r]}validate(t){if(this.destroyed||this.isFrozen||na(t.target)||this.context.graph.isCollapsingExpanding)return!1;let{enable:e}=this.options;return(0,J.Z)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;el.forEach(e=>{t.off(`${e}:${b.POINTER_ENTER}`,this.hoverElement),t.off(`${e}:${b.POINTER_LEAVE}`,this.hoverElement)});let e=this.context.canvas.document;e.removeEventListener(`${b.DRAG_START}`,this.toggleFrozen),e.removeEventListener(`${b.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}}nC.defaultOptions={animation:!1,enable:!0,degree:0,direction:"both",state:"active",inactiveState:void 0};class nT extends tL{constructor(t,e){super(t,Object.assign({},nT.defaultOptions,e)),this.hiddenShapes=[],this.isVisible=!0,this.setElementsVisibility=(t,e,i)=>{t.filter(Boolean).forEach(t=>{"hidden"!==e||t.isVisible()?"visible"===e&&this.hiddenShapes.includes(t)?this.hiddenShapes.splice(this.hiddenShapes.indexOf(t),1):tP(t,e,i):this.hiddenShapes.push(t)})},this.filterShapes=(t,e)=>{if((0,J.Z)(e))return i=>!e(t,i);let i=null==e?void 0:e[t];return t=>!t.className||!(null==i?void 0:i.includes(t.className))},this.hideShapes=t=>{if(!this.validate(t)||!this.isVisible)return;let{element:e}=this.context,{shapes:i={}}=this.options;this.setElementsVisibility(e.getNodes(),"hidden",this.filterShapes("node",i)),this.setElementsVisibility(e.getEdges(),"hidden",this.filterShapes("edge",i)),this.setElementsVisibility(e.getCombos(),"hidden",this.filterShapes("combo",i)),this.isVisible=!1},this.showShapes=(0,np.Z)(t=>{if(!this.validate(t)||this.isVisible)return;let{element:e}=this.context;this.setElementsVisibility(e.getNodes(),"visible"),this.setElementsVisibility(e.getEdges(),"visible"),this.setElementsVisibility(e.getCombos(),"visible"),this.isVisible=!0},this.options.debounce),this.bindEvents()}bindEvents(){let{graph:t}=this.context;t.on(O.BEFORE_TRANSFORM,this.hideShapes),t.on(O.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){let{graph:t}=this.context;t.off(O.BEFORE_TRANSFORM,this.hideShapes),t.off(O.AFTER_TRANSFORM,this.showShapes)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,J.Z)(e)?e(t):!!e}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}nT.defaultOptions={enable:!0,debounce:200,shapes:t=>"node"===t};var nP=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class nA extends tL{constructor(t,e){super(t,Object.assign({},nA.defaultOptions,e)),this.onWheel=t=>nP(this,void 0,void 0,function*(){this.options.preventDefault&&t.preventDefault();let e=t.deltaX,i=t.deltaY;yield this.scroll([-e,-i],t)}),this.shortcut=new es(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){var t,e;let{trigger:i}=this.options;if(this.shortcut.unbindAll(),(0,R.Z)(i)){null===(t=this.graphDom)||void 0===t||t.removeEventListener(b.WHEEL,this.onWheel);let{up:e=[],down:n=[],left:r=[],right:s=[]}=i;this.shortcut.bind(e,t=>this.scroll([0,-10],t)),this.shortcut.bind(n,t=>this.scroll([0,10],t)),this.shortcut.bind(r,t=>this.scroll([-10,0],t)),this.shortcut.bind(s,t=>this.scroll([10,0],t))}else null===(e=this.graphDom)||void 0===e||e.addEventListener(b.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement(t){let{sensitivity:e}=this.options;return t=tF(t,e),t=this.clampByDirection(t),t=this.clampByRange(t)}clampByDirection([t,e]){let{direction:i}=this.options;return"x"===i?e=0:"y"===i&&(t=0),[t,e]}clampByRange([t,e]){let{viewport:i,canvas:n}=this.context,[r,s]=n.getSize(),[o,a,l,h]=tr(this.options.range),d=td(th(i.getCanvasCenter()),[s*o,r*a,s*l,r*h]),c=tB(i.getViewportCenter(),[t,e,0]);if(!tu(c,d)){let{min:[i,n],max:[r,s]}=d;(c[0]<i&&t>0||c[0]>r&&t<0)&&(t=0),(c[1]<n&&e>0||c[1]>s&&e<0)&&(e=0)}return[t,e]}scroll(t,e){return nP(this,void 0,void 0,function*(){if(!this.validate(e))return;let{onFinish:i}=this.options,n=this.context.graph,r=this.formatDisplacement(t);yield n.translateBy(r,!1),null==i||i()})}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,J.Z)(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),null===(t=this.graphDom)||void 0===t||t.removeEventListener(b.WHEEL,this.onWheel),super.destroy()}}nA.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0,range:1/0};var nR=i(15378),nL=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class nk extends tL{constructor(t,e){super(t,Object.assign({},nk.defaultOptions,e)),this.zoom=(t,e,i)=>nL(this,void 0,void 0,function*(){if(!this.validate(e))return;let{graph:n}=this.context,r=this.options.origin;!r&&"viewport"in e&&(r=t2(e.viewport));let{sensitivity:s,onFinish:o}=this.options,a=1+(0,nR.Z)(t,-50,50)*s/100,l=n.getZoom();yield n.zoomTo(l*a,i,r),null==o||o()}),this.onReset=()=>nL(this,void 0,void 0,function*(){yield this.context.graph.zoomTo(1,this.options.animation)}),this.preventDefault=t=>{this.options.preventDefault&&t.preventDefault()},this.shortcut=new es(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){let{trigger:t}=this.options;if(this.shortcut.unbindAll(),Array.isArray(t)){if(t.includes(b.PINCH))this.shortcut.bind([b.PINCH],t=>{this.zoom(t.scale,t,!1)});else{let e=this.context.canvas.getContainer();null==e||e.addEventListener(b.WHEEL,this.preventDefault),this.shortcut.bind([...t,b.WHEEL],t=>{let{deltaX:e,deltaY:i}=t;this.zoom(-(null!=i?i:e),t,!1)})}}if("object"==typeof t){let{zoomIn:e=[],zoomOut:i=[],reset:n=[]}=t;this.shortcut.bind(e,t=>this.zoom(10,t,this.options.animation)),this.shortcut.bind(i,t=>this.zoom(-10,t,this.options.animation)),this.shortcut.bind(n,this.onReset)}}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,J.Z)(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),null===(t=this.context.canvas.getContainer())||void 0===t||t.removeEventListener(b.WHEEL,this.preventDefault),super.destroy()}}nk.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};var nN=i(74355),nj=i(73888),nI=i(83394),nB=i(954),nF=i(70937),n_=i(10507),nz=i(76344),nZ=i(91974),n$=i(86423),nV=i(39688),nH=i(92327),nW=i(50843),nG=i(87941),nY=i(84462),nU=i(15427);class nK extends nb{constructor(){super(...arguments),this.id="fishbone"}getRoot(){let t=this.context.model.getRootsData();if(!(0,eR.Z)(t)&&!(t.length>2))return t[0]}formatSize(t){let e="function"==typeof t?t:()=>t;return t=>ew(e(t))}doLayout(t,e){let{hGap:i,getRibSep:n,vGap:r,nodeSize:s,height:o}=e,{model:a}=this.context,l=this.formatSize(s),h=l(t)[0]+n(t),d=(t,e=0)=>{var n;return e+=i*((t.children||[]).length+1),null===(n=t.children)||void 0===n||n.forEach(t=>{var i;let n=a.getNodeLikeDatum(t);null===(i=n.children)||void 0===i||i.forEach(t=>{let i=a.getNodeLikeDatum(t);e=d(i,e)})}),e},c=t=>{if(1===t.depth)return h;let e=a.getParentData(t.id,"tree");if(nJ(t)){let n=a.getParentData(e.id,"tree"),s=g(t)-g(n);return c(e)+s*i/r}{let i=(e.children||[]).indexOf(t.id),n=a.getNodeData((e.children||[]).slice(i));return u(e)-n.reduce((t,e)=>t+d(e),0)-l(e)[0]/2}},u=(0,nU.Z)(t=>{if(nq(t))return l(t)[0]/2;let e=a.getParentData(t.id,"tree");if(nJ(t))return c(t)+d(t)+l(t)[0]/2;{let n=g(t)-g(e);return c(t)+n*(i/r)}},t=>t.id),p=t=>g(a.getParentData(t,"tree")),g=(0,nU.Z)(t=>{if(nq(t))return o/2;if(nJ(t)){let e=a.getParentData(t.id,"tree"),i=e.children.indexOf(t.id);if(0===i)return p(e.id)+r;let n=a.getNodeLikeDatum(e.children[i-1]);if((0,eR.Z)(n.children))return g(n)+r;let s=a.getDescendantsData(n.id);return Math.max(...s.map(t=>nJ(t)?p(t.id):g(t)))+r}{if((0,eR.Z)(t.children))return p(t.id)+r;let e=a.getNodeLikeDatum(t.children.slice(-1)[0]);if((0,eR.Z)(e.children))return g(e)+r;let i=a.getDescendantsData(t.id).slice(-1)[0];return(nJ(i)?p(i.id):g(i))+r}},t=>t.id),f=0,y={nodes:[],edges:[]},m=t=>{var e;null===(e=t.children)||void 0===e||e.forEach(t=>m(a.getNodeLikeDatum(t)));let i=g(t),r=u(t);if(y.nodes.push({id:t.id,x:r,y:i}),nq(t))return;let s=a.getRelatedEdgesData(t.id,"in")[0],o=[c(t),nJ(t)?i:p(t.id)];y.edges.push({id:tv(s),controlPoints:[o],relatedNodeId:t.id}),f=Math.max(f,r+n(t)),1===t.depth&&(h=f)};return m(t),y}placeAlterative(t,e){let i=(e.children||[]).filter((t,e)=>e%2!=0);if(0===i.length)return t;let{model:n}=this.context,r=t.nodes.find(t=>t.id===e.id).y,s=t=>{let e=n.getAncestorsData(t,"tree");if((0,eR.Z)(e))return!1;let r=1===e.length?t:e[e.length-2].id;return i.includes(r)};t.nodes.forEach(t=>{s(t.id)&&(t.y=2*r-t.y)}),t.edges.forEach(t=>{s(t.relatedNodeId)&&(t.controlPoints=t.controlPoints.map(t=>[t[0],2*r-t[1]]))})}rightToLeft(t,e){return t.nodes.forEach(t=>t.x=e.width-t.x),t.edges.forEach(t=>{t.controlPoints=t.controlPoints.map(t=>[e.width-t[0],t[1]])}),t}execute(t,e){var i,n,r,s;return i=this,n=void 0,r=void 0,s=function*(){let i=Object.assign(Object.assign(Object.assign({},nK.defaultOptions),this.options),e),{direction:n,nodeSize:r}=i,s=this.getRoot();if(!s)return t;let o=this.formatSize(r);i.vGap||(i.vGap=Math.max(...(t.nodes||[]).map(t=>o(t)[1]))),i.hGap||(i.hGap=Math.max(...(t.nodes||[]).map(t=>o(t)[0])));let a=this.doLayout(s,i);this.placeAlterative(a,s),"RL"===n&&(a=this.rightToLeft(a,i));let{model:l}=this.context,h=[],d=[];return a.nodes.forEach(t=>{let{id:e,x:i,y:n}=t,r=l.getNodeLikeDatum(e);h.push(nX(r,{x:i,y:n}))}),a.edges.forEach(t=>{let{id:e,controlPoints:i}=t,n=l.getEdgeDatum(e);d.push(nX(n,{controlPoints:i}))}),{nodes:h,edges:d}},new(r||(r=Promise))(function(t,e){function o(t){try{l(s.next(t))}catch(t){e(t)}}function a(t){try{l(s.throw(t))}catch(t){e(t)}}function l(e){var i;e.done?t(e.value):((i=e.value)instanceof r?i:new r(function(t){t(i)})).then(o,a)}l((s=s.apply(i,n||[])).next())})}}nK.defaultOptions={direction:"RL",getRibSep:()=>60};let nX=(t,e)=>Object.assign(Object.assign({},t),{style:Object.assign(Object.assign({},t.style||{}),e)}),nq=t=>0===t.depth,nJ=t=>(t.depth||(t.depth=0))%2==0;class nQ extends nb{constructor(){super(...arguments),this.id="snake"}formatSize(t,e){let i="function"==typeof e?e:()=>e;return t.reduce((t,e)=>{let[n,r]=ew(i(e))||[0,0];return[Math.max(t[0],n),Math.max(t[1],r)]},[0,0])}validate(t){let{nodes:e=[],edges:i=[]}=t,n={},r={},s={};e.forEach(t=>{n[t.id]=0,r[t.id]=0,s[t.id]=[]}),i.forEach(t=>{n[t.target]++,r[t.source]++,s[t.source].push(t.target)});let o=new Set,a=t=>{o.has(t)||(o.add(t),s[t].forEach(a))};if(a(e[0].id),o.size!==e.length)return!1;let l=e.filter(t=>0===n[t.id]),h=e.filter(t=>0===r[t.id]);if(1!==l.length||1!==h.length)return!1;let d=e.filter(t=>1===n[t.id]&&1===r[t.id]);return d.length===e.length-2}execute(t,e){var i,n,r,s;return i=this,n=void 0,r=void 0,s=function*(){var i;if(!this.validate(t))return t;let{nodeSize:n,padding:r,sortBy:s,cols:o,colGap:a,rowGap:l,clockwise:h,width:d,height:c}=Object.assign({},nQ.defaultOptions,this.options,e),[u,p,g,f]=tr(r),y=this.formatSize(t.nodes||[],n),m=Math.ceil((t.nodes||[]).length/o),v=a||(d-f-p-o*y[0])/(o-1),b=l||(c-u-g-m*y[1])/(m-1);(b===1/0||b<0)&&(b=0),(v===1/0||v<0)&&(v=0);let E=s?null===(i=t.nodes)||void 0===i?void 0:i.sort(s):function(t){let{nodes:e=[],edges:i=[]}=t,n={},r={};e.forEach(t=>{n[t.id]=0,r[t.id]=[]}),i.forEach(t=>{n[t.target]++,r[t.source].push(t.target)});let s=[],o=[];for(e.forEach(t=>{0===n[t.id]&&s.push(t.id)});s.length>0;){let t=s.shift(),i=e.find(e=>e.id===t);o.push(i),r[t].forEach(t=>{n[t]--,0===n[t]&&s.push(t)})}return o}(t),x=(E||[]).map((t,e)=>{let i=Math.floor(e/o),n=e%o,r=f+(h?i%2==0?n:o-1-n:i%2==0?o-1-n:n)*(y[0]+v)+y[0]/2,s=u+i*(y[1]+b)+y[1]/2;return{id:t.id,style:{x:r,y:s}}});return{nodes:x}},new(r||(r=Promise))(function(t,e){function o(t){try{l(s.next(t))}catch(t){e(t)}}function a(t){try{l(s.throw(t))}catch(t){e(t)}}function l(e){var i;e.done?t(e.value):((i=e.value)instanceof r?i:new r(function(t){t(i)})).then(o,a)}l((s=s.apply(i,n||[])).next())})}}nQ.defaultOptions={padding:0,cols:5,clockwise:!0};var n0=i(97067);class n1 extends tR{}function n2(t,e=!0,i){let n=document.createElement("div");return n.setAttribute("class",`g6-${t}`),Object.assign(n.style,{position:"absolute",display:"block"}),e&&Object.assign(n.style,{position:"unset",gridArea:"1 / 1 / 2 / 2",inset:"0px",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none"}),i&&Object.assign(n.style,i),n}function n3(t,e="div",i={},n="",r=document.body){let s=document.getElementById(t);s&&s.remove();let o=document.createElement(e);return o.innerHTML=n,o.id=t,Object.assign(o.style,i),r.appendChild(o),o}class n6 extends n1{constructor(t,e){super(t,Object.assign({},n6.defaultOptions,e)),this.$element=n2("background");let i=this.context.canvas.getContainer();i.prepend(this.$element),this.update(e)}update(t){var e,i,n,r;let s=Object.create(null,{update:{get:()=>super.update}});return e=this,i=void 0,n=void 0,r=function*(){s.update.call(this,t),Object.assign(this.$element.style,(0,n0.Z)(this.options,["key","type"]))},new(n||(n=Promise))(function(t,s){function o(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(e){var i;e.done?t(e.value):((i=e.value)instanceof n?i:new n(function(t){t(i)})).then(o,a)}l((r=r.apply(e,i||[])).next())})}destroy(){super.destroy(),this.$element.remove()}}n6.defaultOptions={transition:"background 0.5s",backgroundSize:"cover",zIndex:"-1"};var n8=i(25470),n4=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};class n9 extends n1{constructor(t,e){super(t,(0,tN.Z)({},n9.defaultOptions,e)),this.members=new Map,this.avoidMembers=new Map,this.bubbleSetOptions={},this.drawBubbleSets=()=>{let{style:t,bubbleSetOptions:e}=this.parseOptions();(0,A.Z)(this.bubbleSetOptions,e)||this.init(),this.bubbleSetOptions=Object.assign({},e);let i=Object.assign(Object.assign({},t),{d:this.getPath()});this.shape?this.shape.update(i):(this.shape=new eZ({style:i}),this.context.canvas.appendChild(this.shape))},this.updateBubbleSetsPath=t=>{if(!this.shape)return;let e=tv(t.data);[...this.options.members,...this.options.avoidMembers].includes(e)&&this.shape.update(Object.assign(Object.assign({},this.parseOptions().style),{d:this.getPath(e)}))},this.getPath=t=>{let{graph:e}=this.context,i=this.options.members,n=[...this.members.keys()],r=this.options.avoidMembers,s=[...this.avoidMembers.keys()];if(!t&&(0,A.Z)(i,n)&&(0,A.Z)(r,s))return this.path;let{enter:o=[],exit:a=[]}=tT(n,i,t=>t),{enter:l=[],exit:h=[]}=tT(s,r,t=>t);t&&(a.push(t),o.push(t));let d=(t,i,n)=>{t.forEach(t=>{let r=n?this.members:this.avoidMembers;if(i){let i;"edge"===e.getElementType(t)?([i]=n7(e,t),this.bubbleSets.pushEdge(i)):([i]=n5(e,t),this.bubbleSets[n?"pushMember":"pushNonMember"](i)),r.set(t,i)}else{let i=r.get(t);i&&("edge"===e.getElementType(t)?this.bubbleSets.removeEdge(i):this.bubbleSets[n?"removeMember":"removeNonMember"](i),r.delete(t))}})};d(a,!1,!0),d(o,!0,!0),d(h,!1,!1),d(l,!0,!1);let c=this.bubbleSets.compute(),u=c.sample(8).simplify(0).bSplines().simplify(0);return this.path=e_(u.points.map(t2)),this.path},this.bindEvents(),this.bubbleSets=new n8.CF(this.options)}bindEvents(){this.context.graph.on(O.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(O.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new n8.CF(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){let t=this.options,{type:e,key:i,members:n,avoidMembers:r}=t,s=n4(t,["type","key","members","avoidMembers"]),o=Object.keys(s).reduce((t,e)=>(e in n8.vC?t.bubbleSetOptions[e]=s[e]:t.style[e]=s[e],t),{style:{},bubbleSetOptions:{}});return Object.assign({type:e,key:i,members:n,avoidMembers:r},o)}addMember(t){let e=Array.isArray(t)?t:[t];e.some(t=>this.options.avoidMembers.includes(t))&&(this.options.avoidMembers=this.options.avoidMembers.filter(t=>!e.includes(t))),this.options.members=[...new Set([...this.options.members,...e])],this.drawBubbleSets()}removeMember(t){let e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(t=>!e.includes(t)),this.drawBubbleSets()}updateMember(t){this.options.members=(0,J.Z)(t)?t(this.options.members):t,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(t){let e=Array.isArray(t)?t:[t];e.some(t=>this.options.members.includes(t))&&(this.options.members=this.options.members.filter(t=>!e.includes(t))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...e])],this.drawBubbleSets()}removeAvoidMember(t){let e=Array.isArray(t)?t:[t];this.options.avoidMembers.some(t=>e.includes(t))&&(this.options.avoidMembers=this.options.avoidMembers.filter(t=>!e.includes(t)),this.drawBubbleSets())}updateAvoidMember(t){this.options.avoidMembers=Array.isArray(t)?t:[t],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(O.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(O.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}}n9.defaultOptions=Object.assign({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},n8.vC);let n5=(t,e)=>{let i=Array.isArray(e)?e:[e];return i.map(e=>{let i=t.getElementRenderBounds(e);return new n8.Ae(i.min[0],i.min[1],ts(i),to(i))})},n7=(t,e)=>{let i=Array.isArray(e)?e:[e];return i.map(e=>{let i=t.getEdgeData(e),n=t.getElementPosition(i.source),r=t.getElementPosition(i.target);return n8.x1.from({x1:n[0],y1:n[1],x2:r[0],y2:r[1]})})},rt=`
  .g6-contextmenu {
    font-size: 12px;
    background-color: rgba(255, 255, 255, 0.96);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;
    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;
  }

  .g6-contextmenu-ul {
    max-width: 256px;
    min-width: 96px;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .g6-contextmenu-li {
    padding: 8px 12px;
    cursor: pointer;
    user-select: none;
  }

  .g6-contextmenu-li:hover {
    background-color: #f5f5f5;
    cursor: pointer;
  }
`;var re=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class ri extends n1{constructor(t,e){super(t,Object.assign({},ri.defaultOptions,e)),this.targetElement=null,this.onTriggerEvent=t=>{var e;null===(e=t.preventDefault)||void 0===e||e.call(t),this.show(t)},this.onMenuItemClick=t=>{let{onClick:e,trigger:i}=this.options;if(t.target instanceof HTMLElement&&t.target.className.includes("g6-contextmenu-li")){let i=t.target.getAttribute("value");null==e||e(i,t.target,this.targetElement),this.hide()}"click"!==i&&this.hide()},this.initElement(),this.update(e)}initElement(){this.$element=n2("contextmenu",!1,{zIndex:"99"});let{className:t}=this.options;t&&this.$element.classList.add(t);let e=this.context.canvas.getContainer();e.appendChild(this.$element),n3("g6-contextmenu-css","style",{},rt,document.head)}show(t){return re(this,void 0,void 0,function*(){let{enable:e,offset:i}=this.options;if("function"==typeof e&&!e(t)||!e){this.hide();return}let n=yield this.getDOMContent(t);n instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(n)):this.$element.innerHTML=n;let r=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${t.client.x-r.left+i[0]}px`,this.$element.style.top=`${t.client.y-r.top+i[1]}px`,this.$element.style.display="block",this.targetElement=t.target})}hide(){this.$element.style.display="none",this.targetElement=null}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(t){return re(this,void 0,void 0,function*(){let{getContent:e,getItems:i}=this.options;return i?`
    <ul class="g6-contextmenu-ul">
      ${(yield i(t)).map(t=>`<li  class="g6-contextmenu-li" value="${t.value}">${t.name}</li>`).join("")}
    </ul>
  `:yield e(t)})}bindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.on(`canvas:${e}`,this.onTriggerEvent),t.on(`node:${e}`,this.onTriggerEvent),t.on(`edge:${e}`,this.onTriggerEvent),t.on(`combo:${e}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.off(`canvas:${e}`,this.onTriggerEvent),t.off(`node:${e}`,this.onTriggerEvent),t.off(`edge:${e}`,this.onTriggerEvent),t.off(`combo:${e}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}}ri.defaultOptions={trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0};class rn extends n1{constructor(t,e){super(t,Object.assign({},rn.defaultOptions,e)),this.edgeBundles={},this.edgePoints={},this.onBundle=()=>{let{model:t,element:e}=this.context,i=t.getEdgeData();this.divideEdges(this.options.divisions);let{cycles:n,iterRate:r,divRate:s}=this.options,{lambda:o,divisions:a,iterations:l}=this.options;for(let t=0;t<n;t++){for(let t=0;t<l;t++){let t={};i.forEach(e=>{var i;if(e.source===e.target)return;let n=tv(e);t[n]=this.getEdgeForces(e,a,o);for(let e=0;e<a+1;e++)(i=this.edgePoints)[n]||(i[n]=[]),this.edgePoints[n][e]=tI(this.edgePoints[n][e],t[n][e])})}o/=2,a*=s,l*=r,this.divideEdges(a)}i.forEach(t=>{let i=tv(t),n=e.getElement(i);null==n||n.update({d:iS(this.edgePoints[i])})})},this.bindEvents()}get nodeMap(){let t=this.context.model.getNodeData();return Object.fromEntries(t.map(t=>[tv(t),tY(tQ(t))]))}divideEdges(t){let e=this.context.model.getEdgeData();e.forEach(e=>{var i;let n=tv(e);(i=this.edgePoints)[n]||(i[n]=[]);let r=this.nodeMap[e.source],s=this.nodeMap[e.target];if(1===t)this.edgePoints[n].push(r),this.edgePoints[n].push(t_(tI(r,s),2)),this.edgePoints[n].push(s);else{let e=0===this.edgePoints[n].length?tZ(r,s):rd(this.edgePoints[n]),i=e/(t+1),o=i,a=[r];for(let t=1;t<this.edgePoints[n].length;t++){let e=this.edgePoints[n][t-1],r=this.edgePoints[n][t],s=tZ(r,e);for(;s>o;){let t=o/s,n=tI(e,tF(tB(r,e),t));a.push(n),s-=o,o=i}o-=s}a.push(s),this.edgePoints[n]=a}})}getVectorPosition(t){let e=this.nodeMap[t.source],i=this.nodeMap[t.target],[n,r]=tB(i,e),s=tZ(e,i);return{source:e,target:i,vx:n,vy:r,length:s}}measureEdgeCompatibility(t,e){let i=this.getVectorPosition(t),n=this.getVectorPosition(e),r=rr(i,n),s=rs(i,n),o=ro(i,n),a=rh(i,n);return r*s*o*a}getEdgeBundles(){let t={},e=this.options.bundleThreshold,i=this.context.model.getEdgeData();return i.forEach((n,r)=>{i.forEach((i,s)=>{var o,a;if(s<=r)return;let l=this.measureEdgeCompatibility(n,i);l>=e&&(t[o=tv(n)]||(t[o]=[]),t[tv(n)].push(i),t[a=tv(i)]||(t[a]=[]),t[tv(i)].push(n))})}),t}getSpringForce(t,e){let{pre:i,cur:n,next:r}=t;return tF(tB(tI(i,r),tF(n,2)),e)}getElectrostaticForce(t,e){(0,eR.Z)(this.edgeBundles)&&(this.edgeBundles=this.getEdgeBundles());let i=this.edgeBundles[tv(e)],n=[0,0];return null==i||i.forEach(i=>{let r=this.edgePoints[tv(i)][t],s=this.edgePoints[tv(e)][t],o=tB(r,s),a=tZ(r,s);n=tI(n,tF(o,1/a))}),n}getEdgeForces(t,e,i){let n=this.nodeMap[t.source],r=this.nodeMap[t.target],s=this.options.K/(tZ(n,r)*(e+1)),o=[[0,0]],a=tv(t);for(let n=1;n<e;n++){let e=this.getSpringForce({pre:this.edgePoints[a][n-1],cur:this.edgePoints[a][n],next:this.edgePoints[a][n+1]||[0,0]},s),r=this.getElectrostaticForce(n,t);o.push(tF(tI(e,r),i))}return o.push([0,0]),o}bindEvents(){let{graph:t}=this.context;t.on(O.AFTER_RENDER,this.onBundle)}unbindEvents(){let{graph:t}=this.context;t.off(O.AFTER_RENDER,this.onBundle)}destroy(){this.unbindEvents(),super.destroy()}}rn.defaultOptions={K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:2/3,bundleThreshold:.6};let rr=(t,e)=>{var i,n;return Math.abs((i=[t.vx,t.vy],n=[e.vx,e.vy],i.reduce((t,e,i)=>t+e*n[i],0)/(t.length*e.length)))},rs=(t,e)=>{let i=(t.length+e.length)/2;return 2/(i/Math.min(t.length,e.length)+Math.max(t.length,e.length)/i)},ro=(t,e)=>{let i=(t.length+e.length)/2,n=t_(tI(t.source,t.target),2),r=t_(tI(e.source,e.target),2);return i/(i+tZ(n,r))},ra=(t,e)=>{if(e.source[0]===e.target[0])return[e.source[0],t[1]];if(e.source[1]===e.target[1])return[t[0],e.source[1]];let i=(e.source[1]-e.target[1])/(e.source[0]-e.target[0]),n=(i*i*e.source[0]+i*(t[1]-e.source[1])+t[0])/(i*i+1),r=i*(n-e.source[0])+e.source[1];return[n,r]},rl=(t,e)=>{let i=ra(e.source,t),n=ra(e.target,t),r=t_(tI(i,n),2),s=t_(tI(t.source,t.target),2);return 0===tZ(i,n)?0:Math.max(0,1-2*tZ(s,r)/tZ(i,n))},rh=(t,e)=>Math.min(rl(t,e),rl(e,t)),rd=t=>{let e=0;for(let i=1;i<t.length;i++)e+=tZ(t[i],t[i-1]);return e},rc={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8,zIndex:-1/0};class ru extends n1{constructor(t,e){super(t,Object.assign({},ru.defaultOptions,e)),this.shapes=new Map,this.r=this.options.r,this.onEdgeFilter=t=>{if("drag"===this.options.trigger&&this.isLensOn)return;let e=t2(t.canvas);this.renderLens(e),this.renderFocusElements()},this.renderLens=t=>{let e=Object.assign({},rc,this.options.style);this.isLensOn||(this.lens=new eq({style:e}),this.canvas.appendChild(this.lens)),Object.assign(e,t3(t),{size:2*this.r}),this.lens.update(e)},this.getFilterData=()=>{let{filter:t}=this.options,{model:e}=this.context,i=e.getData();if(!t)return i;let{nodes:n,edges:r,combos:s}=i;return{nodes:n.filter(e=>t(tv(e),"node")),edges:r.filter(e=>t(tv(e),"edge")),combos:s.filter(e=>t(tv(e),"combo"))}},this.getFocusElements=t=>{let{nodes:e,edges:i}=this.getFilterData(),n=e.filter(e=>tZ(tQ(e),t)<this.r),r=n.map(t=>tv(t)),s=i.filter(t=>{let{source:e,target:i}=t,n=r.includes(e),s=r.includes(i);switch(this.options.nodeType){case"both":return n&&s;case"either":return n!==s;case"source":return n&&!s;case"target":return!n&&s;default:return!1}});return{nodes:n,edges:s}},this.renderFocusElements=()=>{let{element:t,graph:e}=this.context;if(!this.isLensOn)return;let i=this.lens.getCenter(),{nodes:n,edges:r}=this.getFocusElements(i),s=new Set,o=i=>{let n=tv(i);s.add(n);let r=t.getElement(n);if(!r)return;let o=this.shapes.get(n)||r.cloneNode();o.setPosition(r.getPosition()),o.id=r.id,this.shapes.has(n)?Object.entries(r.attributes).forEach(([t,e])=>{o.style[t]!==e&&(o.style[t]=e)}):(this.canvas.appendChild(o),this.shapes.set(n,o));let a=e.getElementType(n),l=this.getElementStyle(a,i);o.update(l)};n.forEach(o),r.forEach(o),this.shapes.forEach((t,e)=>{s.has(e)||(t.destroy(),this.shapes.delete(e))})},this.scaleRByWheel=t=>{var e;this.options.preventDefault&&t.preventDefault();let{clientX:i,clientY:n,deltaX:r,deltaY:s}=t,{graph:o,canvas:a}=this.context,l=o.getCanvasByClient([i,n]),h=null===(e=this.lens)||void 0===e?void 0:e.getCenter();if(!this.isLensOn||tZ(l,h)>this.r)return;let{maxR:d,minR:c}=this.options,u=Math.min(...a.getSize())/2;this.r=Math.max(c||0,Math.min(d||u,this.r*(r+s>0?1/.95:.95))),this.renderLens(h),this.renderFocusElements()},this.isLensDragging=!1,this.onDragStart=t=>{var e;let i=t2(t.canvas),n=null===(e=this.lens)||void 0===e?void 0:e.getCenter();!this.isLensOn||tZ(i,n)>this.r||(this.isLensDragging=!0)},this.onDrag=t=>{if(!this.isLensDragging)return;let e=t2(t.canvas);this.renderLens(e),this.renderFocusElements()},this.onDragEnd=()=>{this.isLensDragging=!1},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(t,e){let i="node"===t?this.options.nodeStyle:this.options.edgeStyle;return"function"==typeof i?i(e):i}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;let{graph:e}=this.context,{trigger:i,scaleRBy:n}=this.options,r=e.getCanvas().getLayer();["click","drag"].includes(i)&&r.addEventListener(b.CLICK,this.onEdgeFilter),"pointermove"===i?r.addEventListener(b.POINTER_MOVE,this.onEdgeFilter):"drag"===i&&(r.addEventListener(b.DRAG_START,this.onDragStart),r.addEventListener(b.DRAG,this.onDrag),r.addEventListener(b.DRAG_END,this.onDragEnd)),"wheel"===n&&(null===(t=this.graphDom)||void 0===t||t.addEventListener(b.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var t;let{graph:e}=this.context,{trigger:i,scaleRBy:n}=this.options,r=e.getCanvas().getLayer();["click","drag"].includes(i)&&r.removeEventListener(b.CLICK,this.onEdgeFilter),"pointermove"===i?r.removeEventListener(b.POINTER_MOVE,this.onEdgeFilter):"drag"===i&&(r.removeEventListener(b.DRAG_START,this.onDragStart),r.removeEventListener(b.DRAG,this.onDrag),r.removeEventListener(b.DRAG_END,this.onDragEnd)),"wheel"===n&&(null===(t=this.graphDom)||void 0===t||t.removeEventListener(b.WHEEL,this.scaleRByWheel))}update(t){var e;this.unbindEvents(),super.update(t),this.r=null!==(e=t.r)&&void 0!==e?e:this.r,this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((t,e)=>{t.destroy(),this.shapes.delete(e)}),super.destroy()}}ru.defaultOptions={trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:"wheel",preventDefault:!0};let rp={fill:"#ccc",fillOpacity:.1,lineWidth:2,stroke:"#000",strokeOpacity:.8,labelFontSize:12};class rg extends n1{constructor(t,e){super(t,Object.assign({},rg.defaultOptions,e)),this.r=this.options.r,this.d=this.options.d,this.onCreateFisheye=t=>{if("drag"===this.options.trigger&&this.isLensOn)return;let e=t2(t.canvas);this.onMagnify(e)},this.onMagnify=t=>{t.some(isNaN)||(this.renderLens(t),this.renderFocusElements())},this.renderLens=t=>{let e=Object.assign({},rp,this.options.style);this.isLensOn||(this.lens=new eq({style:e}),this.canvas.appendChild(this.lens)),Object.assign(e,t3(t),{size:2*this.r,label:this.options.showDPercent,labelText:this.getDPercent()}),this.lens.update(e)},this.getDPercent=()=>{let{minD:t,maxD:e}=this.options,i=Math.round((this.d-t)/(e-t)*100);return`${i}%`},this.prevMagnifiedStyleMap=new Map,this.prevOriginStyleMap=new Map,this.renderFocusElements=()=>{if(!this.isLensOn)return;let{graph:t}=this.context,e=this.lens.getCenter(),i=(this.d+1)*this.r,n=new Map,r=new Map,s=t.getNodeData();s.forEach(s=>{let o=tQ(s),a=tZ(o,e);if(a>this.r)return;let l=i*a/(this.d*a+this.r),[h,d]=o,[c,u]=e,p=tv(s),g=this.getNodeStyle(s),f=(0,e9.Z)(t.getElementRenderStyle(p),Object.keys(g));n.set(p,Object.assign(Object.assign({},t3([c+l*((h-c)/a),u+l*((d-u)/a)])),g)),r.set(p,Object.assign(Object.assign({},t3(o)),f))}),this.updateStyle(n,r)},this.getNodeStyle=t=>{let{nodeStyle:e}=this.options;return"function"==typeof e?e(t):e},this.updateStyle=(t,e)=>{let{graph:i,element:n}=this.context,{enter:r,exit:s,keep:o}=tT(Array.from(this.prevMagnifiedStyleMap.keys()),Array.from(t.keys()),t=>t),a=new Set,l=(t,e)=>{let r=n.getElement(t);null==r||r.update(e),i.getRelatedEdgesData(t).forEach(t=>{a.add(tv(t))})};[...r,...o].forEach(e=>{l(e,t.get(e))}),s.forEach(t=>{l(t,this.prevOriginStyleMap.get(t)),this.prevOriginStyleMap.delete(t)}),a.forEach(t=>{let e=n.getElement(t);null==e||e.update({})}),this.prevMagnifiedStyleMap=t,e.forEach((t,e)=>{this.prevOriginStyleMap.has(e)||this.prevOriginStyleMap.set(e,t)})},this.isWheelValid=t=>{if(this.options.preventDefault&&t.preventDefault(),!this.isLensOn)return!1;let{clientX:e,clientY:i}=t,n=this.context.graph.getCanvasByClient([e,i]),r=this.lens.getCenter();return!(tZ(n,r)>this.r)},this.scaleR=t=>{let{maxR:e,minR:i}=this.options,n=Math.min(...this.context.canvas.getSize())/2;this.r=Math.max(i||0,Math.min(e||n,this.r*(t?1/.95:.95)))},this.scaleD=t=>{let{maxD:e,minD:i}=this.options,n=t?this.d+.1:this.d-.1;this.d=Math.max(i,Math.min(e,n))},this.scaleRByWheel=t=>{if(!this.isWheelValid(t))return;let{deltaX:e,deltaY:i}=t;this.scaleR(e+i>0);let n=this.lens.getCenter();this.onMagnify(n)},this.scaleDByWheel=t=>{if(!this.isWheelValid(t))return;let{deltaX:e,deltaY:i}=t;this.scaleD(e+i>0);let n=this.lens.getCenter();this.onMagnify(n)},this.isDragValid=t=>{if(this.options.preventDefault&&t.preventDefault(),!this.isLensOn)return!1;let e=t2(t.canvas),i=this.lens.getCenter();return!(tZ(e,i)>this.r)},this.isLensDragging=!1,this.onDragStart=t=>{this.isDragValid(t)&&(this.isLensDragging=!0)},this.onDrag=t=>{if(!this.isLensDragging)return;let e=t2(t.canvas);this.onMagnify(e)},this.onDragEnd=()=>{this.isLensDragging=!1},this.scaleRByDrag=t=>{if(!this.isLensDragging)return;let{dx:e,dy:i}=t;this.scaleR(e-i>0);let n=this.lens.getCenter();this.onMagnify(n)},this.scaleDByDrag=t=>{if(!this.isLensDragging)return;let{dx:e,dy:i}=t;this.scaleD(e-i>0);let n=this.lens.getCenter();this.onMagnify(n)},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;let{graph:e}=this.context,{trigger:i,scaleRBy:n,scaleDBy:r}=this.options,s=e.getCanvas().getLayer();if(["click","drag"].includes(i)&&s.addEventListener(b.CLICK,this.onCreateFisheye),"pointermove"===i&&s.addEventListener(b.POINTER_MOVE,this.onCreateFisheye),"drag"===i||"drag"===n||"drag"===r){s.addEventListener(b.DRAG_START,this.onDragStart),s.addEventListener(b.DRAG_END,this.onDragEnd);let t="drag"===i?this.onDrag:"drag"===n?this.scaleRByDrag:this.scaleDByDrag;s.addEventListener(b.DRAG,t)}if("wheel"===n||"wheel"===r){let e="wheel"===n?this.scaleRByWheel:this.scaleDByWheel;null===(t=this.graphDom)||void 0===t||t.addEventListener(b.WHEEL,e,{passive:!1})}}unbindEvents(){var t;let{graph:e}=this.context,{trigger:i,scaleRBy:n,scaleDBy:r}=this.options,s=e.getCanvas().getLayer();if(["click","drag"].includes(i)&&s.removeEventListener(b.CLICK,this.onCreateFisheye),"pointermove"===i&&s.removeEventListener(b.POINTER_MOVE,this.onCreateFisheye),"drag"===i||"drag"===n||"drag"===r){s.removeEventListener(b.DRAG_START,this.onDragStart),s.removeEventListener(b.DRAG_END,this.onDragEnd);let t="drag"===i?this.onDrag:"drag"===n?this.scaleRByDrag:this.scaleDByDrag;s.removeEventListener(b.DRAG,t)}if("wheel"===n||"wheel"===r){let e="wheel"===n?this.scaleRByWheel:this.scaleDByWheel;null===(t=this.graphDom)||void 0===t||t.removeEventListener(b.WHEEL,e)}}update(t){var e,i;this.unbindEvents(),super.update(t),this.r=null!==(e=t.r)&&void 0!==e?e:this.r,this.d=null!==(i=t.d)&&void 0!==i?i:this.d,this.bindEvents()}destroy(){var t;this.unbindEvents(),this.isLensOn&&(null===(t=this.lens)||void 0===t||t.destroy()),this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),super.destroy()}}rg.defaultOptions={trigger:"pointermove",r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};class rf extends n1{constructor(t,e){super(t,Object.assign({},rf.defaultOptions,e)),this.$el=this.context.canvas.getContainer(),this.graphSize=[0,0],this.onFullscreenChange=()=>{var t,e,i,n;let r=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(r),r?null===(e=(t=this.options).onEnter)||void 0===e||e.call(t):null===(n=(i=this.options).onExit)||void 0===n||n.call(i)},this.shortcut=new es(t.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML=`
      :not(:root):fullscreen::backdrop {
        background: transparent;
      }
    `}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();let{request:t=[],exit:e=[]}=this.options.trigger;this.shortcut.bind(t,this.request),this.shortcut.bind(e,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(t=>{document.addEventListener(t,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(t=>{document.removeEventListener(t,this.onFullscreenChange,!1)})}setGraphSize(t=!0){var e,i;let n,r;t?(n=(null===(e=globalThis.screen)||void 0===e?void 0:e.width)||0,r=(null===(i=globalThis.screen)||void 0===i?void 0:i.height)||0,this.graphSize=this.context.graph.getSize()):[n,r]=this.graphSize,this.context.graph.setSize(n,r),this.context.graph.render()}request(){!document.fullscreenElement&&(document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled"))&&this.$el.requestFullscreen().catch(t=>{_.warn(`Error attempting to enable full-screen: ${t.message} (${t.name})`)})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}}rf.defaultOptions={trigger:{},autoFit:!0};var ry=i(29803);class rm extends n1{constructor(t,e){super(t,Object.assign({},rm.defaultOptions,e)),this.$element=n2("grid-line",!0),this.offset=[0,0],this.currentScale=1,this.followZoom=t=>{let{data:{scale:e,origin:i}}=t;if(!e)return;let n=this.currentScale;this.currentScale=e;let r=e/n,s=tF(i||this.context.graph.getCanvasCenter(),1-r),o=this.baseSize*e,a=tF(this.offset,r),l=tG(a,o),h=tI(l,s);this.$element.style.backgroundSize=`${o}px ${o}px`,this.$element.style.backgroundPosition=`${h[0]}px ${h[1]}px`,this.offset=tG(h,o)},this.followTranslate=t=>{if(!this.options.follow)return;let{data:{translate:e}}=t;e&&this.updateOffset(e)},this.onTransform=t=>{let e=this.parseFollow(this.options.follow);e.zoom&&this.followZoom(t),e.translate&&this.followTranslate(t)};let i=this.context.canvas.getContainer();i.prepend(this.$element),this.baseSize=this.options.size,this.updateStyle(),this.bindEvents()}update(t){super.update(t),void 0!==t.size&&(this.baseSize=t.size),this.updateStyle()}bindEvents(){let{graph:t}=this.context;t.on(O.AFTER_TRANSFORM,this.onTransform)}updateStyle(){let{stroke:t,lineWidth:e,border:i,borderLineWidth:n,borderStroke:r,borderStyle:s}=this.options,o=this.baseSize*this.currentScale;Object.assign(this.$element.style,{border:i?`${n}px ${s} ${r}`:"none",backgroundImage:`linear-gradient(${t} ${e}px, transparent ${e}px), linear-gradient(90deg, ${t} ${e}px, transparent ${e}px)`,backgroundSize:`${o}px ${o}px`,backgroundRepeat:"repeat"})}updateOffset(t){let e=this.baseSize*this.currentScale;this.offset=tG(tI(this.offset,t),e),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}parseFollow(t){var e,i;return(0,ry.Z)(t)?{translate:t,zoom:t}:{translate:null!==(e=null==t?void 0:t.translate)&&void 0!==e&&e,zoom:null!==(i=null==t?void 0:t.zoom)&&void 0!==i&&i}}destroy(){this.context.graph.off(O.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}}rm.defaultOptions={border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"};var rv=i(80216);function rb(t){let e={Added:new Map,Updated:new Map,Removed:new Map};return t.forEach(t=>{let{type:i,value:n}=t,r=tv(n);if("NodeAdded"===i||"EdgeAdded"===i||"ComboAdded"===i)e.Added.set(r,t);else if("NodeUpdated"===i||"EdgeUpdated"===i||"ComboUpdated"===i){if(e.Added.has(r))e.Added.set(r,{type:i.replace("Updated","Added"),value:n});else if(e.Updated.has(r)){let{original:t}=e.Updated.get(r);e.Updated.set(r,{type:i,value:n,original:t})}else e.Removed.has(r)||e.Updated.set(r,t)}else("NodeRemoved"===i||"EdgeRemoved"===i||"ComboRemoved"===i)&&(e.Added.has(r)?e.Added.delete(r):(e.Updated.has(r)&&e.Updated.delete(r),e.Removed.set(r,t)))}),[...Array.from(e.Added.values()),...Array.from(e.Updated.values()),...Array.from(e.Removed.values())]}function rE(t){let{NodeAdded:e=[],NodeUpdated:i=[],NodeRemoved:n=[],EdgeAdded:r=[],EdgeUpdated:s=[],EdgeRemoved:o=[],ComboAdded:a=[],ComboUpdated:l=[],ComboRemoved:h=[]}=(0,Q.Z)(t,t=>t.type);return{add:{nodes:e,edges:r,combos:a},update:{nodes:i,edges:s,combos:l},remove:{nodes:n,edges:o,combos:h}}}class rx extends n1{constructor(t,e){super(t,Object.assign({},rx.defaultOptions,e)),this.batchChanges=null,this.batchAnimation=!1,this.undoStack=[],this.redoStack=[],this.freezed=!1,this.executeCommand=(t,e=!0)=>{var i,n,r;this.freezed=!0,null===(n=(i=this.options).executeCommand)||void 0===n||n.call(i,t);let s=e?t.original:t.current;this.context.graph.addData(s.add),this.context.graph.updateData(s.update),this.context.graph.removeData(tb(s.remove,!1)),null===(r=this.context.element)||void 0===r||r.draw({silence:!0,animation:t.animation}),this.freezed=!1},this.addCommand=t=>{var e;if(!this.freezed){if(t.type===O.AFTER_DRAW){let{dataChanges:i=[],animation:n=!0}=t.data;if(null===(e=this.context.batch)||void 0===e?void 0:e.isBatching){if(!this.batchChanges)return;this.batchChanges.push(i),this.batchAnimation&&(this.batchAnimation=n);return}this.batchChanges=[i],this.batchAnimation=n}this.undoStackPush(function(t,e=!1,i){let n={animation:e,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:r,update:s,remove:o}=rE(rb(t));return["nodes","edges","combos"].forEach(t=>{s[t]&&s[t].forEach(e=>{var r,s;let o=Object.assign({},e.value),a=Object.assign({},e.original);if(i){let t=i.graph.getElementType(tv(e.original)),n="edge"===t?"stroke":"fill",r=i.element.getElementComputedStyle(t,e.original);a=Object.assign(Object.assign({},e.original),{style:Object.assign({[n]:r[n]},e.original.style)})}(function t(e,i){for(let n in e)(0,R.Z)(e[n])&&!Array.isArray(e[n])&&null!==e[n]?(i[n]||(i[n]={}),t(e[n],i[n])):void 0===i[n]&&(i[n]=V(n))})(o,a),(r=n.current.update)[t]||(r[t]=[]),n.current.update[t].push(o),(s=n.original.update)[t]||(s[t]=[]),n.original.update[t].push(a)}),r[t]&&r[t].forEach(e=>{var i,r;let s=Object.assign({},e.value);(i=n.current.add)[t]||(i[t]=[]),n.current.add[t].push(s),(r=n.original.remove)[t]||(r[t]=[]),n.original.remove[t].push(s)}),o[t]&&o[t].forEach(e=>{var i,r;let s=Object.assign({},e.value);(i=n.current.remove)[t]||(i[t]=[]),n.current.remove[t].push(s),(r=n.original.add)[t]||(r[t]=[]),n.original.add[t].push(s)})}),n}(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(w.ADD,this.undoStack[this.undoStack.length-1])}},this.initBatchCommand=t=>{let{initiate:e}=t.data;if(this.batchAnimation=!1,e)this.batchChanges=[];else{let t=this.undoStack.pop();t||(this.batchChanges=null)}},this.emitter=new rv.Z;let{graph:i}=this.context;i.on(O.AFTER_DRAW,this.addCommand),i.on(O.BATCH_START,this.initBatchCommand),i.on(O.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var t,e,i,n;let r=this.undoStack.pop();if(r){this.executeCommand(r);let s=null===(e=(t=this.options).beforeAddCommand)||void 0===e?void 0:e.call(t,r,!1);if(!1===s)return;this.redoStack.push(r),null===(n=(i=this.options).afterAddCommand)||void 0===n||n.call(i,r,!1),this.notify(w.UNDO,r)}return this}redo(){let t=this.redoStack.pop();return t&&(this.executeCommand(t,!1),this.undoStackPush(t),this.notify(w.REDO,t)),this}undoAndCancel(){let t=this.undoStack.pop();return t&&(this.executeCommand(t,!1),this.redoStack=[],this.notify(w.CANCEL,t)),this}undoStackPush(t){var e,i,n,r;let{stackSize:s}=this.options;0!==s&&this.undoStack.length>=s&&this.undoStack.shift();let o=null===(i=(e=this.options).beforeAddCommand)||void 0===i?void 0:i.call(e,t,!0);!1!==o&&(this.undoStack.push(t),null===(r=(n=this.options).afterAddCommand)||void 0===r||r.call(n,t,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(w.CLEAR,null)}notify(t,e){this.emitter.emit(t,{cmd:e}),this.emitter.emit(w.CHANGE,{cmd:e})}on(t,e){this.emitter.on(t,e)}destroy(){let{graph:t}=this.context;t.off(O.AFTER_DRAW,this.addCommand),t.off(O.BATCH_START,this.initBatchCommand),t.off(O.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}}rx.defaultOptions={stackSize:0};let rO={toXy(t,e){if(!e)return[...t];let i=e[0].slice(1),n=e[1].slice(1);return t.map(t=>[t[i],t[n]])},fromXy(t,e){if(!e)return[...t];let i=e[0].slice(1),n=e[1].slice(1);return t.map(([t,e])=>({[i]:t,[n]:e}))}};class rw{constructor(t,e){for(let i of(this._cells=[],this._cellSize=e,this._reverseCellSize=1/e,t)){let t=this.coordToCellNum(i[0]),e=this.coordToCellNum(i[1]);this._cells[t]||(this._cells[t]=[]),this._cells[t][e]||(this._cells[t][e]=[]),this._cells[t][e].push(i)}}cellPoints(t,e){var i;return(null===(i=this._cells[t])||void 0===i?void 0:i[e])||[]}rangePoints(t){let e=this.coordToCellNum(t[0]),i=this.coordToCellNum(t[1]),n=this.coordToCellNum(t[2]),r=this.coordToCellNum(t[3]),s=[];for(let t=e;t<=n;t++)for(let e=i;e<=r;e++){let i=this.cellPoints(t,e);for(let t of i)s.push(t)}return s}removePoint(t){let e=this.coordToCellNum(t[0]),i=this.coordToCellNum(t[1]),n=this._cells[e][i],r=n.findIndex(([e,i])=>e===t[0]&&i===t[1]);return r>-1&&n.splice(r,1),n}trunc(t){return Math.trunc(t)}coordToCellNum(t){return this.trunc(t*this._reverseCellSize)}extendBbox(t,e){return[t[0]-e*this._cellSize,t[1]-e*this._cellSize,t[2]+e*this._cellSize,t[3]+e*this._cellSize]}}function rS(t,e,i){let n=t*e,r=134217729*t,s=r-(r-t),o=t-s,a=134217729*e,l=a-(a-e),h=e-l,d=o*h-(n-s*l-o*l-s*h);return i?(i[0]=d,i[1]=n,i):[d,n]}function rD(t,e){let i=t.length;if(1===i){let i=rS(t[0],e);return i[0]?i:[i[1]]}let n=Array(2*i),r=[.1,.1],s=[.1,.1],o=0;rS(t[0],e,r),r[0]&&(n[o++]=r[0]);for(let a=1;a<i;++a){rS(t[a],e,s);let i=r[1];!function(t,e,i){let n=t+e,r=n-t,s=e-r,o=t-(n-r);i&&(i[0]=o+s,i[1]=n)}(i,s[0],r),r[0]&&(n[o++]=r[0]);let l=s[1],h=r[1],d=l+h,c=d-l,u=h-c;r[1]=d,u&&(n[o++]=u)}return r[1]&&(n[o++]=r[1]),0===o&&(n[o++]=0),n.length=o,n}function rM(t,e){let i,n,r,s,o,a;let l=0|t.length,h=0|e.length;if(1===l&&1===h)return function(t,e){let i=t+e,n=i-t,r=t-(i-n)+(e-n);return r?[r,i]:[i]}(t[0],-e[0]);let d=Array(l+h),c=0,u=0,p=0,g=Math.abs,f=t[u],y=g(f),m=-e[p],v=g(m);y<v?(n=f,(u+=1)<l&&(y=g(f=t[u]))):(n=m,(p+=1)<h&&(v=g(m=-e[p]))),u<l&&y<v||p>=h?(i=f,(u+=1)<l&&(y=g(f=t[u]))):(i=m,(p+=1)<h&&(v=g(m=-e[p])));let b=i+n,E=b-i,x=n-E,O=x,w=b;for(;u<l&&p<h;)y<v?(i=f,(u+=1)<l&&(y=g(f=t[u]))):(i=m,(p+=1)<h&&(v=g(m=-e[p]))),E=(b=i+(n=O))-i,(x=n-E)&&(d[c++]=x),s=(r=w+b)-w,O=w-(r-s)+(b-s),w=r;for(;u<l;)E=(b=(i=f)+(n=O))-i,(x=n-E)&&(d[c++]=x),s=(r=w+b)-w,O=w-(r-s)+(b-s),w=r,(u+=1)<l&&(f=t[u]);for(;p<h;)E=(b=(i=m)+(n=O))-i,(x=n-E)&&(d[c++]=x),s=(r=w+b)-w,O=w-(r-s)+(b-s),w=r,(p+=1)<h&&(m=-e[p]);return O&&(d[c++]=O),w&&(d[c++]=w),c||(d[c++]=0),d.length=c,d}function rC(t,e){let i,n,r,s,o,a;let l=0|t.length,h=0|e.length;if(1===l&&1===h)return function(t,e){let i=t+e,n=i-t,r=t-(i-n)+(e-n);return r?[r,i]:[i]}(t[0],e[0]);let d=Array(l+h),c=0,u=0,p=0,g=Math.abs,f=t[u],y=g(f),m=e[p],v=g(m);y<v?(n=f,(u+=1)<l&&(y=g(f=t[u]))):(n=m,(p+=1)<h&&(v=g(m=e[p]))),u<l&&y<v||p>=h?(i=f,(u+=1)<l&&(y=g(f=t[u]))):(i=m,(p+=1)<h&&(v=g(m=e[p])));let b=i+n,E=b-i,x=n-E,O=x,w=b;for(;u<l&&p<h;)y<v?(i=f,(u+=1)<l&&(y=g(f=t[u]))):(i=m,(p+=1)<h&&(v=g(m=e[p]))),E=(b=i+(n=O))-i,(x=n-E)&&(d[c++]=x),s=(r=w+b)-w,O=w-(r-s)+(b-s),w=r;for(;u<l;)E=(b=(i=f)+(n=O))-i,(x=n-E)&&(d[c++]=x),s=(r=w+b)-w,O=w-(r-s)+(b-s),w=r,(u+=1)<l&&(f=t[u]);for(;p<h;)E=(b=(i=m)+(n=O))-i,(x=n-E)&&(d[c++]=x),s=(r=w+b)-w,O=w-(r-s)+(b-s),w=r,(p+=1)<h&&(m=e[p]);return O&&(d[c++]=O),w&&(d[c++]=w),c||(d[c++]=0),d.length=c,d}function rT(t,e,i,n){return function(i,r,s){let o=t(t(e(r[1],s[0]),e(-s[1],r[0])),t(e(i[1],r[0]),e(-r[1],i[0]))),a=t(e(i[1],s[0]),e(-s[1],i[0])),l=n(o,a);return l[l.length-1]}}function rP(t,e,i,n){return function(r,s,o,a){let l=t(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),a[2])))),h=t(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-o[2]),i(t(e(r[1],o[0]),e(-o[1],r[0])),a[2]))),t(i(t(e(s[1],o[0]),e(-o[1],s[0])),r[2]),t(i(t(e(r[1],o[0]),e(-o[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),o[2])))),d=n(l,h);return d[d.length-1]}}function rA(t,e,i,n){return function(r,s,o,a,l){let h=t(t(t(i(t(i(t(e(a[1],l[0]),e(-l[1],a[0])),o[2]),t(i(t(e(o[1],l[0]),e(-l[1],o[0])),-a[2]),i(t(e(o[1],a[0]),e(-a[1],o[0])),l[2]))),s[3]),t(i(t(i(t(e(a[1],l[0]),e(-l[1],a[0])),s[2]),t(i(t(e(s[1],l[0]),e(-l[1],s[0])),-a[2]),i(t(e(s[1],a[0]),e(-a[1],s[0])),l[2]))),-o[3]),i(t(i(t(e(o[1],l[0]),e(-l[1],o[0])),s[2]),t(i(t(e(s[1],l[0]),e(-l[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),l[2]))),a[3]))),t(i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),-l[3]),t(i(t(i(t(e(a[1],l[0]),e(-l[1],a[0])),s[2]),t(i(t(e(s[1],l[0]),e(-l[1],s[0])),-a[2]),i(t(e(s[1],a[0]),e(-a[1],s[0])),l[2]))),r[3]),i(t(i(t(e(a[1],l[0]),e(-l[1],a[0])),r[2]),t(i(t(e(r[1],l[0]),e(-l[1],r[0])),-a[2]),i(t(e(r[1],a[0]),e(-a[1],r[0])),l[2]))),-s[3])))),t(t(i(t(i(t(e(s[1],l[0]),e(-l[1],s[0])),r[2]),t(i(t(e(r[1],l[0]),e(-l[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),l[2]))),a[3]),t(i(t(i(t(e(s[1],a[0]),e(-a[1],s[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),a[2]))),-l[3]),i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),r[3]))),t(i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-o[2]),i(t(e(r[1],o[0]),e(-o[1],r[0])),a[2]))),-s[3]),t(i(t(i(t(e(s[1],a[0]),e(-a[1],s[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),a[2]))),o[3]),i(t(i(t(e(s[1],o[0]),e(-o[1],s[0])),r[2]),t(i(t(e(r[1],o[0]),e(-o[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),o[2]))),-a[3]))))),d=t(t(t(i(t(i(t(e(a[1],l[0]),e(-l[1],a[0])),o[2]),t(i(t(e(o[1],l[0]),e(-l[1],o[0])),-a[2]),i(t(e(o[1],a[0]),e(-a[1],o[0])),l[2]))),r[3]),i(t(i(t(e(a[1],l[0]),e(-l[1],a[0])),r[2]),t(i(t(e(r[1],l[0]),e(-l[1],r[0])),-a[2]),i(t(e(r[1],a[0]),e(-a[1],r[0])),l[2]))),-o[3])),t(i(t(i(t(e(o[1],l[0]),e(-l[1],o[0])),r[2]),t(i(t(e(r[1],l[0]),e(-l[1],r[0])),-o[2]),i(t(e(r[1],o[0]),e(-o[1],r[0])),l[2]))),a[3]),i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-o[2]),i(t(e(r[1],o[0]),e(-o[1],r[0])),a[2]))),-l[3]))),t(t(i(t(i(t(e(o[1],l[0]),e(-l[1],o[0])),s[2]),t(i(t(e(s[1],l[0]),e(-l[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),l[2]))),r[3]),i(t(i(t(e(o[1],l[0]),e(-l[1],o[0])),r[2]),t(i(t(e(r[1],l[0]),e(-l[1],r[0])),-o[2]),i(t(e(r[1],o[0]),e(-o[1],r[0])),l[2]))),-s[3])),t(i(t(i(t(e(s[1],l[0]),e(-l[1],s[0])),r[2]),t(i(t(e(r[1],l[0]),e(-l[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),l[2]))),o[3]),i(t(i(t(e(s[1],o[0]),e(-o[1],s[0])),r[2]),t(i(t(e(r[1],o[0]),e(-o[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),o[2]))),-l[3])))),c=n(h,d);return c[c.length-1]}}function rR(t){return(3===t?rT:4===t?rP:rA)(rC,rS,rD,rM)}let rL=rR(3),rk=rR(4),rN=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,i){let n;let r=(t[1]-i[1])*(e[0]-i[0]),s=(t[0]-i[0])*(e[1]-i[1]),o=r-s;if(r>0){if(s<=0)return o;n=r+s}else{if(!(r<0)||s>=0)return o;n=-(r+s)}let a=33306690738754716e-32*n;return o>=a||o<=-a?o:rL(t,e,i)},function(t,e,i,n){let r=t[0]-n[0],s=e[0]-n[0],o=i[0]-n[0],a=t[1]-n[1],l=e[1]-n[1],h=i[1]-n[1],d=t[2]-n[2],c=e[2]-n[2],u=i[2]-n[2],p=s*h,g=o*l,f=o*a,y=r*h,m=r*l,v=s*a,b=d*(p-g)+c*(f-y)+u*(m-v),E=7771561172376103e-31*((Math.abs(p)+Math.abs(g))*Math.abs(d)+(Math.abs(f)+Math.abs(y))*Math.abs(c)+(Math.abs(m)+Math.abs(v))*Math.abs(u));return b>E||-b>E?b:rk(t,e,i,n)}];var rj=function(){for(;rN.length<=5;)rN.push(rR(rN.length));let t=function(t,e,i,n,r,s,o){return function(...e){switch(e.length){case 0:case 1:return 0;case 2:return n(e[0],e[1]);case 3:return r(e[0],e[1],e[2]);case 4:return s(e[0],e[1],e[2],e[3]);case 5:return o(e[0],e[1],e[2],e[3],e[4])}return t(e)}}(void 0,0,...rN);for(let e=0;e<=5;++e)t[e]=rN[e];return t}();let rI=rj[3];function rB(t,e){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function rF(t,e,i){let n=[e[0]-t[0],e[1]-t[1]],r=[i[0]-t[0],i[1]-t[1]],s=rB(t,e),o=rB(t,i),a=n[0]*r[0]+n[1]*r[1];return a/Math.sqrt(s*o)}function r_(t,e){for(let i=0;i<e.length-1;i++){let n=[e[i],e[i+1]];if((t[0][0]!==n[0][0]||t[0][1]!==n[0][1])&&(t[0][0]!==n[1][0]||t[0][1]!==n[1][1])&&function(t,e,i,n){let r=rj(t,i,n),s=rj(e,i,n);if(r>0&&s>0||r<0&&s<0)return!1;let o=rj(i,t,e),a=rj(n,t,e);return(!(o>0)||!(a>0))&&(!(o<0)||!(a<0))&&(0!==r||0!==s||0!==o||0!==a||function(t,e,i,n){for(let r=0;r<2;++r){let s=t[r],o=e[r],[a,l]=[Math.min(s,o),Math.max(s,o)],h=i[r],d=n[r],[c,u]=[Math.min(h,d),Math.max(h,d)];if(u<a||l<c)return!1}return!0}(t,e,i,n))}(t[0],t[1],n[0],n[1]))return!0}return!1}let rz=Math.cos(90/(180/Math.PI)),rZ=(t,e,i)=>{if("sharp"===i)return[["M",t[0]-e,t[1]-e],["L",t[0]+e,t[1]-e],["L",t[0]+e,t[1]+e],["L",t[0]-e,t[1]+e],["Z"]];let n=[e,e,0,0,0];return[["M",t[0],t[1]-e],["A",...n,t[0],t[1]+e],["A",...n,t[0],t[1]-e]]},r$=(t,e,i)=>{let n=[e,e,0,0,0],r="sharp"===i?tI(t[0],tz(tV(tB(t[0],t[1])),e)):t[0],s="sharp"===i?tI(t[1],tz(tV(tB(t[1],t[0])),e)):t[1],o=tz(tV(tW(tB(r,s),!1)),e),a=tz(o,-1),l=tI(r,o),h=tI(s,o),d=tI(s,a),c=tI(r,a);return"sharp"===i?[["M",l[0],l[1]],["L",h[0],h[1]],["L",d[0],d[1]],["L",c[0],c[1]],["Z"]]:[["M",l[0],l[1]],["L",h[0],h[1]],["A",...n,d[0],d[1]],["L",c[0],c[1]],["A",...n,l[0],l[1]]]},rV=(t,e)=>{let i=et(t).map((i,n)=>{let r=(n-2+t.length)%t.length,s=(n-1+t.length)%t.length,o=(n+1)%t.length,a=t[r],l=t[s],h=t[o],d=tB(a,l),c=tB(l,i),u=tB(i,h),p=(t,e)=>tH(t,e,!0)<Math.PI,g=p(d,c),f=p(c,u),y=t=>tz(tV(tW(t,!1)),e),m=y(c);return[{p:tY(g?tI(l,y(d)):tI(l,m)),concave:g&&l},{p:tY(f?tI(i,y(u)):tI(i,m)),concave:f&&i}]}),n=[e,e,0,0,0],r=i.findIndex((t,e)=>!i[(e-1+i.length)%i.length][0].concave&&!i[(e-1+i.length)%i.length][1].concave&&!t[0].concave&&!t[0].concave&&!t[1].concave),s=i.slice(r).concat(i.slice(0,r)),o=[];return s.flatMap((t,e)=>{let r=[],a=s[i.length-1];return 0===e&&r.push(["M",...a[1].p]),t[0].concave?o.push(t[0].p,t[1].p):r.push(["A",...n,...t[0].p]),t[1].concave?o.unshift(t[1].p):r.push(["L",...t[1].p]),3===o.length&&(r.pop(),r.push(["C",...o.flat()]),o=[]),r})},rH=(t,e)=>{let i=et(t).map((e,i)=>{let n=t[(i+1)%t.length];return{p:e,v:tV(tB(n,e))}});return i.forEach((n,r)=>{let s=r>0?r-1:t.length-1,o=i[s].v,a=tV(tI(o,tz(n.v,tH(o,n.v,!0)<Math.PI?1:-1)));n.p=tI(n.p,tz(a,e))}),e_(i.map(t=>t.p))},rW=(t,e)=>{let i=t.map((i,n)=>{let r=t[0===n?t.length-1:n-1],s=tU(tz(tV(tW(tB(r,i),!1)),e));return[tI(r,s),tI(i,s)]}),n=i.flat(),r=n.map((t,e)=>{if(e%2==0)return null;let i=[n[(e-1)%n.length],n[e%n.length]],r=[n[(e+1)%n.length],n[(e+2)%n.length]];return tq(i,r,!0)}).filter(Boolean);return r.map((t,e)=>[0===e?"M":"L",t[0],t[1]]).concat([["Z"]])};var rG=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};class rY extends n1{constructor(t,e){super(t,Object.assign({},rY.defaultOptions,e)),this.hullMemberIds=[],this.drawHull=()=>{if(this.shape){let t=!(0,A.Z)(this.optionsCache,this.options);this.shape.update(this.getHullStyle(t))}else this.shape=new eZ({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);this.optionsCache=Object.assign({},this.options)},this.updateHullPath=t=>{this.shape&&this.options.members.includes(tv(t.data))&&this.shape.update({d:this.getHullPath(!0)})},this.getHullPath=(t=!1)=>{let{graph:e}=this.context,i=this.getMember();if(0===i.length)return"";let n=i.map(t=>e.getNodeData(t)),r=(function(t,e,i){let n=function(t){let e=[t[0]],i=t[0];for(let n=1;n<t.length;n++){let r=t[n];(i[0]!==r[0]||i[1]!==r[1])&&e.push(r),i=r}return e}(rO.toXy(t,i).sort(function(t,e){return t[0]-e[0]||t[1]-e[1]}));if(n.length<4){let t=n.concat([n[0]]);return i?rO.fromXy(t,i):t}let r=function(t){let e=1/0,i=1/0,n=-1/0,r=-1/0;for(let s=t.length-1;s>=0;s--)t[s][0]<e&&(e=t[s][0]),t[s][1]<i&&(i=t[s][1]),t[s][0]>n&&(n=t[s][0]),t[s][1]>r&&(r=t[s][1]);return[n-e,r-i]}(n),s=[.6*r[0],.6*r[1]],o=(function(t){let e=t.length;if(e<3){let i=Array(e);for(let t=0;t<e;++t)i[t]=t;return 2===e&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:i}let i=Array(e);for(let t=0;t<e;++t)i[t]=t;i.sort((e,i)=>{let n=t[e][0]-t[i][0];return n||t[e][1]-t[i][1]});let n=[i[0],i[1]],r=[i[0],i[1]];for(let s=2;s<e;++s){let e=i[s],o=t[e],a=n.length;for(;a>1&&0>=rI(t[n[a-2]],t[n[a-1]],o);)a-=1,n.pop();for(n.push(e),a=r.length;a>1&&rI(t[r[a-2]],t[r[a-1]],o)>=0;)a-=1,r.pop();r.push(e)}let s=Array(r.length+n.length-2),o=0;for(let t=0,e=n.length;t<e;++t)s[o++]=n[t];for(let t=r.length-2;t>0;--t)s[o++]=r[t];return s})(n).reverse().map(t=>n[t]);o.push(o[0]);let a=n.filter(function(t){return 0>o.indexOf(t)}),l=Math.ceil(1/(n.length/(r[0]*r[1]))),h=function t(e,i,n,r,s){let o=!1;for(let t=0;t<e.length-1;t++){let a,l,h;let d=[e[t],e[t+1]],c=d[0][0]+","+d[0][1]+","+d[1][0]+","+d[1][1];if(rB(d[0],d[1])<i||s.has(c))continue;let u=0,p=[Math.min(d[0][0],d[1][0]),Math.min(d[0][1],d[1][1]),Math.max(d[0][0],d[1][0]),Math.max(d[0][1],d[1][1])];do a=(p=r.extendBbox(p,u))[2]-p[0],l=p[3]-p[1],h=function(t,e,i){let n=null,r=rz,s=rz,o,a;for(let l=0;l<e.length;l++)o=rF(t[0],t[1],e[l]),a=rF(t[1],t[0],e[l]),o>r&&a>s&&!r_([t[0],e[l]],i)&&!r_([t[1],e[l]],i)&&(r=o,s=a,n=e[l]);return n}(d,r.rangePoints(p),e),u++;while(null===h&&(n[0]>a||n[1]>l));a>=n[0]&&l>=n[1]&&s.add(c),null!==h&&(e.splice(t+1,0,h),r.removePoint(h),o=!0)}return o?t(e,i,n,r,s):e}(o,Math.pow(e||20,2),s,new rw(a,l),new Set);return i?rO.fromXy(h,i):h})(n.map(tQ),this.options.concavity).slice(1).reverse(),s=r.flatMap(t=>n.filter(e=>(0,A.Z)(tQ(e),t)).map(tv));return(0,A.Z)(s,this.hullMemberIds)&&!t||(this.hullMemberIds=s,this.path=function(t,e,i){if(1===t.length)return rZ(t[0],e,i);if(2===t.length)return r$(t,e,i);if(3===t.length){let[n,r,s]=et(t);if(tX([n,r],[r,s]))return r$([n,s],e,i)}switch(i){case"smooth":return rH(t,e);case"sharp":return rW(t,e);default:return rV(t,e)}}(r,this.getPadding(),this.options.corner)),this.path},this.bindEvents()}bindEvents(){this.context.graph.on(O.AFTER_RENDER,this.drawHull),this.context.graph.on(O.AFTER_ELEMENT_UPDATE,this.updateHullPath)}unbindEvents(){this.context.graph.off(O.AFTER_RENDER,this.drawHull),this.context.graph.off(O.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(t){let e=this.options,{members:i,padding:n,corner:r}=e,s=rG(e,["members","padding","corner"]);return Object.assign(Object.assign({},s),{d:this.getHullPath(t)})}getPadding(){let{graph:t}=this.context,e=this.hullMemberIds.reduce((e,i)=>{let{halfExtents:n}=t.getElementRenderBounds(i),r=Math.max(n[0],n[1]);return Math.max(e,r)},0);return e+this.options.padding}addMember(t){let e=Array.isArray(t)?t:[t];this.options.members=[...new Set([...this.options.members,...e])],this.shape.update({d:this.getHullPath()})}removeMember(t){let e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(t=>!e.includes(t)),e.some(t=>this.hullMemberIds.includes(t))&&this.shape.update({d:this.getHullPath()})}updateMember(t){this.options.members=(0,J.Z)(t)?t(this.options.members):t,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.unbindEvents(),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}}rY.defaultOptions={members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2};var rU=i(43228);function rK(t){let{width:e,height:i,renderer:n}=t,r=function(t){var e;let{container:i,className:n,graphCanvas:r}=t;if(i)return"string"==typeof i?document.getElementById(i):i;let s=n2(n,!1),{width:o,height:a,containerStyle:l}=t,[h,d]=function(t){let{width:e,height:i,placement:n,graphCanvas:r}=t,[s,o]=r.getSize(),[a,l]=tJ(n);return[a*(s-e),l*(o-i)]}(t);return Object.assign(s.style,Object.assign({position:"absolute",left:h+"px",top:d+"px",width:o+"px",height:a+"px"},l)),null===(e=r.getContainer())||void 0===e||e.appendChild(s),s}(t),s=new C.Xz({width:e,height:i,container:r,renderer:n||new e4.Th});return[r,s]}var rX=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};class rq extends n1{constructor(t,e){super(t,Object.assign({},rq.defaultOptions,e)),this.typePrefix="__data__",this.draw=!1,this.fieldMap={node:new Map,edge:new Map,combo:new Map},this.selectedItems=[],this.bindEvents=()=>{let{graph:t}=this.context;t.on(O.AFTER_DRAW,this.createElement)},this.changeState=(t,e)=>{let{graph:i}=this.context,{typePrefix:n}=this,r=(0,ey.Z)(t,[n,"id"]),s=(0,ey.Z)(t,[n,"style","labelText"]),[o]=r.split("__"),a=this.fieldMap[o].get(s)||[];i.setElementState(Object.fromEntries(null==a?void 0:a.map(t=>[t,e])))},this.click=t=>{if("hover"===this.options.trigger)return;let e=(0,ey.Z)(t,[this.typePrefix,"id"]);this.selectedItems.includes(e)?(this.selectedItems=this.selectedItems.filter(t=>t!==e),this.changeState(t,[])):(this.selectedItems.push(e),this.changeState(t,"selected"))},this.mouseleave=t=>{"click"!==this.options.trigger&&(this.selectedItems=[],this.changeState(t,[]))},this.mouseenter=t=>{if("click"===this.options.trigger)return;let e=(0,ey.Z)(t,[this.typePrefix,"id"]);this.selectedItems.includes(e)?this.selectedItems=this.selectedItems.filter(t=>t!==e):(this.selectedItems.push(e),this.changeState(t,"active"))},this.setFieldMap=(t,e,i)=>{if(!t)return;let n=this.fieldMap[i];if(n){if(n.has(t)){let i=n.get(t);i&&(i.push(e),n.set(t,i))}else n.set(t,[e])}},this.getEvents=()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}),this.getMarkerData=(t,e)=>{if(!t)return[];let{model:i,element:n}=this.context,{nodes:r,edges:s,combos:o}=i.getData(),a={},l=e=>(0,J.Z)(t)?t(e):t,h={node:"circle",edge:"line",combo:"rect"},d={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},c=(t,e)=>{let i=null==n?void 0:n.getElementComputedStyle(t,e);return i},u=(t,e)=>{t.forEach(t=>{let{id:i}=t,r=(0,ey.Z)(t,["data",l(t)]),s=(null==n?void 0:n.getElementType(e,t))||"circle",o=c(e,t),u=("edge"===e?null==o?void 0:o.stroke:null==o?void 0:o.fill)||"#1783ff";i&&r&&r.replace(/\s+/g,"")&&(this.setFieldMap(r,i,e),a[r]||(a[r]={id:`${e}__${i}`,label:r,marker:d[s]||h[e],elementType:e,lineWidth:1,stroke:u,fill:u}))})};switch(e){case"node":u(r,"node");break;case"edge":u(s,"edge");break;case"combo":u(o,"combo");break;default:return[]}return Object.values(a)},this.createElement=()=>{if(this.draw){this.updateElement();return}let t=this.options,{width:e,height:i,nodeField:n,edgeField:r,comboField:s,trigger:o,position:a,container:l,containerStyle:h,className:d}=t,c=rX(t,["width","height","nodeField","edgeField","comboField","trigger","position","container","containerStyle","className"]),u=this.getMarkerData(n,"node"),p=this.getMarkerData(r,"edge"),g=this.getMarkerData(s,"combo"),f=[...u,...g,...p],y=Object.assign({width:e,height:i,data:f,itemMarkerLineWidth:({lineWidth:t})=>t,itemMarker:({marker:t})=>t,itemMarkerStroke:({stroke:t})=>t,itemMarkerFill:({fill:t})=>t,gridCol:u.length},c,this.getEvents()),m=new rU.W({className:"legend",style:y});this.category=m;let v=this.upsertCanvas();v.appendChild(m),this.draw=!0},this.bindEvents()}update(t){super.update(t),this.clear(),this.createElement()}clear(){var t,e;null===(t=this.canvas)||void 0===t||t.destroy(),null===(e=this.container)||void 0===e||e.remove(),this.canvas=void 0,this.container=void 0,this.draw=!1}updateElement(){this.category&&this.category.update({itemMarkerOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5,itemLabelOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5})}upsertCanvas(){if(this.canvas)return this.canvas;let t=this.context.canvas,[e,i]=t.getSize(),{width:n=e,height:r=i,position:s,container:o,containerStyle:a,className:l}=this.options,[h,d]=rK({width:n,height:r,graphCanvas:t,container:o,containerStyle:a,placement:s,className:"legend"});return this.container=h,l&&h.classList.add(l),this.canvas=d,this.canvas}destroy(){this.clear(),this.context.graph.off(O.AFTER_DRAW,this.createElement),super.destroy()}}rq.defaultOptions={position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16,width:240,height:160};class rJ extends n1{constructor(t,e){super(t,Object.assign({},rJ.defaultOptions,e)),this.onDraw=t=>{var e;null!==(e=null==t?void 0:t.data)&&void 0!==e&&e.render||this.onRender()},this.shapes=new Map,this.landmarkMap=new Map,this.mask=null,this.isMaskDragging=!1,this.onMaskDragStart=t=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(t.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))},this.onMaskDrag=t=>{if(!this.mask||!this.isMaskDragging)return;let{size:[e,i]}=this.options,{movementX:n,movementY:r}=t,{left:s,top:o,width:a,height:l}=this.mask.style,[,,h,d]=this.maskBBox,c=parseInt(s)+n,u=parseInt(o)+r,p=parseInt(a),g=parseInt(l);c<0&&(c=0),u<0&&(u=0),c+p>e&&(c=r0(e-p,0)),u+g>i&&(u=r0(i-g,0)),p<h&&(n>0?(c=r0(c-n,0),p=rQ(p+n,e)):n<0&&(p=rQ(p-n,e))),g<d&&(r>0?(u=r0(u-r,0),g=rQ(g+r,i)):r<0&&(g=rQ(g-r,i))),Object.assign(this.mask.style,{left:c+"px",top:u+"px",width:p+"px",height:g+"px"});let f=parseInt(s)-c,y=parseInt(o)-u;if(0===f&&0===y)return;let m=this.context.canvas.getCamera().getZoom(),v=this.canvas.getCamera().getZoom(),b=m/v;this.context.graph.translateBy([f*b,y*b],!1)},this.onMaskDragEnd=t=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(t.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))},this.onTransform=(0,tt.Z)(()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())},32,{leading:!0}),this.setOnRender(),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),"delay"in t&&this.setOnRender(),this.bindEvents()}setOnRender(){this.onRender=(0,np.Z)(()=>{this.renderMinimap(),this.renderMask()},this.options.delay)}bindEvents(){let{graph:t}=this.context;t.on(O.AFTER_DRAW,this.onDraw),t.on(O.AFTER_RENDER,this.onRender),t.on(O.AFTER_ANIMATE,this.onRender),t.on(O.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){let{graph:t}=this.context;t.off(O.AFTER_DRAW,this.onDraw),t.off(O.AFTER_RENDER,this.onRender),t.off(O.AFTER_ANIMATE,this.onRender),t.off(O.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){let t=this.getElements(),e=this.initCanvas();this.setShapes(e,t)}getElements(){let{filter:t}=this.options,{model:e,element:i}=this.context,n=e.getData(),r={nodes:n.nodes.filter(t=>null==i?void 0:i.getElement(tv(t))),edges:n.edges.filter(t=>{let e=null==i?void 0:i.getElement(tv(t));return e&&ns(e)}),combos:n.combos.filter(t=>null==i?void 0:i.getElement(tv(t)))};if(!t)return r;let{nodes:s,edges:o,combos:a}=r;return{nodes:s.filter(e=>t(tv(e),"node")),edges:o.filter(e=>t(tv(e),"edge")),combos:a.filter(e=>t(tv(e),"combo"))}}setShapes(t,e){let{nodes:i,edges:n,combos:r}=e,{shape:s}=this.options,{element:o}=this.context;if("key"===s){let e=new Set,s=i=>{let n=tv(i);e.add(n);let r=o.getElement(n);if(!r)return;let s=r.getShape("key"),a=this.shapes.get(n)||s.cloneNode();a.setPosition(s.getPosition()),r.style.zIndex&&(a.style.zIndex=r.style.zIndex),a.id=r.id,this.shapes.has(n)?Object.entries(s.attributes).forEach(([t,e])=>{a.style[t]!==e&&(a.style[t]=e)}):(t.appendChild(a),this.shapes.set(n,a))};n.forEach(s),r.forEach(s),i.forEach(s),this.shapes.forEach((i,n)=>{e.has(n)||(t.removeChild(i),this.shapes.delete(n))});return}let a=(t,e)=>{let i=o.getElement(t),n=i.getPosition();return e.setPosition(n),e};t.removeChildren(),n.forEach(e=>t.appendChild(s(tv(e),"edge"))),r.forEach(e=>{t.appendChild(a(tv(e),s(tv(e),"combo")))}),i.forEach(e=>{t.appendChild(a(tv(e),s(tv(e),"node")))})}initCanvas(){let{renderer:t,size:[e,i]}=this.options;if(this.canvas){let{width:n,height:r}=this.canvas.getConfig();(e!==n||i!==r)&&this.canvas.resize(e,i),t&&this.canvas.setRenderer(t)}else{let{className:n,position:r,container:s,containerStyle:o}=this.options,[a,l]=rK({renderer:t,width:e,height:i,placement:r,className:"minimap",container:s,containerStyle:o,graphCanvas:this.context.canvas});n&&a.classList.add(n),this.container=a,this.canvas=l}return this.setCamera(),this.canvas}createLandmark(t,e,i){let n=`${t.join(",")}-${e.join(",")}-${i}`;if(this.landmarkMap.has(n))return this.landmarkMap.get(n);let r=this.canvas.getCamera(),s=r.createLandmark(n,{position:t,focalPoint:e,zoom:i});return this.landmarkMap.set(n,s),s}setCamera(){var t;let{canvas:e}=this.context,i=null===(t=this.canvas)||void 0===t?void 0:t.getCamera();if(!i)return;let{size:[n,r],padding:s}=this.options,[o,a,l,h]=tr(s),{min:d,max:c,center:u}=e.getBounds("elements"),p=c[0]-d[0],g=c[1]-d[1],f=this.createLandmark(u,u,Math.min((n-h-a)/p,(r-o-l)/g));i.gotoLandmark(f,0)}get maskBBox(){let{canvas:t}=this.context,e=t.getSize(),i=t.getCanvasByViewport([0,0]),n=t.getCanvasByViewport(e),r=this.canvas.canvas2Viewport(t3(i)),s=this.canvas.canvas2Viewport(t3(n)),o=s.x-r.x,a=s.y-r.y;return[r.x,r.y,o,a]}calculateMaskBBox(){let{size:[t,e]}=this.options,[i,n,r,s]=this.maskBBox;return i<0&&(r=rQ(r+i,t),i=0),n<0&&(s=rQ(s+n,e),n=0),i+r>t&&(r=r0(t-i,0)),n+s>e&&(s=r0(e-n,0)),[rQ(i,t),rQ(n,e),r0(r,0),r0(s,0)]}renderMask(){let{maskStyle:t}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart),this.mask.draggable=!0,this.mask.addEventListener("dragstart",t=>t.preventDefault&&t.preventDefault())),this.container.appendChild(this.mask),Object.assign(this.mask.style,Object.assign(Object.assign({},t),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}updateMask(){if(!this.mask)return;let[t,e,i,n]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:e+"px",left:t+"px",width:i+"px",height:n+"px"})}destroy(){var t,e,i;this.unbindEvents(),null===(t=this.canvas)||void 0===t||t.destroy(),null===(e=this.mask)||void 0===e||e.remove(),null===(i=this.container)||void 0===i||i.remove(),super.destroy()}}rJ.defaultOptions={size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"},delay:128};let rQ=(t,e)=>Math.min(t,e),r0=(t,e)=>Math.max(t,e);var r1=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};let r2={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"};class r3 extends n1{constructor(t,e){super(t,Object.assign({},r3.defaultOptions,e)),this.initSnapline=()=>{let t=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=t.appendChild(new C.x1({style:Object.assign(Object.assign({},r2),this.options.horizontalLineStyle)}))),this.verticalLine||(this.verticalLine=t.appendChild(new C.x1({style:Object.assign(Object.assign({},r2),this.options.verticalLineStyle)})))},this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!0,this.autoSnapToLine=(t,e,i)=>r1(this,void 0,void 0,function*(){let{verticalX:n,horizontalY:r}=i,{tolerance:s}=this.options,{min:[o,a],max:[l,h],center:[d,c]}=e,u=0,p=0;null!==n&&(r6(l,n)<s&&(u=n-l),r6(o,n)<s&&(u=n-o),r6(d,n)<s&&(u=n-d),0!==u&&(this.isVerticalSticking=!0)),null!==r&&(r6(h,r)<s&&(p=r-h),r6(a,r)<s&&(p=r-a),r6(c,r)<s&&(p=r-c),0!==p&&(this.isHorizontalSticking=!0)),(0!==u||0!==p)&&(yield this.context.graph.translateElementBy({[t]:[u,p]},!1))}),this.enableSnap=t=>{let{target:e}=t;if(this.isHorizontalSticking||this.isVerticalSticking){let[i,n]=this.getDelta(t);if(this.isHorizontalSticking&&this.isVerticalSticking&&.5>=Math.abs(i)&&.5>=Math.abs(n))return this.context.graph.translateElementBy({[e.id]:[-i,-n]},!1),!1;if(this.isHorizontalSticking&&.5>=Math.abs(n))return this.context.graph.translateElementBy({[e.id]:[0,-n]},!1),!1;if(this.isVerticalSticking&&.5>=Math.abs(i))return this.context.graph.translateElementBy({[e.id]:[-i,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout(()=>{this.enableStick=!0},200)}return this.enableStick},this.calcSnaplineMetadata=(t,e)=>{let{tolerance:i,shape:n}=this.options,{min:[r,s],max:[o,a],center:[l,h]}=e,d=null,c=null,u=null,p=null,g=null,f=null;return this.getNodes().some(e=>{if((0,A.Z)(t.id,e.id))return!1;let y=r8(e,n).getRenderBounds(),{min:[m,v],max:[b,E],center:[x,O]}=y;return null===d&&(r6(x,l)<i?d=x:r6(m,r)<i?d=m:r6(m,o)<i?d=m:r6(b,o)<i?d=b:r6(b,r)<i&&(d=b),null!==d&&(c=Math.min(v,s),u=Math.max(E,a))),null===p&&(r6(O,h)<i?p=O:r6(v,s)<i?p=v:r6(v,a)<i?p=v:r6(E,a)<i?p=E:r6(E,s)<i&&(p=E),null!==p&&(g=Math.min(m,r),f=Math.max(b,o))),null!==d&&null!==p}),{verticalX:d,verticalMinY:c,verticalMaxY:u,horizontalY:p,horizontalMinX:g,horizontalMaxX:f}},this.onDragStart=()=>{this.initSnapline()},this.onDrag=t=>r1(this,void 0,void 0,function*(){let{target:e}=t;if(this.options.autoSnap){let e=this.enableSnap(t);if(!e)return}let i=r8(e,this.options.shape).getRenderBounds(),n=this.calcSnaplineMetadata(e,i);this.hideSnapline(),(null!==n.verticalX||null!==n.horizontalY)&&this.updateSnapline(n),this.options.autoSnap&&(yield this.autoSnapToLine(e.id,i,n))}),this.onDragEnd=()=>{this.hideSnapline()},this.bindEvents()}getNodes(){var t;let{filter:e}=this.options,i=(null===(t=this.context.element)||void 0===t?void 0:t.getNodes())||[],n=i.filter(t=>{var e;return ns(t)&&(null===(e=this.context.viewport)||void 0===e?void 0:e.isInViewport(t.getRenderBounds()))});return e?n.filter(t=>e(t)):n}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(t){let{lineWidth:e}=this.options[`${t}LineStyle`];return+(e||r2.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(t){let{verticalX:e,verticalMinY:i,verticalMaxY:n,horizontalY:r,horizontalMinX:s,horizontalMaxX:o}=t,[a,l]=this.context.canvas.getSize(),{offset:h}=this.options;null!==r?Object.assign(this.horizontalLine.style,{x1:h===1/0?0:s-h,y1:r,x2:h===1/0?a:o+h,y2:r,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",null!==e?Object.assign(this.verticalLine.style,{x1:e,y1:h===1/0?0:i-h,x2:e,y2:h===1/0?l:n+h,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(t){let e=this.context.graph.getZoom();return t_([t.dx,t.dy],e)}bindEvents(){return r1(this,void 0,void 0,function*(){let{graph:t}=this.context;t.on(S.DRAG_START,this.onDragStart),t.on(S.DRAG,this.onDrag),t.on(S.DRAG_END,this.onDragEnd)})}unbindEvents(){let{graph:t}=this.context;t.off(S.DRAG_START,this.onDragStart),t.off(S.DRAG,this.onDrag),t.off(S.DRAG_END,this.onDragEnd)}destroyElements(){var t,e;null===(t=this.horizontalLine)||void 0===t||t.destroy(),null===(e=this.verticalLine)||void 0===e||e.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}}r3.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0};let r6=(t,e)=>Math.abs(t-e),r8=(t,e)=>"function"==typeof e?e(t):t.getShape(e);var r4=i(57069),r9=i(83262),r5=i(91984),r7=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};let st=["timestamp","time","date","datetime"];class se extends n1{get padding(){return tr(this.options.padding)}constructor(t,e){super(t,Object.assign({},se.defaultOptions,e)),this.backup(),this.upsertTimebar()}play(){var t;null===(t=this.timebar)||void 0===t||t.play()}pause(){var t;null===(t=this.timebar)||void 0===t||t.pause()}forward(){var t;null===(t=this.timebar)||void 0===t||t.forward()}backward(){var t;null===(t=this.timebar)||void 0===t||t.backward()}reset(){var t;null===(t=this.timebar)||void 0===t||t.reset()}update(t){super.update(t),this.backup(),this.upsertTimebar()}backup(){this.originalData=si(this.context.graph.getData())}upsertTimebar(){let{canvas:t}=this.context,e=this.options,{onChange:i,timebarType:n,data:r,x:s,y:o,width:a,height:l,mode:h}=e,d=r7(e,["onChange","timebarType","data","x","y","width","height","mode"]),c=t.getSize(),[u]=this.padding;this.upsertCanvas().ready.then(()=>{var t;let e=Object.assign(Object.assign({x:c[0]/2-a/2,y:u,onChange:t=>{let e=((0,r9.Z)(t)?t:[t,t]).map(t=>(0,r5.Z)(t)?t.getTime():t);"modify"===this.options.mode?this.filterElements(e):this.hiddenElements(e),null==i||i(e)}},d),{data:r.map(t=>(0,W.Z)(t)?{time:t,value:0}:t),width:a,height:l,type:n});this.timebar?this.timebar.update(e):(this.timebar=new r4.s({style:e}),null===(t=this.canvas)||void 0===t||t.appendChild(this.timebar))})}upsertCanvas(){if(this.canvas)return this.canvas;let{className:t,height:e,position:i}=this.options,n=this.context.canvas,[r]=n.getSize(),[s,,o]=this.padding,[a,l]=rK({width:r,height:e+s+o,graphCanvas:n,className:"timebar",placement:i});return this.container=a,t&&a.classList.add(t),this.canvas=l,this.canvas}filterElements(t){var e,i,n,r;return e=this,i=void 0,n=void 0,r=function*(){var e;if(!this.originalData)return;let{elementTypes:i,getTime:n}=this.options,{graph:r,element:s}=this.context,o=si(this.originalData);i.forEach(e=>{let i=`${e}s`;o[i]=(this.originalData[i]||[]).filter(e=>{let i=n(e);return!!sn(i,t)})});let a=[...o.nodes,...o.combos].map(t=>tv(t));o.edges=o.edges.filter(t=>{let e=t.source,i=t.target;return a.includes(e)&&a.includes(i)}),r.setData(o),yield null===(e=s.draw({animation:!1,silence:!0}))||void 0===e?void 0:e.finished},new(n||(n=Promise))(function(t,s){function o(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(e){var i;e.done?t(e.value):((i=e.value)instanceof n?i:new n(function(t){t(i)})).then(o,a)}l((r=r.apply(e,i||[])).next())})}hiddenElements(t){let{graph:e}=this.context,{elementTypes:i,getTime:n}=this.options,r=[],s=[];i.forEach(e=>{var i;let o=`${e}s`,a=(null===(i=this.originalData)||void 0===i?void 0:i[o])||[];a.forEach(e=>{let i=tv(e),o=n(e);sn(o,t)?s.push(i):r.push(i)})}),e.hideElement(r,!1),e.showElement(s,!1)}destroy(){var t,e,i;let{graph:n}=this.context;this.originalData&&n.setData(Object.assign({},this.originalData)),null===(t=this.timebar)||void 0===t||t.destroy(),null===(e=this.canvas)||void 0===e||e.destroy(),null===(i=this.container)||void 0===i||i.remove(),this.originalData=void 0,this.container=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}}se.defaultOptions={position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:t=>sr(t,st,void 0),loop:!1};let si=t=>{let{nodes:e=[],edges:i=[],combos:n=[]}=t;return{nodes:[...e],edges:[...i],combos:[...n]}},sn=(t,e)=>{if((0,W.Z)(e))return t===e;let[i,n]=e;return t>=i&&t<=n},sr=(t,e,i)=>{var n;for(let i=0;i<e.length;i++){let r=e[i],s=null===(n=t.data)||void 0===n?void 0:n[r];if(s)return s}return i},ss=`
  .g6-toolbar {
    position: absolute;
    z-index: 100;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);
    opacity: 0.65;
  }
  .g6-toolbar .g6-toolbar-item {
    display: inline-block;
    width: 16px;
    height: 16px;
    padding: 4px;
    cursor: pointer;
    box-sizing: content-box;
  }

  .g6-toolbar .g6-toolbar-item:hover {
    background-color: #f0f0f0;
  }

  .g6-toolbar .g6-toolbar-item svg {
    display: inline-block;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
`,so=`
  <svg>
    <symbol id="zoom-in" viewBox="64 64 896 896">
      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="zoom-out" viewBox="64 64 896 896">
      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="edit" viewBox="64 64 896 896">
      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>
    </symbol>
    <symbol id="delete" viewBox="64 64 896 896">
      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>
    </symbol>
    <symbol id="redo" viewBox="64 64 896 896">
      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>
    </symbol>
    <symbol id="undo" viewBox="64 64 896 896">
      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>
    </symbol>
    <symbol id="export" viewBox="64 64 896 896">
      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>
    </symbol>
    <symbol id="auto-fit" viewBox="64 64 896 896">
      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>
      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>
    </symbol>
    <symbol id="reset" viewBox="64 64 896 896">
      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>
    </symbol>
    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">
      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>
    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">
      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>
  </svg>
`;var sa=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class sl extends n1{constructor(t,e){super(t,Object.assign({},sl.defaultOptions,e)),this.$element=n2("toolbar",!1),this.onToolbarItemClick=t=>{let{onClick:e}=this.options;if(t.target instanceof Element&&t.target.className.includes("g6-toolbar-item")){let i=t.target.getAttribute("value");null==e||e(i,t.target)}};let i=this.context.canvas.getContainer();this.$element.style.display="flex",i.appendChild(this.$element),n3("g6-toolbar-css","style",{},ss,document.head),n3("g6-toolbar-svgicon","div",{display:"none"},so),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(e)}update(t){let e=Object.create(null,{update:{get:()=>super.update}});return sa(this,void 0,void 0,function*(){e.update.call(this,t);let{className:i,position:n,style:r}=this.options;this.$element.className=`g6-toolbar ${i||""}`,Object.assign(this.$element.style,r,function(t){let e={top:"unset",right:"unset",bottom:"unset",left:"unset"},i=t.split("-");return i.forEach(t=>{e[t]="8px"}),e.flexDirection=t.startsWith("top")||t.startsWith("bottom")?"row":"column",e}(n)),this.$element.innerHTML=yield this.getDOMContent()})}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return sa(this,void 0,void 0,function*(){let t=yield this.options.getItems();return t.map(t=>{var e;return`
          <div class="g6-toolbar-item" value="${t.value}" title="${null!==(e=t.title)&&void 0!==e?e:""}">
            <svg aria-hidden="true" focusable="false">
              <use xlink:href="#${t.id}"></use>
            </svg>
          </div>`}).join("")})}}sl.defaultOptions={position:"top-left"};var sh=i(60953),sd=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class sc extends n1{constructor(t,e){super(t,Object.assign({},sc.defaultOptions,e)),this.currentTarget=null,this.tooltipElement=null,this.container=null,this.isEnable=(t,e)=>{let{enable:i}=this.options;return"function"==typeof i?i(t,e):i},this.onClick=t=>{let{target:{id:e}}=t;this.currentTarget===e?this.hide(t):this.show(t)},this.onPointerMove=t=>{let{target:e}=t;this.currentTarget&&e.id!==this.currentTarget&&this.show(t)},this.onPointerLeave=t=>{this.hide(t)},this.onCanvasMove=t=>{this.hide(t)},this.onPointerOver=t=>{this.show(t)},this.showById=t=>sd(this,void 0,void 0,function*(){yield this.show({target:{id:t}})}),this.getElementData=(t,e)=>{let{model:i}=this.context;switch(e){case"node":return i.getNodeData([t]);case"edge":return i.getEdgeData([t]);case"combo":return i.getComboData([t]);default:return[]}},this.show=t=>sd(this,void 0,void 0,function*(){var e,i;let n,r;let{client:s,target:{id:o}}=t;if(na(t.target))return;let a=this.context.graph.getElementType(o),{getContent:l,title:h}=this.options,d=this.getElementData(o,a);if(!this.tooltipElement||!this.isEnable(t,d))return;let c={};if(l){if(c.content=yield l(t,d),!c.content)return}else{let t=this.context.graph.getElementRenderStyle(o),e="node"===a?t.fill:t.stroke;c={title:h||a,data:d.map(t=>({name:"ID",value:t.id||`${t.source} -> ${t.target}`,color:e}))}}if(this.currentTarget=o,s)n=s.x,r=s.y;else{let t=(0,ey.Z)(d,"0.style",{x:0,y:0});n=t.x,r=t.y}null===(i=(e=this.options).onOpenChange)||void 0===i||i.call(e,!0),this.tooltipElement.update(Object.assign(Object.assign(Object.assign({},this.tooltipStyleProps),{x:n,y:r,style:{".tooltip":{visibility:"visible"}}}),c))}),this.hide=t=>{var e,i,n,r,s;if(!t){null===(i=(e=this.options).onOpenChange)||void 0===i||i.call(e,!1),null===(n=this.tooltipElement)||void 0===n||n.hide(),this.currentTarget=null;return}if(!this.tooltipElement||!this.currentTarget)return;let{client:{x:o,y:a}}=t;null===(s=(r=this.options).onOpenChange)||void 0===s||s.call(r,!1),this.tooltipElement.hide(o,a),this.currentTarget=null},this.initTooltip=()=>{var t;let e=new sh.u({className:"tooltip",style:this.tooltipStyleProps});return null===(t=this.container)||void 0===t||t.appendChild(e.HTMLTooltipElement),e},this.render(),this.bindEvents()}getEvents(){return"click"===this.options.trigger?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerover":this.onPointerOver,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerover":this.onPointerOver,"edge:pointermove":this.onPointerMove,"combo:pointerover":this.onPointerOver,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(t){var e;this.unbindEvents(),super.update(t),this.tooltipElement&&(null===(e=this.container)||void 0===e||e.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){let{canvas:t}=this.context,e=t.getContainer();e&&(this.container=e,this.tooltipElement=this.initTooltip())}unbindEvents(){let{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(i=>{t.off(i,e[i])})}bindEvents(){let{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(i=>{t.on(i,e[i])})}get tooltipStyleProps(){let{canvas:t}=this.context,{center:e}=t.getBounds(),i=t.getContainer(),{top:n,left:r}=i.getBoundingClientRect(),{style:s,position:o,enterable:a,container:l={x:-r,y:-n},title:h,offset:d}=this.options,[c,u]=e,[p,g]=t.getSize();return{x:c,y:u,container:l,title:h,bounding:{x:0,y:0,width:p,height:g},position:o,enterable:a,offset:d,style:s}}destroy(){var t;this.unbindEvents(),this.tooltipElement&&(null===(t=this.container)||void 0===t||t.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}}sc.defaultOptions={trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}};var su=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};function sp(t,e){n||(n=document.createElement("canvas")),n.width=t,n.height=e;let i=n.getContext("2d");return i.clearRect(0,0,t,e),n}var sg=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};class sf extends n1{constructor(t,e){super(t,Object.assign({},sf.defaultOptions,e)),this.$element=n2("watermark");let i=this.context.canvas.getContainer();i.appendChild(this.$element),this.update(e)}update(t){var e,i,n,r;let s=Object.create(null,{update:{get:()=>super.update}});return e=this,i=void 0,n=void 0,r=function*(){s.update.call(this,t);let e=this.options,{width:i,height:n,text:r,imageURL:o}=e,a=sg(e,["width","height","text","imageURL"]);Object.keys(a).forEach(e=>{e.startsWith("background")&&(this.$element.style[e]=t[e])});let l=o?yield function(t,e,i,n){return su(this,void 0,void 0,function*(){let r=sp(t,e),s=r.getContext("2d"),{rotate:o,opacity:a}=n;o&&s.rotate(o),a&&(s.globalAlpha=a);let l=new Image;return l.crossOrigin="anonymous",l.src=i,new Promise(i=>{l.onload=function(){let n=t>l.width?(t-l.width)/2:0,o=e>l.height?(e-l.height)/2:0;s.drawImage(l,0,0,l.width,l.height,n,o,t-2*n,e-2*o),i(r.toDataURL())}})})}(i,n,o,a):yield function(t,e,i,n){return su(this,void 0,void 0,function*(){let r=sp(t,e),s=r.getContext("2d"),{rotate:o,opacity:a,textFill:l,textFontSize:h,textFontFamily:d,textFontVariant:c,textFontWeight:u,textAlign:p,textBaseline:g}=n;return s.textAlign=p,s.textBaseline=g,s.translate(t/2,e/2),s.font=`${h}px ${d} ${c} ${u}`,o&&s.rotate(o),a&&(s.globalAlpha=a),l&&(s.fillStyle=l,s.fillText(`${i}`,0,0)),r.toDataURL()})}(i,n,r,a);this.$element.style.backgroundImage=`url(${l})`},new(n||(n=Promise))(function(t,s){function o(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(e){var i;e.done?t(e.value):((i=e.value)instanceof n?i:new n(function(t){t(i)})).then(o,a)}l((r=r.apply(e,i||[])).next())})}destroy(){super.destroy(),this.$element.remove()}}sf.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"};let sy=["#7E92B5","#F4664A","#FFBE3A"],sm={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},sv={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function sb(t){let{bgColor:e,textColor:i,nodeColor:n,nodeColorDisabled:r,nodeStroke:s,nodeHaloStrokeOpacityActive:o=.15,nodeHaloStrokeOpacitySelected:a=.25,nodeOpacityDisabled:l=.06,nodeIconOpacityInactive:h=.85,nodeOpacityInactive:d=.25,nodeBadgePalette:c=sy,nodePaletteOptions:u=sm,edgeColor:p,edgeColorDisabled:g,edgePaletteOptions:f=sv,comboColor:y,comboColorDisabled:m,comboStroke:v,comboStrokeDisabled:b,edgeColorInactive:E}=t;return{background:e,node:{palette:u,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:c,fill:n,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:i,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:n,portLineWidth:1,portStroke:s,portStrokeOpacity:.65,size:32,stroke:s,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:a,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:s},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:o},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:s,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:d,donutOpacity:d,fillOpacity:d,iconOpacity:h,labelFill:i,labelFillOpacity:d,strokeOpacity:d},disabled:{badgeBackgroundOpacity:.25,donutOpacity:l,fill:r,fillOpacity:l,iconFill:r,iconOpacity:.25,labelFill:i,labelFillOpacity:.25,strokeOpacity:l}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:f,style:{badgeBackgroundFill:p,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:i,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:p,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:E,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:g,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:e,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:y,halo:!1,haloLineWidth:12,haloStroke:v,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:i,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:v},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:m,fillOpacity:.25,labelOpacity:.25,stroke:b,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}let sE=sb({bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:{type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"}),sx=sb({bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"});class sO extends tR{beforeDraw(t,e){return t}afterLayout(t,e){}}function sw(t,e,i,n,r){let s=tv(n),o=`${i}s`,a=r?n:t.add[o].get(s)||t.update[o].get(s)||t.remove[o].get(s)||n;Object.entries(t).forEach(([t,i])=>{e===t?i[o].set(s,a):i[o].delete(s)})}function sS(t,e){return Object.keys(t).every(i=>t[i]===e[i])}let sD=(t,e,i,n)=>{let r=`${i}s`,s=tv(n);t.add[r].has(s)||t.update[r].has(s)||t[e][r].set(tv(n),n)};new WeakMap;let sM=(t,e,i=2)=>{if("object"!=typeof t||"object"!=typeof e)return t===e;let n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(let r of n){let n=t[r],s=e[r];if(i>1&&"object"==typeof n&&"object"==typeof s){if(!sM(n,s,i-1))return!1}else if(n!==s)return!1}return!0};function sC(t,e,i){let n=I[t][e];n&&_.warn(`The extension ${e} of ${t} has been registered before, and will be overridden.`),Object.assign(I[t],{[e]:i})}var sT=i(72225),sP=i(39559),sA=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})},sR=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};let sL=["main"],sk=["background","main","label","transient"];class sN{getConfig(){return this.config}getLayer(t="main"){return this.extends.layers[t]||this.getLayers().main}getLayers(){return this.extends.layers}getRenderer(t){return this.extends.renderers[t]}getCamera(t="main"){return this.getLayer(t).getCamera()}getRoot(t="main"){return this.getLayer(t).getRoot()}getContextService(t="main"){return this.getLayer(t).getContextService()}setCursor(t){this.config.cursor=t,this.getLayer().setCursor(t)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}constructor(t){this.config={enableMultiLayer:!0},Object.assign(this.config,t);let e=this.config,{renderer:i,background:n,cursor:r,enableMultiLayer:s}=e,o=sR(e,["renderer","background","cursor","enableMultiLayer"]),a=s?sk:sL,l=sj(i,a),h=Object.fromEntries(a.map(t=>{let e=new C.Xz(Object.assign(Object.assign({},o),{supportsMutipleCanvasesInOneContainer:s,renderer:l[t],background:s?"background"===t?n:void 0:n}));return[t,e]}));sI(h),this.extends={config:this.config,renderer:i,renderers:l,layers:h}}get ready(){return Promise.all(Object.entries(this.getLayers()).map(([,t])=>t.ready))}resize(t,e){Object.assign(this.extends.config,{width:t,height:e}),Object.values(this.getLayers()).forEach(i=>{let n=i.getCamera(),r=n.getPosition(),s=n.getFocalPoint();i.resize(t,e),n.setPosition(r),n.setFocalPoint(s)})}getBounds(t){return tc(Object.values(this.getLayers()).map(e=>{let i=t?e.getRoot().childNodes.find(e=>e.classList.includes(t)):e.getRoot();return i}).filter(t=>(null==t?void 0:t.childNodes.length)>0).map(t=>t.getBounds()))}getContainer(){let t=this.extends.config.container;return"string"==typeof t?document.getElementById(t):t}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(t,e){var i;let n=(null===(i=t.style)||void 0===i?void 0:i.$layer)||"main";return this.getLayer(n).appendChild(t,e)}setRenderer(t){if(t===this.extends.renderer)return;let e=sj(t,this.config.enableMultiLayer?sk:sL);this.extends.renderers=e,Object.entries(e).forEach(([t,e])=>this.getLayer(t).setRenderer(e)),sI(this.getLayers())}getCanvasByViewport(t){return t2(this.getLayer().viewport2Canvas(t3(t)))}getViewportByCanvas(t){return t2(this.getLayer().canvas2Viewport(t3(t)))}getViewportByClient(t){return t2(this.getLayer().client2Viewport(t3(t)))}getClientByViewport(t){return t2(this.getLayer().viewport2Client(t3(t)))}getClientByCanvas(t){return this.getClientByViewport(this.getViewportByCanvas(t))}getCanvasByClient(t){let e=this.getLayer(),i=e.client2Viewport(t3(t));return t2(e.viewport2Canvas(i))}toDataURL(){return sA(this,arguments,void 0,function*(t={}){let e=globalThis.devicePixelRatio||1,{mode:i="viewport"}=t,n=sR(t,["mode"]),[r,s,o,a]=[0,0,0,0];if("viewport"===i)[o,a]=this.getSize();else if("overall"===i){let t=this.getBounds(),e=ta(t);[r,s]=t.min,[o,a]=e}let l=(0,sP.L)('<div id="virtual-image"></div>'),h=new C.Xz({width:o,height:a,renderer:new e4.Th,devicePixelRatio:e,container:l,background:this.extends.config.background});yield h.ready,h.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),h.appendChild(this.getRoot().cloneNode(!0));let d=this.getLayer("label").getRoot().cloneNode(!0),c=h.viewport2Canvas({x:0,y:0}),u=this.getCanvasByViewport([0,0]);d.translate([u[0]-c.x,u[1]-c.y]),d.scale(1/this.getCamera().getZoom()),h.appendChild(d),h.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));let p=this.getCamera(),g=h.getCamera();if("viewport"===i)g.setZoom(p.getZoom()),g.setPosition(p.getPosition()),g.setFocalPoint(p.getFocalPoint());else if("overall"===i){let[t,e,i]=g.getPosition(),[n,o,a]=g.getFocalPoint();g.setPosition([t+r,e+s,i]),g.setFocalPoint([n+r,o+s,a])}let f=h.getContextService();return new Promise(t=>{h.addEventListener(C.$6.RERENDER,()=>sA(this,void 0,void 0,function*(){yield new Promise(t=>setTimeout(t,300));let e=yield f.toDataURL(n);t(e)}))})})}destroy(){Object.values(this.getLayers()).forEach(t=>{let e=t.getCamera();e.cancelLandmarkAnimation(),t.destroy()})}}function sj(t,e){return Object.fromEntries(e.map(e=>{let i=(null==t?void 0:t(e))||new e4.Th;return i instanceof e4.Th&&i.setConfig({enableDirtyRectangleRendering:!1}),"main"===e?i.registerPlugin(new sT.S({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):i.unregisterPlugin(i.getPlugin("dom-interaction")),[e,i]}))}function sI(t){Object.entries(t).forEach(([t,e])=>{let i=e.getContextService().getDomElement();(null==i?void 0:i.style)&&(i.style.gridArea="1 / 1 / 2 / 2",i.style.outline="none",i.tabIndex=1,"main"!==t&&(i.style.pointerEvents="none")),(null==i?void 0:i.parentElement)&&(i.parentElement.style.display="grid",i.parentElement.style.isolation="isolate")})}let sB=t=>t?parseInt(t):0;function sF(t){if(!t)return[0,0];let e=640,i=480,[n,r]=function(t){let e=getComputedStyle(t),i=t.clientWidth||sB(e.width),n=t.clientHeight||sB(e.height),r=sB(e.paddingLeft)+sB(e.paddingRight),s=sB(e.paddingTop)+sB(e.paddingBottom);return[i-r,n-s]}(t);return e=n||e,i=r||i,[Math.max((0,W.Z)(e)?e:1,1),Math.max((0,W.Z)(i)?i:1,1)]}class s_{constructor(t){this.type=t}}class sz extends s_{constructor(t,e){super(t),this.data=e}}class sZ extends s_{constructor(t,e,i,n){super(t),this.animationType=e,this.animation=i,this.data=n}}class s$ extends s_{constructor(t,e,i){super(t),this.elementType=e,this.data=i}}class sV extends s_{constructor(t,e){super(t),this.data=e}}function sH(t,e){t.emit(e.type,e)}function sW(t){var e;return(null===(e=null==t?void 0:t.style)||void 0===e?void 0:e.zIndex)||0}let sG="cachedStyle",sY=t=>`__${t}__`;function sU(t,e){return(0,ey.Z)(t,[sG,sY(e)])}class sK{constructor(t){this.tasks=[],this.animations=new Set,this.context=t}getTasks(){let t=[...this.tasks];return this.tasks=[],t}add(t,e){this.tasks.push([t,e])}animate(t,e,i){var n,r,s;null===(n=null==e?void 0:e.before)||void 0===n||n.call(e);let o=this.getTasks().map(([e,n])=>{var r,s,o;let{element:a,elementType:l,stage:h}=e,d=function(t,e,i,n){var r,s;let{animation:o}=t;if(!1===o||!1===n)return[];let a=null===(r=null==t?void 0:t[e])||void 0===r?void 0:r.animation;if(!1===a)return[];let l=null==a?void 0:a[i];if(!1===l)return[];let h=null===(s=z(t)[e])||void 0===s?void 0:s.animation,d=(t=[])=>(function(t){if("string"==typeof t){let e=B(D.ANIMATION,t);return e||(_.warn(`The animation of ${t} is not registered.`),[])}return t})(t).map(t=>Object.assign(Object.assign(Object.assign(Object.assign({},k),(0,R.Z)(o)&&o),t),(0,R.Z)(n)&&n));if(l)return d(l);if(!h)return[];let c=h[i];return!1===c?[]:d(c)}(this.context.options,l,h,t);null===(r=null==n?void 0:n.before)||void 0===r||r.call(n);let c=d.length?U(a,this.inferStyle(e,i),d):null;return c?(null===(s=null==n?void 0:n.beforeAnimate)||void 0===s||s.call(n,c),c.finished.then(()=>{var t,e;null===(t=null==n?void 0:n.afterAnimate)||void 0===t||t.call(n,c),null===(e=null==n?void 0:n.after)||void 0===e||e.call(n),this.animations.delete(c)})):null===(o=null==n?void 0:n.after)||void 0===o||o.call(n),c}).filter(Boolean);o.forEach(t=>this.animations.add(t));let a=Z(o);return a?(null===(r=null==e?void 0:e.beforeAnimate)||void 0===r||r.call(e,a),a.finished.then(()=>{var t,i;null===(t=null==e?void 0:e.afterAnimate)||void 0===t||t.call(e,a),null===(i=null==e?void 0:e.after)||void 0===i||i.call(e),this.release()})):null===(s=null==e?void 0:e.after)||void 0===s||s.call(e),a}inferStyle(t,e){var i,n;let{element:r,elementType:s,stage:o,originalStyle:a,updatedStyle:l={}}=t;t.modifiedStyle||(t.modifiedStyle=Object.assign(Object.assign({},a),l));let{modifiedStyle:h}=t,d={},c={};if("enter"===o)Object.assign(d,{opacity:0});else if("exit"===o)Object.assign(c,{opacity:0});else if("show"===o)Object.assign(d,{opacity:0}),Object.assign(c,{opacity:null!==(i=sU(r,"opacity"))&&void 0!==i?i:V("opacity")});else if("hide"===o)Object.assign(d,{opacity:null!==(n=sU(r,"opacity"))&&void 0!==n?n:V("opacity")}),Object.assign(c,{opacity:0});else if("collapse"===o){let{collapse:t}=e||{},{target:i,descendants:n,position:o}=t;if("node"===s){if(n.includes(r.id)){let[t,e,i]=o;Object.assign(c,{x:t,y:e,z:i})}}else if("combo"===s){if(r.id===i||n.includes(r.id)){let[t,e]=o;Object.assign(c,{x:t,y:e,childrenNode:a.childrenNode})}}else"edge"===s&&Object.assign(c,{sourceNode:h.sourceNode,targetNode:h.targetNode})}else if("expand"===o){let{expand:t}=e||{},{target:i,descendants:n,position:o}=t;if("node"===s){if(r.id===i||n.includes(r.id)){let[t,e,i]=o;Object.assign(d,{x:t,y:e,z:i})}}else if("combo"===s){if(r.id===i||n.includes(r.id)){let[t,e,i]=o;Object.assign(d,{x:t,y:e,z:i,childrenNode:h.childrenNode})}}else"edge"===s&&Object.assign(d,{sourceNode:h.sourceNode,targetNode:h.targetNode})}return[Object.keys(d).length>0?Object.assign({},a,d):a,Object.keys(c).length>0?Object.assign({},h,c):h]}stop(){this.animations.forEach(t=>t.cancel())}clear(){this.tasks=[]}release(){var t,e;let{canvas:i}=this.context,n=null===(e=null===(t=i.document)||void 0===t?void 0:t.timeline)||void 0===e?void 0:e.animationsWithPromises;n&&(i.document.timeline.animationsWithPromises=n.filter(t=>"finished"!==t.playState))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}class sX{constructor(t){this.batchCount=0,this.context=t}emit(t){let{graph:e}=this.context;e.emit(t.type,t)}startBatch(t=!0){this.batchCount++,1===this.batchCount&&this.emit(new sz(O.BATCH_START,{initiate:t}))}endBatch(){this.batchCount--,0===this.batchCount&&this.emit(new sz(O.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}class sq extends tA{constructor(t){super(t),this.currentTarget=null,this.currentTargetType=null,this.category="behavior",this.forwardCanvasEvents=t=>{let{target:e}=t,i=function(t){if(!t)return null;if(t instanceof C.BB)return{type:"canvas",element:t};let e=t;for(;e;){if(i2(e))return{type:"node",element:e};if(i3(e))return{type:"edge",element:e};if(i6(e))return{type:"combo",element:e};e=e.parentElement}return null}(e);if(!i)return;let{graph:n,canvas:r}=this.context,{type:s,element:o}=i;if("destroyed"in o&&(na(o)||o.destroyed))return;let{type:a,detail:l,button:h}=t,d=Object.assign(Object.assign({},t),{target:o,targetType:s,originalTarget:e});a===b.POINTER_MOVE&&(this.currentTarget!==o&&(this.currentTarget&&n.emit(`${this.currentTargetType}:${b.POINTER_LEAVE}`,Object.assign(Object.assign({},d),{type:b.POINTER_LEAVE,target:this.currentTarget,targetType:this.currentTargetType})),o&&(Object.assign(d,{type:b.POINTER_ENTER}),n.emit(`${s}:${b.POINTER_ENTER}`,d))),this.currentTarget=o,this.currentTargetType=s),a===b.CLICK&&2===h||(n.emit(`${s}:${a}`,d),n.emit(a,d)),a===b.CLICK&&2===l&&(Object.assign(d,{type:b.DBLCLICK}),n.emit(`${s}:${b.DBLCLICK}`,d),n.emit(b.DBLCLICK,d)),a===b.POINTER_DOWN&&2===h&&(Object.assign(d,{type:b.CONTEXT_MENU,preventDefault:()=>{var t;null===(t=r.getContainer())||void 0===t||t.addEventListener(b.CONTEXT_MENU,t=>t.preventDefault(),{once:!0})}}),n.emit(`${s}:${b.CONTEXT_MENU}`,d),n.emit(b.CONTEXT_MENU,d))},this.forwardContainerEvents=t=>{this.context.graph.emit(t.type,t)},this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(t){this.setExtensions(t)}forwardEvents(){let t=this.context.canvas.getContainer();t&&[E.KEY_DOWN,E.KEY_UP].forEach(e=>{t.addEventListener(e,this.forwardContainerEvents)});let e=this.context.canvas.document;e&&[b.CLICK,b.DBLCLICK,b.POINTER_OVER,b.POINTER_LEAVE,b.POINTER_ENTER,b.POINTER_MOVE,b.POINTER_OUT,b.POINTER_DOWN,b.POINTER_UP,b.CONTEXT_MENU,b.DRAG_START,b.DRAG,b.DRAG_END,b.DRAG_ENTER,b.DRAG_OVER,b.DRAG_LEAVE,b.DROP,b.WHEEL].forEach(t=>{e.addEventListener(t,this.forwardCanvasEvents)})}destroy(){let t=this.context.canvas.getContainer();t&&[E.KEY_DOWN,E.KEY_UP].forEach(e=>{t.removeEventListener(e,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}var sJ=i(68731),sQ=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};function s0(t,e){let{data:i,style:n}=t,r=sQ(t,["data","style"]),{data:s,style:o}=e,a=sQ(e,["data","style"]),l=Object.assign(Object.assign({},r),a);return(i||s)&&Object.assign(l,{data:Object.assign(Object.assign({},i),s)}),(n||o)&&Object.assign(l,{style:Object.assign(Object.assign({},n),o)}),l}function s1(t){let{data:e,style:i}=t,n=sQ(t,["data","style"]);return e&&(n.data=Object.assign({},e)),i&&(n.style=Object.assign({},i)),n}function s2(t={},e={}){let{states:i=[],data:n={},style:r={},children:s=[]}=t,o=sQ(t,["states","data","style","children"]),{states:a=[],data:l={},style:h={},children:d=[]}=e,c=sQ(e,["states","data","style","children"]),u=(t,e)=>t.length===e.length&&t.every((t,i)=>t===e[i]),p=(t,e)=>{let i=Object.keys(t),n=Object.keys(e);return i.length===n.length&&i.every(i=>t[i]===e[i])};return!!(p(o,c)&&u(s,d)&&u(i,a)&&p(n,l)&&p(r,h))}var s3=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};function s6(t){let{id:e=tv(t),style:i,data:n}=t,r=s3(t,["id","style","data"]),s=Object.assign(Object.assign({},t),{style:Object.assign({},i),data:Object.assign({},n)});return"source"in t&&"target"in t?Object.assign({id:e,data:s},r):{id:e,data:s}}function s8(t){return t.data}class s4{constructor(){this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new nv.k}pushChange(t){if(this.isTraceless)return;let{type:e}=t;if(e===f.NodeUpdated||e===f.EdgeUpdated||e===f.ComboUpdated){let{value:i,original:n}=t;this.changes.push({value:s1(i),original:s1(n),type:e})}else this.changes.push({value:s1(t.value),type:e})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(t){this.batchCount++,this.model.batch(t),this.batchCount--}isBatching(){return this.batchCount>0}silence(t){this.isTraceless=!0,t(),this.isTraceless=!1}isCombo(t){return this.comboIds.has(t)||this.latestRemovedComboIds.has(t)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(t){return this.model.getAllNodes().reduce((e,i)=>{let n=s8(i);return this.isCombo(tv(n))||(void 0===t?e.push(n):t.includes(tv(n))&&e.push(n)),e},[])}getEdgeDatum(t){return s8(this.model.getEdge(t))}getEdgeData(t){return this.model.getAllEdges().reduce((e,i)=>{let n=s8(i);return void 0===t?e.push(n):t.includes(tv(n))&&e.push(n),e},[])}getComboData(t){return this.model.getAllNodes().reduce((e,i)=>{let n=s8(i);return this.isCombo(tv(n))&&(void 0===t?e.push(n):t.includes(tv(n))&&e.push(n)),e},[])}getRootsData(t=j){return this.model.getRoots(t).map(s8)}getAncestorsData(t,e){let{model:i}=this;return i.hasNode(t)&&i.hasTreeStructure(e)?i.getAncestors(t,e).map(s8):[]}getDescendantsData(t){let e=this.getElementDataById(t),i=[];return eh(e,t=>{t!==e&&i.push(t)},t=>this.getChildrenData(tv(t)),"TB"),i}getParentData(t,e){let{model:i}=this;if(!e){_.warn("The hierarchy structure key is not specified");return}if(!i.hasNode(t)||!i.hasTreeStructure(e))return;let n=i.getParent(t,e);return n?s8(n):void 0}getChildrenData(t){let e="node"===this.getElementType(t)?j:N,{model:i}=this;return i.hasNode(t)&&i.hasTreeStructure(e)?i.getChildren(t,e).map(s8):[]}getElementsDataByType(t){return"node"===t?this.getNodeData():"edge"===t?this.getEdgeData():"combo"===t?this.getComboData():[]}getElementDataById(t){let e=this.getElementType(t);return"edge"===e?this.getEdgeDatum(t):this.getNodeLikeDatum(t)}getNodeLikeDatum(t){let e=this.model.getNode(t);return s8(e)}getNodeLikeData(t){return this.model.getAllNodes().reduce((e,i)=>{let n=s8(i);return t?t.includes(tv(n))&&e.push(n):e.push(n),e},[])}getElementDataByState(t,e){let i=this.getElementsDataByType(t);return i.filter(t=>{var i;return null===(i=t.states)||void 0===i?void 0:i.includes(e)})}getElementState(t){var e;return(null===(e=this.getElementDataById(t))||void 0===e?void 0:e.states)||[]}hasNode(t){return this.model.hasNode(t)&&!this.isCombo(t)}hasEdge(t){return this.model.hasEdge(t)}hasCombo(t){return this.model.hasNode(t)&&this.isCombo(t)}getRelatedEdgesData(t,e="both"){return this.model.getRelatedEdges(t,e).map(s8)}getNeighborNodesData(t){return this.model.getNeighbors(t).map(s8)}setData(t){let{nodes:e=[],edges:i=[],combos:n=[]}=t,{nodes:r,edges:s,combos:o}=this.getData(),a=tT(r,e,t=>tv(t),s2),l=tT(s,i,t=>tv(t),s2),h=tT(o,n,t=>tv(t),s2);this.batch(()=>{let t={nodes:a.enter,edges:l.enter,combos:h.enter};this.addData(t),this.computeZIndex(t,"add",!0);let e={nodes:a.update,edges:l.update,combos:h.update};this.updateData(e),this.computeZIndex(e,"update",!0);let i={nodes:a.exit.map(tv),edges:l.exit.map(tv),combos:h.exit.map(tv)};this.removeData(i)})}addData(t){let{nodes:e,edges:i,combos:n}=t;this.batch(()=>{this.addComboData(n),this.addNodeData(e),this.addEdgeData(i)}),this.computeZIndex(t,"add")}addNodeData(t=[]){t.length&&(this.model.addNodes(t.map(t=>(this.pushChange({value:t,type:f.NodeAdded}),s6(t)))),this.updateNodeLikeHierarchy(t),this.computeZIndex({nodes:t},"add"))}addEdgeData(t=[]){t.length&&(this.model.addEdges(t.map(t=>(this.pushChange({value:t,type:f.EdgeAdded}),s6(t)))),this.computeZIndex({edges:t},"add"))}addComboData(t=[]){if(!t.length)return;let{model:e}=this;e.hasTreeStructure(N)||e.attachTreeStructure(N),e.addNodes(t.map(t=>(this.comboIds.add(tv(t)),this.pushChange({value:t,type:f.ComboAdded}),s6(t)))),this.updateNodeLikeHierarchy(t),this.computeZIndex({combos:t},"add")}addChildrenData(t,e){let i=this.getNodeLikeDatum(t),n=e.map(tv);this.addNodeData(e),this.updateNodeData([{id:t,children:[...i.children||[],...n]}]),this.addEdgeData(n.map(e=>({source:t,target:e})))}computeZIndex(t,e,i=!1){!i&&this.isBatching()||this.batch(()=>{let{nodes:i=[],edges:n=[],combos:r=[]}=t;r.forEach(t=>{var i,n,r;let s=tv(t);if("add"===e&&(0,W.Z)(null===(i=t.style)||void 0===i?void 0:i.zIndex)||"update"===e&&!("combo"in t))return;let o=this.getParentData(s,N),a=o?(null!==(r=null===(n=o.style)||void 0===n?void 0:n.zIndex)&&void 0!==r?r:0)+1:0;this.preventUpdateNodeLikeHierarchy(()=>{this.updateComboData([{id:s,style:{zIndex:a}}])})}),i.forEach(t=>{var i,n,r;let s=tv(t);if("add"===e&&(0,W.Z)(null===(i=t.style)||void 0===i?void 0:i.zIndex)||"update"===e&&!("combo"in t)&&!("children"in t))return;let o=0,a=this.getParentData(s,N);if(a)o=((null===(n=a.style)||void 0===n?void 0:n.zIndex)||0)+1;else{let t=this.getParentData(s,j);t&&(o=(null===(r=null==t?void 0:t.style)||void 0===r?void 0:r.zIndex)||0)}this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:s,style:{zIndex:o}}])})}),n.forEach(t=>{var e,i,n,r,s;if((0,W.Z)(null===(e=t.style)||void 0===e?void 0:e.zIndex))return;let{id:o,source:a,target:l}=t;if(o){let t=this.getEdgeDatum(o);a=t.source,l=t.target}else o=tv(t);if(!a||!l)return;let h=(null===(n=null===(i=this.getNodeLikeDatum(a))||void 0===i?void 0:i.style)||void 0===n?void 0:n.zIndex)||0,d=(null===(s=null===(r=this.getNodeLikeDatum(l))||void 0===r?void 0:r.style)||void 0===s?void 0:s.zIndex)||0;this.updateEdgeData([{id:tv(t),style:{zIndex:Math.max(h,d)-1}}])})})}getFrontZIndex(t){var e;let i=this.getElementType(t),n=this.getElementDataById(t),r=this.getData();if(Object.assign(r,{[`${i}s`]:r[`${i}s`].filter(e=>tv(e)!==t)}),"combo"===i&&!ef(n)){let e=new Set(this.getAncestorsData(t,N).map(tv));r.nodes=r.nodes.filter(t=>!e.has(tv(t))),r.combos=r.combos.filter(t=>!e.has(tv(t))),r.edges=r.edges.filter(({source:t,target:i})=>!e.has(t)&&!e.has(i))}return Math.max((null===(e=n.style)||void 0===e?void 0:e.zIndex)||0,0,...Object.values(r).flat().map(t=>{var e;return((null===(e=null==t?void 0:t.style)||void 0===e?void 0:e.zIndex)||0)+1}))}updateNodeLikeHierarchy(t){if(!this.enableUpdateNodeLikeHierarchy)return;let{model:e}=this;t.forEach(t=>{let i=tv(t),n=t.combo;void 0!==n&&(e.hasTreeStructure(N)||e.attachTreeStructure(N),null===n&&this.refreshComboData(i),this.setParent(i,t.combo,N));let r=t.children||[];if(r.length){e.hasTreeStructure(j)||e.attachTreeStructure(j);let t=r.filter(t=>e.hasNode(t));t.forEach(t=>this.setParent(t,i,j)),t.length!==r.length&&this.updateNodeData([{id:i,children:t}])}})}preventUpdateNodeLikeHierarchy(t){this.enableUpdateNodeLikeHierarchy=!1,t(),this.enableUpdateNodeLikeHierarchy=!0}updateData(t){let{nodes:e,edges:i,combos:n}=t;this.batch(()=>{this.updateNodeData(e),this.updateComboData(n),this.updateEdgeData(i)}),this.computeZIndex(t,"update")}updateNodeData(t=[]){if(!t.length)return;let{model:e}=this;this.batch(()=>{let i=[];t.forEach(t=>{let n=tv(t),r=s8(e.getNode(n));if(s2(r,t))return;let s=s0(r,t);this.pushChange({value:s,original:r,type:f.NodeUpdated}),e.mergeNodeData(n,s),i.push(s)}),this.updateNodeLikeHierarchy(i)}),this.computeZIndex({nodes:t},"update")}refreshData(){let{nodes:t,edges:e,combos:i}=this.getData();t.forEach(t=>{this.pushChange({value:t,original:t,type:f.NodeUpdated})}),e.forEach(t=>{this.pushChange({value:t,original:t,type:f.EdgeUpdated})}),i.forEach(t=>{this.pushChange({value:t,original:t,type:f.ComboUpdated})})}syncNodeLikeDatum(t){let{model:e}=this,i=tv(t);if(!e.hasNode(i))return;let n=s8(e.getNode(i)),r=s0(n,t);e.mergeNodeData(i,r)}syncEdgeDatum(t){let{model:e}=this,i=tv(t);if(!e.hasEdge(i))return;let n=s8(e.getEdge(i)),r=s0(n,t);e.mergeEdgeData(i,r)}updateEdgeData(t=[]){if(!t.length)return;let{model:e}=this;this.batch(()=>{t.forEach(t=>{let i=tv(t),n=s8(e.getEdge(i));if(s2(n,t))return;t.source&&n.source!==t.source&&e.updateEdgeSource(i,t.source),t.target&&n.target!==t.target&&e.updateEdgeTarget(i,t.target);let r=s0(n,t);this.pushChange({value:r,original:n,type:f.EdgeUpdated}),e.mergeEdgeData(i,r)})}),this.computeZIndex({edges:t},"update")}updateComboData(t=[]){if(!t.length)return;let{model:e}=this;e.batch(()=>{let i=[];t.forEach(t=>{let n=tv(t),r=s8(e.getNode(n));if(s2(r,t))return;let s=s0(r,t);this.pushChange({value:s,original:r,type:f.ComboUpdated}),e.mergeNodeData(n,s),i.push(s)}),this.updateNodeLikeHierarchy(i)}),this.computeZIndex({combos:t},"update")}setParent(t,e,i,n=!0){if(t===e)return;let r=this.getNodeLikeDatum(t),s=r.combo;s!==e&&i===N&&(this.isCombo(t),this.syncNodeLikeDatum({id:t,combo:e})),this.model.setParent(t,e,i),n&&i===N&&(0,sJ.Z)([s,e]).forEach(t=>{void 0!==t&&this.refreshComboData(t)})}refreshComboData(t){let e=this.getComboData([t])[0],i=this.getAncestorsData(t,N);e&&this.pushChange({value:e,original:e,type:f.ComboUpdated}),i.forEach(t=>{this.pushChange({value:t,original:t,type:f.ComboUpdated})})}getElementPosition(t){let e=this.getElementDataById(t);return tQ(e)}translateNodeLikeBy(t,e){this.isCombo(t)?this.translateComboBy(t,e):this.translateNodeBy(t,e)}translateNodeLikeTo(t,e){this.isCombo(t)?this.translateComboTo(t,e):this.translateNodeTo(t,e)}translateNodeBy(t,e){let i=this.getElementPosition(t),n=tI(i,[...e,0].slice(0,3));this.translateNodeTo(t,n)}translateNodeTo(t,e){let[i=0,n=0,r=0]=e;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:t,style:{x:i,y:n,z:r}}])})}translateComboBy(t,e){let[i=0,n=0,r=0]=e;if([i,n,r].some(isNaN)||[i,n,r].every(t=>0===t))return;let s=this.getComboData([t])[0];if(!s)return;let o=new Set;eh(s,t=>{let e=tv(t);if(o.has(e))return;o.add(e);let[s,a,l]=tQ(t),h=s0(t,{style:{x:s+i,y:a+n,z:l+r}});this.pushChange({value:h,original:t,type:this.isCombo(e)?f.ComboUpdated:f.NodeUpdated}),this.model.mergeNodeData(e,h)},t=>this.getChildrenData(tv(t)),"BT")}translateComboTo(t,e){var i;if(e.some(isNaN))return;let[n=0,r=0,s=0]=e,o=null===(i=this.getComboData([t]))||void 0===i?void 0:i[0];if(!o)return;let[a,l,h]=tQ(o),d=n-a,c=r-l,u=s-h;eh(o,t=>{let e=tv(t),[i,n,r]=tQ(t),s=s0(t,{style:{x:i+d,y:n+c,z:r+u}});this.pushChange({value:s,original:t,type:this.isCombo(e)?f.ComboUpdated:f.NodeUpdated}),this.model.mergeNodeData(e,s)},t=>this.getChildrenData(tv(t)),"BT")}removeData(t){let{nodes:e,edges:i,combos:n}=t;this.batch(()=>{this.removeEdgeData(i),this.removeNodeData(e),this.removeComboData(n),this.latestRemovedComboIds=new Set(n)})}removeNodeData(t=[]){t.length&&this.batch(()=>{t.forEach(t=>{this.removeEdgeData(this.getRelatedEdgesData(t).map(tv)),this.pushChange({value:this.getNodeData([t])[0],type:f.NodeRemoved}),this.removeNodeLikeHierarchy(t)}),this.model.removeNodes(t)})}removeEdgeData(t=[]){t.length&&(t.forEach(t=>this.pushChange({value:this.getEdgeData([t])[0],type:f.EdgeRemoved})),this.model.removeEdges(t))}removeComboData(t=[]){t.length&&this.batch(()=>{t.forEach(t=>{this.pushChange({value:this.getComboData([t])[0],type:f.ComboRemoved}),this.removeNodeLikeHierarchy(t),this.comboIds.delete(t)}),this.model.removeNodes(t)})}removeNodeLikeHierarchy(t){if(this.model.hasTreeStructure(N)){let e=this.getNodeLikeDatum(t).combo;this.setParent(t,void 0,N,!1),this.model.getChildren(t,N).forEach(t=>{let i=s8(t),n=tv(i);this.setParent(tv(i),e,N,!1);let r=s0(i,{id:tv(i),combo:e});this.pushChange({value:r,original:i,type:this.isCombo(n)?f.ComboUpdated:f.NodeUpdated}),this.model.mergeNodeData(tv(i),r)}),(0,P.Z)(e)||this.refreshComboData(e)}}getElementType(t){if(this.model.hasNode(t))return this.isCombo(t)?"combo":"node";if(this.model.hasEdge(t))return"edge";throw Error(F(`Unknown element type of id: ${t}`))}destroy(){let{model:t}=this,e=t.getAllNodes(),i=t.getAllEdges();t.removeEdges(i.map(t=>t.id)),t.removeNodes(e.map(t=>t.id)),this.context={}}}var s9=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class s5{constructor(t){this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=t}init(){this.initContainer()}initContainer(){if(!this.container||this.container.destroyed){let{canvas:t}=this.context;this.container=t.appendChild(new C.ZA({className:"elements"}))}}emit(t,e){e.silence||sH(this.context.graph,t)}forEachElementData(t){el.forEach(e=>{let i=this.context.model.getElementsDataByType(e);t(e,i)})}getElementType(t,e){var i;let{options:n,graph:r}=this.context,s=(null===(i=n[t])||void 0===i?void 0:i.type)||e.type;return s?"string"==typeof s?s:s.call(r,e):"edge"===t?"line":"circle"}getTheme(t){return z(this.context.options)[t]||{}}getThemeStyle(t){return this.getTheme(t).style||{}}getThemeStateStyle(t,e){let{state:i={}}=this.getTheme(t);return Object.assign({},...e.map(t=>i[t]||{}))}computePaletteStyle(){let{options:t}=this.context;this.paletteStyle={},this.forEachElementData((e,i)=>{var n,r;let s=Object.assign({},eC(null===(n=this.getTheme(e))||void 0===n?void 0:n.palette),eC(null===(r=t[e])||void 0===r?void 0:r.palette));(null==s?void 0:s.field)&&Object.assign(this.paletteStyle,function(t,e){if(!e)return{};let{type:i,color:n,field:r,invert:s}=e,o=t=>{let e="string"==typeof n?B("palette",n):n;if("function"==typeof e){let i={};return t.forEach(([t,n])=>{i[t]=e(s?1-n:n)}),i}if(Array.isArray(e)){let i=s?[...e].reverse():e,n={};return t.forEach(([t,r])=>{n[t]=i[r%e.length]}),n}return{}},a=(t,e)=>{var i;return"string"==typeof t?null===(i=e.data)||void 0===i?void 0:i[t]:null==t?void 0:t(e)};if("group"===i){let e=(0,Q.Z)(t,t=>{if(!r)return"default";let e=a(r,t);return e?String(e):"default"}),i=Object.keys(e),n=o(i.map((t,e)=>[t,e])),s={};return Object.entries(e).forEach(([t,e])=>{e.forEach(e=>{s[tv(e)]=n[t]})}),s}if("value"===i){let[e,i]=t.reduce(([t,e],i)=>{let n=a(r,i);if("number"!=typeof n)throw Error(F(`Palette field ${r} is not a number`));return[Math.min(t,n),Math.max(e,n)]},[1/0,-1/0]),n=i-e;return o(t.map(t=>[t.id,(a(r,t)-e)/n]))}}(i,s))})}getPaletteStyle(t,e){let i=this.paletteStyle[e];return i?"edge"===t?{stroke:i}:{fill:i}:{}}computeElementDefaultStyle(t,e){var i;let{options:n}=this.context,r=(null===(i=n[t])||void 0===i?void 0:i.style)||{};"transform"in r&&Array.isArray(r.transform)&&(r.transform=[...r.transform]),this.defaultStyle[tv(e.datum)]=eD(r,e)}computeElementsDefaultStyle(t){let{graph:e}=this.context;this.forEachElementData((i,n)=>{let r=n.length;for(let s=0;s<r;s++){let r=n[s];(void 0===t||t.includes(tv(r)))&&this.computeElementDefaultStyle(i,{datum:r,graph:e})}})}getDefaultStyle(t){return this.defaultStyle[t]||{}}getElementState(t){try{let{model:e}=this.context;return e.getElementState(t)}catch(t){return[]}}getElementStateStyle(t,e,i){var n,r;let{options:s}=this.context,o=(null===(r=null===(n=s[t])||void 0===n?void 0:n.state)||void 0===r?void 0:r[e])||{};return eD(o,i)}computeElementStatesStyle(t,e,i){this.stateStyle[tv(i.datum)]=Object.assign({},...e.map(e=>this.getElementStateStyle(t,e,i)))}computeElementsStatesStyle(t){let{graph:e}=this.context;this.forEachElementData((i,n)=>{let r=n.length;for(let s=0;s<r;s++){let r=n[s];if(void 0===t||t.includes(tv(r))){let t=this.getElementState(tv(r));this.computeElementStatesStyle(i,t,{datum:r,graph:e})}}})}getStateStyle(t){return this.stateStyle[t]||{}}computeStyle(t,e){t&&["translate","zIndex"].includes(t)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(e),this.computeElementsStatesStyle(e))}getElement(t){return this.elementMap[t]}getNodes(){return this.context.model.getNodeData().map(({id:t})=>this.elementMap[t])}getEdges(){return this.context.model.getEdgeData().map(t=>this.elementMap[tv(t)])}getCombos(){return this.context.model.getComboData().map(({id:t})=>this.elementMap[t])}getElementComputedStyle(t,e){let i=tv(e),n=this.getThemeStyle(t),r=this.getPaletteStyle(t,i),s=e.style||{},o=this.getDefaultStyle(i),a=this.getThemeStateStyle(t,this.getElementState(i)),l=this.getStateStyle(i),h=Object.assign({},n,r,s,o,a,l);if("combo"===t){let t=this.context.model.getChildrenData(i),e=!!h.collapsed,n=e?[]:t.map(tv).filter(t=>this.getElement(t));Object.assign(h,{childrenNode:n,childrenData:t})}return h}getDrawData(t){this.init();let e=this.computeChangesAndDrawData(t);if(!e)return null;let{type:i="draw",stage:n=i}=t;return this.markDestroyElement(e.drawData),this.computeStyle(n),{type:i,stage:n,data:e}}draw(t={animation:!0}){let e=this.getDrawData(t);if(!e)return;let{data:{drawData:{add:i,update:n,remove:r}}}=e;return this.destroyElements(r,t),this.createElements(i,t),this.updateElements(n,t),this.setAnimationTask(t,e)}preLayoutDraw(){return s9(this,arguments,void 0,function*(t={animation:!0}){var e,i;let n=this.getDrawData(t);if(!n)return;let{data:{drawData:r}}=n;yield null===(i=null===(e=this.context.layout)||void 0===e?void 0:e.preLayout)||void 0===i?void 0:i.call(e,r);let{add:s,update:o,remove:a}=r;return this.destroyElements(a,t),this.createElements(s,t),this.updateElements(o,t),this.setAnimationTask(t,n)})}setAnimationTask(t,e){let{animation:i,silence:n}=t,{data:{dataChanges:r,drawData:s},stage:o,type:a}=e;return this.context.animation.animate(i,n?{}:{before:()=>this.emit(new sz(O.BEFORE_DRAW,{dataChanges:r,animation:i,stage:o,render:"render"===a}),t),beforeAnimate:e=>this.emit(new sZ(O.BEFORE_ANIMATE,y.DRAW,e,s),t),afterAnimate:e=>this.emit(new sZ(O.AFTER_ANIMATE,y.DRAW,e,s),t),after:()=>this.emit(new sz(O.AFTER_DRAW,{dataChanges:r,animation:i,stage:o,render:"render"===a,firstRender:!1===this.context.graph.rendered}),t)})}computeChangesAndDrawData(t){let{model:e}=this.context,i=e.getChanges(),n=rb(i);if(0===n.length)return null;let{NodeAdded:r=[],NodeUpdated:s=[],NodeRemoved:o=[],EdgeAdded:a=[],EdgeUpdated:l=[],EdgeRemoved:h=[],ComboAdded:d=[],ComboUpdated:c=[],ComboRemoved:u=[]}=(0,Q.Z)(n,t=>t.type),p=t=>new Map(t.map(t=>{let e=t.value;return[tv(e),e]})),g={add:{nodes:p(r),edges:p(a),combos:p(d)},update:{nodes:p(s),edges:p(l),combos:p(c)},remove:{nodes:p(o),edges:p(h),combos:p(u)}},f=this.transformData(g,t);return e.clearChanges(),{dataChanges:i,drawData:f}}transformData(t,e){let i=this.context.transform.getTransformInstance();return Object.values(i).reduce((t,i)=>i.beforeDraw(t,e),t)}createElement(t,e,i){var n;let r=tv(e),s=this.getElement(r);if(s)return;let o=this.getElementType(t,e),a=this.getElementComputedStyle(t,e),l=B(t,o);if(!l)return _.warn(`The element ${o} of ${t} is not registered.`);this.emit(new s$(O.BEFORE_ELEMENT_CREATE,t,e),i);let h=this.container.appendChild(new l({id:r,context:this.context,style:a}));this.shapeTypeMap[r]=o,this.elementMap[r]=h;let{stage:d="enter"}=i;null===(n=this.context.animation)||void 0===n||n.add({element:h,elementType:t,stage:d,originalStyle:Object.assign({},h.attributes),updatedStyle:a},{after:()=>{var n;this.emit(new s$(O.AFTER_ELEMENT_CREATE,t,e),i),null===(n=h.onCreate)||void 0===n||n.call(h)}})}createElements(t,e){let{nodes:i,edges:n,combos:r}=t;[["node",i],["combo",r],["edge",n]].forEach(([t,i])=>{i.forEach(i=>this.createElement(t,i,e))})}getUpdateStageStyle(t,e,i){let{stage:n="update"}=i;if("translate"===n){if("node"!==t&&"combo"!==t)return{};{let{style:{x:t=0,y:i=0,z:n=0}={}}=e;return{x:t,y:i,z:n}}}return this.getElementComputedStyle(t,e)}updateElement(t,e,i){var n;let r=tv(e),{stage:s="update"}=i,o=this.getElement(r);if(!o)return()=>null;this.emit(new s$(O.BEFORE_ELEMENT_UPDATE,t,e),i);let a=this.getElementType(t,e),l=this.getUpdateStageStyle(t,e,i);this.shapeTypeMap[r]!==a&&(o.destroy(),delete this.shapeTypeMap[r],delete this.elementMap[r],this.createElement(t,e,{animation:!1,silence:!0}));let h="visibility"!==s?s:"hidden"===l.visibility?"hide":"show";"hide"===h&&delete l.visibility,null===(n=this.context.animation)||void 0===n||n.add({element:o,elementType:t,stage:h,originalStyle:Object.assign({},o.attributes),updatedStyle:l},{before:()=>{let t=this.elementMap[r];"collapse"!==s&&no(t,l),"visibility"===s&&(sY("opacity") in((0,ey.Z)(t,sG)||{})||function(t,e){let i=Array.isArray(e)?e:[e];(0,ey.Z)(t,sG)||(0,em.Z)(t,sG,{}),i.forEach(e=>{(0,em.Z)((0,ey.Z)(t,sG),sY(e),t.attributes[e])})}(t,"opacity"),this.visibilityCache.set(t,"show"===h?"visible":"hidden"),"show"===h&&tP(t,"visible"))},after:()=>{var n;let o=this.elementMap[r];"collapse"===s&&no(o,l),"hide"===h&&tP(o,this.visibilityCache.get(o)),this.emit(new s$(O.AFTER_ELEMENT_UPDATE,t,e),i),null===(n=o.onUpdate)||void 0===n||n.call(o)}})}updateElements(t,e){let{nodes:i,edges:n,combos:r}=t;[["node",i],["combo",r],["edge",n]].forEach(([t,i])=>{i.forEach(i=>this.updateElement(t,i,e))})}markDestroyElement(t){Object.values(t.remove).forEach(t=>{t.forEach(t=>{let e=tv(t),i=this.getElement(e);i&&(0,em.Z)(i,"__to_be_destroyed__",!0)})})}destroyElement(t,e,i){var n;let{stage:r="exit"}=i,s=tv(e),o=this.elementMap[s];if(!o)return()=>null;this.emit(new s$(O.BEFORE_ELEMENT_DESTROY,t,e),i),null===(n=this.context.animation)||void 0===n||n.add({element:o,elementType:t,stage:r,originalStyle:Object.assign({},o.attributes),updatedStyle:{}},{after:()=>{var n;this.clearElement(s),o.destroy(),null===(n=o.onDestroy)||void 0===n||n.call(o),this.emit(new s$(O.AFTER_ELEMENT_DESTROY,t,e),i)}})}destroyElements(t,e){let{nodes:i,edges:n,combos:r}=t;[["combo",r],["edge",n],["node",i]].forEach(([t,i])=>{i.forEach(i=>this.destroyElement(t,i,e))})}clearElement(t){delete this.paletteStyle[t],delete this.defaultStyle[t],delete this.stateStyle[t],delete this.elementMap[t],delete this.shapeTypeMap[t]}alignLayoutResultToElement(t,e){var i,n;let r=null===(i=t.nodes)||void 0===i?void 0:i.find(t=>tv(t)===e);if(r){let i=tQ(this.context.model.getNodeLikeDatum(e)),s=tQ(r),o=tB(i,s);null===(n=t.nodes)||void 0===n||n.forEach(t=>{var e,i,n;(null===(e=t.style)||void 0===e?void 0:e.x)&&(t.style.x+=o[0]),(null===(i=t.style)||void 0===i?void 0:i.y)&&(t.style.y+=o[1]),(null===(n=t.style)||void 0===n?void 0:n.z)&&(t.style.z+=o[2]||0)})}}collapseNode(t,e){return s9(this,void 0,void 0,function*(){var i;let{animation:n}=e,{model:r}=this.context,s=this.computeChangesAndDrawData({stage:"collapse",animation:n});if(!s)return;let{drawData:o}=s,{add:a,remove:l,update:h}=o;this.markDestroyElement(o);let d={animation:n,stage:"collapse",data:o};this.destroyElements(l,d),this.createElements(a,d),this.updateElements(h,d),yield null===(i=this.context.animation.animate(n,{beforeAnimate:t=>this.emit(new sZ(O.BEFORE_ANIMATE,y.COLLAPSE,t,o),d),afterAnimate:t=>this.emit(new sZ(O.AFTER_ANIMATE,y.COLLAPSE,t,o),d)},{collapse:{target:t,descendants:Array.from(l.nodes).map(([,t])=>tv(t)),position:tQ(h.nodes.get(t))}}))||void 0===i?void 0:i.finished})}expandNode(t,e){return s9(this,void 0,void 0,function*(){var i;let{model:n,layout:r}=this.context,{animation:s,align:o}=e,a=tQ(n.getNodeData([t])[0]),l=this.computeChangesAndDrawData({stage:"expand",animation:s});if(this.createElements(l.drawData.add,{animation:!1,stage:"expand",target:t}),this.context.animation.clear(),this.computeStyle("expand"),!l)return;let{drawData:h}=l,{update:d,add:c}=h,u={animation:s,stage:"expand",data:h};c.edges.forEach(t=>d.edges.set(tv(t),t)),c.nodes.forEach(t=>d.nodes.set(tv(t),t)),this.updateElements(d,u),yield null===(i=this.context.animation.animate(s,{beforeAnimate:t=>this.emit(new sZ(O.BEFORE_ANIMATE,y.EXPAND,t,h),u),afterAnimate:t=>this.emit(new sZ(O.AFTER_ANIMATE,y.EXPAND,t,h),u)},{expand:{target:t,descendants:Array.from(c.nodes).map(([,t])=>tv(t)),position:a}}))||void 0===i?void 0:i.finished})}collapseCombo(t,e){return s9(this,void 0,void 0,function*(){var i;let{model:n,element:r}=this.context;if(n.getAncestorsData(t,N).some(t=>ef(t)))return;let s=r.getElement(t),o=s.getComboPosition(Object.assign(Object.assign({},s.attributes),{collapsed:!0})),a=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!a)return;let{dataChanges:l,drawData:h}=a;this.markDestroyElement(h);let{update:d,remove:c}=h,u={animation:e,stage:"collapse",data:h};this.destroyElements(c,u),this.updateElements(d,u);let p=t=>Array.from(t).map(([,t])=>tv(t));yield null===(i=this.context.animation.animate(e,{before:()=>this.emit(new sz(O.BEFORE_DRAW,{dataChanges:l,animation:e}),u),beforeAnimate:t=>this.emit(new sZ(O.BEFORE_ANIMATE,y.COLLAPSE,t,h),u),afterAnimate:t=>this.emit(new sZ(O.AFTER_ANIMATE,y.COLLAPSE,t,h),u),after:()=>this.emit(new sz(O.AFTER_DRAW,{dataChanges:l,animation:e}),u)},{collapse:{target:t,descendants:[...p(c.nodes),...p(c.combos)],position:o}}))||void 0===i?void 0:i.finished})}expandCombo(t,e){return s9(this,void 0,void 0,function*(){var i;let{model:n}=this.context,r=tQ(n.getComboData([t])[0]);this.computeStyle("expand");let s=this.computeChangesAndDrawData({stage:"expand",animation:e});if(!s)return;let{dataChanges:o,drawData:a}=s,{add:l,update:h}=a,d={animation:e,stage:"expand",data:a,target:t};this.createElements(l,d),this.updateElements(h,d);let c=t=>Array.from(t).map(([,t])=>tv(t));yield null===(i=this.context.animation.animate(e,{before:()=>this.emit(new sz(O.BEFORE_DRAW,{dataChanges:o,animation:e}),d),beforeAnimate:t=>this.emit(new sZ(O.BEFORE_ANIMATE,y.EXPAND,t,a),d),afterAnimate:t=>this.emit(new sZ(O.AFTER_ANIMATE,y.EXPAND,t,a),d),after:()=>this.emit(new sz(O.AFTER_DRAW,{dataChanges:o,animation:e}),d)},{expand:{target:t,descendants:[...c(l.nodes),...c(l.combos)],position:r}}))||void 0===i?void 0:i.finished})}clear(){this.container.destroy(),this.initContainer(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={}}destroy(){this.clear(),this.container.destroy(),this.context={}}}var s7=i(15767),ot=i(80345);class oe extends rv.Z{constructor(t,e,i){super(),this.graph=t,this.layout=e,this.options=i,this.spawnWorker()}spawnWorker(){this.proxy=ot.Ud(new Worker(i.tu(new URL(i.p+i.u(8367),i.b)),{type:void 0})),this.running&&(this.running=!1,this.execute())}execute(){var t;return(0,s7.mG)(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;let e=this.layout.options,{onTick:i}=e,n=(0,s7._T)(e,["onTick"]),r={};Object.keys(n).forEach(t=>{(0,J.Z)(n[t])||(r[t]=n[t])});let s={layout:{id:this.layout.id,options:r,iterations:null===(t=this.options)||void 0===t?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},o=new Float32Array([0]),[a]=yield this.proxy.calculateLayout(s,[o]);return a})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[ot.Yy]()}isRunning(){return this.running}}var oi=i(30519),on=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})},or=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};class os{get presetOptions(){return{animation:!!H(this.context.options,!0)}}get options(){let{options:t}=this.context;return t.layout}constructor(t){this.instances=[],this.context=t}getLayoutInstance(){return this.instances}preLayout(t){return on(this,void 0,void 0,function*(){var e,i,n,r;let{graph:s,model:o}=this.context,{add:a}=t;sH(s,new sz(O.BEFORE_LAYOUT,{type:"pre"}));let l=yield null===(e=this.context.layout)||void 0===e?void 0:e.simulate();null===(i=null==l?void 0:l.nodes)||void 0===i||i.forEach(t=>{let e=tv(t),i=a.nodes.get(e);o.syncNodeLikeDatum(t),i&&Object.assign(i.style,t.style)}),null===(n=null==l?void 0:l.edges)||void 0===n||n.forEach(t=>{let e=tv(t),i=a.edges.get(e);o.syncEdgeDatum(t),i&&Object.assign(i.style,t.style)}),null===(r=null==l?void 0:l.combos)||void 0===r||r.forEach(t=>{let e=tv(t),i=a.combos.get(e);o.syncNodeLikeDatum(t),i&&Object.assign(i.style,t.style)}),sH(s,new sz(O.AFTER_LAYOUT,{type:"pre"})),this.transformDataAfterLayout("pre",t)})}postLayout(){return on(this,arguments,void 0,function*(t=this.options){if(!t)return;let e=Array.isArray(t)?t:[t],{graph:i}=this.context;sH(i,new sz(O.BEFORE_LAYOUT,{type:"post"}));for(let t=0;t<e.length;t++){let n=e[t],r=this.getLayoutData(n),s=Object.assign(Object.assign({},this.presetOptions),n);sH(i,new sz(O.BEFORE_STAGE_LAYOUT,{options:s,index:t}));let o=yield this.stepLayout(r,s,t);sH(i,new sz(O.AFTER_STAGE_LAYOUT,{options:s,index:t})),n.animation||this.updateElementPosition(o,!1)}sH(i,new sz(O.AFTER_LAYOUT,{type:"post"})),this.transformDataAfterLayout("post")})}transformDataAfterLayout(t,e){let i=this.context.transform.getTransformInstance();Object.values(i).forEach(i=>i.afterLayout(t,e))}simulate(){return on(this,void 0,void 0,function*(){if(!this.options)return{};let t=Array.isArray(this.options)?this.options:[this.options],e={};for(let i=0;i<t.length;i++){let n=t[i],r=this.getLayoutData(n),s=yield this.stepLayout(r,Object.assign(Object.assign(Object.assign({},this.presetOptions),n),{animation:!1}),i);e=s}return e})}stepLayout(t,e,i){return on(this,void 0,void 0,function*(){return!function(t){let{type:e}=t;return["compact-box","mindmap","dendrogram","indented"].includes(e)}(e)?yield this.graphLayout(t,e,i):yield this.treeLayout(t,e,i)})}graphLayout(t,e,i){return on(this,void 0,void 0,function*(){let{animation:n,enableWorker:r,iterations:s=300}=e,o=this.initGraphLayout(e);if(!o)return{};if(this.instances[i]=o,this.instance=o,r)return this.supervisor=new oe(o.graphData2LayoutModel(t),o.instance,{iterations:s}),nx((yield this.supervisor.execute()));if((0,oi.h)(o))return n?yield o.execute(t,{onTick:t=>{this.updateElementPosition(t,!1)}}):(o.execute(t),o.stop(),o.tick(s));let a=yield o.execute(t);if(n){let t=this.updateElementPosition(a,n);yield null==t?void 0:t.finished}return a})}treeLayout(t,e,i){return on(this,void 0,void 0,function*(){let{type:i,animation:n}=e,r=B("layout",i);if(!r)return{};let{nodes:s=[],edges:o=[]}=t,a=new nv.k({nodes:s.map(t=>({id:tv(t),data:t.data||{}})),edges:o.map(t=>({id:tv(t),source:t.source,target:t.target,data:t.data||{}}))});!function(t){if(t.hasTreeStructure(j))return;t.attachTreeStructure(j);let e=t.getAllEdges();for(let i of e){let{source:e,target:n}=i;t.setParent(n,e,j)}}(a);let l={nodes:[],edges:[]},h={nodes:[],edges:[]},d=a.getRoots(j);d.forEach(t=>{eh(t,t=>{t.children=a.getSuccessors(t.id)},t=>a.getSuccessors(t.id),"TB");let i=r(t,e),{x:n,y:s,z:o=0}=i;eh(i,t=>{let{id:e,x:i,y:r,z:a=0}=t;l.nodes.push({id:e,style:{x:n,y:s,z:o}}),h.nodes.push({id:e,style:{x:i,y:r,z:a}})},t=>t.children,"TB")});let c=this.inferTreeLayoutOffset(h);if(oo(h,c),n){oo(l,c),this.updateElementPosition(l,!1);let t=this.updateElementPosition(h,n);yield null==t?void 0:t.finished}return h})}inferTreeLayoutOffset(t){var e;let[i,n]=[1/0,-1/0],[r,s]=[1/0,-1/0];null===(e=t.nodes)||void 0===e||e.forEach(t=>{let{x:e=0,y:o=0}=t.style||{};i=Math.min(i,e),n=Math.max(n,e),r=Math.min(r,o),s=Math.max(s,o)});let{canvas:o}=this.context,a=o.getSize(),[l,h]=o.getCanvasByViewport([0,0]),[d,c]=o.getCanvasByViewport(a);return i>=l&&n<=d&&r>=h&&s<=c?[0,0]:[(l+d)/2-(i+n)/2,(h+c)/2-(r+s)/2]}stopLayout(){this.instance&&(0,oi.h)(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(t){let{nodeFilter:e=()=>!0,preLayout:i=!1,isLayoutInvisibleNodes:n=!1}=t,{nodes:r,edges:s,combos:o}=this.context.model.getData(),{element:a,model:l}=this.context,h=t=>a.getElement(t),d=i?t=>{var i;return!(!n&&((null===(i=t.style)||void 0===i?void 0:i.visibility)==="hidden"||l.getAncestorsData(t.id,j).some(ef)||l.getAncestorsData(t.id,N).some(ef)))&&e(t)}:t=>{let i=tv(t),n=h(i);return!(!n||na(n))&&e(t)},c=r.filter(d),u=new Map(c.map(t=>[tv(t),t]));o.forEach(t=>u.set(tv(t),t));let p=s.filter(({source:t,target:e})=>u.has(t)&&u.has(e));return{nodes:c,edges:p,combos:o}}initGraphLayout(t){var e,i;let{element:n,viewport:r}=this.context,{type:s,enableWorker:o,animation:a,iterations:l}=t,h=or(t,["type","enableWorker","animation","iterations"]),[d,c]=r.getCanvasSize(),u=[d/2,c/2],p=null!==(e=null==t?void 0:t.nodeSize)&&void 0!==e?e:t=>{let e=null==n?void 0:n.getElement(t.id);return e?e.attributes.size:null==n?void 0:n.getElementComputedStyle("node",t).size},g=B("layout",s);if(!g)return _.warn(`The layout of ${s} is not registered.`);let f=Object.getPrototypeOf(g.prototype)===nb.prototype?g:(i=this.context,class extends nb{constructor(t,e){if(super(t,e),this.instance=new g({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){let t=this.instance;this.stop=t.stop.bind(t),this.tick=e=>{let i=t.tick(e);return nx(i)}}}execute(t,e){var i,n,r,s;return i=this,n=void 0,r=void 0,s=function*(){return nx((yield this.instance.execute(this.graphData2LayoutModel(t),this.transformOptions((0,tN.Z)({},this.options,e)))))},new(r||(r=Promise))(function(t,e){function o(t){try{l(s.next(t))}catch(t){e(t)}}function a(t){try{l(s.throw(t))}catch(t){e(t)}}function l(e){var i;e.done?t(e.value):((i=e.value)instanceof r?i:new r(function(t){t(i)})).then(o,a)}l((s=s.apply(i,n||[])).next())})}transformOptions(t){if(!("onTick"in t))return t;let e=t.onTick;return t.onTick=t=>e(nx(t)),t}graphData2LayoutModel(t){let{nodes:e=[],edges:n=[],combos:r=[]}=t,s=e.map(t=>{let e=tv(t),{data:i,style:n,combo:r}=t,s=nE(t,["data","style","combo"]),o={id:e,data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},i),{data:i}),r?{parentId:r}:{}),{style:n}),s)};return(null==n?void 0:n.x)&&Object.assign(o.data,{x:n.x}),(null==n?void 0:n.y)&&Object.assign(o.data,{y:n.y}),(null==n?void 0:n.z)&&Object.assign(o.data,{z:n.z}),o}),o=new Map(s.map(t=>[t.id,t])),a=n.filter(t=>{let{source:e,target:i}=t;return o.has(e)&&o.has(i)}).map(t=>{let{source:e,target:i,data:n,style:r}=t;return{id:tv(t),source:e,target:i,data:Object.assign({},n),style:Object.assign({},r)}}),l=r.map(t=>({id:tv(t),data:Object.assign({_isCombo:!0},t.data),style:Object.assign({},t.style)})),h=new nv.k({nodes:[...s,...l],edges:a});return i.model.model.hasTreeStructure(N)&&(h.attachTreeStructure(N),s.forEach(t=>{let e=i.model.model.getParent(t.id,N);e&&h.hasNode(e.id)&&h.setParent(t.id,e.id,N)})),h}}),y=new f(this.context),m={nodeSize:p,width:d,height:c,center:u};switch(y.id){case"d3-force":case"d3-force-3d":Object.assign(m,{center:{x:d/2,y:c/2,z:0}})}return(0,tN.Z)(y.options,m,h),y}updateElementPosition(t,e){let{model:i,element:n}=this.context;return n?(i.updateData(t),n.draw({animation:e,silence:!0})):null}destroy(){var t;this.stopLayout(),this.context={},null===(t=this.supervisor)||void 0===t||t.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}let oo=(t,e)=>{var i;let[n,r]=e;null===(i=t.nodes)||void 0===i||i.forEach(t=>{if(t.style){let{x:e=0,y:i=0}=t.style;t.style.x=e+n,t.style.y=i+r}else t.style={x:n,y:r}})};function oa(t){return!t.layout||Array.isArray(t.layout)||"preLayout"in t.layout||["antv-dagre","combo-combined","compact-box","circular","concentric","dagre","fishbone","grid","indented","mds","radial","random","snake","dendrogram","mindmap"].includes(t.layout.type)&&(t.layout.preLayout=!0),t}class ol extends tA{constructor(t){super(t),this.category="plugin",this.setPlugins(this.context.options.plugins||[])}setPlugins(t){this.setExtensions(t)}getPluginInstance(t){let e=this.extensionMap[t];if(e)return e;_.warn(`Cannot find the plugin ${t}, will try to find it by type.`);let i=this.extensions.find(e=>e.type===t);if(i)return this.extensionMap[i.key]}}let oh=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class od extends tA{constructor(t){super(t),this.category="transform",this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(t){this.setExtensions([...oh.slice(0,oh.length-1),...t,oh[oh.length-1]])}getTransformInstance(t){return t?this.extensionMap[t]:this.extensionMap}}var oc=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class ou{get padding(){return tr(this.context.options.padding)}get paddingOffset(){let[t,e,i,n]=this.padding,[r,s,o]=[(n-e)/2,(t-i)/2,0];return[r,s,o]}constructor(t){this.landmarkCounter=0,this.context=t;let[e,i]=this.paddingOffset,{zoom:n,rotation:r,x:s=e,y:o=i}=t.options;this.transform({mode:"absolute",scale:n,translate:[s,o],rotate:r},!1)}get camera(){let{canvas:t}=this.context;return new Proxy(t.getCamera(),{get:(e,i)=>{let n=Object.entries(t.getLayers()).filter(([t])=>!["main"].includes(t)),r=n.map(([,t])=>t.getCamera()),s=e[i];if("function"==typeof s)return(...t)=>{let n=s.apply(e,t);return r.forEach(e=>{e[i].apply(e,t)}),n}}})}createLandmark(t){return this.camera.createLandmark(`landmark-${this.landmarkCounter++}`,t)}getAnimation(t){let e=H(this.context.options,t);return!!e&&(0,e9.Z)(Object.assign({},e),["easing","duration"])}getCanvasSize(){let{canvas:t}=this.context,{width:e=0,height:i=0}=t.getConfig();return[e,i]}getCanvasCenter(){let{canvas:t}=this.context,{width:e=0,height:i=0}=t.getConfig();return[e/2,i/2,0]}getViewportCenter(){let[t,e]=this.camera.getPosition();return[t,e,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(t){let{camera:e}=this,{mode:i,translate:n=[]}=t,r=this.getZoom(),s=e.getPosition(),o=e.getFocalPoint(),[a,l]=this.getCanvasCenter(),[h=0,d=0,c=0]=n,u=t_([-h,-d,-c],r);return"relative"===i?{position:tI(s,u),focalPoint:tI(o,u)}:{position:tI([a,l,s[2]],u),focalPoint:tI([a,l,o[2]],u)}}getRotateOptions(t){let{mode:e,rotate:i=0}=t,n="relative"===e?this.camera.getRoll()+i:i;return{roll:n}}getZoomOptions(t){let{zoomRange:e}=this.context.options,i=this.camera.getZoom(),{mode:n,scale:r=1}=t;return(0,nR.Z)("relative"===n?i*r:r,...e)}transform(t,e){return oc(this,void 0,void 0,function*(){let{graph:i}=this.context,{translate:n,rotate:r,scale:s,origin:o}=t;this.cancelAnimation();let a=this.getAnimation(e);if(sH(i,new sV(O.BEFORE_TRANSFORM,t)),!r&&s&&!n&&o&&!a){this.camera.setZoomByViewportPoint(this.getZoomOptions(t),o),sH(i,new sV(O.AFTER_TRANSFORM,t));return}let l={};if(n&&Object.assign(l,this.getTranslateOptions(t)),(0,W.Z)(r)&&Object.assign(l,this.getRotateOptions(t)),(0,W.Z)(s)&&Object.assign(l,{zoom:this.getZoomOptions(t)}),a)return sH(i,new sZ(O.BEFORE_ANIMATE,y.TRANSFORM,null,t)),new Promise(e=>{this.transformResolver=e,this.camera.gotoLandmark(this.createLandmark(l),Object.assign(Object.assign({},a),{onfinish:()=>{sH(i,new sZ(O.AFTER_ANIMATE,y.TRANSFORM,null,t)),sH(i,new sV(O.AFTER_TRANSFORM,t)),this.transformResolver=void 0,e()}}))});this.camera.gotoLandmark(this.createLandmark(l),{duration:0}),sH(i,new sV(O.AFTER_TRANSFORM,t))})}fitView(t,e){return oc(this,void 0,void 0,function*(){let[i,n,r,s]=this.padding,{when:o="always",direction:a="both"}=t||{},[l,h]=this.context.canvas.getSize(),d=l-s-n,c=h-i-r,u=this.context.canvas.getBounds(),p=this.getBBoxInViewport(u),[g,f]=ta(p);if("overflow"===o&&!("x"===a&&g>=d||"y"===a&&f>=c||"both"===a&&g>=d&&f>=c))return yield this.fitCenter({animation:e});let y=d/g,m=c/f,v="x"===a?y:"y"===a?m:Math.min(y,m),b=this.getAnimation(e);yield this.transform({mode:"relative",scale:v,translate:tI(tB(this.getCanvasCenter(),this.getBBoxInViewport(u).center),t_(this.paddingOffset,v))},b)})}fitCenter(t){return oc(this,void 0,void 0,function*(){let e=this.context.canvas.getBounds();yield this.focus(e,t)})}focusElements(t){return oc(this,arguments,void 0,function*(t,e={}){let{element:i}=this.context;if(!i)return;let n=t=>e.shapes?t.getShape(e.shapes).getRenderBounds():t.getRenderBounds(),r=tc(t.map(t=>n(i.getElement(t))));yield this.focus(r,e)})}focus(t,e){return oc(this,void 0,void 0,function*(){let i=this.context.graph.getViewportByCanvas(t.center),n=e.position||this.getCanvasCenter(),r=tB(n,i);yield this.transform({mode:"relative",translate:tI(r,this.paddingOffset)},e.animation)})}getBBoxInViewport(t){let{min:e,max:i}=t,{graph:n}=this.context,[r,s]=n.getViewportByCanvas(e),[o,a]=n.getViewportByCanvas(i),l=new C.mN;return l.setMinMax([r,s,0],[o,a,0]),l}isInViewport(t,e=!1,i=0){let{graph:n}=this.context,r=this.getCanvasSize(),[s,o]=n.getCanvasByViewport([0,0]),[a,l]=n.getCanvasByViewport(r),h=new C.mN;return h.setMinMax([s,o,0],[a,l,0]),i&&(h=td(h,i)),ti(t)?tu(t,h):e?function(t,e){let[i,n]=t.min,[r,s]=t.max,[o,a]=e.min,[l,h]=e.max;return i>=o&&r<=l&&n>=a&&s<=h}(t,h):h.intersects(t)}cancelAnimation(){var t,e;(null===(t=this.camera.landmarks)||void 0===t?void 0:t.length)&&this.camera.cancelLandmarkAnimation(),null===(e=this.transformResolver)||void 0===e||e.call(this)}}var op=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class og extends rv.Z{constructor(t){var e;super(),this.options={},this.rendered=!1,this.destroyed=!1,this.context={model:new s4},this.isCollapsingExpanding=!1,this.onResize=(0,np.Z)(()=>{this.resize()},300),this._setOptions(Object.assign({},og.defaultOptions,t),!0),this.context.graph=this,this.options.autoResize&&(null===(e=globalThis.addEventListener)||void 0===e||e.call(globalThis,"resize",this.onResize))}getOptions(){return this.options}setOptions(t){this._setOptions(t,!1)}_setOptions(t,e){if(this.updateCanvas(t),Object.assign(this.options,[oa].reduce((t,e)=>e(t),t)),e){let{data:e}=t;e&&this.addData(e);return}let{behaviors:i,combo:n,data:r,edge:s,layout:o,node:a,plugins:l,theme:h,transforms:d}=t;i&&this.setBehaviors(i),r&&this.setData(r),a&&this.setNode(a),s&&this.setEdge(s),n&&this.setCombo(n),o&&this.setLayout(o),h&&this.setTheme(h),l&&this.setPlugins(l),d&&this.setTransforms(d)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(t,e){t&&(this.options.width=t),e&&(this.options.height=e),this.resize(t,e)}setZoomRange(t){this.options.zoomRange=t}getZoomRange(){return this.options.zoomRange}setNode(t){this.options.node=t,this.context.model.refreshData()}setEdge(t){this.options.edge=t,this.context.model.refreshData()}setCombo(t){this.options.combo=t,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(t){this.options.theme=(0,J.Z)(t)?t(this.getTheme()):t}setLayout(t){this.options.layout=(0,J.Z)(t)?t(this.getLayout()):t}getLayout(){return this.options.layout}setBehaviors(t){var e;this.options.behaviors=(0,J.Z)(t)?t(this.getBehaviors()):t,null===(e=this.context.behavior)||void 0===e||e.setBehaviors(this.options.behaviors)}updateBehavior(t){this.setBehaviors(e=>e.map(e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e))}getBehaviors(){return this.options.behaviors||[]}setPlugins(t){var e;this.options.plugins=(0,J.Z)(t)?t(this.getPlugins()):t,null===(e=this.context.plugin)||void 0===e||e.setPlugins(this.options.plugins)}updatePlugin(t){this.setPlugins(e=>e.map(e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e))}getPlugins(){return this.options.plugins||[]}getPluginInstance(t){return this.context.plugin.getPluginInstance(t)}setTransforms(t){var e;this.options.transforms=(0,J.Z)(t)?t(this.getTransforms()):t,null===(e=this.context.transform)||void 0===e||e.setTransforms(this.options.transforms)}updateTransform(t){this.setTransforms(e=>e.map(e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(t){return Array.isArray(t)?t.map(t=>this.context.model.getElementDataById(t)):this.context.model.getElementDataById(t)}getNodeData(t){return void 0===t?this.context.model.getNodeData():Array.isArray(t)?this.context.model.getNodeData(t):this.context.model.getNodeLikeDatum(t)}getEdgeData(t){return void 0===t?this.context.model.getEdgeData():Array.isArray(t)?this.context.model.getEdgeData(t):this.context.model.getEdgeDatum(t)}getComboData(t){return void 0===t?this.context.model.getComboData():Array.isArray(t)?this.context.model.getComboData(t):this.context.model.getNodeLikeDatum(t)}setData(t){this.context.model.setData((0,J.Z)(t)?t(this.getData()):t)}addData(t){this.context.model.addData((0,J.Z)(t)?t(this.getData()):t)}addNodeData(t){this.context.model.addNodeData((0,J.Z)(t)?t(this.getNodeData()):t)}addEdgeData(t){this.context.model.addEdgeData((0,J.Z)(t)?t(this.getEdgeData()):t)}addComboData(t){this.context.model.addComboData((0,J.Z)(t)?t(this.getComboData()):t)}addChildrenData(t,e){this.context.model.addChildrenData(t,e)}updateData(t){this.context.model.updateData((0,J.Z)(t)?t(this.getData()):t)}updateNodeData(t){this.context.model.updateNodeData((0,J.Z)(t)?t(this.getNodeData()):t)}updateEdgeData(t){this.context.model.updateEdgeData((0,J.Z)(t)?t(this.getEdgeData()):t)}updateComboData(t){this.context.model.updateComboData((0,J.Z)(t)?t(this.getComboData()):t)}removeData(t){this.context.model.removeData((0,J.Z)(t)?t(this.getData()):t)}removeNodeData(t){this.context.model.removeNodeData((0,J.Z)(t)?t(this.getNodeData()):t)}removeEdgeData(t){this.context.model.removeEdgeData((0,J.Z)(t)?t(this.getEdgeData()):t)}removeComboData(t){this.context.model.removeComboData((0,J.Z)(t)?t(this.getComboData()):t)}getElementType(t){return this.context.model.getElementType(t)}getRelatedEdgesData(t,e="both"){return this.context.model.getRelatedEdgesData(t,e)}getNeighborNodesData(t){return this.context.model.getNeighborNodesData(t)}getAncestorsData(t,e){return this.context.model.getAncestorsData(t,e)}getParentData(t,e){return this.context.model.getParentData(t,e)}getChildrenData(t){return this.context.model.getChildrenData(t)}getDescendantsData(t){return this.context.model.getDescendantsData(t)}getElementDataByState(t,e){return this.context.model.getElementDataByState(t,e)}initCanvas(){return op(this,void 0,void 0,function*(){var t;if(this.context.canvas)return yield this.context.canvas.ready;let{container:e="container",width:i,height:n,renderer:r,cursor:s,background:o,canvas:a,devicePixelRatio:l=null!==(t=globalThis.devicePixelRatio)&&void 0!==t?t:1}=this.options;if(e instanceof sN)this.context.canvas=e,s&&e.setCursor(s),r&&e.setRenderer(r),yield e.ready;else{let t=(0,ei.Z)(e)?document.getElementById(e):e,h=sF(t);this.emit(O.BEFORE_CANVAS_INIT,{container:t,width:i,height:n});let d=Object.assign(Object.assign({},a),{container:t,width:i||h[0],height:n||h[1],background:o,renderer:r,cursor:s,devicePixelRatio:l}),c=new sN(d);this.context.canvas=c,yield c.ready,this.emit(O.AFTER_CANVAS_INIT,{canvas:c})}})}updateCanvas(t){var e,i;let{renderer:n,cursor:r,height:s,width:o}=t,a=this.context.canvas;a&&(n&&(this.emit(O.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),a.setRenderer(n),this.emit(O.AFTER_RENDERER_CHANGE,{renderer:n})),r&&a.setCursor(r),((0,W.Z)(o)||(0,W.Z)(s))&&this.setSize(null!==(e=null!=o?o:this.options.width)&&void 0!==e?e:0,null!==(i=null!=s?s:this.options.height)&&void 0!==i?i:0))}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new sX(this.context)),this.context.plugin||(this.context.plugin=new ol(this.context)),this.context.viewport||(this.context.viewport=new ou(this.context)),this.context.transform||(this.context.transform=new od(this.context)),this.context.element||(this.context.element=new s5(this.context)),this.context.animation||(this.context.animation=new sK(this.context)),this.context.layout||(this.context.layout=new os(this.context)),this.context.behavior||(this.context.behavior=new sq(this.context))}prepare(){return op(this,void 0,void 0,function*(){if(yield Promise.resolve(),this.destroyed){console.error(F("The graph instance has been destroyed"));return}yield this.initCanvas(),this.initRuntime()})}render(){return op(this,void 0,void 0,function*(){if(yield this.prepare(),sH(this,new sz(O.BEFORE_RENDER)),this.options.layout){var t;if(!this.rendered&&!Array.isArray(t=this.options.layout)&&(null==t?void 0:t.preLayout)){let t=yield this.context.element.preLayoutDraw({type:"render"});yield Promise.all([null==t?void 0:t.finished,this.autoFit()])}else{let t=this.context.element.draw({type:"render"});yield Promise.all([null==t?void 0:t.finished,this.context.layout.postLayout()]),yield this.autoFit()}}else{let t=this.context.element.draw({type:"render"});yield Promise.all([null==t?void 0:t.finished,this.autoFit()])}this.rendered=!0,sH(this,new sz(O.AFTER_RENDER))})}draw(){return op(this,void 0,void 0,function*(){var t;yield this.prepare(),yield null===(t=this.context.element.draw())||void 0===t?void 0:t.finished})}layout(t){return op(this,void 0,void 0,function*(){yield this.context.layout.postLayout(t)})}stopLayout(){this.context.layout.stopLayout()}clear(){return op(this,void 0,void 0,function*(){let{model:t,element:e}=this.context;t.setData({}),t.clearChanges(),null==e||e.clear()})}destroy(){var t;sH(this,new sz(O.BEFORE_DESTROY));let{layout:e,animation:i,element:n,model:r,canvas:s,behavior:o,plugin:a}=this.context;null==a||a.destroy(),null==o||o.destroy(),null==e||e.destroy(),null==i||i.destroy(),null==n||n.destroy(),r.destroy(),null==s||s.destroy(),this.options={},this.context={},this.off(),null===(t=globalThis.removeEventListener)||void 0===t||t.call(globalThis,"resize",this.onResize),this.destroyed=!0,sH(this,new sz(O.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(t,e){var i;let n=sF(null===(i=this.context.canvas)||void 0===i?void 0:i.getContainer()),r=[t||n[0],e||n[1]];if(!this.context.canvas)return;let s=this.context.canvas.getSize();(0,A.Z)(r,s)||(sH(this,new sz(O.BEFORE_SIZE_CHANGE,{size:r})),this.context.canvas.resize(...r),sH(this,new sz(O.AFTER_SIZE_CHANGE,{size:r})))}fitView(t,e){return op(this,void 0,void 0,function*(){var i;yield null===(i=this.context.viewport)||void 0===i?void 0:i.fitView(t,e)})}fitCenter(t){return op(this,void 0,void 0,function*(){var e;yield null===(e=this.context.viewport)||void 0===e?void 0:e.fitCenter({animation:t})})}autoFit(){return op(this,void 0,void 0,function*(){let{autoFit:t}=this.context.options;if(t){if((0,ei.Z)(t))"view"===t?yield this.fitView():"center"===t&&(yield this.fitCenter());else{let{type:e,animation:i}=t;"view"===e?yield this.fitView(t.options,i):"center"===e&&(yield this.fitCenter(i))}}})}focusElement(t,e){return op(this,void 0,void 0,function*(){var i;yield null===(i=this.context.viewport)||void 0===i?void 0:i.focusElements(Array.isArray(t)?t:[t],{animation:e})})}zoomBy(t,e,i){return op(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",scale:t,origin:i},e)})}zoomTo(t,e,i){return op(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",scale:t,origin:i},e)})}getZoom(){return this.context.viewport.getZoom()}rotateBy(t,e,i){return op(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",rotate:t,origin:i},e)})}rotateTo(t,e,i){return op(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",rotate:t,origin:i},e)})}getRotation(){return this.context.viewport.getRotation()}translateBy(t,e){return op(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",translate:t},e)})}translateTo(t,e){return op(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",translate:t},e)})}getPosition(){return tB([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(t,e){return op(this,arguments,void 0,function*(t,e,i=!0){var n;let[r,s]=(0,R.Z)(t)?[t,null==e||e]:[{[t]:e},i];Object.entries(r).forEach(([t,e])=>this.context.model.translateNodeLikeBy(t,e)),yield null===(n=this.context.element.draw({animation:s,stage:"translate"}))||void 0===n?void 0:n.finished})}translateElementTo(t,e){return op(this,arguments,void 0,function*(t,e,i=!0){var n;let[r,s]=(0,R.Z)(t)?[t,null==e||e]:[{[t]:e},i];Object.entries(r).forEach(([t,e])=>this.context.model.translateNodeLikeTo(t,e)),yield null===(n=this.context.element.draw({animation:s,stage:"translate"}))||void 0===n?void 0:n.finished})}getElementPosition(t){return this.context.model.getElementPosition(t)}getElementRenderStyle(t){return(0,n0.Z)(this.context.element.getElement(t).attributes,["context"])}setElementVisibility(t,e){return op(this,arguments,void 0,function*(t,e,i=!0){var n;let[r,s]=(0,R.Z)(t)?[t,null==e||e]:[{[t]:e},i],o={nodes:[],edges:[],combos:[]};Object.entries(r).forEach(([t,e])=>{let i=this.getElementType(t);o[`${i}s`].push({id:t,style:{visibility:e}})});let{model:a,element:l}=this.context;a.preventUpdateNodeLikeHierarchy(()=>{a.updateData(o)}),yield null===(n=l.draw({animation:s,stage:"visibility"}))||void 0===n?void 0:n.finished})}showElement(t,e){return op(this,void 0,void 0,function*(){let i=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(i.map(t=>[t,"visible"])),e)})}hideElement(t,e){return op(this,void 0,void 0,function*(){let i=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(i.map(t=>[t,"hidden"])),e)})}getElementVisibility(t){var e,i;let n=this.context.element.getElement(t);return null!==(i=null===(e=null==n?void 0:n.style)||void 0===e?void 0:e.visibility)&&void 0!==i?i:"visible"}setElementZIndex(t,e){return op(this,void 0,void 0,function*(){var i;let n={nodes:[],edges:[],combos:[]},r=(0,R.Z)(t)?t:{[t]:e};Object.entries(r).forEach(([t,e])=>{let i=this.getElementType(t);n[`${i}s`].push({id:t,style:{zIndex:e}})});let{model:s,element:o}=this.context;s.preventUpdateNodeLikeHierarchy(()=>s.updateData(n)),yield null===(i=o.draw({animation:!1,stage:"zIndex"}))||void 0===i?void 0:i.finished})}frontElement(t){return op(this,void 0,void 0,function*(){let e=Array.isArray(t)?t:[t],{model:i}=this.context,n={};e.map(t=>{let e=i.getFrontZIndex(t),r=i.getElementType(t);if("combo"===r){let r=i.getAncestorsData(t,N).at(-1)||this.getComboData(t),s=[r,...i.getDescendantsData(tv(r))],o=e-sW(r);s.forEach(t=>{n[tv(t)]=this.getElementZIndex(tv(t))+o});let{internal:a}=iC(s.map(tv),t=>i.getRelatedEdgesData(t));a.forEach(t=>{let e=tv(t);n[e]=this.getElementZIndex(e)+o})}else n[t]=e}),yield this.setElementZIndex(n)})}getElementZIndex(t){return sW(this.context.model.getElementDataById(t))}setElementState(t,e){return op(this,arguments,void 0,function*(t,e,i=!0){var n;let[r,s]=(0,R.Z)(t)?[t,null==e||e]:[{[t]:e},i],o=t=>t?Array.isArray(t)?t:[t]:[],a={nodes:[],edges:[],combos:[]};Object.entries(r).forEach(([t,e])=>{let i=this.getElementType(t);a[`${i}s`].push({id:t,states:o(e)})}),this.updateData(a),yield null===(n=this.context.element.draw({animation:s,stage:"state"}))||void 0===n?void 0:n.finished})}getElementState(t){return this.context.model.getElementState(t)}getElementRenderBounds(t){return this.context.element.getElement(t).getRenderBounds()}collapseElement(t){return op(this,arguments,void 0,function*(t,e=!0){let{model:i,element:n}=this.context;if(ef(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;"boolean"==typeof e&&(e={animation:e,align:!0});let r=i.getElementType(t);yield this.frontElement(t),this.isCollapsingExpanding=!0,i.updateData("node"===r?{nodes:[{id:t,style:{collapsed:!0}}]}:{combos:[{id:t,style:{collapsed:!0}}]}),"node"===r?yield n.collapseNode(t,e):"combo"===r&&(yield n.collapseCombo(t,!!e.animation)),this.isCollapsingExpanding=!1})}expandElement(t){return op(this,arguments,void 0,function*(t,e=!0){let{model:i,element:n}=this.context;if(!ef(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;"boolean"==typeof e&&(e={animation:e,align:!0});let r=i.getElementType(t);this.isCollapsingExpanding=!0,i.updateData("node"===r?{nodes:[{id:t,style:{collapsed:!1}}]}:{combos:[{id:t,style:{collapsed:!1}}]}),"node"===r?yield n.expandNode(t,e):"combo"===r&&(yield n.expandCombo(t,!!e.animation)),this.isCollapsingExpanding=!1})}setElementCollapsibility(t,e){let i=this.getElementType(t);"node"===i?this.updateNodeData([{id:t,style:{collapsed:e}}]):"combo"===i&&this.updateComboData([{id:t,style:{collapsed:e}}])}toDataURL(){return op(this,arguments,void 0,function*(t={}){return this.context.canvas.toDataURL(t)})}getCanvasByViewport(t){return this.context.canvas.getCanvasByViewport(t)}getViewportByCanvas(t){return this.context.canvas.getViewportByCanvas(t)}getClientByCanvas(t){return this.context.canvas.getClientByCanvas(t)}getCanvasByClient(t){return this.context.canvas.getCanvasByClient(t)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(t,e,i){return super.on(t,e,i)}once(t,e){return super.once(t,e)}off(t,e){return super.off(t,e)}}og.defaultOptions={autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]};var of=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i};function oy(t,e){let{getNodeData:i=(t,e)=>{if(t.depth=e,!t.children)return t;let{children:i}=t,n=of(t,["children"]);return Object.assign(Object.assign({},n),{children:i.map(t=>t.id)})},getEdgeData:n=(t,e)=>({source:t.id,target:e.id}),getChildren:r=t=>t.children||[]}=e||{},s=[],o=[];return eh(t,(t,e)=>{s.push(i(t,e));let a=r(t);for(let e of a)o.push(n(t,e))},t=>r(t),"TB"),{nodes:s,edges:o}}let om=(t,e)=>{let{source:i,target:n}=e,r=t.getElementDataById(i),s=t.getElementDataById(n),o=iT(r,e=>t.getParentData(e,N)),a=iT(s,e=>t.getParentData(e,N)),l=tv(o),h=tv(a),d={sourceNode:l,targetNode:h};return e.style?Object.assign(e.style,d):e.style=d,e},ov=(t,e,i)=>{let[n,r]=e,[s,o]=i;return r===n?s:s+(t-n)/(r-n)*(o-s)},ob=(t,e,i)=>{let[n,r]=e,[s,o]=i;return s+Math.log(t-n+1)/Math.log(r-n+1)*(o-s)},oE=(t,e,i,n=2)=>{let[r,s]=e,[o,a]=i;return o+Math.pow((t-r)/(s-r),n)*(a-o)},ox=(t,e,i)=>{let[n,r]=e,[s,o]=i;return s+Math.sqrt((t-n)/(r-n))*(o-s)};class oO extends sO{constructor(t,e){super(t,(0,tN.Z)({},oO.defaultOptions,e)),this.assignSizeByCentrality=(t,e,i,n,r,s)=>{let o=[e,i],a=[n[0],r[0]],l=[n[1],r[1]],h=[n[2],r[2]],d=(t,e)=>{if("function"==typeof s)return s(t,o,e);switch(s){case"linear":return ov(t,o,e);case"log":return ob(t,o,e);case"pow":return oE(t,o,e,2);case"sqrt":return ox(t,o,e);default:return e[0]}};return[d(t,a),d(t,l),d(t,h)]}}beforeDraw(t){let{model:e}=this.context,i=e.getNodeData(),n=ew(this.options.maxSize),r=ew(this.options.minSize),s=this.getCentralities(this.options.centrality),o=s.size>0?Math.max(...s.values()):0,a=s.size>0?Math.min(...s.values()):0;return i.forEach(e=>{var i;let l=this.assignSizeByCentrality(s.get(tv(e))||0,a,o,r,n,this.options.scale),h=null===(i=this.context.element)||void 0===i?void 0:i.getElement(tv(e)),d={size:l};this.assignLabelStyle(d,l,e,h),h&&sS(d,h.attributes)||sw(t,h?"update":"add","node",(0,tN.Z)(e,{style:d}),!0)}),t}assignLabelStyle(t,e,i,n){var r;let s=n?n.config.style:null===(r=this.context.element)||void 0===r?void 0:r.getElementComputedStyle("node",i);if(Object.assign(t,(0,e9.Z)(s,["labelFontSize","labelLineHeight"])),this.options.mapLabelSize){let i=this.getLabelSizeByNodeSize(e,1/0,Number(t.labelFontSize));Object.assign(t,{labelFontSize:i,labelLineHeight:i+function(t=0){let e=tr(t);return e[0]+e[2]}(t.labelPadding)})}return t}getLabelSizeByNodeSize(t,e,i){let[n,r]=Array.isArray(this.options.mapLabelSize)?this.options.mapLabelSize:[i,e];return Math.min(r,Math.max(Math.min(...t)/2,n))}getCentralities(t){let{model:e}=this.context,i=e.getData();if("function"==typeof t)return t(i);let n=e.getRelatedEdgesData.bind(e);return tE(i,n,t)}}oO.defaultOptions={centrality:{type:"degree"},maxSize:80,minSize:20,scale:"linear",mapLabelSize:!1};class ow extends sO{constructor(t,e){super(t,Object.assign({},ow.defaultOptions,e))}get ref(){return this.context.model.getRootsData()[0]}afterLayout(){var t;let e=tQ(this.ref),{graph:i,model:n}=this.context,r=n.getData();null===(t=r.nodes)||void 0===t||t.forEach(t=>{var r;if(tv(t)===tv(this.ref))return;let s=tK(tB(tQ(t),e)),o=Math.abs(s)>Math.PI/2,a=!t.children||0===t.children.length,l=tv(t),h=null===(r=this.context.element)||void 0===r?void 0:r.getElement(l);if(!h||!h.isVisible())return;let d=ew(i.getElementRenderStyle(l).size)[0]/2,c=(a?1:-1)*(d+this.options.offset),u=[["translate",c*Math.cos(s),c*Math.sin(s)],["rotate",o?(0,C.BV)(s)+180:(0,C.BV)(s)]];n.updateNodeData([{id:tv(t),style:{labelTextAlign:o===a?"right":"left",labelTextBaseline:"middle",labelTransform:u}}])}),i.draw()}}ow.defaultOptions={offset:5};let oS=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"];class oD extends sO{constructor(t,e){super(t,Object.assign({},oD.defaultOptions,e)),this.cacheMergeStyle=new Map,this.getAffectedParallelEdges=t=>{let{add:{edges:e},update:{nodes:i,edges:n,combos:r},remove:{edges:s}}=t,{model:o}=this.context,a=new Map,l=(t,e)=>{let i=o.getRelatedEdgesData(e);i.forEach(t=>!a.has(tv(t))&&a.set(tv(t),t))};i.forEach(l),r.forEach(l);let h=t=>{let e=o.getEdgeData().map(t=>om(o,t)),i=oC(t,e,!0);i.forEach(t=>!a.has(tv(t))&&a.set(tv(t),t))};if(s.size&&s.forEach(h),e.size&&e.forEach(h),n.size){let t=rE(rb(o.getChanges())).update.edges;n.forEach(e=>{var i;h(e);let n=null===(i=t.find(t=>tv(t.value)===tv(e)))||void 0===i?void 0:i.original;n&&!oT(e,n)&&h(n)})}(0,eR.Z)(this.options.edges)||a.forEach((t,e)=>!this.options.edges.includes(e)&&a.delete(e));let d=o.getEdgeData().map(tv);return new Map([...a].sort((t,e)=>d.indexOf(t[0])-d.indexOf(e[0])))},this.applyBundlingStyle=(t,e,i)=>{let{edgeMap:n,reverses:r}=oM(e);n.forEach(e=>{e.forEach((e,n,s)=>{var o;let a=s.length,l=e.style||{};if(e.source===e.target){let t=oS.length;l.loopPlacement=oS[n%t],l.loopDist=Math.floor(n/t)*i+50}else if(1===a)l.curveOffset=0;else{let t=(n%2==0?1:-1)*(r[`${e.source}|${e.target}|${n}`]?-1:1);l.curveOffset=a%2==1?t*Math.ceil(n/2)*i*2:t*(Math.floor(n/2)*i*2+i)}let h=Object.assign(e,{type:"quadratic",style:l}),d=null===(o=this.context.element)||void 0===o?void 0:o.getElement(tv(e));d&&sS(h.style,d.attributes)||sw(t,d?"update":"add","edge",h,!0)})})},this.resetEdgeStyle=t=>{let e=t.style||{},i=this.cacheMergeStyle.get(tv(t))||{};return Object.keys(i).forEach(n=>{(0,A.Z)(e[n],i[n])&&(t[n]?e[n]=t[n]:delete e[n])}),Object.assign(t,{style:e})},this.applyMergingStyle=(t,e)=>{let{edgeMap:i,reverses:n}=oM(e);i.forEach(e=>{var i;if(1===e.length){let n=e[0],r=null===(i=this.context.element)||void 0===i?void 0:i.getElement(tv(n)),s=this.resetEdgeStyle(n);r&&sS(s,r.attributes)||sw(t,r?"update":"add","edge",s);return}let r=e.map(({source:t,target:e,style:i={}},r)=>{let{startArrow:s,endArrow:o}=i,a={},[l,h]=n[`${t}|${e}|${r}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return(0,ry.Z)(s)&&(a[l]=s),(0,ry.Z)(o)&&(a[h]=o),a}).reduce((t,e)=>Object.assign(Object.assign({},t),e),{});e.forEach((e,i,n)=>{var s;if(0!==i){sw(t,"remove","edge",e);return}let o=Object.assign({},(0,J.Z)(this.options.style)?this.options.style(n):this.options.style,{childrenData:n});this.cacheMergeStyle.set(tv(e),o);let a=Object.assign(Object.assign({},e),{type:"line",style:Object.assign(Object.assign(Object.assign({},e.style),r),o)}),l=null===(s=this.context.element)||void 0===s?void 0:s.getElement(tv(e));l&&sS(a.style,l.attributes)||sw(t,l?"update":"add","edge",a,!0)})})}}beforeDraw(t){let e=this.getAffectedParallelEdges(t);return 0===e.size||("bundle"===this.options.mode?this.applyBundlingStyle(t,e,this.options.distance):this.applyMergingStyle(t,e)),t}}oD.defaultOptions={mode:"bundle",distance:15};let oM=t=>{let e=new Map,i=new Set,n={},r=new Map;for(let[s,o]of t){if(i.has(s))continue;let{source:a,target:l}=o,h=`${a}-${l}`;e.has(h)||(e.set(h,[]),r.set(h,new Set));let d=e.get(h),c=r.get(h);for(let[u,p]of(d&&c&&!c.has(s)&&(d.push(o),c.add(s),i.add(s)),t))if(!i.has(u)&&u!==s&&oT(o,p)){let t=e.get(h),s=r.get(h);t&&s&&!s.has(u)&&(t.push(p),s.add(u),a===p.target&&l===p.source&&(n[`${p.source}|${p.target}|${t.length-1}`]=!0),i.add(u))}}return{edgeMap:e,reverses:n}},oC=(t,e,i)=>e.filter(e=>(i||tv(e)!==tv(t))&&oT(e,t)),oT=(t,e)=>{let{sourceNode:i,targetNode:n}=t.style||{},{sourceNode:r,targetNode:s}=e.style||{};return i===r&&n===s||i===s&&n===r},oP={animation:{"combo-collapse":q,"combo-expand":q,"node-collapse":K,"node-expand":K,"path-in":X,"path-out":X,fade:[{fields:["opacity"]}],translate:[{fields:["x","y"]}]},behavior:{"brush-select":eo,"click-select":eg,"collapse-expand":nl,"create-edge":nu,"drag-canvas":nf,"drag-element-force":class extends nm{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(t=>["d3-force","d3-force-3d"].includes(null==t?void 0:t.id))}validate(t){return!!this.context.layout&&(this.forceLayoutInstance?super.validate(t):(_.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1))}moveElement(t,e){var i,n,r,s;return i=this,n=void 0,r=void 0,s=function*(){let i=this.forceLayoutInstance;this.context.graph.getNodeData(t).forEach((n,r)=>{let{x:s=0,y:o=0}=n.style||{};i&&nO(i,"setFixedPosition",t[r],[...tI([+s,+o],e)])})},new(r||(r=Promise))(function(t,e){function o(t){try{l(s.next(t))}catch(t){e(t)}}function a(t){try{l(s.throw(t))}catch(t){e(t)}}function l(e){var i;e.done?t(e.value):((i=e.value)instanceof r?i:new r(function(t){t(i)})).then(o,a)}l((s=s.apply(i,n||[])).next())})}onDragStart(t){if(this.enable=this.validate(t),!this.enable)return;this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);let e=this.forceLayoutInstance;e&&nw(e,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(t=>{let{x:i=0,y:n=0}=t.style||{};e&&nO(e,"setFixedPosition",tv(t),[+i,+n])})}onDrag(t){if(!this.enable)return;let e=this.getDelta(t);this.moveElement(this.target,e)}onDragEnd(){let t=this.forceLayoutInstance;t&&nw(t,"simulation").alphaTarget(0),this.options.fixed||this.context.graph.getNodeData(this.target).forEach(e=>{t&&nO(t,"setFixedPosition",tv(e),[null,null,null])})}},"drag-element":nm,"fix-element-size":nD,"focus-element":nM,"hover-activate":nC,"lasso-select":class extends eo{onPointerDown(t){if(!super.validate(t)||!super.isKeydown()||this.points)return;let{canvas:e}=this.context;this.pathShape=new C.y$({id:"g6-lasso-select",style:this.options.style}),e.appendChild(this.pathShape),this.points=[ea(t)]}onPointerMove(t){var e;if(!this.points)return;let{immediately:i,mode:n}=this.options;this.points.push(ea(t)),null===(e=this.pathShape)||void 0===e||e.setAttribute("d",function(t,e=!0){let i=[];return t.forEach((t,e)=>{i.push([0===e?"M":"L",...t])}),e&&i.push(["Z"]),i}(this.points)),i&&"default"===n&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var t;null===(t=this.pathShape)||void 0===t||t.remove(),this.pathShape=void 0,this.points=void 0}},"auto-adapt-label":tk,"optimize-viewport-transform":nT,"scroll-canvas":nA,"zoom-canvas":nk},combo:{circle:class extends io{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",C.Cd,this.getKeyStyle(t),e)}getKeyStyle(t){let{collapsed:e}=t,i=super.getKeyStyle(t),[n]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},i),e&&eE(i,"collapsed")),{r:n/2})}getCollapsedKeySize(t){let[e,i]=ew(t.collapsedSize),n=Math.max(e,i)/2;return[2*n,2*n,0]}getExpandedKeySize(t){let e=this.getContentBBox(t),[i,n]=ta(e),r=Math.sqrt(Math.pow(i,2)+Math.pow(n,2))/2;return[2*r,2*r,0]}getIntersectPoint(t,e=!1){let i=this.getShape("key").getBounds();return t5(t,i,e)}},rect:class extends io{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",C.UL,this.getKeyStyle(t),e)}getKeyStyle(t){let e=super.getKeyStyle(t),[i,n]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},e),t.collapsed&&eE(e,"collapsed")),{width:i,height:n,x:-i/2,y:-n/2})}}},edge:{cubic:iF,line:i$,polyline:iQ,quadratic:i0,"cubic-horizontal":i_,"cubic-radial":iz,"cubic-vertical":iZ},layout:{"antv-dagre":nj.b,"combo-combined":nB.u,"compact-box":nN.compactBox,"d3-force":n_.j,"force-atlas2":nZ.E,circular:nI.S,concentric:nF.W,dagre:nz.V,dendrogram:nN.dendrogram,fishbone:nK,force:n$.y,fruchterman:nV.O,grid:nH.M,indented:nN.indented,mds:nW.A,mindmap:nN.mindmap,radial:nG.D,random:nY._,snake:nQ},node:{circle:eq,diamond:class extends eJ{constructor(t){super(t)}getPoints(t){let[e,i]=this.getSize(t);return[[0,-i/2],[e/2,0],[0,i/2],[-e/2,0]]}},ellipse:e8,hexagon:class extends eJ{constructor(t){super(t)}getOuterR(t){return t.outerR||Math.min(...this.getSize(t))/2}getPoints(t){var e;return[[0,e=this.getOuterR(t)],[e*Math.sqrt(3)/2,e/2],[e*Math.sqrt(3)/2,-e/2],[0,-e],[-e*Math.sqrt(3)/2,-e/2],[-e*Math.sqrt(3)/2,e/2]]}getIconStyle(t){let e=super.getIconStyle(t),i=.8*this.getOuterR(t);return!!e&&Object.assign({width:i,height:i},e)}},html:it,image:ii,rect:class extends eX{constructor(t){super(t)}getKeyStyle(t){let[e,i]=this.getSize(t);return Object.assign(Object.assign({},super.getKeyStyle(t)),{width:e,height:i,x:-e/2,y:-i/2})}getIconStyle(t){let e=super.getIconStyle(t),{width:i,height:n}=this.getShape("key").attributes;return!!e&&Object.assign({width:.8*i,height:.8*n},e)}drawKeyShape(t,e){return this.upsert("key",C.UL,this.getKeyStyle(t),e)}},star:class extends eJ{constructor(t){super(t)}getInnerR(t){return t.innerR||3*this.getOuterR(t)/8}getOuterR(t){return Math.min(...this.getSize(t))/2}getPoints(t){var e,i;return[[0,-(e=this.getOuterR(t))],[(i=this.getInnerR(t))*Math.cos(3*Math.PI/10),-i*Math.sin(3*Math.PI/10)],[e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[i*Math.cos(Math.PI/10),i*Math.sin(Math.PI/10)],[e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[0,i],[-e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[-i*Math.cos(Math.PI/10),i*Math.sin(Math.PI/10)],[-e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[-i*Math.cos(3*Math.PI/10),-i*Math.sin(3*Math.PI/10)]]}getIconStyle(t){let e=super.getIconStyle(t),i=2*this.getInnerR(t)*.8;return!!e&&Object.assign({width:i,height:i},e)}getPortXY(t,e){let{placement:i="top"}=e,n=this.getShape("key").getLocalBounds(),r=function(t,e){let i={};return i.top=[0,-t],i.left=[-t*Math.cos(Math.PI/10),-t*Math.sin(Math.PI/10)],i["left-bottom"]=[-t*Math.cos(3*Math.PI/10),t*Math.sin(3*Math.PI/10)],i.bottom=[0,e],i["right-bottom"]=[t*Math.cos(3*Math.PI/10),t*Math.sin(3*Math.PI/10)],i.right=i.default=[t*Math.cos(Math.PI/10),-t*Math.sin(Math.PI/10)],i}(this.getOuterR(t),this.getInnerR(t));return i4(n,i,r,!1)}},donut:e0,triangle:ir},palette:{spectral:["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],tableau:["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],oranges:["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],greens:["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],blues:["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"]},theme:{dark:sE,light:sx},plugin:{"bubble-sets":n9,"edge-bundling":rn,"edge-filter-lens":ru,"grid-line":rm,background:n6,contextmenu:ri,fisheye:rg,fullscreen:rf,history:rx,hull:rY,legend:rq,minimap:rJ,snapline:r3,timebar:se,toolbar:sl,tooltip:sc,watermark:sf},transform:{"arrange-draw-order":class extends sO{beforeDraw(t){let{model:e}=this.context,i=t.add.combos,n=t=>{let i=[];return t.forEach((t,n)=>{let r=e.getAncestorsData(n,"combo"),s=r.map(t=>tv(t)).reverse();i.push([n,t,s.length])}),new Map(i.sort(([,,t],[,,e])=>e-t).map(([t,e])=>[t,e]))};return t.add.combos=n(i),t.update.combos=n(t.update.combos),t}},"collapse-expand-combo":class extends sO{beforeDraw(t,e){if("visibility"===e.stage||!this.context.model.model.hasTreeStructure(N))return t;let{model:i}=this.context,{add:n,update:r}=t,s=[...t.update.combos.entries(),...t.add.combos.entries()];for(;s.length;){let[e,o]=s.pop();if(ef(o)){let o=i.getDescendantsData(e),a=o.map(tv),{internal:l,external:h}=iC(a,t=>i.getRelatedEdgesData(t));o.forEach(e=>{let n=tv(e),r=s.findIndex(([t])=>t===n);-1!==r&&s.splice(r,1);let o=i.getElementType(n);sw(t,"remove",o,e)}),l.forEach(e=>sw(t,"remove","edge",e)),h.forEach(t=>{var e;let i=tv(t),s=null===(e=this.context.element)||void 0===e?void 0:e.getElement(i);s?r.edges.set(i,t):n.edges.set(i,t)})}else{let n=i.getChildrenData(e),r=n.map(tv),{edges:o}=iC(r,t=>i.getRelatedEdgesData(t));[...n,...o].forEach(e=>{var n;let r=tv(e),o=i.getElementType(r),a=null===(n=this.context.element)||void 0===n?void 0:n.getElement(r);a?sw(t,"update",o,e):sw(t,"add",o,e),"combo"===o&&s.push([r,e])})}}return t}},"collapse-expand-node":class extends sO{getElement(t){return this.context.element.getElement(t)}handleExpand(t,e){if(sD(e,"add","node",t),ef(t))return;let i=tv(t);sD(e,"add","node",t);let n=this.context.model.getRelatedEdgesData(i);n.forEach(t=>{sw(e,"add","edge",t)});let r=this.context.model.getChildrenData(i);r.forEach(t=>{this.handleExpand(t,e)})}beforeDraw(t){let{graph:e,model:i}=this.context;if(!i.model.hasTreeStructure(j))return t;let{add:{nodes:n,edges:r},update:{nodes:s}}=t,o=new Map,a=new Map;n.forEach((t,e)=>{ef(t)&&o.set(e,t)}),r.forEach(t=>{if("node"!==e.getElementType(t.source))return;let i=e.getNodeData(t.source);ef(i)&&o.set(t.source,i)}),s.forEach((t,e)=>{let i=this.getElement(e);if(!i)return;let n=i.attributes.collapsed;ef(t)?n||o.set(e,t):n&&a.set(e,t)});let l=new Set;return o.forEach((e,n)=>{let r=i.getDescendantsData(n);r.forEach(e=>{let n=tv(e);if(l.has(n))return;sw(t,"remove","node",e);let r=i.getRelatedEdgesData(n);r.forEach(e=>{sw(t,"remove","edge",e)}),l.add(n)})}),a.forEach((e,n)=>{let r=i.getAncestorsData(n,j);if(r.some(ef)){sw(t,"remove","node",e);return}this.handleExpand(e,t)}),t}},"get-edge-actual-ends":class extends sO{beforeDraw(t){let{add:e,update:i}=t,{model:n}=this.context;return[...e.edges.entries(),...i.edges.entries()].forEach(([,t])=>{om(n,t)}),t}},"map-node-size":oO,"place-radial-labels":ow,"process-parallel-edges":oD,"update-related-edges":class extends sO{beforeDraw(t,e){let{stage:i}=e;if("visibility"===i)return t;let{model:n}=this.context,{update:{nodes:r,edges:s,combos:o}}=t,a=(t,e)=>{let i=n.getRelatedEdgesData(e);i.forEach(t=>!s.has(tv(t))&&s.set(tv(t),t))};return r.forEach(a),o.forEach(a),t}}},shape:{circle:C.Cd,ellipse:C.Pj,group:C.ZA,html:C.k9,image:e$,line:C.x1,path:C.y$,polygon:C.mg,polyline:C.aH,rect:C.UL,text:C.xv,label:eI,badge:eB}};Object.entries(oP).forEach(([t,e])=>{Object.entries(e).forEach(([e,i])=>{sC(t,e,i)})})},74355:function(t){"undefined"!=typeof self&&self,t.exports=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=5)}([function(t,e){t.exports={assign:Object.assign,getHeight:function(t,e,i,n){return void 0===n&&(n="height"),"center"===i?(t[n]+e[n])/2:t.height}}},function(t,e,i){var n=i(3),r=function(){function t(t,e){void 0===e&&(e={}),this.options=e,this.rootNode=n(t,e)}return t.prototype.execute=function(){throw Error("please override this method")},t}();t.exports=r},function(t,e,i){var n=i(4),r=["LR","RL","TB","BT","H","V"],s=["LR","RL","H"],o=r[0];t.exports=function(t,e,i){var a=e.direction||o;if(e.isHorizontal=s.indexOf(a)>-1,a&&-1===r.indexOf(a))throw TypeError("Invalid direction: "+a);if(a===r[0])i(t,e);else if(a===r[1])i(t,e),t.right2left();else if(a===r[2])i(t,e);else if(a===r[3])i(t,e),t.bottom2top();else if(a===r[4]||a===r[5]){var l=n(t,e),h=l.left,d=l.right;i(h,e),i(d,e),e.isHorizontal?h.right2left():h.bottom2top(),d.translate(h.x-d.x,h.y-d.y),t.x=h.x,t.y=d.y;var c=t.getBoundingBox();e.isHorizontal?c.top<0&&t.translate(0,-c.top):c.left<0&&t.translate(-c.left,0)}var u=e.fixedRoot;return void 0===u&&(u=!0),u&&t.translate(-(t.x+t.width/2+t.hgap),-(t.y+t.height/2+t.vgap)),function(t,e){if(e.radial){var i=e.isHorizontal?["x","y"]:["y","x"],n=i[0],r=i[1],s={x:1/0,y:1/0},o={x:-1/0,y:-1/0},a=0;t.DFTraverse(function(t){a++;var e=t.x,i=t.y;s.x=Math.min(s.x,e),s.y=Math.min(s.y,i),o.x=Math.max(o.x,e),o.y=Math.max(o.y,i)});var l=o[r]-s[r];if(0!==l){var h=2*Math.PI/a;t.DFTraverse(function(e){var i=(e[r]-s[r])/l*(2*Math.PI-h)+h,o=e[n]-t[n];e.x=Math.cos(i)*o,e.y=Math.sin(i)*o})}}}(t,e),t}},function(t,e,i){var n=i(0),r={getId:function(t){return t.id||t.name},getPreH:function(t){return t.preH||0},getPreV:function(t){return t.preV||0},getHGap:function(t){return t.hgap||18},getVGap:function(t){return t.vgap||18},getChildren:function(t){return t.children},getHeight:function(t){return t.height||36},getWidth:function(t){var e=t.label||" ";return t.width||18*e.split("").length}};function s(t,e){if(this.vgap=this.hgap=0,t instanceof s)return t;this.data=t;var i=e.getHGap(t),n=e.getVGap(t);return this.preH=e.getPreH(t),this.preV=e.getPreV(t),this.width=e.getWidth(t),this.height=e.getHeight(t),this.width+=this.preH,this.height+=this.preV,this.id=e.getId(t),this.x=this.y=0,this.depth=0,this.children||(this.children=[]),this.addGap(i,n),this}n.assign(s.prototype,{isRoot:function(){return 0===this.depth},isLeaf:function(){return 0===this.children.length},addGap:function(t,e){this.hgap+=t,this.vgap+=e,this.width+=2*t,this.height+=2*e},eachNode:function(t){for(var e,i=[this];e=i.shift();)t(e),i=e.children.concat(i)},DFTraverse:function(t){this.eachNode(t)},BFTraverse:function(t){for(var e,i=[this];e=i.shift();)t(e),i=i.concat(e.children)},getBoundingBox:function(){var t={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(e){t.left=Math.min(t.left,e.x),t.top=Math.min(t.top,e.y),t.width=Math.max(t.width,e.x+e.width),t.height=Math.max(t.height,e.y+e.height)}),t},translate:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.eachNode(function(i){i.x+=t,i.y+=e,i.x+=i.preH,i.y+=i.preV})},right2left:function(){var t=this.getBoundingBox();this.eachNode(function(e){e.x=e.x-(e.x-t.left)*2-e.width}),this.translate(t.width,0)},bottom2top:function(){var t=this.getBoundingBox();this.eachNode(function(e){e.y=e.y-(e.y-t.top)*2-e.height}),this.translate(0,t.height)}}),t.exports=function(t,e,i){void 0===e&&(e={}),e=n.assign({},r,e);var o,a=new s(t,e),l=[a];if(!i&&!t.collapsed){for(;o=l.shift();)if(!o.data.collapsed){var h=e.getChildren(o.data),d=h?h.length:0;if(o.children=Array(d),h&&d)for(var c=0;c<d;c++){var u=new s(h[c],e);o.children[c]=u,l.push(u),u.parent=o,u.depth=o.depth+1}}}return a}},function(t,e,i){var n=i(3);t.exports=function(t,e){for(var i=n(t.data,e,!0),r=n(t.data,e,!0),s=t.children.length,o=Math.round(s/2),a=e.getSide||function(t,e){return e<o?"right":"left"},l=0;l<s;l++){var h=t.children[l];"right"===a(h,l)?r.children.push(h):i.children.push(h)}return i.eachNode(function(t){t.isRoot()||(t.side="left")}),r.eachNode(function(t){t.isRoot()||(t.side="right")}),{left:i,right:r}}},function(t,e,i){var n={compactBox:i(6),dendrogram:i(8),indented:i(10),mindmap:i(12)};t.exports=n},function(t,e,i){function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var r=i(1),s=i(7),o=i(2),a=i(0),l=function(t){function e(){return t.apply(this,arguments)||this}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t),e.prototype.execute=function(){return o(this.rootNode,this.options,s)},e}(r),h={};t.exports=function(t,e){return e=a.assign({},h,e),new l(t,e).execute()}},function(t,e){function i(t,e,i,n){void 0===n&&(n=[]),this.w=t||0,this.h=e||0,this.y=i||0,this.x=0,this.c=n||[],this.cs=n.length,this.prelim=0,this.mod=0,this.shift=0,this.change=0,this.tl=null,this.tr=null,this.el=null,this.er=null,this.msel=0,this.mser=0}i.fromNode=function(t,e){if(!t)return null;var n=[];return(t.children.forEach(function(t){n.push(i.fromNode(t,e))}),e)?new i(t.height,t.width,t.x,n):new i(t.width,t.height,t.y,n)},t.exports=function(t,e){void 0===e&&(e={});var n,r=e.isHorizontal;function s(t){0===t.cs?(t.el=t,t.er=t,t.msel=t.mser=0):(t.el=t.c[0].el,t.msel=t.c[0].msel,t.er=t.c[t.cs-1].er,t.mser=t.c[t.cs-1].mser)}function o(t){return t.y+t.h}function a(t,e,i){for(;null!==i&&t>=i.low;)i=i.nxt;return{low:t,index:e,nxt:i}}!function t(e,i,n){void 0===n&&(n=0),i?(e.x=n,n+=e.width):(e.y=n,n+=e.height),e.children.forEach(function(e){t(e,i,n)})}(t,r);var l=i.fromNode(t,r);return function t(e){if(0===e.cs){s(e);return}t(e.c[0]);for(var i=a(o(e.c[0].el),0,null),n=1;n<e.cs;++n){t(e.c[n]);var r=o(e.c[n].er);(function(t,e,i){for(var n=t.c[e-1],r=n.mod,s=t.c[e],a=s.mod;null!==n&&null!==s;){o(n)>i.low&&(i=i.nxt);var l,h,d,c=r+n.prelim+n.w-(a+s.prelim);c>0&&(a+=c,l=i.index,t.c[e].mod+=c,t.c[e].msel+=c,t.c[e].mser+=c,function(t,e,i,n){if(i!==e-1){var r=e-i;t.c[i+1].shift+=n/r,t.c[e].shift-=n/r,t.c[e].change-=n-n/r}}(t,e,l,c));var u=o(n),p=o(s);u<=p&&null!==(n=0===(h=n).cs?h.tr:h.c[h.cs-1])&&(r+=n.mod),u>=p&&null!==(s=0===(d=s).cs?d.tl:d.c[0])&&(a+=s.mod)}!n&&s?function(t,e,i,n){var r=t.c[0].el;r.tl=i;var s=n-i.mod-t.c[0].msel;r.mod+=s,r.prelim-=s,t.c[0].el=t.c[e].el,t.c[0].msel=t.c[e].msel}(t,e,s,a):n&&!s&&function(t,e,i,n){var r=t.c[e].er;r.tr=i;var s=n-i.mod-t.c[e].mser;r.mod+=s,r.prelim-=s,t.c[e].er=t.c[e-1].er,t.c[e].mser=t.c[e-1].mser}(t,e,n,r)})(e,n,i),i=a(r,n,i)}e.prelim=(e.c[0].prelim+e.c[0].mod+e.c[e.cs-1].mod+e.c[e.cs-1].prelim+e.c[e.cs-1].w)/2-e.w/2,s(e)}(l),function t(e,i){i+=e.mod,e.x=e.prelim+i,function(t){for(var e=0,i=0,n=0;n<t.cs;n++)e+=t.c[n].shift,i+=e+t.c[n].change,t.c[n].mod+=i}(e);for(var n=0;n<e.cs;n++)t(e.c[n],i)}(l,0),function t(e,i,n){n?i.y=e.x:i.x=e.x,e.c.forEach(function(e,r){t(e,i.children[r],n)})}(l,t,r),n=function t(e,i){var n=i?e.y:e.x;return e.children.forEach(function(e){n=Math.min(t(e,i),n)}),n}(t,r),function t(e,i,n){n?e.y+=i:e.x+=i,e.children.forEach(function(e){t(e,i,n)})}(t,-n,r),t}},function(t,e,i){function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var r=i(1),s=i(9),o=i(2),a=i(0),l=function(t){function e(){return t.apply(this,arguments)||this}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t),e.prototype.execute=function(){return this.rootNode.width=0,o(this.rootNode,this.options,s)},e}(r),h={};t.exports=function(t,e){return e=a.assign({},h,e),new l(t,e).execute()}},function(t,e,i){var n=i(0);function r(t,e){void 0===t&&(t=0),void 0===e&&(e=[]),this.x=this.y=0,this.leftChild=this.rightChild=null,this.height=0,this.children=e}var s={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};t.exports=function(t,e){void 0===e&&(e={}),e=n.assign({},s,e);var i,o=0,a=function t(e){if(!e)return null;e.width=0,e.depth&&e.depth>o&&(o=e.depth);var i=e.children,n=i.length,s=new r(e.height,[]);return i.forEach(function(e,i){var r=t(e);s.children.push(r),0===i&&(s.leftChild=r),i===n-1&&(s.rightChild=r)}),s.originNode=e,s.isLeaf=e.isLeaf(),s}(t);return function t(e){if(e.isLeaf||0===e.children.length)e.drawingDepth=o;else{var i=e.children.map(function(e){return t(e)}),n=Math.min.apply(null,i);e.drawingDepth=n-1}return e.drawingDepth}(a),function t(n){n.x=n.drawingDepth*e.rankSep,n.isLeaf?(n.y=0,i&&(n.y=i.y+i.height+e.nodeSep,n.originNode.parent!==i.originNode.parent&&(n.y+=e.subTreeSep)),i=n):(n.children.forEach(function(e){t(e)}),n.y=(n.leftChild.y+n.rightChild.y)/2)}(a),function t(e,i,n){n?(i.x=e.x,i.y=e.y):(i.x=e.y,i.y=e.x),e.children.forEach(function(e,r){t(e,i.children[r],n)})}(a,t,e.isHorizontal),t}},function(t,e,i){function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var r=i(1),s=i(11),o=i(4),a=i(0),l=["LR","RL","H"],h=l[0],d=function(t){function e(){return t.apply(this,arguments)||this}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t),e.prototype.execute=function(){var t=this.options,e=this.rootNode;t.isHorizontal=!0;var i=t.indent,n=void 0===i?20:i,r=t.dropCap,a=void 0===r||r,d=t.direction,c=void 0===d?h:d,u=t.align;if(c&&-1===l.indexOf(c))throw TypeError("Invalid direction: "+c);if(c===l[0])s(e,n,a,u);else if(c===l[1])s(e,n,a,u),e.right2left();else if(c===l[2]){var p=o(e,t),g=p.left,f=p.right;s(g,n,a,u),g.right2left(),s(f,n,a,u);var y=g.getBoundingBox();f.translate(y.width,0),e.x=f.x-e.width/2}return e},e}(r),c={};t.exports=function(t,e){return e=a.assign({},c,e),new d(t,e).execute()}},function(t,e,i){var n=i(0);t.exports=function(t,e,i,r){var s=null;t.eachNode(function(t){(function(t,e,i,r,s){var o=("function"==typeof i?i(t):i)*t.depth;if(!r)try{if(t.id===t.parent.children[0].id){t.x+=o,t.y=e?e.y:0;return}}catch(t){}if(t.x+=o,e){if(t.y=e.y+n.getHeight(e,t,s),e.parent&&t.parent.id!==e.parent.id){var a=e.parent,l=a.y+n.getHeight(a,t,s);t.y=l>t.y?l:t.y}}else t.y=0})(t,s,e,i,r),s=t})}},function(t,e,i){function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var r=i(1),s=i(13),o=i(2),a=i(0),l=function(t){function e(){return t.apply(this,arguments)||this}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t),e.prototype.execute=function(){return o(this.rootNode,this.options,s)},e}(r),h={};t.exports=function(t,e){return e=a.assign({},h,e),new l(t,e).execute()}},function(t,e,i){var n=i(0),r={getSubTreeSep:function(){return 0}};t.exports=function(t,e){void 0===e&&(e={}),e=n.assign({},r,e),t.parent={x:0,width:0,height:0,y:0},t.BFTraverse(function(t){t.x=t.parent.x+t.parent.width}),t.parent=null,function t(e,i){var n=0;return e.children.length?e.children.forEach(function(e){n+=t(e,i)}):n=e.height,e._subTreeSep=i.getSubTreeSep(e.data),e.totalHeight=Math.max(e.height,n)+2*e._subTreeSep,e.totalHeight}(t,e),t.startY=0,t.y=t.totalHeight/2-t.height/2,t.eachNode(function(t){var e=t.children,i=e.length;if(i){var n=e[0];if(n.startY=t.startY+t._subTreeSep,1===i)n.y=t.y+t.height/2-n.height/2;else{n.y=n.startY+n.totalHeight/2-n.height/2;for(var r=1;r<i;r++){var s=e[r];s.startY=e[r-1].startY+e[r-1].totalHeight,s.y=s.startY+s.totalHeight/2-s.height/2}}}}),function t(e){var i=e.children,n=i.length;if(n){i.forEach(function(e){t(e)});var r=i[0],s=i[n-1],o=s.y-r.y+s.height,a=0;if(i.forEach(function(t){a+=t.totalHeight}),o>e.height)e.y=r.y+o/2-e.height/2;else if(1!==i.length||e.height>a){var l=e.y+(e.height-o)/2-r.y;i.forEach(function(t){t.translate(0,l)})}else e.y=(r.y+r.height/2+s.y+s.height/2)/2-e.height/2}}(t)}}])},69499:function(t,e,i){"use strict";i.d(e,{d9:function(){return O},kJ:function(){return a},jn:function(){return b},Xy:function(){return D},mf:function(){return o},hj:function(){return m},Kn:function(){return l},PO:function(){return c},HD:function(){return f},o8:function(){return E},CE:function(){return M},jj:function(){return y},EL:function(){return T}});var n,r={}.toString,s=function(t,e){return r.call(t)==="[object "+e+"]"},o=function(t){return s(t,"Function")},a=function(t){return Array.isArray?Array.isArray(t):s(t,"Array")},l=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e},h=function(t,e){if(t){if(a(t))for(var i=0,n=t.length;i<n&&!1!==e(t[i],i);i++);else if(l(t)){for(var r in t)if(t.hasOwnProperty(r)&&!1===e(t[r],r))break}}},d=function(t){return"object"==typeof t&&null!==t},c=function(t){if(!d(t)||!s(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},u=function(t,e){if(void 0===e&&(e=[]),isArray(t))for(var i=0;i<t.length;i+=1)u(t[i],e);else e.push(t);return e},p=Array.prototype;p.splice,p.indexOf,Array.prototype.splice;var g=function(t,e,i){if(!a(t)&&!c(t))return t;var n=i;return h(t,function(t,i){n=e(n,t,i)}),n},f=function(t){return s(t,"String")};function y(t,e){void 0===e&&(e=new Map);var i=[];if(Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var s=t[n];e.has(s)||(i.push(s),e.set(s,!0))}return i}Object.prototype.hasOwnProperty;var m=function(t){return s(t,"Number")},v=Object.values?function(t){return Object.values(t)}:function(t){var e=[];return h(t,function(i,n){o(t)&&"prototype"===n||e.push(i)}),e},b=function(t){return s(t,"Boolean")},E=function(t){return void 0===t},x=function(t){if("object"!=typeof t||null===t)return t;if(a(t)){e=[];for(var e,i=0,n=t.length;i<n;i++)"object"==typeof t[i]&&null!=t[i]?e[i]=x(t[i]):e[i]=t[i]}else for(var r in e={},t)"object"==typeof t[r]&&null!=t[r]?e[r]=x(t[r]):e[r]=t[r];return e},O=x;Object.prototype.hasOwnProperty;var w=function(t){return null!==t&&"function"!=typeof t&&isFinite(t.length)},S=function(t,e){if(t===e)return!0;if(!t||!e||f(t)||f(e))return!1;if(w(t)||w(e)){if(t.length!==e.length)return!1;for(var i=!0,n=0;n<t.length&&(i=S(t[n],e[n]));n++);return i}if(d(t)||d(e)){var r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(var i=!0,n=0;n<r.length&&(i=S(t[r[n]],e[r[n]]));n++);return i}return!1},D=S;Object.prototype.hasOwnProperty;var M=function(t,e){return g(t,function(t,i,n){return e.includes(n)||(t[n]=i),t},{})},C={},T=function(t){return C[t=t||"g"]?C[t]+=1:C[t]=1,t+C[t]},P=i(15767);!function(t,e){if(!o(t))throw TypeError("Expected a function");var i=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var s=e?e.apply(this,n):n[0],o=i.cache;if(o.has(s))return o.get(s);var a=t.apply(this,n);return o.set(s,a),a};i.cache=new Map}(function(t,e){void 0===e&&(e={});var i=e.fontSize,r=e.fontFamily,s=e.fontWeight,o=e.fontStyle,a=e.fontVariant;return n||(n=document.createElement("canvas").getContext("2d")),n.font=[o,a,s,i+"px",r].join(" "),n.measureText(f(t)?t:"").width},function(t,e){return void 0===e&&(e={}),(0,P.pr)([t],v(e)).join("")}),function(){function t(){this.map={}}t.prototype.has=function(t){return void 0!==this.map[t]},t.prototype.get=function(t,e){var i=this.map[t];return void 0===i?e:i},t.prototype.set=function(t,e){this.map[t]=e},t.prototype.clear=function(){this.map={}},t.prototype.delete=function(t){delete this.map[t]},t.prototype.size=function(){return Object.keys(this.map).length}}()},82425:function(t,e,i){"use strict";i.d(e,{Z:function(){return s}});var n=i(13535),r=i(37234),s=function(t,e){return void 0===e&&(e=[]),(0,n.Z)(t,function(t){var i;return i=e,!((0,r.Z)(i)&&i.indexOf(t)>-1)})}},26218:function(t,e,i){"use strict";var n=i(83262),r=i(91531),s=Object.prototype.hasOwnProperty;e.Z=function(t,e){if(!e||!(0,n.Z)(t))return{};for(var i,o={},a=(0,r.Z)(e)?e:function(t){return t[e]},l=0;l<t.length;l++){var h=t[l];i=a(h),s.call(o,i)?o[i].push(h):o[i]=[h]}return o}},91984:function(t,e,i){"use strict";function n(t){return t instanceof Date}i.d(e,{Z:function(){return n}})},70591:function(t,e,i){"use strict";i.d(e,{Z:function(){return h}});var n=i(89148),r=i(37234),s={}.toString,o=Object.prototype,a=function(t){var e=t&&t.constructor,i="function"==typeof e&&e.prototype||o;return t===i},l=Object.prototype.hasOwnProperty,h=function(t){if((0,n.Z)(t))return!0;if((0,r.Z)(t))return!t.length;var e=s.call(t).replace(/^\[object /,"").replace(/]$/,"");if("Map"===e||"Set"===e)return!t.size;if(a(t))return!Object.keys(t).length;for(var i in t)if(l.call(t,i))return!1;return!0}},68731:function(t,e,i){"use strict";function n(t,e){void 0===e&&(e=new Map);var i=[];if(Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var s=t[n];e.has(s)||(i.push(s),e.set(s,!0))}return i}i.d(e,{Z:function(){return n}})},6466:function(t,e){"use strict";var i={};e.Z=function(t){return i[t=t||"g"]?i[t]+=1:i[t]=1,t+i[t]}},25470:function(t,e,i){"use strict";var n,r,s,o,a,l;function h(t,e,i,n,r,s){let o=i-t,a=n-e,l=r-t,h=s-e,d=l*o+h*a,c=0;c=d<=0?0:(d=(l=o-l)*o+(h=a-h)*a)<=0?0:d*d/(o*o+a*a);let u=l*l+h*h-c;return u<0?0:u}function d(t,e,i,n){return(t-i)*(t-i)+(e-n)*(e-n)}function c(t){let e=Math.min(t.x1,t.x2),i=Math.max(t.x1,t.x2),n=Math.min(t.y1,t.y2),r=Math.max(t.y1,t.y2);return{x:e,y:n,x2:i,y2:r,width:i-e,height:r-n}}i.d(e,{Ae:function(){return v},CF:function(){return k},vC:function(){return A},x1:function(){return u}});class u{constructor(t,e,i,n){this.x1=t,this.y1=e,this.x2=i,this.y2=n}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}draw(t){t.moveTo(this.x1,this.y1),t.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(t){return new u(t.x1,t.y1,t.x2,t.y2)}cuts(t,e){if(this.y1===this.y2||e<this.y1&&e<=this.y2||e>this.y1&&e>=this.y2||t>this.x1&&t>=this.x2)return!1;if(t<this.x1&&t<=this.x2)return!0;let i=this.x1+(e-this.y1)*(this.x2-this.x1)/(this.y2-this.y1);return t<=i}distSquare(t,e){return h(this.x1,this.y1,this.x2,this.y2,t,e)}ptClose(t,e,i){if(this.x1<this.x2){if(t<this.x1-i||t>this.x2+i)return!1}else if(t<this.x2-i||t>this.x1+i)return!1;if(this.y1<this.y2){if(e<this.y1-i||e>this.y2+i)return!1}else if(e<this.y2-i||e>this.y1+i)return!1;return!0}}(o=n||(n={}))[o.POINT=1]="POINT",o[o.PARALLEL=2]="PARALLEL",o[o.COINCIDENT=3]="COINCIDENT",o[o.NONE=4]="NONE";class p{constructor(t,e=0,i=0){this.state=t,this.x=e,this.y=i}}function g(t,e){let i=(e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1),r=(t.x2-t.x1)*(t.y1-e.y1)-(t.y2-t.y1)*(t.x1-e.x1),s=(e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1);if(s){let e=i/s,o=r/s;return 0<=e&&e<=1&&0<=o&&o<=1?new p(n.POINT,t.x1+e*(t.x2-t.x1),t.y1+e*(t.y2-t.y1)):new p(n.NONE)}return new p(0===i||0===r?n.COINCIDENT:n.PARALLEL)}function f(t,e){let i=(e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1),n=(t.x2-t.x1)*(t.y1-e.y1)-(t.y2-t.y1)*(t.x1-e.x1),r=(e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1);if(r){let t=i/r,e=n/r;if(0<=t&&t<=1&&0<=e&&e<=1)return t}return Number.POSITIVE_INFINITY}function y(t,e,i){let n=new Set;return t.width<=0?(n.add(r.LEFT),n.add(r.RIGHT)):e<t.x?n.add(r.LEFT):e>t.x+t.width&&n.add(r.RIGHT),t.height<=0?(n.add(r.TOP),n.add(r.BOTTOM)):i<t.y?n.add(r.TOP):i>t.y+t.height&&n.add(r.BOTTOM),n}function m(t,e){let i=e.x1,n=e.y1,s=e.x2,o=e.y2,a=Array.from(y(t,s,o));if(0===a.length)return!0;let l=y(t,i,n);for(;0!==l.size;){for(let t of a)if(l.has(t))return!1;if(l.has(r.RIGHT)||l.has(r.LEFT)){let e=t.x;l.has(r.RIGHT)&&(e+=t.width),n+=(e-i)*(o-n)/(s-i),i=e}else{let e=t.y;l.has(r.BOTTOM)&&(e+=t.height),i+=(e-n)*(s-i)/(o-n),n=e}l=y(t,i,n)}return!0}(a=r||(r={}))[a.LEFT=0]="LEFT",a[a.TOP=1]="TOP",a[a.RIGHT=2]="RIGHT",a[a.BOTTOM=3]="BOTTOM";class v{constructor(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(t){return new v(t.x,t.y,t.width,t.height)}equals(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}clone(){return new v(this.x,this.y,this.width,this.height)}add(t){let e=Math.min(this.x,t.x),i=Math.min(this.y,t.y),n=Math.max(this.x2,t.x+t.width),r=Math.max(this.y2,t.y+t.height);this.x=e,this.y=i,this.width=n-e,this.height=r-i}addPoint(t){let e=Math.min(this.x,t.x),i=Math.min(this.y,t.y),n=Math.max(this.x2,t.x),r=Math.max(this.y2,t.y);this.x=e,this.y=i,this.width=n-e,this.height=r-i}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(t){t.rect(this.x,this.y,this.width,this.height)}containsPt(t,e){return t>=this.x&&t<=this.x2&&e>=this.y&&e<=this.y2}get area(){return this.width*this.height}intersects(t){return!(this.area<=0)&&!(t.width<=0)&&!(t.height<=0)&&t.x+t.width>this.x&&t.y+t.height>this.y&&t.x<this.x2&&t.y<this.y2}distSquare(t,e){if(this.containsPt(t,e))return 0;let i=y(this,t,e);return i.has(r.TOP)?i.has(r.LEFT)?d(t,e,this.x,this.y):i.has(r.RIGHT)?d(t,e,this.x2,this.y):(this.y-e)*(this.y-e):i.has(r.BOTTOM)?i.has(r.LEFT)?d(t,e,this.x,this.y2):i.has(r.RIGHT)?d(t,e,this.x2,this.y2):(e-this.y2)*(e-this.y2):i.has(r.LEFT)?(this.x-t)*(this.x-t):i.has(r.RIGHT)?(t-this.x2)*(t-this.x2):0}}class b{constructor(t,e,i){this.cx=t,this.cy=e,this.radius=i}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return 2*this.radius}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return 2*this.radius}static from(t){return new b(t.cx,t.cy,t.radius)}containsPt(t,e){return d(this.cx,this.cy,t,e)<this.radius*this.radius}distSquare(t,e){let i=d(this.cx,this.cy,t,e);if(i<this.radius*this.radius)return 0;let n=Math.sqrt(i)-this.radius;return n*n}draw(t){t.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,2*Math.PI)}}class E{constructor(t,e=0,i=0,n=0,r=0,s=10,o=10,a=new Float32Array(Math.max(0,s*o)).fill(0)){this.pixelGroup=t,this.i=e,this.j=i,this.pixelX=n,this.pixelY=r,this.width=s,this.height=o,this.area=a}createSub(t,e){return new E(this.pixelGroup,t.x,t.y,e.x,e.y,t.width,t.height)}static fromPixelRegion(t,e){return new E(e,0,0,t.x,t.y,Math.ceil(t.width/e),Math.ceil(t.height/e))}copy(t,e){return new E(this.pixelGroup,this.scaleX(e.x),this.scaleY(e.y),e.x,e.y,t.width,t.height,t.area)}boundX(t){return t<this.i?this.i:t>=this.width?this.width-1:t}boundY(t){return t<this.j?this.j:t>=this.height?this.height-1:t}scaleX(t){return this.boundX(Math.floor((t-this.pixelX)/this.pixelGroup))}scaleY(t){return this.boundY(Math.floor((t-this.pixelY)/this.pixelGroup))}scale(t){let e=this.scaleX(t.x),i=this.scaleY(t.y),n=this.boundX(Math.ceil((t.x+t.width-this.pixelX)/this.pixelGroup)),r=this.boundY(Math.ceil((t.y+t.height-this.pixelY)/this.pixelGroup)),s=n-e,o=r-i;return new v(e,i,s,o)}invertScaleX(t){return Math.round(t*this.pixelGroup+this.pixelX)}invertScaleY(t){return Math.round(t*this.pixelGroup+this.pixelY)}addPadding(t,e){let i=Math.ceil(e/this.pixelGroup),n=this.boundX(t.x-i),r=this.boundY(t.y-i),s=this.boundX(t.x2+i),o=this.boundY(t.y2+i),a=s-n,l=o-r;return new v(n,r,a,l)}get(t,e){return t<0||e<0||t>=this.width||e>=this.height?Number.NaN:this.area[t+e*this.width]}inc(t,e,i){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]+=i)}set(t,e,i){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]=i)}incArea(t,e){if(t.width<=0||t.height<=0||0===e)return;let i=this.width,n=t.width,r=Math.max(0,t.i),s=Math.max(0,t.j),o=Math.min(t.i+t.width,i),a=Math.min(t.j+t.height,this.height);if(!(a<=0)&&!(o<=0)&&!(r>=i)&&!(a>=this.height))for(let l=s;l<a;l++){let s=(l-t.j)*n,a=l*i;for(let i=r;i<o;i++){let n=t.area[i-t.i+s];0!==n&&(this.area[i+a]+=e*n)}}}fill(t){this.area.fill(t)}fillArea(t,e){let i=t.x+t.y*this.width;for(let n=0;n<t.height;n++){let r=i+n*this.width;this.area.fill(e,r,r+t.width)}}fillHorizontalLine(t,e,i,n){let r=t+e*this.width;this.area.fill(n,r,r+i)}fillVerticalLine(t,e,i,n){let r=t+e*this.width;for(let t=0;t<i;t++)this.area[r+t*this.width]=n}clear(){this.area.fill(0)}toString(){let t="";for(let e=0;e<this.height;e++){let i=e*this.width;for(let e=0;e<this.width;e++){let n=this.area[i+e];t+=n.toFixed(1).padStart(6)+" "}t+="\n"}return t}draw(t,e=!0){if(this.width<=0||this.height<=0)return;t.save(),e&&t.translate(this.pixelX,this.pixelY);let i=this.area.reduce((t,e)=>Math.min(t,e),Number.POSITIVE_INFINITY),n=this.area.reduce((t,e)=>Math.max(t,e),Number.NEGATIVE_INFINITY),r=t=>(t-i)/(n-i);t.scale(this.pixelGroup,this.pixelGroup);for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++){let n=this.area[e+i*this.width];t.fillStyle=`rgba(0, 0, 0, ${r(n)})`,t.fillRect(e,i,1,1)}t.restore()}drawThreshold(t,e,i=!0){if(!(this.width<=0)&&!(this.height<=0)){t.save(),i&&t.translate(this.pixelX,this.pixelY),t.scale(this.pixelGroup,this.pixelGroup);for(let i=0;i<this.width;i++)for(let n=0;n<this.height;n++){let r=this.area[i+n*this.width];t.fillStyle=r>e?"black":"white",t.fillRect(i,n,1,1)}t.restore()}}}function x(t,e){let i=t=>({x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e});return Array.isArray(t)?t.map(i):i(t)}function O(t,e,i){return w(Object.assign(c(t),{distSquare:(e,i)=>h(t.x1,t.y1,t.x2,t.y2,e,i)}),e,i)}function w(t,e,i){let n=x(t,i),r=e.scale(n),s=e.createSub(r,n);return function(t,e,i,n){let r=i*i;for(let s=0;s<t.height;s++)for(let o=0;o<t.width;o++){let a=e.invertScaleX(t.i+o),l=e.invertScaleY(t.j+s),h=n(a,l);if(0===h){t.set(o,s,r);continue}if(h<r){let e=i-Math.sqrt(h);t.set(o,s,e*e)}}}(s,e,i,(e,i)=>t.distSquare(e,i)),s}function S(t,e){return e.some(e=>e.containsPt(t.x,t.y))}function D(t,e){return e.some(e=>{var i,n,r,s;return i=e.x1,n=e.y1,1e-6>d(i,n,t.x,t.y)||(r=e.x2,s=e.y2,1e-6>d(r,s,t.x,t.y))})}function M(t,e){let i=Number.POSITIVE_INFINITY,n=null;for(let r of t){if(!m(r,e))continue;let t=function(t,e){let i=Number.POSITIVE_INFINITY,n=0;function r(t,r,s,o){let a=f(e,new u(t,r,s,o));(a=Math.abs(a-.5))>=0&&a<=1&&(n++,a<i&&(i=a))}return(r(t.x,t.y,t.x2,t.y),r(t.x,t.y,t.x,t.y2),n>1)?i:(r(t.x,t.y2,t.x2,t.y2),n>1)?i:(r(t.x2,t.y,t.x2,t.y2),0===n)?-1:i}(r,e);t>=0&&t<i&&(n=r,i=t)}return n}function C(t,e,i,r){let s=i.top,o=i.left,a=i.bottom,l=i.right;if(r){if(o.state===n.POINT){if(s.state===n.POINT)return{x:t.x-e,y:t.y-e};if(a.state===n.POINT)return{x:t.x-e,y:t.y2+e};let i=t.width*t.height,r=t.width*((o.y-t.y+(l.y-t.y))*.5);return r<.5*i?o.y>l.y?{x:t.x-e,y:t.y-e}:{x:t.x2+e,y:t.y-e}:o.y<l.y?{x:t.x-e,y:t.y2+e}:{x:t.x2+e,y:t.y2+e}}if(l.state===n.POINT){if(s.state===n.POINT)return{x:t.x2+e,y:t.y-e};if(a.state===n.POINT)return{x:t.x2+e,y:t.y2+e}}let i=t.height*t.width,r=t.height*((s.x-t.x+(l.x-t.x))*.5);return r<.5*i?s.x>a.x?{x:t.x-e,y:t.y-e}:{x:t.x-e,y:t.y2+e}:s.x<a.x?{x:t.x2+e,y:t.y-e}:{x:t.x2+e,y:t.y2+e}}if(o.state===n.POINT){if(s.state===n.POINT)return{x:t.x2+e,y:t.y2+e};if(a.state===n.POINT)return{x:t.x2+e,y:t.y-e};let i=t.height*t.width,r=t.width*((o.y-t.y+(l.y-t.y))*.5);return r<.5*i?o.y>l.y?{x:t.x2+e,y:t.y2+e}:{x:t.x-e,y:t.y2+e}:o.y<l.y?{x:t.x2+e,y:t.y-e}:{x:t.x-e,y:t.y-e}}if(l.state===n.POINT){if(s.state===n.POINT)return{x:t.x-e,y:t.y2+e};if(a.state===n.POINT)return{x:t.x-e,y:t.y-e}}let h=t.height*t.width,d=t.height*((s.x-t.x+(l.x-t.x))*.5);return d<.5*h?s.x>a.x?{x:t.x2+e,y:t.y2+e}:{x:t.x2+e,y:t.y-e}:s.x<a.x?{x:t.x-e,y:t.y2+e}:{x:t.x-e,y:t.y-e}}class T{constructor(t=[],e=!0){this.points=t,this.closed=e}get(t){let e=this.points.length;return t<0?this.closed?this.get(t+e):this.points[0]:t>=e?this.closed?this.get(t-e):this.points[e-1]:this.points[t]}get length(){return this.points.length}toString(t=1/0){let e=this.points;if(0===e.length)return"";let i="function"==typeof t?t:function(t){if(!Number.isFinite(t))return t=>t;if(0===t)return Math.round;let e=Math.pow(10,t);return t=>Math.round(t*e)/e}(t),n="M";for(let t of e)n+=`${i(t.x)},${i(t.y)} L`;return n=n.slice(0,-1),this.closed&&(n+=" Z"),n}draw(t){let e=this.points;if(0!==e.length){for(let i of(t.beginPath(),t.moveTo(e[0].x,e[0].y),e))t.lineTo(i.x,i.y);this.closed&&t.closePath()}}sample(t){return(function(t=8){return e=>{let i=t,n=e.length;if(i>1)for(n=Math.floor(e.length/i);n<3&&i>1;)i-=1,n=Math.floor(e.length/i);let r=[];for(let t=0,s=0;s<n;s++,t+=i)r.push(e.get(t));return new T(r)}})(t)(this)}simplify(t){return(function(t=0){return e=>{if(t<0||e.length<3)return e;let i=[],n=0,r=t*t;for(;n<e.length;){let t=n+1;for(;function(t,e,i,n){let r=t.closed?i<t.length:i<t.length-1;if(!r)return!1;let s=t.get(e),o=t.get(i+1);for(let r=e+1;r<=i;r++){let e=t.get(r),i=h(s.x,s.y,o.x,o.y,e.x,e.y);if(i>n)return!1}return!0}(e,n,t,r);)t++;i.push(e.get(n)),n=t}return new T(i)}})(t)(this)}bSplines(t){return(function(t=6){function e(t,e,i){let n=0,r=0;for(let s=-2;s<=1;s++){let o=t.get(e+s),a=function(t,e){switch(t){case -2:return(((-e+3)*e-3)*e+1)/6;case -1:return((3*e-6)*e*e+4)/6;case 0:return(((-3*e+3)*e+3)*e+1)/6;case 1:return e*e*e/6;default:throw Error("unknown error")}}(s,i);n+=a*o.x,r+=a*o.y}return{x:n,y:r}}return i=>{if(i.length<3)return i;let n=[],r=i.closed,s=i.length+3-1+(r?0:2);n.push(e(i,2-(r?0:2),0));for(let o=2-(r?0:2);o<s;o++)for(let r=1;r<=t;r++)n.push(e(i,o,r/t));return new T(n)}})(t)(this)}apply(t){return t(this)}containsElements(t){let e=function(t){if(0===t.length)return null;let e=t[0],i=new v(e.x,e.y,0,0);for(let e of t)i.addPoint(e);return i}(this.points);return!!e&&t.every(t=>e.containsPt(t.cx,t.cy)&&this.withinArea(t.cx,t.cy))}withinArea(t,e){if(0===this.length)return!1;let i=0,n=this.points[0],r=new u(n.x,n.y,n.x,n.y);for(let n=1;n<this.points.length;n++){let s=this.points[n];r.x1=r.x2,r.y1=r.y2,r.x2=s.x,r.y2=s.y,r.cuts(t,e)&&i++}return r.x1=r.x2,r.y1=r.y2,r.x2=n.x,r.y2=n.y,r.cuts(t,e)&&i++,i%2==1}}class P{constructor(t=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=t}add(t){this.set.add(`${t.x}x${t.y}`),this.arr[this.count++]=t}contains(t){return this.set.has(`${t.x}x${t.y}`)}isFirst(t){if(0===this.count)return!1;let e=this.arr[0];return null!=e&&e.x===t.x&&e.y===t.y}path(){return new T(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(t){return this.arr[t]}get length(){return this.count}}let A={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function R(t){return null!=t&&"number"==typeof t.radius}function L(t,e){return R(t)===R(e)&&(R(t)?t.cx===e.cx&&t.cy===e.cy&&t.radius===e.radius:t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height)}(l=s||(s={}))[l.MEMBERS=0]="MEMBERS",l[l.NON_MEMBERS=1]="NON_MEMBERS",l[l.EDGES=2]="EDGES";class k{constructor(t={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new v(0,0,0,0),this.potentialArea=new E(1,0,0,0,0,0,0),this.o=Object.assign({},A,t)}pushMember(...t){if(0!==t.length)for(let e of(this.dirty.add(s.MEMBERS),t))this.members.push({raw:e,obj:R(e)?b.from(e):v.from(e),area:null})}removeMember(t){let e=this.members.findIndex(e=>L(e.raw,t));return!(e<0)&&(this.members.splice(e,1),this.dirty.add(s.MEMBERS),!0)}removeNonMember(t){let e=this.nonMembers.findIndex(e=>L(e.raw,t));return!(e<0)&&(this.nonMembers.splice(e,1),this.dirty.add(s.NON_MEMBERS),!0)}removeEdge(t){let e=this.edges.findIndex(e=>e.obj.equals(t));return!(e<0)&&(this.edges.splice(e,1),this.dirty.add(s.NON_MEMBERS),!0)}pushNonMember(...t){if(0!==t.length)for(let e of(this.dirty.add(s.NON_MEMBERS),t))this.nonMembers.push({raw:e,obj:R(e)?b.from(e):v.from(e),area:null})}pushEdge(...t){if(0!==t.length)for(let e of(this.dirty.add(s.EDGES),t))this.edges.push({raw:e,obj:u.from(e),area:null})}update(){let t=this.dirty.has(s.MEMBERS),e=this.dirty.has(s.NON_MEMBERS),i=this.dirty.has(s.EDGES);this.dirty.clear();let r=this.members.map(t=>t.obj);if(this.o.virtualEdges&&(t||e)){let t=this.nonMembers.map(t=>t.obj),e=function(t,e,i,r){if(0===t.length)return[];let s=function(t){if(t.length<2)return t;let e=0,i=0;return t.forEach(t=>{e+=t.cx,i+=t.cy}),e/=t.length,i/=t.length,t.map(t=>{let n=e-t.cx,r=i-t.cy;return[t,n*n+r*r]}).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}(t);return s.map((t,o)=>{let a=s.slice(0,o);return function(t,e,i,r,s){let o;let a={x:e.cx,y:e.cy},l=(o=Number.POSITIVE_INFINITY,i.reduce((e,i)=>{let n=d(a.x,a.y,i.cx,i.cy);if(n>o)return e;let r=new u(a.x,a.y,i.cx,i.cy),s=t.reduce((t,e)=>m(e,r)&&function(t,e){function i(t,i,n,r){let s=f(e,new u(t,i,n,r));return(s=Math.abs(s-.5))>=0&&s<=1?1:0}let n=i(t.x,t.y,t.x2,t.y);return!!((n+=i(t.x,t.y,t.x,t.y2))>1||(n+=i(t.x,t.y2,t.x2,t.y2))>1)||(n+=i(t.x2,t.y,t.x2,t.y2))>0}(e,r)?t+1:t,0);return n*(s+1)*(s+1)<o&&(e=i,o=n*(s+1)*(s+1)),e},null));if(null==l)return[];let h=new u(a.x,a.y,l.cx,l.cy),c=function(t,e,i,r){let s=[],o=[];o.push(t);let a=!0;for(let t=0;t<i&&a;t++)for(a=!1;!a&&o.length>0;){let t=o.pop(),i=M(e,t),l=i?function(t,e){let i=0,r=g(t,new u(e.x,e.y,e.x2,e.y));i+=r.state===n.POINT?1:0;let s=g(t,new u(e.x,e.y,e.x,e.y2));i+=s.state===n.POINT?1:0;let o=g(t,new u(e.x,e.y2,e.x2,e.y2));i+=o.state===n.POINT?1:0;let a=g(t,new u(e.x2,e.y,e.x2,e.y2));return{top:r,left:s,bottom:o,right:a,count:i+=a.state===n.POINT?1:0}}(t,i):null;if(!i||!l||2!==l.count){a||s.push(t);continue}let h=r,d=C(i,h,l,!0),c=D(d,o)||D(d,s),p=S(d,e);for(;!c&&p&&h>=1;)h/=1.5,c=D(d=C(i,h,l,!0),o)||D(d,s),p=S(d,e);if(!d||c||p||(o.push(new u(t.x1,t.y1,d.x,d.y)),o.push(new u(d.x,d.y,t.x2,t.y2)),a=!0),a)continue;let f=D(d=C(i,h=r,l,!1),o)||D(d,s);for(p=S(d,e);!f&&p&&h>=1;)h/=1.5,f=D(d=C(i,h,l,!1),o)||D(d,s),p=S(d,e);d&&!f&&(o.push(new u(t.x1,t.y1,d.x,d.y)),o.push(new u(d.x,d.y,t.x2,t.y2)),a=!0),a||s.push(t)}for(;o.length>0;)s.push(o.pop());return s}(h,t,r,s);return function(t,e){let i=[];for(;t.length>0;){let n=t.pop();if(0===t.length){i.push(n);break}let r=t.pop(),s=new u(n.x1,n.y1,r.x2,r.y2),o=M(e,s);o?(i.push(n),t.push(r)):t.push(s)}return i}(c,t)}(e,t,a,i,r)}).flat()}(r,t,this.o.maxRoutingIterations,this.o.morphBuffer),s=new Map(this.virtualEdges.map(t=>[t.obj.toString(),t.area]));this.virtualEdges=e.map(t=>{var e;return{raw:t,obj:t,area:null!==(e=s.get(t.toString()))&&void 0!==e?e:null}}),i=!0}let o=!1;if(t||i){let t=this.virtualEdges.concat(this.edges).map(t=>t.obj),e=function(t,e){if(0===t.length)return new v(0,0,0,0);let i=v.from(t[0]);for(let e of t)i.add(e);for(let t of e)i.add(c(t));return i}(r,t),i=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,n=v.from(x(e,i));n.equals(this.activeRegion)||(o=!0,this.activeRegion=n)}if(o){let t=Math.ceil(this.activeRegion.width/this.o.pixelGroup),e=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=E.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach(t=>t.area=null),this.nonMembers.forEach(t=>t.area=null),this.edges.forEach(t=>t.area=null),this.virtualEdges.forEach(t=>t.area=null)):(t!==this.potentialArea.width||e!==this.potentialArea.height)&&(this.potentialArea=E.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}let a=new Map,l=t=>{if(t.area){let e=`${t.obj.width}x${t.obj.height}x${t.obj instanceof v?"R":"C"}`;a.set(e,t.area)}},h=t=>{if(t.area)return;let e=`${t.obj.width}x${t.obj.height}x${t.obj instanceof v?"R":"C"}`;if(a.has(e)){let i=a.get(e);t.area=this.potentialArea.copy(i,{x:t.obj.x-this.o.nodeR1,y:t.obj.y-this.o.nodeR1});return}let i=t.obj instanceof v?function(t,e,i){let n=e.scale(t),r=e.addPadding(n,i),s=e.createSub(r,{x:t.x-i,y:t.y-i}),o=n.x-r.x,a=n.y-r.y,l=r.x2-n.x2,h=r.y2-n.y2,d=r.width-o-l,c=r.height-a-h,u=i*i;s.fillArea({x:o,y:a,width:d+1,height:c+1},u);let p=[0],g=Math.max(a,o,l,h);{let r=e.invertScaleX(n.x+n.width/2);for(let s=1;s<g;s++){let o=e.invertScaleY(n.y-s),a=t.distSquare(r,o);if(a<u){let t=i-Math.sqrt(a);p.push(t*t)}else break}}let f=[],y=Math.max(o,l),m=Math.max(a,l);for(let r=1;r<y;r++){let s=e.invertScaleX(n.x-r),o=[];for(let r=1;r<m;r++){let a=e.invertScaleY(n.y-r),l=t.distSquare(s,a);if(l<u){let t=i-Math.sqrt(l);o.push(t*t)}else o.push(0)}f.push(o)}for(let t=1;t<Math.min(a,p.length);t++){let e=p[t];s.fillHorizontalLine(o,a-t,d+1,e)}for(let t=1;t<Math.min(h,p.length);t++){let e=p[t];s.fillHorizontalLine(o,a+c+t,d+1,e)}for(let t=1;t<Math.min(o,p.length);t++){let e=p[t];s.fillVerticalLine(o-t,a,c+1,e)}for(let t=1;t<Math.min(h,p.length);t++){let e=p[t];s.fillVerticalLine(o+d+t,a,c+1,e)}for(let t=1;t<o;t++){let e=f[t-1],i=o-t;for(let t=1;t<a;t++)s.set(i,a-t,e[t-1]);for(let t=1;t<h;t++)s.set(i,a+c+t,e[t-1])}for(let t=1;t<l;t++){let e=f[t-1],i=o+d+t;for(let t=1;t<a;t++)s.set(i,a-t,e[t-1]);for(let t=1;t<h;t++)s.set(i,a+c+t,e[t-1])}return s}(t.obj,this.potentialArea,this.o.nodeR1):w(t.obj,this.potentialArea,this.o.nodeR1);t.area=i,a.set(e,i)};this.members.forEach(l),this.nonMembers.forEach(l),this.members.forEach(h),this.nonMembers.forEach(t=>{this.activeRegion.intersects(t.obj)?h(t):t.area=null}),this.edges.forEach(t=>{t.area||(t.area=O(t.obj,this.potentialArea,this.o.edgeR1))}),this.virtualEdges.forEach(t=>{t.area||(t.area=O(t.obj,this.potentialArea,this.o.edgeR1))})}drawMembers(t){for(let e of this.members)e.obj.draw(t)}drawNonMembers(t){for(let e of this.nonMembers)e.obj.draw(t)}drawEdges(t){for(let e of this.edges)e.obj.draw(t)}drawPotentialArea(t,e=!0){this.potentialArea.draw(t,e)}compute(){if(0===this.members.length)return new T([]);this.dirty.size>0&&this.update();let{o:t,potentialArea:e}=this,i=this.members.map(t=>t.area),n=this.virtualEdges.concat(this.edges).map(t=>t.area),r=this.nonMembers.filter(t=>null!=t.area).map(t=>t.area),s=this.members.map(t=>t.obj);return function(t,e,i,n,r,s={}){let o=Object.assign({},A,s),a=o.threshold,l=o.memberInfluenceFactor,h=o.edgeInfluenceFactor,d=o.nonMemberInfluenceFactor,c=(o.nodeR0-o.nodeR1)*(o.nodeR0-o.nodeR1),u=(o.edgeR0-o.edgeR1)*(o.edgeR0-o.edgeR1);for(let s=0;s<o.maxMarchingIterations;s++){if(t.clear(),0!==l){let i=l/c;for(let n of e)t.incArea(n,i)}if(0!==h){let e=h/u;for(let n of i)t.incArea(n,e)}if(0!==d){let e=d/c;for(let i of n)t.incArea(i,e)}let p=function(t,e){let i=(Math.floor(t.width)+Math.floor(t.height))*2,n=new P(i);function r(i,n,r,s){let o=t.get(i,n);return Number.isNaN(o)?Number.NaN:o>e?r+s:r}function s(t,e){let i=0;return(i=r(t,e,0,1),i=r(t+1,e,i,2),i=r(t,e+1,i,4),Number.isNaN(i=r(t+1,e+1,i,8)))?-1:i}let o=1;for(let i=0;i<t.width;i++)for(let r=0;r<t.height;r++){if(t.get(i,r)<=e)continue;let a=s(i,r);if(!(a<0)&&15!==a&&function(e,i){let r=e,a=i,l=t.invertScaleX(r),h=t.invertScaleY(a);for(let e=0;e<t.width*t.height;e++){let e={x:l,y:h};if(n.contains(e)){if(n.isFirst(e))break}else n.add(e);let i=s(r,a);switch(i){case -1:return!0;case 0:case 3:case 2:case 7:o=2;break;case 12:case 14:case 4:o=3;break;case 6:o=0===o?3:2;break;case 1:case 13:case 5:o=0;break;case 9:o=2===o?0:1;break;case 10:case 8:case 11:o=1;break;default:return console.warn("Marching squares invalid state: "+i),!0}switch(o){case 0:a--,h-=t.pixelGroup;break;case 1:a++,h+=t.pixelGroup;break;case 3:r--,l-=t.pixelGroup;break;case 2:r++,l+=t.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+i),!0}}return!0}(i,r))return n.path()}return null}(t,a);if(p&&r(p))return p;if(a*=.95,s<=.5*o.maxMarchingIterations)l*=1.2,h*=1.2;else if(0!==d&&n.length>0)d*=.8;else break}return new T([])}(e,i,n,r,t=>t.containsElements(s),t)}}},51633:function(t,e,i){"use strict";i.d(e,{P3:function(){return c}});var n=i(75271),r=n.createContext({graph:null,isReady:!1}),s=i(36052),o=function(){return(o=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},a=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,s=i.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o},l=function(){return(l=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},h=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i},d=(0,n.forwardRef)(function(t,e){var i,d,c,u,p,g,f,y,m,v,b=t.style,E=t.children,x=(d=(i=h(t,["style","children"])).onInit,c=i.onReady,u=i.onDestroy,p=i.options,f=(g=a((0,n.useState)(!1),2))[0],y=g[1],m=(0,n.useRef)(null),v=(0,n.useRef)(null),(0,n.useEffect)(function(){if(!m.current&&v.current){var t=new s.kJ(o({container:v.current},p));return m.current=t,y(!0),null==d||d(m.current),function(){var t=m.current;t&&(t.destroy(),null==u||u(),m.current=null)}}},[]),(0,n.useEffect)(function(){var t=v.current,e=m.current;p&&t&&e&&!e.destroyed&&(e.setOptions(p),e.render().then(function(){return null==c?void 0:c(e)}))},[p]),{graph:m.current,containerRef:v,isReady:f}),O=x.graph,w=x.containerRef,S=x.isReady;(0,n.useImperativeHandle)(e,function(){return O},[O]);var D=l({height:"inherit",position:"relative"},b);return E?n.createElement(r.Provider,{value:{graph:O,isReady:S}},n.createElement("div",{ref:w,style:D},S&&E)):n.createElement("div",{ref:w,style:D})}),c=(0,n.memo)(d)},80345:function(t,e,i){"use strict";i.d(e,{Ud:function(){return c},Yy:function(){return s}});/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let n=Symbol("Comlink.proxy"),r=Symbol("Comlink.endpoint"),s=Symbol("Comlink.releaseProxy"),o=Symbol("Comlink.finalizer"),a=Symbol("Comlink.thrown"),l=t=>"object"==typeof t&&null!==t||"function"==typeof t,h=new Map([["proxy",{canHandle:t=>l(t)&&t[n],serialize(t){let{port1:e,port2:i}=new MessageChannel;return function t(e,i=globalThis,r=["*"]){i.addEventListener("message",function s(l){let h;if(!l||!l.data)return;if(!function(t,e){for(let i of t)if(e===i||"*"===i||i instanceof RegExp&&i.test(e))return!0;return!1}(r,l.origin)){console.warn(`Invalid origin '${l.origin}' for comlink proxy`);return}let{id:c,type:u,path:p}=Object.assign({path:[]},l.data),g=(l.data.argumentList||[]).map(b);try{var f;let i=p.slice(0,-1).reduce((t,e)=>t[e],e),r=p.reduce((t,e)=>t[e],e);switch(u){case"GET":h=r;break;case"SET":i[p.slice(-1)[0]]=b(l.data.value),h=!0;break;case"APPLY":h=r.apply(i,g);break;case"CONSTRUCT":{let t=new r(...g);h=Object.assign(t,{[n]:!0})}break;case"ENDPOINT":{let{port1:i,port2:n}=new MessageChannel;t(e,n),f=[i],m.set(i,f),h=i}break;case"RELEASE":h=void 0;break;default:return}}catch(t){h={value:t,[a]:0}}Promise.resolve(h).catch(t=>({value:t,[a]:0})).then(t=>{let[n,r]=v(t);i.postMessage(Object.assign(Object.assign({},n),{id:c}),r),"RELEASE"===u&&(i.removeEventListener("message",s),d(i),o in e&&"function"==typeof e[o]&&e[o]())}).catch(t=>{let[e,n]=v({value:TypeError("Unserializable return value"),[a]:0});i.postMessage(Object.assign(Object.assign({},e),{id:c}),n)})}),i.start&&i.start()}(t,e),[i,[i]]},deserialize:t=>(t.start(),c(t))}],["throw",{canHandle:t=>l(t)&&a in t,serialize:({value:t})=>[t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[]],deserialize(t){if(t.isError)throw Object.assign(Error(t.value.message),t.value);throw t.value}}]]);function d(t){"MessagePort"===t.constructor.name&&t.close()}function c(t,e){let i=new Map;return t.addEventListener("message",function(t){let{data:e}=t;if(!e||!e.id)return;let n=i.get(e.id);if(n)try{n(e)}finally{i.delete(e.id)}}),function t(e,i,n=[],o=function(){}){let a=!1,l=new Proxy(o,{get(r,o){if(u(a),o===s)return()=>{f&&f.unregister(l),p(e),i.clear(),a=!0};if("then"===o){if(0===n.length)return{then:()=>l};let t=E(e,i,{type:"GET",path:n.map(t=>t.toString())}).then(b);return t.then.bind(t)}return t(e,i,[...n,o])},set(t,r,s){u(a);let[o,l]=v(s);return E(e,i,{type:"SET",path:[...n,r].map(t=>t.toString()),value:o},l).then(b)},apply(s,o,l){u(a);let h=n[n.length-1];if(h===r)return E(e,i,{type:"ENDPOINT"}).then(b);if("bind"===h)return t(e,i,n.slice(0,-1));let[d,c]=y(l);return E(e,i,{type:"APPLY",path:n.map(t=>t.toString()),argumentList:d},c).then(b)},construct(t,r){u(a);let[s,o]=y(r);return E(e,i,{type:"CONSTRUCT",path:n.map(t=>t.toString()),argumentList:s},o).then(b)}});return function(t,e){let i=(g.get(e)||0)+1;g.set(e,i),f&&f.register(t,e,t)}(l,e),l}(t,i,[],e)}function u(t){if(t)throw Error("Proxy has been released and is not useable")}function p(t){return E(t,new Map,{type:"RELEASE"}).then(()=>{d(t)})}let g=new WeakMap,f="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{let e=(g.get(t)||0)-1;g.set(t,e),0===e&&p(t)});function y(t){var e;let i=t.map(v);return[i.map(t=>t[0]),(e=i.map(t=>t[1]),Array.prototype.concat.apply([],e))]}let m=new WeakMap;function v(t){for(let[e,i]of h)if(i.canHandle(t)){let[n,r]=i.serialize(t);return[{type:"HANDLER",name:e,value:n},r]}return[{type:"RAW",value:t},m.get(t)||[]]}function b(t){switch(t.type){case"HANDLER":return h.get(t.name).deserialize(t.value);case"RAW":return t.value}}function E(t,e,i,n){return new Promise(r=>{let s=[,,,,].fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");e.set(s,r),t.start&&t.start(),t.postMessage(Object.assign({id:s},i),n)})}}}]);