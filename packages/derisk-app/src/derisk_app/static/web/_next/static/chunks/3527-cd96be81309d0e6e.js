"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3527],{19518:function(e,t,l){l.d(t,{_:function(){return F},a:function(){return T}});var a=l(52676),n=l(21011),r=l(8080),s=l(30426),i=l(33394),c=l(62601),d=l(12424),o=l(19475),u=l(53832),m=l(40389),h=l(41148),x=l(57107),p=l(32699),g=l(75271);let v=e=>{if(!e)return;let t=e.getContainer(),l=t.getElementsByTagName("canvas")[0];return l};var j=l(35462),f=l(54554);let y=e=>{let{charts:t,scopeOfCharts:l,ruleConfig:a}=e,n={};if(null==t||t.forEach(e=>{if(e.chartKnowledge.toSpec){let t=e.chartKnowledge.toSpec;e.chartKnowledge.toSpec=(e,l)=>({...t(e,l),dataProps:l})}else e.chartKnowledge.toSpec=(e,t)=>({dataProps:t});n[e.chartType]=e.chartKnowledge}),(null==l?void 0:l.exclude)&&l.exclude.forEach(e=>{Object.keys(n).includes(e)&&delete n[e]}),null==l?void 0:l.include){let e=l.include;Object.keys(n).forEach(t=>{e.includes(t)||delete n[t]})}let r={...l,custom:n},s={...a},i=new j.w({ckbCfg:r,ruleCfg:s});return i},b=e=>{var t;let{data:l,dataMetaMap:a,myChartAdvisor:n}=e,r=a?Object.keys(a).map(e=>({name:e,...a[e]})):null,s=new f.Z(l).info(),i=(0,p.size)(s)>2?null==s?void 0:s.filter(e=>"string"!==e.recommendation&&"date"!==e.recommendation||e.distinct&&e.distinct>1):s,c=null==n?void 0:n.adviseWithLog({data:l,dataProps:r,fields:null==i?void 0:i.map(e=>e.name)});return null!==(t=null==c?void 0:c.advices)&&void 0!==t?t:[]};function N(e,t){return t.every(t=>e.includes(t))}function _(e,t){let l=t.find(t=>t.name===e);return(null==l?void 0:l.recommendation)==="date"?t=>new Date(t[e]):e}function w(e){return e.find(e=>{var t;return e.levelOfMeasurements&&(t=e.levelOfMeasurements,["Time","Ordinal"].some(e=>t.includes(e)))})}function k(e){return e.find(e=>e.levelOfMeasurements&&N(e.levelOfMeasurements,["Nominal"]))}let Z=e=>{let{data:t,xField:l}=e,a=(0,p.uniq)(t.map(e=>e[l]));return a.length<=1},C=(e,t,l)=>{let{field4Split:a,field4X:n}=l;if((null==a?void 0:a.name)&&(null==n?void 0:n.name)){let l=e[a.name],r=t.filter(e=>a.name&&e[a.name]===l);return Z({data:r,xField:n.name})?5:void 0}return(null==n?void 0:n.name)&&Z({data:t,xField:n.name})?5:void 0},S=e=>{let{data:t,chartType:l,xField:a}=e,n=(0,p.cloneDeep)(t);try{if(l.includes("line")&&(null==a?void 0:a.name)&&"date"===a.recommendation)return n.sort((e,t)=>new Date(e[a.name]).getTime()-new Date(t[a.name]).getTime()),n;l.includes("line")&&(null==a?void 0:a.name)&&["float","integer"].includes(a.recommendation)&&n.sort((e,t)=>e[a.name]-t[a.name])}catch(e){console.error(e)}return n},E=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return e.map(e=>{let l={};return Object.keys(e).forEach(a=>{l[a]=e[a]===t?null:e[a]}),l})},O="multi_line_chart",P="multi_measure_line_chart",L=[{chartType:"multi_line_chart",chartKnowledge:{id:O,name:"multi_line_chart",alias:["multi_line_chart"],family:["LineCharts"],def:"multi_line_chart uses lines with segments to show changes in data in a ordinal dimension",purpose:["Comparison","Trend"],coord:["Cartesian2D"],category:["Statistic"],shape:["Lines"],dataPres:[{minQty:1,maxQty:1,fieldConditions:["Time","Ordinal"]},{minQty:1,maxQty:"*",fieldConditions:["Interval"]},{minQty:0,maxQty:1,fieldConditions:["Nominal"]}],channel:["Color","Direction","Position"],recRate:"Recommended",toSpec:(e,t)=>{var l,a;let n=w(t),r=k(t),s=null!==(l=null!=n?n:r)&&void 0!==l?l:t[0],i=t.filter(e=>e.name!==(null==s?void 0:s.name)),c=null!==(a=i.filter(e=>e.levelOfMeasurements&&N(e.levelOfMeasurements,["Interval"])))&&void 0!==a?a:[i[0]],d=i.filter(e=>!c.find(t=>t.name===e.name)).find(e=>e.levelOfMeasurements&&N(e.levelOfMeasurements,["Nominal"]));if(!s||!c)return null;let o={type:"view",autoFit:!0,data:S({data:e,chartType:O,xField:s}),children:[]};return c.forEach(l=>{let a={type:"line",encode:{x:_(s.name,t),y:l.name,size:t=>C(t,e,{field4Split:d,field4X:s})},legend:{size:!1}};d&&(a.encode.color=d.name),o.children.push(a)}),o}},chineseName:"折线图"},{chartType:"multi_measure_column_chart",chartKnowledge:{id:"multi_measure_column_chart",name:"multi_measure_column_chart",alias:["multi_measure_column_chart"],family:["ColumnCharts"],def:"multi_measure_column_chart uses lines with segments to show changes in data in a ordinal dimension",purpose:["Comparison","Distribution"],coord:["Cartesian2D"],category:["Statistic"],shape:["Lines"],dataPres:[{minQty:1,maxQty:"*",fieldConditions:["Interval"]},{minQty:1,maxQty:1,fieldConditions:["Nominal"]}],channel:["Color","Direction","Position"],recRate:"Recommended",toSpec:(e,t)=>{try{let l=null==t?void 0:t.filter(e=>N(e.levelOfMeasurements,["Interval"])),a=k(t),n=w(t),r=null!=a?a:n;if(!r||!l)return null;let s={type:"view",data:e,children:[]};return null==l||l.forEach(e=>{let t={type:"interval",encode:{x:r.name,y:e.name,color:()=>e.name,series:()=>e.name}};s.children.push(t)}),s}catch(e){return console.log(e),null}}},chineseName:"折线图"},{chartType:"multi_measure_line_chart",chartKnowledge:{id:P,name:"multi_measure_line_chart",alias:["multi_measure_line_chart"],family:["LineCharts"],def:"multi_measure_line_chart uses lines with segments to show changes in data in a ordinal dimension",purpose:["Comparison","Distribution"],coord:["Cartesian2D"],category:["Statistic"],shape:["Lines"],dataPres:[{minQty:1,maxQty:"*",fieldConditions:["Interval"]},{minQty:1,maxQty:1,fieldConditions:["Nominal"]}],channel:["Color","Direction","Position"],recRate:"Recommended",toSpec:(e,t)=>{try{var l,a;let n=null!==(a=null!==(l=k(t))&&void 0!==l?l:w(t))&&void 0!==a?a:t[0],r=null==t?void 0:t.filter(e=>e.name!==(null==n?void 0:n.name)&&N(e.levelOfMeasurements,["Interval"]));if(!n||!r)return null;let s={type:"view",data:S({data:e,chartType:P,xField:n}),children:[]};return null==r||r.forEach(l=>{let a={type:"line",encode:{x:_(n.name,t),y:l.name,color:()=>l.name,series:()=>l.name,size:t=>C(t,e,{field4X:n})},legend:{size:!1}};s.children.push(a)}),s}catch(e){return console.log(e),null}}},chineseName:"折线图"}],T=e=>"response_line_chart"===e?["multi_line_chart","multi_measure_line_chart"]:"response_bar_chart"===e?["multi_measure_column_chart"]:"response_pie_chart"===e?["pie_chart"]:"response_scatter_chart"===e?["scatter_plot"]:"response_area_chart"===e?["area_chart"]:"response_heatmap_chart"===e?["heatmap"]:[],{Option:R}=c.default,F=e=>{let{data:t,chartType:l,scopeOfCharts:j,ruleConfig:f}=e,N=E(t),{mode:_}=(0,g.useContext)(n.p),[w,k]=(0,g.useState)(),[Z,C]=(0,g.useState)([]),[O,P]=(0,g.useState)(),T=(0,g.useRef)();(0,g.useEffect)(()=>{k(y({charts:L,scopeOfCharts:{exclude:["area_chart","stacked_area_chart","percent_stacked_area_chart"]},ruleConfig:f}))},[f,j]);let F=e=>{if(!w)return[];let t=function(e){let{advices:t}=e;return t}({advices:e}),a=(0,p.uniq)((0,p.compact)((0,p.concat)(l,e.map(e=>e.type)))),n=a.map(e=>{let l=t.find(t=>t.type===e);if(l)return l;let a=w.dataAnalyzer.execute({data:N});if("data"in a){var n;let t=w.specGenerator.execute({data:a.data,dataProps:a.dataProps,chartTypeRecommendations:[{chartType:e,score:1}]});if("advices"in t)return null===(n=t.advices)||void 0===n?void 0:n[0]}}).filter(e=>null==e?void 0:e.spec);return n};(0,g.useEffect)(()=>{if(N&&w){var e;let t=b({data:N,myChartAdvisor:w}),l=F(t);C(l),P(null===(e=l[0])||void 0===e?void 0:e.type)}},[JSON.stringify(N),w,l]);let M=(0,g.useMemo)(()=>{if((null==Z?void 0:Z.length)>0){var e,t,l,n;let r=null!=O?O:Z[0].type,s=null!==(t=null===(e=null==Z?void 0:Z.find(e=>e.type===r))||void 0===e?void 0:e.spec)&&void 0!==t?t:void 0;if(s){if(s.data&&["line_chart","step_line_chart"].includes(r)){let e=null==w?void 0:w.dataAnalyzer.execute({data:N});e&&"dataProps"in e&&(s.data=S({data:s.data,xField:null===(n=e.dataProps)||void 0===n?void 0:n.find(e=>"date"===e.recommendation),chartType:r}))}return"pie_chart"===r&&(null==s?void 0:null===(l=s.encode)||void 0===l?void 0:l.color)&&(s.tooltip={title:{field:s.encode.color}}),(0,a.jsx)(i.k,{options:{...s,autoFit:!0,theme:_,height:300},ref:T},r)}}},[Z,_,O]);return O?(0,a.jsxs)("div",{children:[(0,a.jsxs)(d.Z,{justify:"space-between",className:"mb-2",children:[(0,a.jsx)(o.Z,{children:(0,a.jsxs)(u.Z,{children:[(0,a.jsx)("span",{children:r.Z.t("Advices")}),(0,a.jsx)(c.default,{className:"w-52",value:O,placeholder:"Chart Switcher",onChange:e=>P(e),size:"small",children:null==Z?void 0:Z.map(e=>{let t=r.Z.t(e.type);return(0,a.jsx)(R,{value:e.type,children:(0,a.jsx)(m.Z,{title:t,placement:"right",children:(0,a.jsx)("div",{children:t})})},e.type)})})]})}),(0,a.jsx)(o.Z,{children:(0,a.jsx)(m.Z,{title:r.Z.t("Download"),children:(0,a.jsx)(h.ZP,{onClick:()=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Chart",l=document.createElement("a"),a="".concat(t,".png");setTimeout(()=>{let t=function(e){let t=v(e);if(t){let e=t.toDataURL("image/png");return e}}(e);if(t){l.addEventListener("click",()=>{l.download=a,l.href=t});let e=document.createEvent("MouseEvents");e.initEvent("click",!1,!1),l.dispatchEvent(e)}},16)})(T.current,r.Z.t(O)),icon:(0,a.jsx)(s.Z,{}),type:"text"})})})]}),(0,a.jsx)("div",{className:"flex",children:M})]}):(0,a.jsx)(x.Z,{image:x.Z.PRESENTED_IMAGE_SIMPLE,description:"暂无合适的可视化视图"})}},78471:function(e,t,l){l.d(t,{_z:function(){return p._},ZP:function(){return g},aG:function(){return p.a}});var a=l(52676),n=l(21521),r=l(13053),s=l(13501),i=l(75271),c=l(21011),d=l(33394);function o(e){let{chart:t}=e,{mode:l}=(0,i.useContext)(c.p);return(0,a.jsx)("div",{className:"flex-1 min-w-0 p-4 bg-white dark:bg-theme-dark-container rounded",children:(0,a.jsxs)("div",{className:"h-full",children:[(0,a.jsx)("div",{className:"mb-2",children:t.chart_name}),(0,a.jsx)("div",{className:"opacity-80 text-sm mb-2",children:t.chart_desc}),(0,a.jsx)("div",{className:"h-[300px]",children:(0,a.jsx)(d.k,{style:{height:"100%"},options:{autoFit:!0,theme:l,type:"interval",data:t.values,encode:{x:"name",y:"value",color:"type"},axis:{x:{labelAutoRotate:!1}}}})})]})})}function u(e){let{chart:t}=e,{mode:l}=(0,i.useContext)(c.p);return(0,a.jsx)("div",{className:"flex-1 min-w-0 p-4 bg-white dark:bg-theme-dark-container rounded",children:(0,a.jsxs)("div",{className:"h-full",children:[(0,a.jsx)("div",{className:"mb-2",children:t.chart_name}),(0,a.jsx)("div",{className:"opacity-80 text-sm mb-2",children:t.chart_desc}),(0,a.jsx)("div",{className:"h-[300px]",children:(0,a.jsx)(d.k,{style:{height:"100%"},options:{autoFit:!0,theme:l,type:"view",data:t.values,children:[{type:"line",encode:{x:"name",y:"value",color:"type",shape:"smooth"}},{type:"area",encode:{x:"name",y:"value",color:"type",shape:"smooth"},legend:!1,style:{fillOpacity:.15}}],axis:{x:{labelAutoRotate:!1}}}})})]})})}var m=l(6354),h=l(32699);function x(e){var t,l;let{chart:n}=e,r=(0,h.groupBy)(n.values,"type");return(0,a.jsx)("div",{className:"flex-1 min-w-0 p-4 bg-white dark:bg-theme-dark-container rounded",children:(0,a.jsxs)("div",{className:"h-full",children:[(0,a.jsx)("div",{className:"mb-2",children:n.chart_name}),(0,a.jsx)("div",{className:"opacity-80 text-sm mb-2",children:n.chart_desc}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)(m.Z,{"aria-label":"basic table",stripe:"odd",hoverRow:!0,borderAxis:"bothBetween",children:[(0,a.jsx)("thead",{children:(0,a.jsx)("tr",{children:Object.keys(r).map(e=>(0,a.jsx)("th",{children:e},e))})}),(0,a.jsx)("tbody",{children:null===(t=Object.values(r))||void 0===t?void 0:null===(l=t[0])||void 0===l?void 0:l.map((e,t)=>{var l;return(0,a.jsx)("tr",{children:null===(l=Object.keys(r))||void 0===l?void 0:l.map(e=>{var l;return(0,a.jsx)("td",{children:(null==r?void 0:null===(l=r[e])||void 0===l?void 0:l[t].value)||""},e)})},t)})})]})})]})})}var p=l(19518),g=function(e){let{chartsData:t}=e,l=(0,i.useMemo)(()=>{if(t){let e=[],l=null==t?void 0:t.filter(e=>"IndicatorValue"===e.chart_type);l.length>0&&e.push({charts:l,type:"IndicatorValue"});let a=null==t?void 0:t.filter(e=>"IndicatorValue"!==e.chart_type),n=a.length,r=0;return[[0],[1],[2],[1,2],[1,3],[2,1,2],[2,1,3],[3,1,3],[3,2,3]][n].forEach(t=>{if(t>0){let l=a.slice(r,r+t);r+=t,e.push({charts:l})}}),e}},[t]);return(0,a.jsx)("div",{className:"flex flex-col gap-3",children:null==l?void 0:l.map((e,t)=>(0,a.jsx)("div",{className:"".concat((null==e?void 0:e.type)!=="IndicatorValue"?"flex gap-3":""),children:e.charts.map(e=>"IndicatorValue"===e.chart_type||"IndicatorValue"===e.type?(0,a.jsx)("div",{className:"flex flex-row gap-3",children:e.values.map(e=>(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(n.Z,{sx:{background:"transparent"},children:(0,a.jsxs)(r.Z,{className:"justify-around",children:[(0,a.jsx)(s.ZP,{gutterBottom:!0,component:"div",children:e.name}),(0,a.jsx)(s.ZP,{children:e.value})]})})},e.name))},e.chart_uid):"LineChart"===e.chart_type||"LineChart"===e.type?(0,a.jsx)(u,{chart:e},e.chart_uid):"BarChart"===e.chart_type||"BarChart"===e.type?(0,a.jsx)(o,{chart:e},e.chart_uid):"Table"===e.chart_type||"TableChartData"===e.type?(0,a.jsx)(x,{chart:e},e.chart_uid):void 0)},"chart_row_".concat(t)))})}},50554:function(e,t,l){l.d(t,{ZP:function(){return eH},dx:function(){return eG},CE:function(){return eA}});var a=l(52676),n=l(78471),r=l(92821);function s(e,t){try{return JSON.parse(e)}catch(e){return console.error("Failed to parse JSON:",e),t}}var i=l(81707),c=l(22694),d=l(25796),o=l(41066),u=l(35215),m=l(58021),h=l(56367),x=l(63046),p=l(85711);l(51004);var g=l(50752),v=l(79031),j=l(65308),f=l(6229),y=l(43840),b=l(44610),N=l(81882),_=l(94132),w=l(13250),k=l(75271);let Z=e=>{let{references:t}=e,l=(0,w.useRouter)(),[n,r]=(0,k.useState)(!1),s=(0,k.useMemo)(()=>l.pathname.includes("/mobile"),[l]),c=(0,k.useMemo)(()=>{var e;return null==t?void 0:null===(e=t.knowledge)||void 0===e?void 0:e.map(e=>{var t;return{label:(0,a.jsx)("div",{style:{maxWidth:"120px"},children:(0,a.jsx)(b.Z.Text,{ellipsis:{tooltip:e.name},children:decodeURIComponent(e.name).split("_")[0]})}),key:e.name,children:(0,a.jsx)("div",{className:"h-full overflow-y-auto",children:null==e?void 0:null===(t=e.chunks)||void 0===t?void 0:t.map(e=>(0,a.jsx)(y.default,{children:e.content},e.id))})}})},[t]);return(0,a.jsxs)("div",{children:[(0,a.jsx)(N.Z,{className:"mb-1 mt-0",dashed:!0}),(0,a.jsxs)("div",{className:"flex text-sm gap-2 text-blue-400",onClick:()=>r(!0),children:[(0,a.jsx)(i.Z,{}),(0,a.jsx)("span",{className:"text-sm",children:"查看回复引用"})]}),(0,a.jsx)(_.Z,{open:n,title:"回复引用",placement:s?"bottom":"right",onClose:()=>r(!1),destroyOnClose:!0,className:"p-0",...!s&&{width:"30%"},children:(0,a.jsx)(p.Z,{items:c,size:"small"})})]})};var C=e=>{let{references:t}=e;try{let e=JSON.parse(t);return(0,a.jsx)(Z,{references:e})}catch(e){return null}},S=l(99275),E=l(7036),O=l(42599),P=l(66118),L=l(24573),T=l(94634),R=e=>{let{data:t}=e,l=(0,k.useMemo)(()=>{switch(t.status){case"todo":return(0,a.jsx)(E.Z,{});case"failed":return(0,a.jsx)(O.Z,{className:"text-[rgb(255,77,79)]"});case"complete":return(0,a.jsx)(P.Z,{className:"text-[rgb(82,196,26)]"});case"running":return(0,a.jsx)(T.Z,{indicator:(0,a.jsx)(L.Z,{style:{fontSize:24},spin:!0})});default:return null}},[t]);return t?(0,a.jsxs)("div",{className:"flex flex-col p-2 border pr-4 rounded-md min-w-fit w-2/5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(S.Z,{scene:"chat_agent",width:8,height:8}),(0,a.jsxs)("div",{className:"flex flex-col flex-1 ml-2",children:[(0,a.jsx)("div",{className:"flex items-center text-sm dark:text-[rgba(255,255,255,0.85)] gap-2",children:null==t?void 0:t.app_name}),(0,a.jsx)(b.Z.Text,{className:"text-sm text-[#525964] dark:text-[rgba(255,255,255,0.65)] leading-6",ellipsis:{tooltip:!0},children:null==t?void 0:t.app_desc})]})]}),(0,a.jsx)("div",{className:"text-2xl ml-1",children:l})]}),"failed"===t.status&&t.msg&&(0,a.jsx)(b.Z.Text,{type:"danger",className:"pl-12 text-xs mt-2",children:t.msg})]}):null},F=l(31959),M=l(919),z=l(41148),D=e=>{let{children:t,msg:l}=e,{handleChat:n}=(0,k.useContext)(F.ChatContentContext),{handleChat:r}=(0,k.useContext)(M.MobileChatContext);return(0,a.jsx)(z.ZP,{className:"ml-1 inline text-xs",onClick:()=>{null==r||r(l),null==n||n(l)},type:"dashed",size:"small",children:t||"点击分析当前异常"})},I=l(21011),$=l(97344),q=l(92344),K=l(42625),A=l(89113),J=l(82187),Q=l.n(J),U=e=>{let{data:t}=e,{mode:l}=(0,k.useContext)(I.p),n=(0,k.useMemo)(()=>{switch(t.status){case"complete":return"success";case"failed":return"error";case"running":return"warning";default:return}},[t]);if(!t)return null;let r="dark"===l?q.R:K.K;return(0,a.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,a.jsx)(A.Z,{className:Q()("mb-4",{"bg-[#fafafa] border-[transparent]":!n}),message:t.name,type:n,...n&&{showIcon:!0},..."warning"===n&&{icon:(0,a.jsx)(T.Z,{indicator:(0,a.jsx)(L.Z,{spin:!0})})}}),t.result&&(0,a.jsx)($.ZP,{style:{...r,width:"100%",padding:10},className:Q()({"bg-[#fafafa]":"light"===l}),value:JSON.parse(t.result||"{}"),enableClipboard:!1,displayDataTypes:!1,objectSortKeys:!1}),t.err_msg&&(0,a.jsx)(u.Z,{components:eH,...eG,children:t.err_msg})]})},B=l(10332),G=function(e){let{data:t}=e;return t&&t.length?(0,a.jsx)(a.Fragment,{children:t.map((e,t)=>(0,a.jsxs)("div",{className:"rounded",children:[(0,a.jsxs)("div",{className:"flex items-center mb-3 text-sm",children:[e.model?(0,a.jsx)(B.Z,{model:e.model}):(0,a.jsx)("img",{src:"/agents/".concat(e.avatar),className:"flex-0 rounded-2xl w-6 h-6 inline-block"}),(0,a.jsxs)("div",{className:"ml-2 opacity-70 text-xs",children:[e.sender,(0,a.jsxs)("span",{className:"text-blue-500 font-medium pl-1",children:["@",e.receiver]})]})]}),(0,a.jsx)("div",{className:"whitespace-normal text-xs mb-3",children:(0,a.jsx)(u.Z,{components:eH,...eG,children:eA(e.markdown)})}),e.resource&&"null"!==e.resource&&(0,a.jsx)(C,{references:e.resource})]},t))}):null},H=l(3642),V=function(e){let{data:t}=e;return t&&t.length?(0,a.jsx)("div",{className:"flex flex-col",children:t.map((e,t)=>(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex-row mb-1",children:[(0,a.jsx)("span",{className:"text-sm",children:e.agent}),"complete"===e.status?(0,a.jsx)(H.Z,{className:"!text-green-500 ml-2"}):(0,a.jsx)(E.Z,{className:"!text-gray-500 ml-2"})]}),(0,a.jsx)("div",{className:"text-xs break-all text-gray-500",children:e.name})]},t))}):null},W=l(64771),Y=l(42673),X=l(874),ee=l.n(X),et=l(72365),el=l(94736),ea=l(2071);function en(e){let{code:t,light:l,dark:n,language:r,customStyle:s}=e,{mode:i}=(0,k.useContext)(I.p);return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(z.ZP,{className:"absolute right-3 top-2 text-gray-300 hover:!text-gray-200 bg-gray-700",type:"text",icon:(0,a.jsx)(W.Z,{}),onClick:()=>{let e=ee()(t);Y.ZP[e?"success":"error"](e?"复制成功":"复制失败")}}),(0,a.jsx)(et.Z,{customStyle:s,language:r,style:"dark"===i?null!=n?n:el.Z:null!=l?l:ea.Z,children:t})]})}var er=l(36967),es=l(41804),ei=l(30426),ec=l(49113),ed=l(99879),eo=l(78490),eu=e=>{let{code:t,language:l="html"}=e,[n,r]=(0,k.useState)(!1),[s,i]=(0,k.useState)(!1),[c,d]=(0,k.useState)(!1),o=(0,k.useRef)(null),{t:u}=(0,eo.$G)(),[m,h]=(0,k.useState)({html:"",css:"",js:"",fullCode:""});(0,k.useEffect)(()=>{h((e=>{let t=e,l="",a="",n=[...e.matchAll(/<style[^>]*>([\s\S]*?)<\/style>/gi)];n.length>0&&n.forEach(e=>{l+=e[1]+"\n",t=t.replace(e[0],"")});let r=[...e.matchAll(/<script[^>]*>([\s\S]*?)<\/script>/gi)];r.length>0&&r.forEach(e=>{a+=e[1]+"\n",t=t.replace(e[0],"")});let s=e;return e.includes("<!DOCTYPE html>")||e.includes("<html")||(s='\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>HTML Preview</title>\n  '.concat(n.length>0?n.map(e=>e[0]).join("\n"):"","\n</head>\n<body>\n  ").concat(t,"\n  ").concat(r.length>0?r.map(e=>e[0]).join("\n"):"","\n</body>\n</html>")),{html:t,css:l,js:a,fullCode:s}})(t))},[t]),(0,k.useEffect)(()=>{let e=()=>{d(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e),()=>{document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e)}},[]);let x=()=>{c&&f(),r(!1)},g=()=>{let e=new Blob([m.fullCode],{type:"text/html"}),t=URL.createObjectURL(e),l=document.createElement("a");l.href=t,l.download="preview.html",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(t)},v=()=>{c?f():j()},j=()=>{let e=o.current;e&&(e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen&&e.mozRequestFullScreen())},f=()=>{document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen()};return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(en,{code:t,language:l}),(0,a.jsxs)("div",{className:"absolute bottom-2 right-2 flex gap-2",children:[(0,a.jsx)(z.ZP,{type:"text",icon:(0,a.jsx)(W.Z,{}),onClick:()=>{navigator.clipboard.writeText(t).then(()=>{i(!0),setTimeout(()=>i(!1),2e3)})},className:"flex items-center justify-center bg-opacity-70 hover:bg-opacity-100 transition-all",size:"small",children:s?u("code_preview_already_copied"):u("code_preview_copy")}),(0,a.jsx)(z.ZP,{type:"text",icon:(0,a.jsx)(ei.Z,{}),onClick:g,className:"flex items-center justify-center bg-opacity-70 hover:bg-opacity-100 transition-all",size:"small",children:u("code_preview_download")}),(0,a.jsx)(z.ZP,{type:"primary",icon:(0,a.jsx)(ec.Z,{}),onClick:()=>{r(!0)},className:"flex items-center justify-center bg-opacity-70 hover:bg-opacity-100 transition-all",size:"small",children:u("code_preview_run")})]}),(0,a.jsx)(ed.default,{title:"HTML "+u("code_preview"),open:n,onCancel:x,footer:[(0,a.jsxs)(z.ZP,{icon:(0,a.jsx)(ei.Z,{}),onClick:g,children:[u("code_preview_download")," HTML"]},"download"),(0,a.jsx)(z.ZP,{icon:c?(0,a.jsx)(er.Z,{}):(0,a.jsx)(es.Z,{}),onClick:v,children:c?u("code_preview_exit_full_screen"):u("code_preview_full_screen")},"fullscreen"),(0,a.jsx)(z.ZP,{onClick:x,children:u("code_preview_close")},"close")],width:800,bodyStyle:{padding:0},children:(0,a.jsx)(p.Z,{defaultActiveKey:"preview",items:(()=>{let e=[{key:"preview",label:u("code_preview"),children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("iframe",{ref:o,srcDoc:m.fullCode,style:{width:"100%",height:"60vh",border:"none"},sandbox:"allow-scripts allow-same-origin",title:"HTML Preview"}),(0,a.jsx)(z.ZP,{type:"primary",icon:c?(0,a.jsx)(er.Z,{}):(0,a.jsx)(es.Z,{}),onClick:v,className:"absolute top-2 right-2 z-10",size:"small",children:c?u("code_preview_exit_full_screen"):u("code_preview_full_screen")})]})}];return(m.html||m.css||m.js)&&e.push({key:"code",label:u("code_preview_code"),children:(0,a.jsxs)("div",{className:"p-4",children:[m.html&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"HTML"}),(0,a.jsx)(en,{code:m.html,language:"html"})]}),m.css&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"CSS"}),(0,a.jsx)(en,{code:m.css,language:"css"})]}),m.js&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"JavaScript"}),(0,a.jsx)(en,{code:m.js,language:"javascript"})]})]})}),e})()})})]})},em=l(1693),eh=l(98342),ex=l(47383),ep=l(53832),eg=l(14486),ev=e=>{let{code:t,language:l="svg"}=e,[n,r]=(0,k.useState)(!1),[s,i]=(0,k.useState)(!1),[c,d]=(0,k.useState)(100),{t:o}=(0,eo.$G)(),u=e=>{let t=e.replace(/<\?xml[^>]*\?>/g,"");if(t.includes("<svg")||(t='<svg xmlns="http://www.w3.org/2000/svg">'.concat(t,"</svg>")),!t.includes("xmlns=")&&t.includes("<svg")&&(t=t.replace("<svg",'<svg xmlns="http://www.w3.org/2000/svg"')),!t.includes("viewBox")&&t.includes("<svg")){let e=t.match(/width=["']([^"']*)["']/),l=t.match(/height=["']([^"']*)["']/);if(e&&l){let a=e[1].replace(/[^\d.]/g,""),n=l[1].replace(/[^\d.]/g,"");a&&n&&(t=t.replace("<svg",'<svg viewBox="0 0 '.concat(a," ").concat(n,'"')))}else t=t.replace("<svg",'<svg viewBox="0 0 800 600"')}return t.includes("</svg>")||(t="".concat(t,"</svg>")),t},m=()=>{let e=t.match(/<svg[\s\S]*<\/svg>/im);return e?u(e[0]):u(t)},h=()=>{r(!1),d(100)},x=()=>{let e=new Blob([m()],{type:"image/svg+xml"}),t=URL.createObjectURL(e),l=document.createElement("a");l.href=t,l.download="image.svg",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(t)},g=e=>{d(e)},v=()=>{d(Math.min(c+10,200))},j=()=>{d(Math.max(c-10,50))},f=()=>{d(100)};return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(en,{code:t,language:l}),(0,a.jsxs)("div",{className:"absolute bottom-2 right-2 flex gap-2",children:[(0,a.jsx)(z.ZP,{type:"text",icon:(0,a.jsx)(W.Z,{}),onClick:()=>{navigator.clipboard.writeText(t).then(()=>{i(!0),setTimeout(()=>i(!1),2e3)})},className:"flex items-center justify-center bg-opacity-70 hover:bg-opacity-100 transition-all",size:"small",children:s?o("code_preview_already_copied"):o("code_preview_copy")}),(0,a.jsx)(z.ZP,{type:"text",icon:(0,a.jsx)(ei.Z,{}),onClick:x,className:"flex items-center justify-center bg-opacity-70 hover:bg-opacity-100 transition-all",size:"small",children:o("code_preview_download")}),(0,a.jsx)(z.ZP,{type:"primary",icon:(0,a.jsx)(ec.Z,{}),onClick:()=>{r(!0)},className:"flex items-center justify-center bg-opacity-70 hover:bg-opacity-100 transition-all",size:"small",children:o("code_preview")})]}),(0,a.jsx)(ed.default,{title:"SVG "+o("code_preview"),open:n,onCancel:h,footer:[(0,a.jsxs)(z.ZP,{icon:(0,a.jsx)(ei.Z,{}),onClick:x,children:[o("code_preview_download")," SVG"]},"svg"),(0,a.jsxs)(z.ZP,{onClick:()=>{let e=document.createElement("canvas"),t=e.getContext("2d"),l=new Image,a=new Blob([m()],{type:"image/svg+xml"}),n=URL.createObjectURL(a);l.onload=()=>{e.width=l.width,e.height=l.height,t.drawImage(l,0,0);try{let t=e.toDataURL("image/png"),l=document.createElement("a");l.href=t,l.download="image.png",document.body.appendChild(l),l.click(),document.body.removeChild(l)}catch(e){console.error("PNG export failed:",e)}URL.revokeObjectURL(n)},l.src=n},children:[o("code_preview_download")," PNG"]},"png"),(0,a.jsx)(z.ZP,{onClick:h,children:o("code_preview_close")},"close")],width:800,bodyStyle:{padding:0},children:(0,a.jsx)(p.Z,{defaultActiveKey:"preview",items:(()=>{let e=[{key:"preview",label:o("code_preview"),children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"flex justify-center items-center p-4 bg-gray-100 dark:bg-gray-800 min-h-[60vh] overflow-auto",children:(0,a.jsx)("div",{className:"relative bg-white dark:bg-gray-700 p-4 shadow-md rounded flex items-center justify-center",children:(0,a.jsx)("div",{className:"transition-transform duration-200",style:{transform:"scale(".concat(c/100,")"),transformOrigin:"center center",maxWidth:"100%",maxHeight:"100%"},children:(0,a.jsx)("div",{className:"svg-container",dangerouslySetInnerHTML:{__html:m()},style:{maxWidth:"100%",margin:"0 auto",display:"flex",alignItems:"center",justifyContent:"center"}})})})}),(0,a.jsx)("div",{className:"flex items-center justify-center p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:(0,a.jsxs)(ep.Z,{children:[(0,a.jsx)(z.ZP,{icon:(0,a.jsx)(em.Z,{}),onClick:j,disabled:c<=50}),(0,a.jsx)(eg.Z,{min:50,max:200,value:c,onChange:g,style:{width:200}}),(0,a.jsx)(z.ZP,{icon:(0,a.jsx)(eh.Z,{}),onClick:v,disabled:c>=200}),(0,a.jsx)(z.ZP,{icon:(0,a.jsx)(ex.Z,{}),onClick:f,disabled:100===c}),(0,a.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400 min-w-[50px]",children:[c,"%"]})]})})]})},{key:"code",label:o("code_preview_code"),children:(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(en,{code:t,language:"svg"})})}];return e})()})})]})},ej=l(19518),ef=function(e){var t;let{data:l,type:n,sql:s}=e,i=(null==l?void 0:l[0])?null===(t=Object.keys(null==l?void 0:l[0]))||void 0===t?void 0:t.map(e=>({title:e,dataIndex:e,key:e})):[],c={key:"chart",label:"Chart",children:(0,a.jsx)(ej._,{data:l,chartType:(0,ej.a)(n)})},d={key:"sql",label:"SQL",children:(0,a.jsx)(en,{language:"sql",code:(0,r._m)(null!=s?s:"","mysql")})},o={key:"data",label:"Data",children:(0,a.jsx)(x.Z,{dataSource:l,columns:i,scroll:{x:"auto"}})},u="response_table"===n?[o,d]:[c,d,o];return(0,a.jsx)(p.Z,{defaultActiveKey:"response_table"===n?"data":"chart",items:u,size:"small"})},ey=function(e){let{data:t}=e;return t?(0,a.jsx)(ef,{data:null==t?void 0:t.data,type:null==t?void 0:t.type,sql:null==t?void 0:t.sql}):null},eb=l(40082),eN=l(98990),e_=l(47023),ew=function(e){let{data:t}=e,{t:l}=(0,eo.$G)(),[n,r]=(0,k.useState)(0);return(0,a.jsxs)("div",{className:"bg-[#EAEAEB] rounded overflow-hidden border border-theme-primary dark:bg-theme-dark text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex",children:t.code.map((e,t)=>(0,a.jsxs)("div",{className:Q()("px-4 py-2 text-[#121417] dark:text-white cursor-pointer",{"bg-white dark:bg-theme-dark-container":t===n}),onClick:()=>{r(t)},children:["CODE ",t+1,": ",e[0]]},t))}),t.code.length&&(0,a.jsx)(en,{language:t.code[n][0],code:t.code[n][1],customStyle:{maxHeight:300,margin:0},light:e_.Z,dark:ea.Z})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-theme-dark-container px-4 py-2 text-[#121417] dark:text-white",children:[l("Terminal")," ",t.exit_success?(0,a.jsx)(eb.Z,{className:"text-green-600"}):(0,a.jsx)(eN.Z,{className:"text-red-600"})]})}),(0,a.jsx)("div",{className:"p-4 max-h-72 overflow-y-auto whitespace-normal bg-white dark:dark:bg-theme-dark",children:(0,a.jsx)(u.Z,{components:eH,remarkPlugins:[j.Z],children:t.log})})]})]})},ek=function(e){let{data:t}=e;return(0,a.jsxs)("div",{className:"rounded overflow-hidden",children:[(0,a.jsx)("div",{className:"p-3 text-white bg-red-500 whitespace-normal",children:t.display_type}),(0,a.jsxs)("div",{className:"p-3 bg-red-50",children:[(0,a.jsx)("div",{className:"mb-2 whitespace-normal",children:t.thought}),(0,a.jsx)(en,{code:(0,r._m)(t.sql),language:"sql"})]})]})};let eZ=[[2],[1,2],[1,3],[2,1,2],[2,1,3],[3,1,3],[3,2,3]];var eC=function(e){let{data:t}=e,l=(0,k.useMemo)(()=>{if(t.chart_count>1){let e=eZ[t.chart_count-2],l=0;return e.map(e=>{let a=t.data.slice(l,l+e);return l=e,a})}return[t.data]},[t.data,t.chart_count]);return(0,a.jsx)("div",{className:"flex flex-col gap-3",children:l.map((e,t)=>(0,a.jsx)("div",{className:"flex gap-3",children:e.map((e,t)=>(0,a.jsxs)("div",{className:"flex flex-1 flex-col justify-between p-4 rounded border border-gray-200 dark:border-gray-500 whitespace-normal",children:[(0,a.jsxs)("div",{children:[e.title&&(0,a.jsx)("div",{className:"mb-2 text-lg",children:e.title}),e.describe&&(0,a.jsx)("div",{className:"mb-4 text-sm text-gray-500",children:e.describe})]}),(0,a.jsx)(n._z,{data:e.data,chartType:(0,n.aG)(e.type)})]},"chart-".concat(t)))},"row-".concat(t)))})},eS=l(14258);let eE={todo:{bgClass:"bg-gray-500",icon:(0,a.jsx)(E.Z,{className:"ml-2"})},runing:{bgClass:"bg-blue-500",icon:(0,a.jsx)(L.Z,{className:"ml-2"})},failed:{bgClass:"bg-red-500",icon:(0,a.jsx)(eS.Z,{className:"ml-2"})},complete:{bgClass:"bg-green-500",icon:(0,a.jsx)(H.Z,{className:"ml-2"})}};var eO=function(e){var t,l;let{data:n}=e,{bgClass:r,icon:s}=null!==(t=eE[n.status])&&void 0!==t?t:{};return(0,a.jsxs)("div",{className:"bg-theme-light dark:bg-theme-dark-container rounded overflow-hidden my-2 flex flex-col",children:[(0,a.jsxs)("div",{className:Q()("flex px-4 md:px-6 py-2 items-center text-white text-sm",r),children:[n.name,s]}),n.result?(0,a.jsx)("div",{className:"px-4 md:px-6 py-4 text-sm whitespace-normal",children:(0,a.jsx)(u.Z,{components:eH,rehypePlugins:[v.Z],remarkPlugins:[j.Z],children:null!==(l=n.result)&&void 0!==l?l:""})}):(0,a.jsx)("div",{className:"px-4 md:px-6 py-4 text-sm",children:n.err_msg})]})};function eP(e,t){if(!e)return null;let l=e;for(;l;){if(l.classList.contains(t))return l;l=l.parentElement}return null}var eL=l(80216);let eT={TASK_CLICK:"task-click"},eR=new eL.Z;function eF(e){return e.length>0?e[e.length-1].task_id:""}function eM(e){let{data:t}=e,[l,n]=(0,k.useState)(eF(t)),[r,s]=(0,k.useState)(!1),[i,c]=(0,k.useState)(!0),d=(0,k.useRef)(null);function o(){if(!d.current)return;let e=eP(d.current,"overflow-y-auto");if(!e)return;let t=e.scrollTop,l=e.scrollHeight,a=e.clientHeight;c(t+a>=l-10)}function m(e){e===eF(t)?s(!1):s(!0),n(e)}return(0,k.useEffect)(()=>{if(r||n(eF(t)),i&&!r&&d.current){let e=eP(d.current,"overflow-y-auto");e&&e.scrollTo({top:e.scrollHeight})}},[t]),(0,k.useEffect)(()=>{if(eR.on(eT.TASK_CLICK,e=>{m(e.taskId)}),d.current){let e=eP(d.current,"overflow-y-auto");e&&e.addEventListener("scroll",o)}},[]),(0,a.jsx)("div",{className:"flex pl-2",ref:d,children:(0,a.jsx)(p.Z,{className:"w-full",activeKey:l,items:t.map((e,t)=>{let{agent:l,markdown:n,task_id:r}=e;return{key:r,label:(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)("img",{src:"/agents/".concat(e.avatar),className:"flex-0 rounded-xl w-4 h-4 inline-block mr-2",alt:"".concat(l," avatar")}),(0,a.jsx)("span",{className:"text-xs break-all",children:l})]}),children:(0,a.jsx)(u.Z,{components:eH,...eG,children:eA(n)})}}),size:"small",onChange:m})})}var ez=l(15853);function eD(e){let{data:t}=e;return t&&t.length?(0,a.jsx)("div",{className:"flex flex-col",children:t.map(e=>{var t;return(0,a.jsxs)("div",{className:"flex flex-row mb-4 cursor-pointer hover:bg-gray-100 p-2 rounded-lg",onClick:(t=e.task_id,()=>{eR.emit(eT.TASK_CLICK,{taskId:t})}),children:[(0,a.jsx)("img",{src:"/agents/".concat(e.avatar),className:"flex-0 rounded-2xl w-8 h-8 inline-block mr-2"}),(0,a.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,a.jsxs)("div",{className:"flex-row mb-1",children:[(0,a.jsxs)("span",{className:"text-xs break-all",children:[e.name," ",(0,a.jsxs)("span",{className:"text-blue-500 font-medium",children:["@",e.agent]})]}),function(e){switch(e){case"todo":return(0,a.jsx)(ez.Z,{className:"!text-gray-500 ml-2"});case"running":return(0,a.jsx)(L.Z,{className:"!text-blue-500 ml-2"});case"waiting":return(0,a.jsx)(E.Z,{className:"!text-yellow-500 ml-2"});case"retrying":return(0,a.jsx)(L.Z,{className:"!text-orange-500 ml-2"});case"failed":return(0,a.jsx)(eS.Z,{className:"!text-red-500 ml-2"});case"complete":return(0,a.jsx)(H.Z,{className:"!text-green-500 ml-2"});default:return(0,a.jsx)(E.Z,{className:"!text-gray-500 ml-2"})}}(e.status)]}),(0,a.jsx)("div",{className:"text-xs break-all text-gray-500",children:e.content})]})]},"task-".concat(e.task_id))})}):null}var eI=l(13143),e$=l(27806);function eq(e){let{content:t}=e,{t:l}=(0,eo.$G)(),[n,r]=k.useState(!0);return(0,a.jsxs)("div",{className:"my-4 border rounded-lg overflow-hidden dark:border-gray-600",children:[(0,a.jsx)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 cursor-pointer",onClick:()=>r(!n),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"mr-2 font-medium text-gray-700 dark:text-gray-300",children:n?(0,a.jsx)(eI.Z,{}):(0,a.jsx)(e$.Z,{})}),(0,a.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:l("cot_title")})]})}),n&&(0,a.jsx)("div",{className:"p-4 bg-white dark:bg-gray-900 border-t dark:border-gray-700",children:(0,a.jsx)("div",{className:"py-2 px-4 border-l-4 border-blue-600 rounded bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-300",children:t||""})})]})}let eK=["custom-view","chart-view","references","summary"];function eA(e){if("string"!=typeof e)return e;let t=[];return e=(e=(e=(e=(e=e.replace(/(```[\s\S]*?```|`[^`\n]+`)/g,e=>(t.push(e),"<<CODE_BLOCK_".concat(t.length-1,">>")))).replace(/\\\\\[/g,"$$").replace(/\\\\\]/g,"$$").replace(/\\\\\(/g,"$").replace(/\\\\\)/g,"$").replace(/\\\[/g,"$$").replace(/\\\]/g,"$$").replace(/\\\(/g,"$").replace(/\\\)/g,"$")).replace(/([^\n])\$\$/g,"$1\n\n$$").replace(/\$\$([^\n])/g,"$$\n\n$1")).replace(/\$(?=\d)/g,"\\$")).replace(/<<CODE_BLOCK_(\d+)>>/g,(e,l)=>t[parseInt(l)])}let eJ={code:(0,o.r)({languageRenderers:{"agent-plans":e=>{let{className:t,children:l}=e,n=String(l),r=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(n);return(0,a.jsx)(V,{data:e})}catch(e){return(0,a.jsx)(en,{language:r,code:n})}},"agent-messages":e=>{let{className:t,children:l}=e,n=String(l),r=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(n);return(0,a.jsx)(G,{data:e})}catch(e){return(0,a.jsx)(en,{language:r,code:n})}},"vis-tabs":e=>{let{className:t,children:l}=e,n=String(l),r=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=s(n,[]);return(0,a.jsx)(eM,{data:e})}catch(e){return(0,a.jsx)(en,{language:r,code:n})}},"vis-tasks":e=>{let{className:t,children:l}=e,n=String(l),r=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=s(n,[]);return(0,a.jsx)(eD,{data:e})}catch(e){return(0,a.jsx)(en,{language:r,code:n})}},"vis-convert-error":e=>{let{className:t,children:l}=e,n=String(l),r=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(n);return(0,a.jsx)(ek,{data:e})}catch(e){return(0,a.jsx)(en,{language:r,code:n})}},"vis-dashboard":e=>{let{className:t,children:l}=e,n=String(l),r=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(n);return(0,a.jsx)(eC,{data:e})}catch(e){return(0,a.jsx)(en,{language:r,code:n})}},"vis-db-chart":e=>{let{className:t,children:l}=e,n=String(l),r=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(n);return(0,a.jsx)(ey,{data:e})}catch(e){return(0,a.jsx)(en,{language:r,code:n})}},"vis-plugin":e=>{let{className:t,children:l}=e,n=String(l),r=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(n);return(0,a.jsx)(eO,{data:e})}catch(e){return(0,a.jsx)(en,{language:r,code:n})}},"vis-code":e=>{let{className:t,children:l}=e,n=String(l),r=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(n);return(0,a.jsx)(ew,{data:e})}catch(e){return(0,a.jsx)(en,{language:r,code:n})}},"vis-app-link":e=>{let{className:t,children:l}=e,n=String(l),r=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(n);return(0,a.jsx)(R,{data:e})}catch(e){return(0,a.jsx)(en,{language:r,code:n})}},"vis-api-response":e=>{let{className:t,children:l}=e,n=String(l),r=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(n);return(0,a.jsx)(U,{data:e})}catch(e){return(0,a.jsx)(en,{language:r,code:n})}},"vis-thinking":e=>{let{className:t,children:l}=e,n=String(l);return null==t||t.replace("language-",""),(0,a.jsx)(eq,{content:n})},html:e=>{let{className:t,children:l}=e,n=String(l);return(0,a.jsx)(eu,{code:n,language:"html"})},web:e=>{let{className:t,children:l}=e,n=String(l);return(0,a.jsx)(eu,{code:n,language:"html"})},svg:e=>{let{className:t,children:l}=e,n=String(l);return(0,a.jsx)(ev,{code:n,language:"svg"})},xml:e=>{let{className:t,children:l}=e,n=String(l);return n.includes("<svg")&&n.includes("</svg>")?(0,a.jsx)(ev,{code:n,language:"svg"}):(0,a.jsx)(en,{code:n,language:"xml"})}},defaultRenderer(e){let{node:t,className:l,children:n,style:r,...s}=e,i=String(n),c=(null==l?void 0:l.replace("language-",""))||"",{context:d,matchValues:o}=function(e){let t=eK.reduce((t,l)=>{let a=RegExp("<".concat(l,"[^>]*/?>"),"gi");return e=e.replace(a,e=>(t.push(e),"")),t},[]);return{context:e,matchValues:t}}(i);return(0,a.jsxs)(a.Fragment,{children:[c?(0,a.jsx)(en,{code:d,language:c||"javascript"}):(0,a.jsx)("code",{...s,style:r,className:"p-1 mx-1 rounded bg-theme-light dark:bg-theme-dark text-sm",children:n}),(0,a.jsx)(u.Z,{components:eB,rehypePlugins:[v.Z,g.Z],remarkPlugins:[j.Z,f.Z],children:o.join("\n")})]})}})},eQ={...eJ,ul(e){let{children:t}=e;return(0,a.jsx)("ul",{className:"py-1",children:t})},ol(e){let{children:t}=e;return(0,a.jsx)("ol",{className:"py-1",children:t})},li(e){let{children:t,ordered:l}=e;return(0,a.jsx)("li",{className:"text-sm leading-7 ml-5 pl-2 text-gray-600 dark:text-gray-300 ".concat(l?"list-decimal":"list-disc"),children:t})},table(e){let{children:t}=e;return(0,a.jsx)("table",{className:"my-2 rounded-tl-md rounded-tr-md  bg-white dark:bg-gray-800 text-sm rounded-lg overflow-hidden",children:t})},thead(e){let{children:t}=e;return(0,a.jsx)("thead",{className:"bg-[#fafafa] dark:bg-black font-semibold",children:t})},th(e){let{children:t}=e;return(0,a.jsx)("th",{className:"!text-left p-4",children:t})},td(e){let{children:t}=e;return(0,a.jsx)("td",{className:"p-4 border-t border-[#f0f0f0] dark:border-gray-700",children:t})},h1(e){let{children:t}=e;return(0,a.jsx)("h3",{className:"text-2xl font-bold my-4 border-b border-slate-300 pb-4",children:t})},h2(e){let{children:t}=e;return(0,a.jsx)("h3",{className:"text-xl font-bold my-3",children:t})},h3(e){let{children:t}=e;return(0,a.jsx)("h3",{className:"text-lg font-semibold my-2",children:t})},h4(e){let{children:t}=e;return(0,a.jsx)("h3",{className:"text-base font-semibold my-1",children:t})},a(e){let{children:t,href:l}=e;return(0,a.jsxs)("div",{className:"inline-block text-blue-600 dark:text-blue-400",children:[(0,a.jsx)(i.Z,{className:"mr-1"}),(0,a.jsx)("a",{href:l,target:"_blank",rel:"noreferrer",children:t})]})},img(e){let{src:t,alt:l}=e;return(0,a.jsx)("div",{children:(0,a.jsx)(m.Z,{className:"min-h-[1rem] max-w-full max-h-full border rounded",src:t,alt:l,placeholder:(0,a.jsx)(h.Z,{icon:(0,a.jsx)(c.Z,{spin:!0}),color:"processing",children:"Image Loading..."}),fallback:"/pictures/fallback.png"})})},blockquote(e){let{children:t}=e;return(0,a.jsx)("blockquote",{className:"py-4 px-6 border-l-4 border-blue-600 rounded bg-white my-2 text-gray-500 dark:bg-slate-800 dark:text-gray-200 dark:border-white shadow-sm",children:t})},button(e){let{children:t,className:l,...n}=e;if("chat-link"===l){let e=null==n?void 0:n["data-msg"];return(0,a.jsx)(D,{msg:e,children:t})}return(0,a.jsx)("button",{className:l,...n,children:t})}},eU=e=>{let t={"，":",","。":".","？":"?","！":"!","：":":","；":";","“":'"',"”":'"',"‘":"'","’":"'","（":"(","）":")","【":"[","】":"]","《":"<","》":">","—":"-","、":",","…":"..."},l=RegExp(Object.keys(t).join("|"),"g");return e.replace(l,e=>t[e])},eB={...eQ,"chart-view":function(e){var t,l,s;let i,{content:c,children:d}=e;try{i=JSON.parse(c)}catch(e){console.log(e,c),i={type:"response_table",sql:"",data:[]}}let o=(null==i?void 0:null===(t=i.data)||void 0===t?void 0:t[0])?null===(l=Object.keys(null==i?void 0:null===(s=i.data)||void 0===s?void 0:s[0]))||void 0===l?void 0:l.map(e=>({title:e,dataIndex:e,key:e})):[],u={key:"chart",label:"Chart",children:(0,a.jsx)(n._z,{data:null==i?void 0:i.data,chartType:(0,n.aG)(null==i?void 0:i.type)})},m={key:"sql",label:"SQL",children:(0,a.jsx)(en,{code:(0,r._m)(eU(null==i?void 0:i.sql),"mysql"),language:"sql"})},h={key:"data",label:"Data",children:(0,a.jsx)(x.Z,{dataSource:null==i?void 0:i.data,columns:o,scroll:{x:!0},virtual:!0})},g=(null==i?void 0:i.type)==="response_table"?[h,m]:[u,m,h];return(0,a.jsxs)("div",{children:[(0,a.jsx)(p.Z,{defaultActiveKey:(null==i?void 0:i.type)==="response_table"?"data":"chart",items:g,size:"small"}),d]})},references:function(e){let{children:t}=e;if(t)try{let e=JSON.parse(t),l=e.references;return(0,a.jsx)(C,{references:l})}catch(e){return null}},summary:function(e){let{children:t}=e;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"mb-2",children:[(0,a.jsx)(d.Z,{className:"mr-2"}),(0,a.jsx)("span",{className:"font-semibold",children:"Document Summary"})]}),(0,a.jsx)("div",{children:t})]})}},eG={remarkPlugins:[j.Z,[f.Z,{singleDollarTextMath:!0}]],rehypePlugins:[v.Z,[g.Z,{output:"htmlAndMathml"}]]};var eH=eB},43840:function(e,t,l){l.r(t);var a=l(52676),n=l(50554),r=l(35215);l(75271),t.default=e=>{let{children:t}=e;return(0,a.jsx)(r.Z,{components:{...n.ZP},...n.dx,children:(0,n.CE)(t)})}}}]);